# خريطة الأراضي - توثيق الميزات الجديدة

## الميزات المضافة

### 1. واجهة الفلاح - خريطة تحديد موقع الأرض
تم إضافة عنصر جديد في قائمة الفلاح يسمى "موقع الأرض" مع الميزات التالية:

- **تحديد الموقع على الخريطة**: الفلاح يمكنه النقر على خريطة الجزائر لتحديد موقع أرضه
- **إدارة الإحداثيات**: عرض خط العرض وخط الطول للموقع المحدد
- **تسمية الأراضي**: يمكن إضافة اسم لكل أرض لتمييزها
- **الحفظ والتخزين**: جميع المواقع المحددة تحفظ في localStorage لكل فلاح
- **العرض المتقدم**: عرض جميع الأراضي المسجلة مع إمكانية التنقل بينها

**الملف المسؤول**: `FarmLocationMap.tsx`

### 2. واجهة الإدارة - خريطة أراضي جميع الفلاحين
تم إضافة قسم جديد في لوحة التحكم الإدارية يسمى "خريطة الأراضي" مع الميزات التالية:

#### المميزات:
1. **عرض شامل للأراضي**: عرض جميع أراضي الفلاحين المسجلين على خريطة واحدة
2. **بحث متقدم**: البحث عن الفلاح أو اسم الأرض مع تحديث الخريطة تلقائياً
3. **قائمة جانبية**: عرض قائمة بجميع الأراضي مع معلومات سريعة:
   - اسم الفلاح
   - اسم الأرض
   - الإحداثيات (خط العرض والطول)
4. **التكبير والعرض**: عند الضغط على أي أرضية يتم التكبير على الخريطة وفتح معلومات الموقع
5. **علامات ملونة**: كل أرضية لها علامة زرقاء مميزة مع اسم الفلاح
6. **معلومات منفصلة**: عند النقر على العلامة يظهر:
   - اسم الفلاح
   - اسم الأرض
   - الإحداثيات الدقيقة

**الملف المسؤول**: `AdminFarmersMap.tsx`

### 3. تحديثات واجهات المستخدم

#### FarmerDashboard.tsx
- إضافة استيراد `MapPin` من Lucide
- إضافة استيراد `FarmLocationMap` component
- إضافة "map" للـ View type
- إضافة عنصر "موقع الأرض" في القائمة الجانبية
- إضافة عرض المكون عند اختيار الخريطة

#### AdminDashboard.tsx
- إضافة استيراد `MapPin` و `AdminFarmersMap`
- إضافة "map" للـ View type
- إضافة عنصر "خريطة الأراضي" في القائمة الإدارية
- إضافة عرض المكون في الواجهة الرئيسية

### 4. المكتبات المثبتة
```bash
npm install leaflet react-leaflet --legacy-peer-deps
```

- **Leaflet**: مكتبة خرائط مفتوحة المصدر قوية
- **React Leaflet**: ربط React مع Leaflet

### 5. تحديثات نمط CSS
تمت إضافة استيراد Leaflet CSS في `src/styles/index.css`

## معلومات تقنية

### تخزين البيانات
- كل فلاح لديه مفتاح localStorage خاص به: `farmLocation_${userId}`
- يتم تخزين الموقع بصيغة JSON مع الإحداثيات والاسم

### التكامل مع النظام الموجود
- الخريطة تقرأ بيانات الفلاحين من localStorage (نفس نظام التخزين الحالي)
- تعمل مع نظام المصادقة الموجود
- توافقة مع الواجهات الأخرى

## كيفية الاستخدام

### للفلاح:
1. الدخول إلى لوحة التحكم
2. الضغط على "موقع الأرض" من القائمة
3. النقر على الخريطة لتحديد الموقع
4. إضافة اسم الأرض (اختياري)
5. الضغط على "حفظ الموقع"

### للإدارة:
1. الدخول إلى لوحة التحكم الإدارية
2. الضغط على "خريطة الأراضي"
3. البحث عن فلاح أو أرضية معينة
4. النقر على أي عنصر في القائمة لعرضه على الخريطة
5. استخدام الخريطة للتخطيط للتفتيشات المفاجئة

## الفوائد

1. **تحسين الإدارة**: الإدارة يمكنها رؤية توزيع الأراضي جغرافياً
2. **تسهيل التفتيشات**: تخطيط أفضل للتفتيشات المفاجئة بناءً على المواقع
3. **دقة البيانات**: الإحداثيات الدقيقة لكل أرضية
4. **تحسين الخدمات**: يمكن تقديم خدمات محلية أفضل للفلاحين
5. **التتبع والإحصائيات**: معلومات جغرافية للتقارير والتحليلات
