{
  "version": 3,
  "sources": ["../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_listCacheClear.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/eq.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_assocIndexOf.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_listCacheDelete.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_listCacheGet.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_listCacheHas.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_listCacheSet.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_ListCache.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_stackClear.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_stackDelete.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_stackGet.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_stackHas.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_freeGlobal.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_root.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_Symbol.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_getRawTag.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_objectToString.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseGetTag.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/isObject.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/isFunction.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_coreJsData.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_isMasked.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_toSource.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseIsNative.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_getValue.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_getNative.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_Map.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_nativeCreate.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_hashClear.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_hashDelete.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_hashGet.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_hashHas.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_hashSet.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_Hash.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_mapCacheClear.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_isKeyable.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_getMapData.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_mapCacheDelete.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_mapCacheGet.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_mapCacheHas.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_mapCacheSet.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_MapCache.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_stackSet.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_Stack.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_defineProperty.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseAssignValue.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_assignMergeValue.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_createBaseFor.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseFor.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_cloneBuffer.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_Uint8Array.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_cloneArrayBuffer.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_cloneTypedArray.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_copyArray.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseCreate.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_overArg.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_getPrototype.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_isPrototype.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_initCloneObject.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/isObjectLike.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseIsArguments.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/isArguments.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/isArray.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/isLength.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/isArrayLike.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/isArrayLikeObject.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/stubFalse.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/isBuffer.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/isPlainObject.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseIsTypedArray.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseUnary.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_nodeUtil.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/isTypedArray.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_safeGet.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_assignValue.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_copyObject.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseTimes.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_isIndex.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_arrayLikeKeys.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_nativeKeysIn.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseKeysIn.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/keysIn.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/toPlainObject.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseMergeDeep.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseMerge.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/identity.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_apply.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_overRest.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/constant.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseSetToString.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_shortOut.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_setToString.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseRest.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_isIterateeCall.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_createAssigner.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/merge.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/isSymbol.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_isKey.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/memoize.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_memoizeCapped.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_stringToPath.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_arrayMap.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseToString.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/toString.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_castPath.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_toKey.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/_baseGet.js", "../../@geoman-io/leaflet-geoman-free/node_modules/lodash/get.js", "../../@geoman-io/leaflet-geoman-free/node_modules/rbush/rbush.min.js", "../../@geoman-io/leaflet-geoman-free/src/js/polyfills.js", "../../@geoman-io/leaflet-geoman-free/package.json", "../../@geoman-io/leaflet-geoman-free/src/js/L.PM.Map.js", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/en.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/de.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/it.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/id.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/ro.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/ru.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/es.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/nl.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/fr.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/zh.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/zh_tw.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/pt_br.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/pt_pt.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/pl.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/sv.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/el.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/hu.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/da.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/no.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/fa.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/ua.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/tr.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/cz.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/ja.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/fi.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/ko.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/ky.json", "../../@geoman-io/leaflet-geoman-free/src/assets/translations/index.js", "../../@geoman-io/leaflet-geoman-free/src/js/Mixins/Modes/Mode.Edit.js", "../../@geoman-io/leaflet-geoman-free/src/js/Mixins/Modes/Mode.Drag.js", "../../@geoman-io/leaflet-geoman-free/src/js/Mixins/Modes/Mode.Removal.js", "../../@geoman-io/leaflet-geoman-free/src/js/Mixins/Modes/Mode.Rotate.js", "../../@geoman-io/leaflet-geoman-free/src/js/Mixins/Events.js", "../../@geoman-io/leaflet-geoman-free/src/js/Mixins/Keyboard.js", "../../@geoman-io/leaflet-geoman-free/src/js/helpers/index.js", "../../@geoman-io/leaflet-geoman-free/src/js/helpers/language.js", "../../@geoman-io/leaflet-geoman-free/src/js/Toolbar/L.Controls.js", "../../@geoman-io/leaflet-geoman-free/src/js/Toolbar/L.PM.Toolbar.js", "../../@geoman-io/leaflet-geoman-free/src/js/Draw/L.PM.Draw.js", "../../@geoman-io/leaflet-geoman-free/src/js/Mixins/Snapping.js", "../../@geoman-io/leaflet-geoman-free/src/js/Draw/L.PM.Draw.Marker.js", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/helpers/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/kinks/index.ts", "../../@geoman-io/leaflet-geoman-free/src/js/Draw/L.PM.Draw.Line.js", "../../@geoman-io/leaflet-geoman-free/src/js/Draw/L.PM.Draw.Polygon.js", "../../@geoman-io/leaflet-geoman-free/src/js/Draw/L.PM.Draw.Rectangle.js", "../../@geoman-io/leaflet-geoman-free/src/js/Draw/L.PM.Draw.CircleMarker.js", "../../@geoman-io/leaflet-geoman-free/src/js/Draw/L.PM.Draw.Circle.js", "../../@geoman-io/leaflet-geoman-free/node_modules/sweepline-intersections/dist/sweeplineIntersections.esm.js", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/line-intersect/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/line-intersect/lib/sweepline-intersections-export.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/geojson-rbush/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/meta/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/bbox/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/truncate/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/invariant/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/line-segment/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/distance/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/nearest-point-on-line/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/line-split/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/robust-predicates/esm/util.js", "../../@geoman-io/leaflet-geoman-free/node_modules/robust-predicates/esm/orient2d.js", "../../@geoman-io/leaflet-geoman-free/node_modules/robust-predicates/esm/orient3d.js", "../../@geoman-io/leaflet-geoman-free/node_modules/robust-predicates/esm/incircle.js", "../../@geoman-io/leaflet-geoman-free/node_modules/robust-predicates/esm/insphere.js", "../../@geoman-io/leaflet-geoman-free/node_modules/point-in-polygon-hao/dist/esm/index.js", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/boolean-point-in-polygon/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/boolean-point-on-line/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/@turf/boolean-contains/index.ts", "../../@geoman-io/leaflet-geoman-free/src/js/Draw/L.PM.Draw.Cut.js", "../../@geoman-io/leaflet-geoman-free/node_modules/bignumber.js/bignumber.mjs", "../../@geoman-io/leaflet-geoman-free/node_modules/splaytree-ts/src/index.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/geom-in.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/constant.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/compare.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/orient.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/snap.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/identity.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/precision.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/bbox.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/operation.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/vector.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/sweep-event.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/geom-out.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/sweep-line.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/segment.ts", "../../@geoman-io/leaflet-geoman-free/node_modules/polyclip-ts/src/index.ts", "../../@geoman-io/leaflet-geoman-free/src/js/helpers/turfHelper.js", "../../@geoman-io/leaflet-geoman-free/src/js/Draw/L.PM.Draw.Text.js", "../../@geoman-io/leaflet-geoman-free/src/js/Mixins/Dragging.js", "../../@geoman-io/leaflet-geoman-free/src/js/Mixins/Rotating.js", "../../@geoman-io/leaflet-geoman-free/src/js/helpers/ModeHelper.js", "../../@geoman-io/leaflet-geoman-free/src/js/Edit/L.PM.Edit.js", "../../@geoman-io/leaflet-geoman-free/src/js/Edit/L.PM.Edit.LayerGroup.js", "../../@geoman-io/leaflet-geoman-free/src/js/Edit/L.PM.Edit.Marker.js", "../../@geoman-io/leaflet-geoman-free/src/js/Edit/L.PM.Edit.Line.js", "../../@geoman-io/leaflet-geoman-free/src/js/Mixins/MarkerLimits.js", "../../@geoman-io/leaflet-geoman-free/src/js/Edit/L.PM.Edit.Polygon.js", "../../@geoman-io/leaflet-geoman-free/src/js/Edit/L.PM.Edit.Rectangle.js", "../../@geoman-io/leaflet-geoman-free/src/js/Edit/L.PM.Edit.CircleMarker.js", "../../@geoman-io/leaflet-geoman-free/src/js/Edit/L.PM.Edit.Circle.js", "../../@geoman-io/leaflet-geoman-free/src/js/Edit/L.PM.Edit.ImageOverlay.js", "../../@geoman-io/leaflet-geoman-free/src/js/Edit/L.PM.Edit.Text.js", "../../@geoman-io/leaflet-geoman-free/src/js/helpers/Matrix.js", "../../@geoman-io/leaflet-geoman-free/src/js/L.PM.Utils.js", "../../@geoman-io/leaflet-geoman-free/src/js/L.PM.js"],
  "sourcesContent": ["/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nmodule.exports = listCacheClear;\n", "/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n", "var eq = require('./eq');\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = assocIndexOf;\n", "var assocIndexOf = require('./_assocIndexOf');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nmodule.exports = listCacheDelete;\n", "var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nmodule.exports = listCacheGet;\n", "var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nmodule.exports = listCacheHas;\n", "var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nmodule.exports = listCacheSet;\n", "var listCacheClear = require('./_listCacheClear'),\n    listCacheDelete = require('./_listCacheDelete'),\n    listCacheGet = require('./_listCacheGet'),\n    listCacheHas = require('./_listCacheHas'),\n    listCacheSet = require('./_listCacheSet');\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nmodule.exports = ListCache;\n", "var ListCache = require('./_ListCache');\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nmodule.exports = stackClear;\n", "/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nmodule.exports = stackDelete;\n", "/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nmodule.exports = stackGet;\n", "/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nmodule.exports = stackHas;\n", "/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n", "var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n", "var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n", "var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n", "/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n", "var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n", "/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n", "var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n", "var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n", "var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n", "/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n", "var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n", "/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n", "var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n", "var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nmodule.exports = Map;\n", "var getNative = require('./_getNative');\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nmodule.exports = nativeCreate;\n", "var nativeCreate = require('./_nativeCreate');\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nmodule.exports = hashClear;\n", "/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = hashDelete;\n", "var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nmodule.exports = hashGet;\n", "var nativeCreate = require('./_nativeCreate');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nmodule.exports = hashHas;\n", "var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nmodule.exports = hashSet;\n", "var hashClear = require('./_hashClear'),\n    hashDelete = require('./_hashDelete'),\n    hashGet = require('./_hashGet'),\n    hashHas = require('./_hashHas'),\n    hashSet = require('./_hashSet');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nmodule.exports = Hash;\n", "var Hash = require('./_Hash'),\n    ListCache = require('./_ListCache'),\n    Map = require('./_Map');\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nmodule.exports = mapCacheClear;\n", "/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nmodule.exports = isKeyable;\n", "var isKeyable = require('./_isKeyable');\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nmodule.exports = getMapData;\n", "var getMapData = require('./_getMapData');\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = mapCacheDelete;\n", "var getMapData = require('./_getMapData');\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nmodule.exports = mapCacheGet;\n", "var getMapData = require('./_getMapData');\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nmodule.exports = mapCacheHas;\n", "var getMapData = require('./_getMapData');\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nmodule.exports = mapCacheSet;\n", "var mapCacheClear = require('./_mapCacheClear'),\n    mapCacheDelete = require('./_mapCacheDelete'),\n    mapCacheGet = require('./_mapCacheGet'),\n    mapCacheHas = require('./_mapCacheHas'),\n    mapCacheSet = require('./_mapCacheSet');\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nmodule.exports = MapCache;\n", "var ListCache = require('./_ListCache'),\n    Map = require('./_Map'),\n    MapCache = require('./_MapCache');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nmodule.exports = stackSet;\n", "var ListCache = require('./_ListCache'),\n    stackClear = require('./_stackClear'),\n    stackDelete = require('./_stackDelete'),\n    stackGet = require('./_stackGet'),\n    stackHas = require('./_stackHas'),\n    stackSet = require('./_stackSet');\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nmodule.exports = Stack;\n", "var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n", "var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n", "var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/**\n * This function is like `assignValue` except that it doesn't assign\n * `undefined` values.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignMergeValue(object, key, value) {\n  if ((value !== undefined && !eq(object[key], value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignMergeValue;\n", "/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n", "var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n", "var root = require('./_root');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nmodule.exports = cloneBuffer;\n", "var root = require('./_root');\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nmodule.exports = Uint8Array;\n", "var Uint8Array = require('./_Uint8Array');\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nmodule.exports = cloneArrayBuffer;\n", "var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nmodule.exports = cloneTypedArray;\n", "/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nmodule.exports = copyArray;\n", "var isObject = require('./isObject');\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nmodule.exports = baseCreate;\n", "/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n", "var overArg = require('./_overArg');\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nmodule.exports = getPrototype;\n", "/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n", "var baseCreate = require('./_baseCreate'),\n    getPrototype = require('./_getPrototype'),\n    isPrototype = require('./_isPrototype');\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nmodule.exports = initCloneObject;\n", "/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n", "var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n", "var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n", "/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n", "/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n", "var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n", "var isArrayLike = require('./isArrayLike'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nmodule.exports = isArrayLikeObject;\n", "/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n", "var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n", "var baseGetTag = require('./_baseGetTag'),\n    getPrototype = require('./_getPrototype'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nmodule.exports = isPlainObject;\n", "var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n", "/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n", "var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n", "var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n", "/**\n * Gets the value at `key`, unless `key` is \"__proto__\" or \"constructor\".\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction safeGet(object, key) {\n  if (key === 'constructor' && typeof object[key] === 'function') {\n    return;\n  }\n\n  if (key == '__proto__') {\n    return;\n  }\n\n  return object[key];\n}\n\nmodule.exports = safeGet;\n", "var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n", "var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n", "/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n", "/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n", "var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n", "/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = nativeKeysIn;\n", "var isObject = require('./isObject'),\n    isPrototype = require('./_isPrototype'),\n    nativeKeysIn = require('./_nativeKeysIn');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeysIn;\n", "var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeysIn = require('./_baseKeysIn'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nmodule.exports = keysIn;\n", "var copyObject = require('./_copyObject'),\n    keysIn = require('./keysIn');\n\n/**\n * Converts `value` to a plain object flattening inherited enumerable string\n * keyed properties of `value` to own properties of the plain object.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {Object} Returns the converted plain object.\n * @example\n *\n * function Foo() {\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.assign({ 'a': 1 }, new Foo);\n * // => { 'a': 1, 'b': 2 }\n *\n * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n * // => { 'a': 1, 'b': 2, 'c': 3 }\n */\nfunction toPlainObject(value) {\n  return copyObject(value, keysIn(value));\n}\n\nmodule.exports = toPlainObject;\n", "var assignMergeValue = require('./_assignMergeValue'),\n    cloneBuffer = require('./_cloneBuffer'),\n    cloneTypedArray = require('./_cloneTypedArray'),\n    copyArray = require('./_copyArray'),\n    initCloneObject = require('./_initCloneObject'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isArrayLikeObject = require('./isArrayLikeObject'),\n    isBuffer = require('./isBuffer'),\n    isFunction = require('./isFunction'),\n    isObject = require('./isObject'),\n    isPlainObject = require('./isPlainObject'),\n    isTypedArray = require('./isTypedArray'),\n    safeGet = require('./_safeGet'),\n    toPlainObject = require('./toPlainObject');\n\n/**\n * A specialized version of `baseMerge` for arrays and objects which performs\n * deep merges and tracks traversed objects enabling objects with circular\n * references to be merged.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {string} key The key of the value to merge.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} mergeFunc The function to merge values.\n * @param {Function} [customizer] The function to customize assigned values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n  var objValue = safeGet(object, key),\n      srcValue = safeGet(source, key),\n      stacked = stack.get(srcValue);\n\n  if (stacked) {\n    assignMergeValue(object, key, stacked);\n    return;\n  }\n  var newValue = customizer\n    ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n    : undefined;\n\n  var isCommon = newValue === undefined;\n\n  if (isCommon) {\n    var isArr = isArray(srcValue),\n        isBuff = !isArr && isBuffer(srcValue),\n        isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n    newValue = srcValue;\n    if (isArr || isBuff || isTyped) {\n      if (isArray(objValue)) {\n        newValue = objValue;\n      }\n      else if (isArrayLikeObject(objValue)) {\n        newValue = copyArray(objValue);\n      }\n      else if (isBuff) {\n        isCommon = false;\n        newValue = cloneBuffer(srcValue, true);\n      }\n      else if (isTyped) {\n        isCommon = false;\n        newValue = cloneTypedArray(srcValue, true);\n      }\n      else {\n        newValue = [];\n      }\n    }\n    else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n      newValue = objValue;\n      if (isArguments(objValue)) {\n        newValue = toPlainObject(objValue);\n      }\n      else if (!isObject(objValue) || isFunction(objValue)) {\n        newValue = initCloneObject(srcValue);\n      }\n    }\n    else {\n      isCommon = false;\n    }\n  }\n  if (isCommon) {\n    // Recursively merge objects and arrays (susceptible to call stack limits).\n    stack.set(srcValue, newValue);\n    mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n    stack['delete'](srcValue);\n  }\n  assignMergeValue(object, key, newValue);\n}\n\nmodule.exports = baseMergeDeep;\n", "var Stack = require('./_Stack'),\n    assignMergeValue = require('./_assignMergeValue'),\n    baseFor = require('./_baseFor'),\n    baseMergeDeep = require('./_baseMergeDeep'),\n    isObject = require('./isObject'),\n    keysIn = require('./keysIn'),\n    safeGet = require('./_safeGet');\n\n/**\n * The base implementation of `_.merge` without support for multiple sources.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} [customizer] The function to customize merged values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMerge(object, source, srcIndex, customizer, stack) {\n  if (object === source) {\n    return;\n  }\n  baseFor(source, function(srcValue, key) {\n    stack || (stack = new Stack);\n    if (isObject(srcValue)) {\n      baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n    }\n    else {\n      var newValue = customizer\n        ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      if (newValue === undefined) {\n        newValue = srcValue;\n      }\n      assignMergeValue(object, key, newValue);\n    }\n  }, keysIn);\n}\n\nmodule.exports = baseMerge;\n", "/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n", "/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n", "var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n", "/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n", "var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n", "/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n", "var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n", "var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n", "var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n", "var baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n", "var baseMerge = require('./_baseMerge'),\n    createAssigner = require('./_createAssigner');\n\n/**\n * This method is like `_.assign` except that it recursively merges own and\n * inherited enumerable string keyed properties of source objects into the\n * destination object. Source properties that resolve to `undefined` are\n * skipped if a destination value exists. Array and plain object properties\n * are merged recursively. Other objects and value types are overridden by\n * assignment. Source objects are applied from left to right. Subsequent\n * sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 0.5.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @example\n *\n * var object = {\n *   'a': [{ 'b': 2 }, { 'd': 4 }]\n * };\n *\n * var other = {\n *   'a': [{ 'c': 3 }, { 'e': 5 }]\n * };\n *\n * _.merge(object, other);\n * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n */\nvar merge = createAssigner(function(object, source, srcIndex) {\n  baseMerge(object, source, srcIndex);\n});\n\nmodule.exports = merge;\n", "var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n", "var isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nmodule.exports = isKey;\n", "var MapCache = require('./_MapCache');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nmodule.exports = memoize;\n", "var memoize = require('./memoize');\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nmodule.exports = memoizeCapped;\n", "var memoizeCapped = require('./_memoizeCapped');\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nmodule.exports = stringToPath;\n", "/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n", "var Symbol = require('./_Symbol'),\n    arrayMap = require('./_arrayMap'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = baseToString;\n", "var baseToString = require('./_baseToString');\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nmodule.exports = toString;\n", "var isArray = require('./isArray'),\n    isKey = require('./_isKey'),\n    stringToPath = require('./_stringToPath'),\n    toString = require('./toString');\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nmodule.exports = castPath;\n", "var isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = toKey;\n", "var castPath = require('./_castPath'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nmodule.exports = baseGet;\n", "var baseGet = require('./_baseGet');\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n", "!function(t,i){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=i():\"function\"==typeof define&&define.amd?define(i):(t=t||self).RBush=i()}(this,function(){\"use strict\";function t(t,r,e,a,h){!function t(n,r,e,a,h){for(;a>e;){if(a-e>600){var o=a-e+1,s=r-e+1,l=Math.log(o),f=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*f*(o-f)/o)*(s-o/2<0?-1:1),m=Math.max(e,Math.floor(r-s*f/o+u)),c=Math.min(a,Math.floor(r+(o-s)*f/o+u));t(n,r,m,c,h)}var p=n[r],d=e,x=a;for(i(n,e,r),h(n[a],p)>0&&i(n,e,a);d<x;){for(i(n,d,x),d++,x--;h(n[d],p)<0;)d++;for(;h(n[x],p)>0;)x--}0===h(n[e],p)?i(n,e,x):i(n,++x,a),x<=r&&(e=x+1),r<=x&&(a=x-1)}}(t,r,e||0,a||t.length-1,h||n)}function i(t,i,n){var r=t[i];t[i]=t[n],t[n]=r}function n(t,i){return t<i?-1:t>i?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function e(t,i,n){if(!n)return i.indexOf(t);for(var r=0;r<i.length;r++)if(n(t,i[r]))return r;return-1}function a(t,i){h(t,0,t.children.length,i,t)}function h(t,i,n,r,e){e||(e=p(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var a=i;a<n;a++){var h=t.children[a];o(e,t.leaf?r(h):h)}return e}function o(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function s(t,i){return t.minX-i.minX}function l(t,i){return t.minY-i.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function m(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function c(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,n,r,e,a){for(var h=[n,r];h.length;)if(!((r=h.pop())-(n=h.pop())<=e)){var o=n+Math.ceil((r-n)/e/2)*e;t(i,o,n,r,a),h.push(n,o,o,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var i=this.data,n=[];if(!c(t,i))return n;for(var r=this.toBBox,e=[];i;){for(var a=0;a<i.children.length;a++){var h=i.children[a],o=i.leaf?r(h):h;c(t,o)&&(i.leaf?n.push(h):m(t,o)?this._all(h,n):e.push(h))}i=e.pop()}return n},r.prototype.collides=function(t){var i=this.data;if(!c(t,i))return!1;for(var n=[];i;){for(var r=0;r<i.children.length;r++){var e=i.children[r],a=i.leaf?this.toBBox(e):e;if(c(t,a)){if(i.leaf||m(t,a))return!0;n.push(e)}}i=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0;i<t.length;i++)this.insert(t[i]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=p([]),this},r.prototype.remove=function(t,i){if(!t)return this;for(var n,r,a,h=this.data,o=this.toBBox(t),s=[],l=[];h||s.length;){if(h||(h=s.pop(),r=s[s.length-1],n=l.pop(),a=!0),h.leaf){var f=e(t,h.children,i);if(-1!==f)return h.children.splice(f,1),s.push(h),this._condense(s),this}a||h.leaf||!m(h,o)?r?(n++,h=r.children[n],a=!1):h=null:(s.push(h),l.push(n),n=0,r=h,h=h.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,i){return t.minX-i.minX},r.prototype.compareMinY=function(t,i){return t.minY-i.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},r.prototype._build=function(t,i,n,r){var e,h=n-i+1,o=this._maxEntries;if(h<=o)return a(e=p(t.slice(i,n+1)),this.toBBox),e;r||(r=Math.ceil(Math.log(h)/Math.log(o)),o=Math.ceil(h/Math.pow(o,r-1))),(e=p([])).leaf=!1,e.height=r;var s=Math.ceil(h/o),l=s*Math.ceil(Math.sqrt(o));d(t,i,n,l,this.compareMinX);for(var f=i;f<=n;f+=l){var u=Math.min(f+l-1,n);d(t,f,u,s,this.compareMinY);for(var m=f;m<=u;m+=s){var c=Math.min(m+s-1,u);e.children.push(this._build(t,m,c,r-1))}}return a(e,this.toBBox),e},r.prototype._chooseSubtree=function(t,i,n,r){for(;r.push(i),!i.leaf&&r.length-1!==n;){for(var e=1/0,a=1/0,h=void 0,o=0;o<i.children.length;o++){var s=i.children[o],l=f(s),u=(m=t,c=s,(Math.max(c.maxX,m.maxX)-Math.min(c.minX,m.minX))*(Math.max(c.maxY,m.maxY)-Math.min(c.minY,m.minY))-l);u<a?(a=u,e=l<e?l:e,h=s):u===a&&l<e&&(e=l,h=s)}i=h||i.children[0]}var m,c;return i},r.prototype._insert=function(t,i,n){var r=n?t:this.toBBox(t),e=[],a=this._chooseSubtree(r,this.data,i,e);for(a.children.push(t),o(a,r);i>=0&&e[i].children.length>this._maxEntries;)this._split(e,i),i--;this._adjustParentBBoxes(r,e,i)},r.prototype._split=function(t,i){var n=t[i],r=n.children.length,e=this._minEntries;this._chooseSplitAxis(n,e,r);var h=this._chooseSplitIndex(n,e,r),o=p(n.children.splice(h,n.children.length-h));o.height=n.height,o.leaf=n.leaf,a(n,this.toBBox),a(o,this.toBBox),i?t[i-1].children.push(o):this._splitRoot(n,o)},r.prototype._splitRoot=function(t,i){this.data=p([t,i]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,i,n){for(var r,e,a,o,s,l,u,m=1/0,c=1/0,p=i;p<=n-i;p++){var d=h(t,0,p,this.toBBox),x=h(t,p,n,this.toBBox),v=(e=d,a=x,o=void 0,s=void 0,l=void 0,u=void 0,o=Math.max(e.minX,a.minX),s=Math.max(e.minY,a.minY),l=Math.min(e.maxX,a.maxX),u=Math.min(e.maxY,a.maxY),Math.max(0,l-o)*Math.max(0,u-s)),M=f(d)+f(x);v<m?(m=v,r=p,c=M<c?M:c):v===m&&M<c&&(c=M,r=p)}return r||n-i},r.prototype._chooseSplitAxis=function(t,i,n){var r=t.leaf?this.compareMinX:s,e=t.leaf?this.compareMinY:l;this._allDistMargin(t,i,n,r)<this._allDistMargin(t,i,n,e)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,i,n,r){t.children.sort(r);for(var e=this.toBBox,a=h(t,0,i,e),s=h(t,n-i,n,e),l=u(a)+u(s),f=i;f<n-i;f++){var m=t.children[f];o(a,t.leaf?e(m):m),l+=u(a)}for(var c=n-i-1;c>=i;c--){var p=t.children[c];o(s,t.leaf?e(p):p),l+=u(s)}return l},r.prototype._adjustParentBBoxes=function(t,i,n){for(var r=n;r>=0;r--)o(i[r],t)},r.prototype._condense=function(t){for(var i=t.length-1,n=void 0;i>=0;i--)0===t[i].children.length?i>0?(n=t[i-1].children).splice(n.indexOf(t[i]),1):this.clear():a(t[i],this.toBBox)},r});\n", "// Array.findIndex Polyfill\nArray.prototype.findIndex =\n  Array.prototype.findIndex ||\n  function (callback) {\n    if (this === null) {\n      throw new TypeError(\n        'Array.prototype.findIndex called on null or undefined'\n      );\n    } else if (typeof callback !== 'function') {\n      throw new TypeError('callback must be a function');\n    }\n    var list = Object(this);\n    // Makes sures is always has an positive integer as length.\n    var length = list.length >>> 0;\n    var thisArg = arguments[1];\n    for (var i = 0; i < length; i++) {\n      if (callback.call(thisArg, list[i], i, list)) {\n        return i;\n      }\n    }\n    return -1;\n  };\n\n// Array.find Polyfill for IE<12.\n// Requested here: https://github.com/geoman-io/leaflet-geoman/issues/173\nArray.prototype.find =\n  Array.prototype.find ||\n  function (callback) {\n    if (this === null) {\n      throw new TypeError('Array.prototype.find called on null or undefined');\n    } else if (typeof callback !== 'function') {\n      throw new TypeError('callback must be a function');\n    }\n    var list = Object(this);\n    // Makes sures is always has an positive integer as length.\n    var length = list.length >>> 0;\n    var thisArg = arguments[1];\n    for (var i = 0; i < length; i++) {\n      var element = list[i];\n      if (callback.call(thisArg, element, i, list)) {\n        return element;\n      }\n    }\n  };\n\n// Polyfill for Object.assign()\n// https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#Polyfill\nif (typeof Object.assign != 'function') {\n  Object.assign = function (target) {\n    'use strict';\n    if (target == null) {\n      throw new TypeError('Cannot convert undefined or null to object');\n    }\n\n    target = Object(target);\n    for (var index = 1; index < arguments.length; index++) {\n      var source = arguments[index];\n      if (source != null) {\n        for (var key in source) {\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\n            target[key] = source[key];\n          }\n        }\n      }\n    }\n    return target;\n  };\n}\n\n// Polyfill for Element.remove()\n// https://developer.mozilla.org/de/docs/Web/API/ChildNode/remove#Polyfill\n(function (arr) {\n  arr.forEach(function (item) {\n    if (item.hasOwnProperty('remove')) {\n      return;\n    }\n    Object.defineProperty(item, 'remove', {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function remove() {\n        this.parentNode.removeChild(this);\n      },\n    });\n  });\n})([Element.prototype, CharacterData.prototype, DocumentType.prototype]);\n\n// Polyfill for Array.includes()\n// https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Global_Objects/Array/includes#Polyfill\nif (!Array.prototype.includes) {\n  Object.defineProperty(Array.prototype, 'includes', {\n    value: function (searchElement, fromIndex) {\n      if (this == null) {\n        throw new TypeError('\"this\" is null or not defined');\n      }\n\n      // 1. Let O be ? ToObject(this value).\n      var o = Object(this);\n\n      // 2. Let len be ? ToLength(? Get(O, \"length\")).\n      var len = o.length >>> 0;\n\n      // 3. If len is 0, return false.\n      if (len === 0) {\n        return false;\n      }\n\n      // 4. Let n be ? ToInteger(fromIndex).\n      //    (If fromIndex is undefined, this step produces the value 0.)\n      var n = fromIndex | 0;\n\n      // 5. If n \u2265 0, then\n      //  a. Let k be n.\n      // 6. Else n < 0,\n      //  a. Let k be len + n.\n      //  b. If k < 0, let k be 0.\n      var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\n\n      function sameValueZero(x, y) {\n        return (\n          x === y ||\n          (typeof x === 'number' &&\n            typeof y === 'number' &&\n            isNaN(x) &&\n            isNaN(y))\n        );\n      }\n\n      // 7. Repeat, while k < len\n      while (k < len) {\n        // a. Let elementK be the result of ? Get(O, ! ToString(k)).\n        // b. If SameValueZero(searchElement, elementK) is true, return true.\n        if (sameValueZero(o[k], searchElement)) {\n          return true;\n        }\n        // c. Increase k by 1.\n        k++;\n      }\n\n      // 8. Return false\n      return false;\n    },\n  });\n}\n", "{\n  \"name\": \"@geoman-io/leaflet-geoman-free\",\n  \"version\": \"2.19.2\",\n  \"description\": \"A Leaflet Plugin For Editing Geometry Layers in Leaflet 1.0\",\n  \"keywords\": [\n    \"leaflet\",\n    \"geoman\",\n    \"polygon management\",\n    \"geometry editing\",\n    \"map data\",\n    \"map overlay\",\n    \"polygon\",\n    \"geojson\",\n    \"leaflet-draw\",\n    \"data-field-geojson\",\n    \"ui-leaflet-draw\"\n  ],\n  \"files\": [\n    \"dist/leaflet-geoman.js\",\n    \"dist/leaflet-geoman.min.js\",\n    \"dist/leaflet-geoman.css\",\n    \"dist/leaflet-geoman.d.ts\",\n    \"dist/leaflet-geoman.js.map\",\n    \"dist/leaflet-geoman.css.map\"\n  ],\n  \"main\": \"dist/leaflet-geoman.js\",\n  \"module\": \"dist/leaflet-geoman.js\",\n  \"types\": \"dist/leaflet-geoman.d.ts\",\n  \"exports\": {\n    \".\": {\n      \"types\": \"./dist/leaflet-geoman.d.ts\",\n      \"import\": \"./dist/leaflet-geoman.js\",\n      \"require\": \"./dist/leaflet-geoman.js\",\n      \"default\": \"./dist/leaflet-geoman.js\"\n    },\n    \"./dist/leaflet-geoman.css\": \"./dist/leaflet-geoman.css\"\n  },\n  \"dependencies\": {\n    \"@turf/boolean-contains\": \"^7.3.3\",\n    \"@turf/kinks\": \"^7.3.3\",\n    \"@turf/line-intersect\": \"^7.3.3\",\n    \"@turf/line-split\": \"^7.3.3\",\n    \"lodash\": \"4.17.23\",\n    \"polyclip-ts\": \"^0.16.8\"\n  },\n  \"devDependencies\": {\n    \"@types/leaflet\": \"^1.9.21\",\n    \"@vitest/coverage-v8\": \"^4.0.18\",\n    \"cross-env\": \"^10.1.0\",\n    \"cypress\": \"^15.9.0\",\n    \"esbuild\": \"^0.27.2\",\n    \"oxlint\": \"^1.0.0\",\n    \"oxfmt\": \"^0.28.0\",\n    \"husky\": \"^9.1.7\",\n    \"leaflet\": \"1.9.4\",\n    \"lint-staged\": \"^16.2.7\",\n    \"prosthetic-hand\": \"1.3.1\",\n    \"typescript\": \"^5.9.3\",\n    \"vitest\": \"^4.0.18\"\n  },\n  \"peerDependencies\": {\n    \"leaflet\": \"^1.2.0\"\n  },\n  \"engines\": {\n    \"node\": \">=18.0.0\"\n  },\n  \"scripts\": {\n    \"start\": \"npm run dev\",\n    \"dev\": \"cross-env DEV=true node bundle.mjs\",\n    \"build\": \"node bundle.mjs\",\n    \"test\": \"cypress run --browser chrome\",\n    \"test:unit\": \"vitest run\",\n    \"test:unit:watch\": \"vitest\",\n    \"test:unit:coverage\": \"vitest run --coverage\",\n    \"test:all\": \"npm run test:unit && npm run test\",\n    \"cypress\": \"cypress open\",\n    \"prepare\": \"npm run build && husky\",\n    \"lint\": \"oxlint src demo --fix && oxfmt --write src demo\",\n    \"lint:check\": \"oxlint src demo && oxfmt --check src demo\",\n    \"typecheck\": \"tsc --noEmit\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git://github.com/geoman-io/leaflet-geoman.git\"\n  },\n  \"author\": {\n    \"name\": \"Geoman.io\",\n    \"email\": \"sales@geoman.io\",\n    \"url\": \"http://geoman.io\"\n  },\n  \"license\": \"MIT\",\n  \"bugs\": {\n    \"url\": \"https://github.com/geoman-io/leaflet-geoman/issues\"\n  },\n  \"homepage\": \"https://geoman.io\",\n  \"lint-staged\": {\n    \"*.js\": \"oxlint --fix\",\n    \"*.{js,css}\": \"oxfmt --write\"\n  }\n}\n", "import merge from 'lodash/merge';\nimport translations from '../assets/translations';\nimport GlobalEditMode from './Mixins/Modes/Mode.Edit';\nimport GlobalDragMode from './Mixins/Modes/Mode.Drag';\nimport GlobalRemovalMode from './Mixins/Modes/Mode.Removal';\nimport GlobalRotateMode from './Mixins/Modes/Mode.Rotate';\nimport EventMixin from './Mixins/Events';\nimport createKeyboardMixins from './Mixins/Keyboard';\nimport { getRenderer } from './helpers';\nimport { resolveLanguageCode } from './helpers/language';\n\nconst Map = L.Class.extend({\n  includes: [\n    GlobalEditMode,\n    GlobalDragMode,\n    GlobalRemovalMode,\n    GlobalRotateMode,\n    EventMixin,\n  ],\n  initialize(map) {\n    this.map = map;\n    this.Draw = new L.PM.Draw(map);\n    this.Toolbar = new L.PM.Toolbar(map);\n    this.Keyboard = createKeyboardMixins();\n\n    this.globalOptions = {\n      snappable: true,\n      layerGroup: undefined,\n      snappingOrder: [\n        'Marker',\n        'CircleMarker',\n        'Circle',\n        'Line',\n        'Polygon',\n        'Rectangle',\n      ],\n      panes: {\n        vertexPane: 'markerPane',\n        layerPane: 'overlayPane',\n        markerPane: 'markerPane',\n      },\n      draggable: true,\n      exitModeOnEscape: false,\n      finishOnEnter: false,\n    };\n\n    this.Keyboard._initKeyListener(map);\n  },\n\n  setLang(lang = 'en', override, fallback = 'en') {\n    // Resolve the language code to a translation key\n    lang = resolveLanguageCode(lang, translations);\n\n    const oldLang = L.PM.activeLang;\n    if (override) {\n      translations[lang] = merge(translations[fallback], override);\n    }\n\n    L.PM.activeLang = lang;\n    this.map.pm.Toolbar.reinit();\n    this._fireLangChange(oldLang, lang, fallback, translations[lang]);\n  },\n  addControls(options) {\n    this.Toolbar.addControls(options);\n  },\n  removeControls() {\n    this.Toolbar.removeControls();\n  },\n  toggleControls() {\n    this.Toolbar.toggleControls();\n  },\n  controlsVisible() {\n    return this.Toolbar.isVisible;\n  },\n\n  enableDraw(shape = 'Polygon', options) {\n    // backwards compatible, remove after 3.0\n    if (shape === 'Poly') {\n      shape = 'Polygon';\n    }\n\n    this.Draw.enable(shape, options);\n  },\n  disableDraw(shape = 'Polygon') {\n    // backwards compatible, remove after 3.0\n    if (shape === 'Poly') {\n      shape = 'Polygon';\n    }\n\n    this.Draw.disable(shape);\n  },\n  // optionsModifier for special options like ignoreShapes or merge\n  setPathOptions(options, optionsModifier = {}) {\n    const ignore = optionsModifier.ignoreShapes || [];\n    const mergeOptions = optionsModifier.merge || false;\n\n    this.map.pm.Draw.shapes.forEach((shape) => {\n      if (ignore.indexOf(shape) === -1) {\n        this.map.pm.Draw[shape].setPathOptions(options, mergeOptions);\n      }\n    });\n  },\n\n  getGlobalOptions() {\n    return this.globalOptions;\n  },\n  setGlobalOptions(o) {\n    // merge passed and existing options\n    const options = merge(this.globalOptions, o);\n\n    // TODO: remove with next major release\n    if (options.editable) {\n      options.resizeableCircleMarker = options.editable;\n      delete options.editable;\n    }\n\n    // check if switched the editable mode for CircleMarker while drawing\n    let reenableCircleMarker = false;\n    if (\n      this.map.pm.Draw.CircleMarker.enabled() &&\n      !!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker !==\n        !!options.resizeableCircleMarker\n    ) {\n      this.map.pm.Draw.CircleMarker.disable();\n      reenableCircleMarker = true;\n    }\n    // check if switched the editable mode for Circle while drawing\n    let reenableCircle = false;\n    if (\n      this.map.pm.Draw.Circle.enabled() &&\n      !!this.map.pm.Draw.Circle.options.resizeableCircle !==\n        !!options.resizeableCircle\n    ) {\n      this.map.pm.Draw.Circle.disable();\n      reenableCircle = true;\n    }\n\n    // enable options for Drawing Shapes\n    this.map.pm.Draw.shapes.forEach((shape) => {\n      this.map.pm.Draw[shape].setOptions(options);\n    });\n\n    if (reenableCircleMarker) {\n      this.map.pm.Draw.CircleMarker.enable();\n    }\n\n    if (reenableCircle) {\n      this.map.pm.Draw.Circle.enable();\n    }\n\n    // enable options for Editing\n    const layers = L.PM.Utils.findLayers(this.map);\n    layers.forEach((layer) => {\n      layer.pm.setOptions(options);\n    });\n\n    this.map.fire('pm:globaloptionschanged');\n\n    // store options\n    this.globalOptions = options;\n\n    // apply the options (actually trigger the functionality)\n    this.applyGlobalOptions();\n  },\n  applyGlobalOptions() {\n    const layers = L.PM.Utils.findLayers(this.map);\n    layers.forEach((layer) => {\n      if (layer.pm.enabled()) {\n        layer.pm.applyOptions();\n      }\n    });\n  },\n  globalDrawModeEnabled() {\n    return !!this.Draw.getActiveShape();\n  },\n  globalCutModeEnabled() {\n    return !!this.Draw.Cut.enabled();\n  },\n  enableGlobalCutMode(options) {\n    return this.Draw.Cut.enable(options);\n  },\n  toggleGlobalCutMode(options) {\n    return this.Draw.Cut.toggle(options);\n  },\n  disableGlobalCutMode() {\n    return this.Draw.Cut.disable();\n  },\n  getGeomanLayers(asGroup = false) {\n    const layers = L.PM.Utils.findLayers(this.map);\n    if (!asGroup) {\n      return layers;\n    }\n    const group = L.featureGroup();\n    group._pmTempLayer = true;\n    layers.forEach((layer) => {\n      group.addLayer(layer);\n    });\n    return group;\n  },\n  getGeomanDrawLayers(asGroup = false) {\n    const layers = L.PM.Utils.findLayers(this.map).filter(\n      (l) => l._drawnByGeoman === true\n    );\n    if (!asGroup) {\n      return layers;\n    }\n    const group = L.featureGroup();\n    group._pmTempLayer = true;\n    layers.forEach((layer) => {\n      group.addLayer(layer);\n    });\n    return group;\n  },\n  // returns the map instance by default or a layergroup is set through global options\n  _getContainingLayer() {\n    return this.globalOptions.layerGroup &&\n      this.globalOptions.layerGroup instanceof L.LayerGroup\n      ? this.globalOptions.layerGroup\n      : this.map;\n  },\n  _isCRSSimple() {\n    return this.map.options.crs === L.CRS.Simple;\n  },\n  // in Canvas mode we need to convert touch- and pointerevents (IE) to mouseevents, because Leaflet don't support them.\n  _touchEventCounter: 0,\n  _addTouchEvents(elm) {\n    if (this._touchEventCounter === 0) {\n      L.DomEvent.on(elm, 'touchmove', this._canvasTouchMove, this);\n      L.DomEvent.on(\n        elm,\n        'touchstart touchend touchcancel',\n        this._canvasTouchClick,\n        this\n      );\n    }\n    this._touchEventCounter += 1;\n  },\n  _removeTouchEvents(elm) {\n    if (this._touchEventCounter === 1) {\n      L.DomEvent.off(elm, 'touchmove', this._canvasTouchMove, this);\n      L.DomEvent.off(\n        elm,\n        'touchstart touchend touchcancel',\n        this._canvasTouchClick,\n        this\n      );\n    }\n    this._touchEventCounter =\n      this._touchEventCounter <= 1 ? 0 : this._touchEventCounter - 1;\n  },\n  _canvasTouchMove(e) {\n    getRenderer(this.map)._onMouseMove(this._createMouseEvent('mousemove', e));\n  },\n  _canvasTouchClick(e) {\n    let type = '';\n    if (e.type === 'touchstart' || e.type === 'pointerdown') {\n      type = 'mousedown';\n    } else if (e.type === 'touchend' || e.type === 'pointerup') {\n      type = 'mouseup';\n    } else if (e.type === 'touchcancel' || e.type === 'pointercancel') {\n      type = 'mouseup';\n    }\n    if (!type) {\n      return;\n    }\n    getRenderer(this.map)._onClick(this._createMouseEvent(type, e));\n  },\n  _createMouseEvent(type, e) {\n    let mouseEvent;\n    const touchEvt = e.touches[0] || e.changedTouches[0];\n    try {\n      mouseEvent = new MouseEvent(type, {\n        bubbles: e.bubbles,\n        cancelable: e.cancelable,\n        view: e.view,\n        detail: touchEvt.detail,\n        screenX: touchEvt.screenX,\n        screenY: touchEvt.screenY,\n        clientX: touchEvt.clientX,\n        clientY: touchEvt.clientY,\n        ctrlKey: e.ctrlKey,\n        altKey: e.altKey,\n        shiftKey: e.shiftKey,\n        metaKey: e.metaKey,\n        button: e.button,\n        relatedTarget: e.relatedTarget,\n      });\n    } catch (ex) {\n      mouseEvent = document.createEvent('MouseEvents');\n      mouseEvent.initMouseEvent(\n        type,\n        e.bubbles,\n        e.cancelable,\n        e.view,\n        touchEvt.detail,\n        touchEvt.screenX,\n        touchEvt.screenY,\n        touchEvt.clientX,\n        touchEvt.clientY,\n        e.ctrlKey,\n        e.altKey,\n        e.shiftKey,\n        e.metaKey,\n        e.button,\n        e.relatedTarget\n      );\n    }\n    return mouseEvent;\n  },\n});\n\nexport default Map;\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Click to place marker\",\n    \"placeMarkerTouch\": \"Tap the map to place a marker\",\n    \"firstVertex\": \"Click to place first vertex\",\n    \"continueLine\": \"Click to continue drawing\",\n    \"finishLine\": \"Click any existing marker to finish\",\n    \"finishPoly\": \"Click first marker to finish\",\n    \"finishRect\": \"Click to finish\",\n    \"startCircle\": \"Click to place circle center\",\n    \"finishCircle\": \"Click to finish circle\",\n    \"placeCircleMarker\": \"Click to place circle marker\",\n    \"placeText\": \"Click to place text\",\n    \"selectFirstLayerFor\": \"Select first layer for {action}\",\n    \"selectSecondLayerFor\": \"Select second layer for {action}\"\n  },\n  \"actions\": {\n    \"finish\": \"Finish\",\n    \"cancel\": \"Cancel\",\n    \"removeLastVertex\": \"Remove Last Vertex\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Draw Marker\",\n    \"drawPolyButton\": \"Draw Polygons\",\n    \"drawLineButton\": \"Draw Polyline\",\n    \"drawCircleButton\": \"Draw Circle\",\n    \"drawRectButton\": \"Draw Rectangle\",\n    \"editButton\": \"Edit Layers\",\n    \"dragButton\": \"Drag Layers\",\n    \"cutButton\": \"Cut Layers\",\n    \"deleteButton\": \"Remove Layers\",\n    \"drawCircleMarkerButton\": \"Draw Circle Marker\",\n    \"snappingButton\": \"Snap dragged marker to other layers and vertices\",\n    \"pinningButton\": \"Pin shared vertices together\",\n    \"rotateButton\": \"Rotate Layers\",\n    \"drawTextButton\": \"Draw Text\",\n    \"scaleButton\": \"Scale Layers\",\n    \"autoTracingButton\": \"Auto trace Line\",\n    \"snapGuidesButton\": \"Show SnapGuides\",\n    \"unionButton\": \"Union layers\",\n    \"differenceButton\": \"Subtract layers\"\n  },\n  \"measurements\": {\n    \"totalLength\": \"Length\",\n    \"segmentLength\": \"Segment length\",\n    \"area\": \"Area\",\n    \"radius\": \"Radius\",\n    \"perimeter\": \"Perimeter\",\n    \"height\": \"Height\",\n    \"width\": \"Width\",\n    \"coordinates\": \"Position\",\n    \"coordinatesMarker\": \"Position Marker\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Platziere den Marker mit Klick\",\n    \"placeMarkerTouch\": \"Tippe auf die Karte, um einen Marker zu platzieren\",\n    \"firstVertex\": \"Platziere den ersten Marker mit Klick\",\n    \"continueLine\": \"Klicke, um weiter zu zeichnen\",\n    \"finishLine\": \"Beende mit Klick auf existierenden Marker\",\n    \"finishPoly\": \"Beende mit Klick auf ersten Marker\",\n    \"finishRect\": \"Beende mit Klick\",\n    \"startCircle\": \"Platziere das Kreiszentrum mit Klick\",\n    \"finishCircle\": \"Beende den Kreis mit Klick\",\n    \"placeCircleMarker\": \"Platziere den Kreismarker mit Klick\",\n    \"placeText\": \"Platziere den Text mit Klick\"\n  },\n  \"actions\": {\n    \"finish\": \"Beenden\",\n    \"cancel\": \"Abbrechen\",\n    \"removeLastVertex\": \"Letzten Vertex l\u00F6schen\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Marker zeichnen\",\n    \"drawPolyButton\": \"Polygon zeichnen\",\n    \"drawLineButton\": \"Polyline zeichnen\",\n    \"drawCircleButton\": \"Kreis zeichnen\",\n    \"drawRectButton\": \"Rechteck zeichnen\",\n    \"editButton\": \"Layer editieren\",\n    \"dragButton\": \"Layer bewegen\",\n    \"cutButton\": \"Layer schneiden\",\n    \"deleteButton\": \"Layer l\u00F6schen\",\n    \"drawCircleMarkerButton\": \"Kreismarker zeichnen\",\n    \"snappingButton\": \"Bewegter Layer an andere Layer oder Vertexe einhacken\",\n    \"pinningButton\": \"Vertexe an der gleichen Position verkn\u00FCpfen\",\n    \"rotateButton\": \"Layer drehen\",\n    \"drawTextButton\": \"Text zeichnen\",\n    \"scaleButton\": \"Layer skalieren\",\n    \"autoTracingButton\": \"Linie automatisch nachzeichen\"\n  },\n  \"measurements\": {\n    \"totalLength\": \"L\u00E4nge\",\n    \"segmentLength\": \"Segment L\u00E4nge\",\n    \"area\": \"Fl\u00E4che\",\n    \"radius\": \"Radius\",\n    \"perimeter\": \"Umfang\",\n    \"height\": \"H\u00F6he\",\n    \"width\": \"Breite\",\n    \"coordinates\": \"Position\",\n    \"coordinatesMarker\": \"Position Marker\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Clicca per posizionare un Marker\",\n    \"placeMarkerTouch\": \"Tocca la mappa per posizionare un marker\",\n    \"firstVertex\": \"Clicca per posizionare il primo vertice\",\n    \"continueLine\": \"Clicca per continuare a disegnare\",\n    \"finishLine\": \"Clicca qualsiasi marker esistente per terminare\",\n    \"finishPoly\": \"Clicca il primo marker per terminare\",\n    \"finishRect\": \"Clicca per terminare\",\n    \"startCircle\": \"Clicca per posizionare il punto centrale del cerchio\",\n    \"finishCircle\": \"Clicca per terminare il cerchio\",\n    \"placeCircleMarker\": \"Clicca per posizionare un Marker del cherchio\"\n  },\n  \"actions\": {\n    \"finish\": \"Termina\",\n    \"cancel\": \"Annulla\",\n    \"removeLastVertex\": \"Rimuovi l'ultimo vertice\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Disegna Marker\",\n    \"drawPolyButton\": \"Disegna Poligoni\",\n    \"drawLineButton\": \"Disegna Polilinea\",\n    \"drawCircleButton\": \"Disegna Cerchio\",\n    \"drawRectButton\": \"Disegna Rettangolo\",\n    \"editButton\": \"Modifica Livelli\",\n    \"dragButton\": \"Sposta Livelli\",\n    \"cutButton\": \"Ritaglia Livelli\",\n    \"deleteButton\": \"Elimina Livelli\",\n    \"drawCircleMarkerButton\": \"Disegna Marker del Cerchio\",\n    \"snappingButton\": \"Snap ha trascinato il pennarello su altri strati e vertici\",\n    \"pinningButton\": \"Pin condiviso vertici insieme\",\n    \"rotateButton\": \"Ruota livello\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Klik untuk menempatkan marker\",\n    \"placeMarkerTouch\": \"Ketuk peta untuk menempatkan marker\",\n    \"firstVertex\": \"Klik untuk menempatkan vertex pertama\",\n    \"continueLine\": \"Klik untuk meneruskan digitasi\",\n    \"finishLine\": \"Klik pada sembarang marker yang ada untuk mengakhiri\",\n    \"finishPoly\": \"Klik marker pertama untuk mengakhiri\",\n    \"finishRect\": \"Klik untuk mengakhiri\",\n    \"startCircle\": \"Klik untuk menempatkan titik pusat lingkaran\",\n    \"finishCircle\": \"Klik untuk mengakhiri lingkaran\",\n    \"placeCircleMarker\": \"Klik untuk menempatkan penanda lingkarann\"\n  },\n  \"actions\": {\n    \"finish\": \"Selesai\",\n    \"cancel\": \"Batal\",\n    \"removeLastVertex\": \"Hilangkan Vertex Terakhir\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Digitasi Marker\",\n    \"drawPolyButton\": \"Digitasi Polygon\",\n    \"drawLineButton\": \"Digitasi Polyline\",\n    \"drawCircleButton\": \"Digitasi Lingkaran\",\n    \"drawRectButton\": \"Digitasi Segi Empat\",\n    \"editButton\": \"Edit Layer\",\n    \"dragButton\": \"Geser Layer\",\n    \"cutButton\": \"Potong Layer\",\n    \"deleteButton\": \"Hilangkan Layer\",\n    \"drawCircleMarkerButton\": \"Digitasi Penanda Lingkaran\",\n    \"snappingButton\": \"Jepretkan penanda yang ditarik ke lapisan dan simpul lain\",\n    \"pinningButton\": \"Sematkan simpul bersama bersama\",\n    \"rotateButton\": \"Putar lapisan\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Adaug\u0103 un punct\",\n    \"placeMarkerTouch\": \"Atinge\u021Bi harta pentru a plasa un punct\",\n    \"firstVertex\": \"Apas\u0103 aici pentru a ad\u0103uga primul Vertex\",\n    \"continueLine\": \"Apas\u0103 aici pentru a continua desenul\",\n    \"finishLine\": \"Apas\u0103 pe orice obiect pentru a finisa desenul\",\n    \"finishPoly\": \"Apas\u0103 pe primul obiect pentru a finisa\",\n    \"finishRect\": \"Apas\u0103 pentru a finisa\",\n    \"startCircle\": \"Apas\u0103 pentru a desena un cerc\",\n    \"finishCircle\": \"Apas\u0103 pentru a finisa un cerc\",\n    \"placeCircleMarker\": \"Adaug\u0103 un punct\"\n  },\n  \"actions\": {\n    \"finish\": \"Termin\u0103\",\n    \"cancel\": \"Anuleaz\u0103\",\n    \"removeLastVertex\": \"\u0218terge ultimul Vertex\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Adaug\u0103 o bulin\u0103\",\n    \"drawPolyButton\": \"Deseneaz\u0103 un poligon\",\n    \"drawLineButton\": \"Deseneaz\u0103 o linie\",\n    \"drawCircleButton\": \"Deseneaz\u0103 un cerc\",\n    \"drawRectButton\": \"Deseneaz\u0103 un dreptunghi\",\n    \"editButton\": \"Editeaz\u0103 straturile\",\n    \"dragButton\": \"Mut\u0103 straturile\",\n    \"cutButton\": \"Taie straturile\",\n    \"deleteButton\": \"\u0218terge straturile\",\n    \"drawCircleMarkerButton\": \"Deseneaz\u0103 marcatorul cercului\",\n    \"snappingButton\": \"Fixa\u021Bi marcatorul glisat pe alte straturi \u0219i v\u00E2rfuri\",\n    \"pinningButton\": \"Fixa\u021Bi v\u00E2rfurile partajate \u00EEmpreun\u0103\",\n    \"rotateButton\": \"Roti\u021Bi stratul\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u043C\u0430\u0440\u043A\u0435\u0440\",\n    \"placeMarkerTouch\": \"\u041A\u043E\u0441\u043D\u0438\u0442\u0435\u0441\u044C \u043A\u0430\u0440\u0442\u044B, \u0447\u0442\u043E\u0431\u044B \u0440\u0430\u0437\u043C\u0435\u0441\u0442\u0438\u0442\u044C \u043C\u0430\u0440\u043A\u0435\u0440\",\n    \"firstVertex\": \"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u043F\u0435\u0440\u0432\u044B\u0439 \u043E\u0431\u044A\u0435\u043A\u0442\",\n    \"continueLine\": \"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C \u0440\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u0435\",\n    \"finishLine\": \"\u041D\u0430\u0436\u043C\u0438\u0442\u0435 \u043B\u044E\u0431\u043E\u0439 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0439 \u043C\u0430\u0440\u043A\u0435\u0440 \u0434\u043B\u044F \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0438\u044F\",\n    \"finishPoly\": \"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043F\u0435\u0440\u0432\u0443\u044E \u0442\u043E\u0447\u043A\u0443, \u0447\u0442\u043E\u0431\u044B \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u0442\u044C\",\n    \"finishRect\": \"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u0442\u044C\",\n    \"startCircle\": \"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0446\u0435\u043D\u0442\u0440 \u043A\u0440\u0443\u0433\u0430\",\n    \"finishCircle\": \"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u0437\u0430\u0434\u0430\u0442\u044C \u0440\u0430\u0434\u0438\u0443\u0441\",\n    \"placeCircleMarker\": \"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u043A\u0440\u0443\u0433\u043E\u0432\u043E\u0439 \u043C\u0430\u0440\u043A\u0435\u0440\"\n  },\n  \"actions\": {\n    \"finish\": \"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044C\",\n    \"cancel\": \"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C\",\n    \"removeLastVertex\": \"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u043F\u043E\u0441\u043B\u0435\u0434\u043D\u0435\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043C\u0430\u0440\u043A\u0435\u0440\",\n    \"drawPolyButton\": \"\u0420\u0438\u0441\u043E\u0432\u0430\u0442\u044C \u043F\u043E\u043B\u0438\u0433\u043E\u043D\",\n    \"drawLineButton\": \"\u0420\u0438\u0441\u043E\u0432\u0430\u0442\u044C \u043A\u0440\u0438\u0432\u0443\u044E\",\n    \"drawCircleButton\": \"\u0420\u0438\u0441\u043E\u0432\u0430\u0442\u044C \u043A\u0440\u0443\u0433\",\n    \"drawRectButton\": \"\u0420\u0438\u0441\u043E\u0432\u0430\u0442\u044C \u043F\u0440\u044F\u043C\u043E\u0443\u0433\u043E\u043B\u044C\u043D\u0438\u043A\",\n    \"editButton\": \"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0441\u043B\u043E\u0439\",\n    \"dragButton\": \"\u041F\u0435\u0440\u0435\u043D\u0435\u0441\u0442\u0438 \u0441\u043B\u043E\u0439\",\n    \"cutButton\": \"\u0412\u044B\u0440\u0435\u0437\u0430\u0442\u044C \u0441\u043B\u043E\u0439\",\n    \"deleteButton\": \"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u043B\u043E\u0439\",\n    \"drawCircleMarkerButton\": \"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043A\u0440\u0443\u0433\u043E\u0432\u043E\u0439 \u043C\u0430\u0440\u043A\u0435\u0440\",\n    \"snappingButton\": \"\u041F\u0440\u0438\u0432\u044F\u0437\u0430\u0442\u044C \u043F\u0435\u0440\u0435\u0442\u0430\u0441\u043A\u0438\u0432\u0430\u0435\u043C\u044B\u0439 \u043C\u0430\u0440\u043A\u0435\u0440 \u043A \u0434\u0440\u0443\u0433\u0438\u043C \u0441\u043B\u043E\u044F\u043C \u0438 \u0432\u0435\u0440\u0448\u0438\u043D\u0430\u043C\",\n    \"pinningButton\": \"\u0421\u0432\u044F\u0437\u0430\u0442\u044C \u043E\u0431\u0449\u0438\u0435 \u0442\u043E\u0447\u043A\u0438 \u0432\u043C\u0435\u0441\u0442\u0435\",\n    \"rotateButton\": \"\u041F\u043E\u0432\u043E\u0440\u043E\u0442 \u0441\u043B\u043E\u044F\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Presiona para colocar un marcador\",\n    \"placeMarkerTouch\": \"Toca el mapa para colocar un marcador\",\n    \"firstVertex\": \"Presiona para colocar el primer v\u00E9rtice\",\n    \"continueLine\": \"Presiona para continuar dibujando\",\n    \"finishLine\": \"Presiona cualquier marcador existente para finalizar\",\n    \"finishPoly\": \"Presiona el primer marcador para finalizar\",\n    \"finishRect\": \"Presiona para finalizar\",\n    \"startCircle\": \"Presiona para colocar el centro del c\u00EDrculo\",\n    \"finishCircle\": \"Presiona para finalizar el c\u00EDrculo\",\n    \"placeCircleMarker\": \"Presiona para colocar un marcador de c\u00EDrculo\"\n  },\n  \"actions\": {\n    \"finish\": \"Finalizar\",\n    \"cancel\": \"Cancelar\",\n    \"removeLastVertex\": \"Eliminar \u00FAltimo v\u00E9rtice\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Dibujar Marcador\",\n    \"drawPolyButton\": \"Dibujar Pol\u00EDgono\",\n    \"drawLineButton\": \"Dibujar L\u00EDnea\",\n    \"drawCircleButton\": \"Dibujar C\u00EDrculo\",\n    \"drawRectButton\": \"Dibujar Rect\u00E1ngulo\",\n    \"editButton\": \"Editar Capas\",\n    \"dragButton\": \"Arrastrar Capas\",\n    \"cutButton\": \"Cortar Capas\",\n    \"deleteButton\": \"Eliminar Capas\",\n    \"drawCircleMarkerButton\": \"Dibujar Marcador de C\u00EDrculo\",\n    \"snappingButton\": \"El marcador de Snap arrastrado a otras capas y v\u00E9rtices\",\n    \"pinningButton\": \"Fijar juntos los v\u00E9rtices compartidos\",\n    \"rotateButton\": \"Rotar capa\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Klik om een marker te plaatsen\",\n    \"placeMarkerTouch\": \"Tik op de kaart om een marker te plaatsen\",\n    \"firstVertex\": \"Klik om het eerste punt te plaatsen\",\n    \"continueLine\": \"Klik om te blijven tekenen\",\n    \"finishLine\": \"Klik op een bestaand punt om te be\u00EBindigen\",\n    \"finishPoly\": \"Klik op het eerst punt om te be\u00EBindigen\",\n    \"finishRect\": \"Klik om te be\u00EBindigen\",\n    \"startCircle\": \"Klik om het middelpunt te plaatsen\",\n    \"finishCircle\": \"Klik om de cirkel te be\u00EBindigen\",\n    \"placeCircleMarker\": \"Klik om een marker te plaatsen\"\n  },\n  \"actions\": {\n    \"finish\": \"Bewaar\",\n    \"cancel\": \"Annuleer\",\n    \"removeLastVertex\": \"Verwijder laatste punt\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Plaats Marker\",\n    \"drawPolyButton\": \"Teken een vlak\",\n    \"drawLineButton\": \"Teken een lijn\",\n    \"drawCircleButton\": \"Teken een cirkel\",\n    \"drawRectButton\": \"Teken een vierkant\",\n    \"editButton\": \"Bewerk\",\n    \"dragButton\": \"Verplaats\",\n    \"cutButton\": \"Knip\",\n    \"deleteButton\": \"Verwijder\",\n    \"drawCircleMarkerButton\": \"Plaats Marker\",\n    \"snappingButton\": \"Snap gesleepte marker naar andere lagen en hoekpunten\",\n    \"pinningButton\": \"Speld gedeelde hoekpunten samen\",\n    \"rotateButton\": \"Laag roteren\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Cliquez pour placer un marqueur\",\n    \"placeMarkerTouch\": \"Appuyez sur la carte pour placer un marqueur\",\n    \"firstVertex\": \"Cliquez pour placer le premier sommet\",\n    \"continueLine\": \"Cliquez pour continuer \u00E0 dessiner\",\n    \"finishLine\": \"Cliquez sur n'importe quel marqueur pour terminer\",\n    \"finishPoly\": \"Cliquez sur le premier marqueur pour terminer\",\n    \"finishRect\": \"Cliquez pour terminer\",\n    \"startCircle\": \"Cliquez pour placer le centre du cercle\",\n    \"finishCircle\": \"Cliquez pour finir le cercle\",\n    \"placeCircleMarker\": \"Cliquez pour placer le marqueur circulaire\"\n  },\n  \"actions\": {\n    \"finish\": \"Terminer\",\n    \"cancel\": \"Annuler\",\n    \"removeLastVertex\": \"Retirer le dernier sommet\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Placer des marqueurs\",\n    \"drawPolyButton\": \"Dessiner des polygones\",\n    \"drawLineButton\": \"Dessiner des polylignes\",\n    \"drawCircleButton\": \"Dessiner un cercle\",\n    \"drawRectButton\": \"Dessiner un rectangle\",\n    \"editButton\": \"\u00C9diter des calques\",\n    \"dragButton\": \"D\u00E9placer des calques\",\n    \"cutButton\": \"Couper des calques\",\n    \"deleteButton\": \"Supprimer des calques\",\n    \"drawCircleMarkerButton\": \"Dessiner un marqueur circulaire\",\n    \"snappingButton\": \"Glisser le marqueur vers d'autres couches et sommets\",\n    \"pinningButton\": \"\u00C9pingler ensemble les sommets partag\u00E9s\",\n    \"rotateButton\": \"Tourner des calques\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"\u5355\u51FB\u653E\u7F6E\u6807\u8BB0\",\n    \"placeMarkerTouch\": \"\u70B9\u51FB\u5730\u56FE\u653E\u7F6E\u6807\u8BB0\",\n    \"firstVertex\": \"\u5355\u51FB\u653E\u7F6E\u9996\u4E2A\u9876\u70B9\",\n    \"continueLine\": \"\u5355\u51FB\u7EE7\u7EED\u7ED8\u5236\",\n    \"finishLine\": \"\u5355\u51FB\u4EFB\u4F55\u5B58\u5728\u7684\u6807\u8BB0\u4EE5\u5B8C\u6210\",\n    \"finishPoly\": \"\u5355\u51FB\u7B2C\u4E00\u4E2A\u6807\u8BB0\u4EE5\u5B8C\u6210\",\n    \"finishRect\": \"\u5355\u51FB\u5B8C\u6210\",\n    \"startCircle\": \"\u5355\u51FB\u653E\u7F6E\u5706\u5FC3\",\n    \"finishCircle\": \"\u5355\u51FB\u5B8C\u6210\u5706\u5F62\",\n    \"placeCircleMarker\": \"\u70B9\u51FB\u653E\u7F6E\u5706\u5F62\u6807\u8BB0\"\n  },\n  \"actions\": {\n    \"finish\": \"\u5B8C\u6210\",\n    \"cancel\": \"\u53D6\u6D88\",\n    \"removeLastVertex\": \"\u79FB\u9664\u6700\u540E\u7684\u9876\u70B9\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"\u7ED8\u5236\u6807\u8BB0\",\n    \"drawPolyButton\": \"\u7ED8\u5236\u591A\u8FB9\u5F62\",\n    \"drawLineButton\": \"\u7ED8\u5236\u7EBF\u6BB5\",\n    \"drawCircleButton\": \"\u7ED8\u5236\u5706\u5F62\",\n    \"drawRectButton\": \"\u7ED8\u5236\u957F\u65B9\u5F62\",\n    \"editButton\": \"\u7F16\u8F91\u56FE\u5C42\",\n    \"dragButton\": \"\u62D6\u62FD\u56FE\u5C42\",\n    \"cutButton\": \"\u526A\u5207\u56FE\u5C42\",\n    \"deleteButton\": \"\u5220\u9664\u56FE\u5C42\",\n    \"drawCircleMarkerButton\": \"\u753B\u5706\u5708\u6807\u8BB0\",\n    \"snappingButton\": \"\u5C06\u62D6\u52A8\u7684\u6807\u8BB0\u6355\u6349\u5230\u5176\u4ED6\u56FE\u5C42\u548C\u9876\u70B9\",\n    \"pinningButton\": \"\u5C06\u5171\u4EAB\u9876\u70B9\u56FA\u5B9A\u5728\u4E00\u8D77\",\n    \"rotateButton\": \"\u65CB\u8F6C\u56FE\u5C42\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"\u55AE\u64CA\u653E\u7F6E\u6A19\u8A18\",\n    \"placeMarkerTouch\": \"\u9EDE\u64CA\u5730\u5716\u653E\u7F6E\u6A19\u8A18\",\n    \"firstVertex\": \"\u55AE\u64CA\u653E\u7F6E\u7B2C\u4E00\u500B\u9802\u9EDE\",\n    \"continueLine\": \"\u55AE\u64CA\u7E7C\u7E8C\u7E6A\u88FD\",\n    \"finishLine\": \"\u55AE\u64CA\u4EFB\u4F55\u5B58\u5728\u7684\u6A19\u8A18\u4EE5\u5B8C\u6210\",\n    \"finishPoly\": \"\u55AE\u64CA\u7B2C\u4E00\u500B\u6A19\u8A18\u4EE5\u5B8C\u6210\",\n    \"finishRect\": \"\u55AE\u64CA\u5B8C\u6210\",\n    \"startCircle\": \"\u55AE\u64CA\u653E\u7F6E\u5713\u5FC3\",\n    \"finishCircle\": \"\u55AE\u64CA\u5B8C\u6210\u5713\u5F62\",\n    \"placeCircleMarker\": \"\u9EDE\u64CA\u653E\u7F6E\u5713\u5F62\u6A19\u8A18\"\n  },\n  \"actions\": {\n    \"finish\": \"\u5B8C\u6210\",\n    \"cancel\": \"\u53D6\u6D88\",\n    \"removeLastVertex\": \"\u79FB\u9664\u6700\u5F8C\u4E00\u500B\u9802\u9EDE\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"\u653E\u7F6E\u6A19\u8A18\",\n    \"drawPolyButton\": \"\u7E6A\u88FD\u591A\u908A\u5F62\",\n    \"drawLineButton\": \"\u7E6A\u88FD\u7DDA\u6BB5\",\n    \"drawCircleButton\": \"\u7E6A\u88FD\u5713\u5F62\",\n    \"drawRectButton\": \"\u7E6A\u88FD\u65B9\u5F62\",\n    \"editButton\": \"\u7DE8\u8F2F\u5716\u5F62\",\n    \"dragButton\": \"\u79FB\u52D5\u5716\u5F62\",\n    \"cutButton\": \"\u88C1\u5207\u5716\u5F62\",\n    \"deleteButton\": \"\u522A\u9664\u5716\u5F62\",\n    \"drawCircleMarkerButton\": \"\u756B\u5713\u5708\u6A19\u8A18\",\n    \"snappingButton\": \"\u5C07\u62D6\u52D5\u7684\u6A19\u8A18\u5C0D\u9F4A\u5230\u5176\u4ED6\u5716\u5C64\u548C\u9802\u9EDE\",\n    \"pinningButton\": \"\u5C07\u5171\u4EAB\u9802\u9EDE\u56FA\u5B9A\u5728\u4E00\u8D77\",\n    \"rotateButton\": \"\u65CB\u8F49\u5716\u5F62\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Clique para posicionar o marcador\",\n    \"placeMarkerTouch\": \"Toque no mapa para posicionar um marcador\",\n    \"firstVertex\": \"Clique para posicionar o primeiro v\u00E9rtice\",\n    \"continueLine\": \"Clique para continuar desenhando\",\n    \"finishLine\": \"Clique em qualquer marcador existente para finalizar\",\n    \"finishPoly\": \"Clique no primeiro marcador para finalizar\",\n    \"finishRect\": \"Clique para finalizar\",\n    \"startCircle\": \"Clique para posicionar o centro do c\u00EDrculo\",\n    \"finishCircle\": \"Clique para finalizar o c\u00EDrculo\",\n    \"placeCircleMarker\": \"Clique para posicionar o marcador circular\",\n    \"placeText\": \"Clique para inserir texto\"\n  },\n  \"actions\": {\n    \"finish\": \"Finalizar\",\n    \"cancel\": \"Cancelar\",\n    \"removeLastVertex\": \"Remover \u00FAltimo v\u00E9rtice\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Desenhar Marcador\",\n    \"drawPolyButton\": \"Desenhar Pol\u00EDgonos\",\n    \"drawLineButton\": \"Desenhar Linha Poligonal\",\n    \"drawCircleButton\": \"Desenhar C\u00EDrculo\",\n    \"drawRectButton\": \"Desenhar Ret\u00E2ngulo\",\n    \"editButton\": \"Editar Camadas\",\n    \"dragButton\": \"Arrastar Camadas\",\n    \"cutButton\": \"Recortar Camadas\",\n    \"deleteButton\": \"Remover Camadas\",\n    \"drawCircleMarkerButton\": \"Desenhar Marcador de C\u00EDrculo\",\n    \"snappingButton\": \"Ajustar marcador arrastado a outras camadas e v\u00E9rtices\",\n    \"pinningButton\": \"Unir v\u00E9rtices compartilhados\",\n    \"rotateButton\": \"Rotacionar Camadas\",\n    \"drawTextButton\": \"Desenhar Texto\",\n    \"scaleButton\": \"Redimensionar Camadas\",\n    \"autoTracingButton\": \"Tra\u00E7ado Autom\u00E1tico de Linha\"\n  },\n  \"measurements\": {\n    \"totalLength\": \"Comprimento\",\n    \"segmentLength\": \"Comprimento do Segmento\",\n    \"area\": \"\u00C1rea\",\n    \"radius\": \"Raio\",\n    \"perimeter\": \"Per\u00EDmetro\",\n    \"height\": \"Altura\",\n    \"width\": \"Largura\",\n    \"coordinates\": \"Posi\u00E7\u00E3o\",\n    \"coordinatesMarker\": \"Marcador de Posi\u00E7\u00E3o\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Clique para colocar marcador\",\n    \"placeMarkerTouch\": \"Toque no mapa para colocar um marcador\",\n    \"firstVertex\": \"Clique para colocar primeiro v\u00E9rtice\",\n    \"continueLine\": \"Clique para continuar a desenhar\",\n    \"finishLine\": \"Clique num marcador existente para terminar\",\n    \"finishPoly\": \"Clique no primeiro marcador para terminar\",\n    \"finishRect\": \"Clique para terminar\",\n    \"startCircle\": \"Clique para colocar o centro do c\u00EDrculo\",\n    \"finishCircle\": \"Clique para terminar o c\u00EDrculo\",\n    \"placeCircleMarker\": \"Clique para colocar marcador de c\u00EDrculo\",\n    \"placeText\": \"Clique para colocar texto\"\n  },\n  \"actions\": {\n    \"finish\": \"Terminar\",\n    \"cancel\": \"Cancelar\",\n    \"removeLastVertex\": \"Remover \u00DAltimo V\u00E9rtice\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Desenhar Marcador\",\n    \"drawPolyButton\": \"Desenhar Pol\u00EDgonos\",\n    \"drawLineButton\": \"Desenhar Polilinha\",\n    \"drawCircleButton\": \"Desenhar C\u00EDrculo\",\n    \"drawRectButton\": \"Desenhar Ret\u00E2ngulo\",\n    \"editButton\": \"Editar Camadas\",\n    \"dragButton\": \"Arrastar Camadas\",\n    \"cutButton\": \"Cortar Camadas\",\n    \"deleteButton\": \"Remover Camadas\",\n    \"drawCircleMarkerButton\": \"Desenhar Marcador de C\u00EDrculo\",\n    \"snappingButton\": \"Ajustar marcador arrastado a outras camadas e v\u00E9rtices\",\n    \"pinningButton\": \"Unir v\u00E9rtices partilhados\",\n    \"rotateButton\": \"Rodar Camadas\",\n    \"drawTextButton\": \"Desenhar Texto\",\n    \"scaleButton\": \"Escalar Camadas\",\n    \"autoTracingButton\": \"Tra\u00E7ado Autom\u00E1tico de Linha\"\n  },\n  \"measurements\": {\n    \"totalLength\": \"Comprimento\",\n    \"segmentLength\": \"Comprimento do Segmento\",\n    \"area\": \"\u00C1rea\",\n    \"radius\": \"Raio\",\n    \"perimeter\": \"Per\u00EDmetro\",\n    \"height\": \"Altura\",\n    \"width\": \"Largura\",\n    \"coordinates\": \"Posi\u00E7\u00E3o\",\n    \"coordinatesMarker\": \"Marcador de Posi\u00E7\u00E3o\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Kliknij, aby umie\u015Bci\u0107 znacznik\",\n    \"placeMarkerTouch\": \"Dotknij map\u0119, aby umie\u015Bci\u0107 znacznik\",\n    \"firstVertex\": \"Kliknij, aby umie\u015Bci\u0107 pierwszy wierzcho\u0142ek\",\n    \"continueLine\": \"Kliknij, aby kontynuowa\u0107 rysowanie\",\n    \"finishLine\": \"Kliknij dowolny istniej\u0105cy znacznik, aby zako\u0144czy\u0107\",\n    \"finishPoly\": \"Kliknij pierwszy znacznik, aby zako\u0144czy\u0107\",\n    \"finishRect\": \"Kliknij, aby zako\u0144czy\u0107\",\n    \"startCircle\": \"Kliknij, aby umie\u015Bci\u0107 \u015Brodek okr\u0119gu\",\n    \"finishCircle\": \"Kliknij, aby zako\u0144czy\u0107 okr\u0105g\",\n    \"placeCircleMarker\": \"Kliknij, aby umie\u015Bci\u0107 znacznik okr\u0119gu\",\n    \"placeText\": \"Kliknij, aby umie\u015Bci\u0107 tekst\"\n  },\n  \"actions\": {\n    \"finish\": \"Zako\u0144cz\",\n    \"cancel\": \"Anuluj\",\n    \"removeLastVertex\": \"Usu\u0144 ostatni wierzcho\u0142ek\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Rysuj znacznik\",\n    \"drawPolyButton\": \"Rysuj wielok\u0105t\",\n    \"drawLineButton\": \"Rysuj lini\u0119\",\n    \"drawCircleButton\": \"Rysuj okr\u0105g\",\n    \"drawRectButton\": \"Rysuj prostok\u0105t\",\n    \"editButton\": \"Edytuj warstwy\",\n    \"dragButton\": \"Przeci\u0105gnij warstwy\",\n    \"cutButton\": \"Wytnij warstwy\",\n    \"deleteButton\": \"Usu\u0144 warstwy\",\n    \"drawCircleMarkerButton\": \"Rysuj znacznik okr\u0105g\u0142y\",\n    \"snappingButton\": \"Przyci\u0105gnij przenoszony znacznik do innych warstw i wierzcho\u0142k\u00F3w\",\n    \"pinningButton\": \"Przypnij wsp\u00F3lne wierzcho\u0142ki razem\",\n    \"rotateButton\": \"Obr\u00F3\u0107 warstwy\",\n    \"drawTextButton\": \"Rysuj tekst\",\n    \"scaleButton\": \"Skaluj warstwy\",\n    \"autoTracingButton\": \"Automatyczne \u015Bledzenie linii\"\n  },\n  \"measurements\": {\n    \"totalLength\": \"D\u0142ugo\u015B\u0107\",\n    \"segmentLength\": \"D\u0142ugo\u015B\u0107 odcinka\",\n    \"area\": \"Obszar\",\n    \"radius\": \"Promie\u0144\",\n    \"perimeter\": \"Obw\u00F3d\",\n    \"height\": \"Wysoko\u015B\u0107\",\n    \"width\": \"Szeroko\u015B\u0107\",\n    \"coordinates\": \"Pozycja\",\n    \"coordinatesMarker\": \"Znacznik pozycji\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Klicka f\u00F6r att placera mark\u00F6r\",\n    \"placeMarkerTouch\": \"Tryck p\u00E5 kartan f\u00F6r att placera en mark\u00F6r\",\n    \"firstVertex\": \"Klicka f\u00F6r att placera f\u00F6rsta h\u00F6rnet\",\n    \"continueLine\": \"Klicka f\u00F6r att forts\u00E4tta rita\",\n    \"finishLine\": \"Klicka p\u00E5 en existerande punkt f\u00F6r att slutf\u00F6ra\",\n    \"finishPoly\": \"Klicka p\u00E5 den f\u00F6rsta punkten f\u00F6r att slutf\u00F6ra\",\n    \"finishRect\": \"Klicka f\u00F6r att slutf\u00F6ra\",\n    \"startCircle\": \"Klicka f\u00F6r att placera cirkelns centrum\",\n    \"finishCircle\": \"Klicka f\u00F6r att slutf\u00F6ra cirkeln\",\n    \"placeCircleMarker\": \"Klicka f\u00F6r att placera cirkelmark\u00F6r\"\n  },\n  \"actions\": {\n    \"finish\": \"Slutf\u00F6r\",\n    \"cancel\": \"Avbryt\",\n    \"removeLastVertex\": \"Ta bort sista h\u00F6rnet\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Rita Mark\u00F6r\",\n    \"drawPolyButton\": \"Rita Polygoner\",\n    \"drawLineButton\": \"Rita Linje\",\n    \"drawCircleButton\": \"Rita Cirkel\",\n    \"drawRectButton\": \"Rita Rektangel\",\n    \"editButton\": \"Redigera Lager\",\n    \"dragButton\": \"Dra Lager\",\n    \"cutButton\": \"Klipp i Lager\",\n    \"deleteButton\": \"Ta bort Lager\",\n    \"drawCircleMarkerButton\": \"Rita Cirkelmark\u00F6r\",\n    \"snappingButton\": \"Sn\u00E4pp dra mark\u00F6ren till andra lager och h\u00F6rn\",\n    \"pinningButton\": \"F\u00E4st delade h\u00F6rn tillsammans\",\n    \"rotateButton\": \"Rotera lagret\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03BF\u03C0\u03BF\u03B8\u03B5\u03C4\u03AE\u03C3\u03B5\u03C4\u03B5 \u0394\u03B5\u03AF\u03BA\u03C4\u03B7\",\n    \"placeMarkerTouch\": \"\u03A0\u03B1\u03C4\u03AE\u03C3\u03C4\u03B5 \u03C3\u03C4\u03BF \u03C7\u03AC\u03C1\u03C4\u03B7 \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03BF\u03C0\u03BF\u03B8\u03B5\u03C4\u03AE\u03C3\u03B5\u03C4\u03B5 \u03B4\u03B5\u03AF\u03BA\u03C4\u03B7\",\n    \"firstVertex\": \"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03BF\u03C0\u03BF\u03B8\u03B5\u03C4\u03AE\u03C3\u03B5\u03C4\u03B5 \u03C4\u03BF \u03C0\u03C1\u03CE\u03C4\u03BF \u03C3\u03B7\u03BC\u03B5\u03AF\u03BF\",\n    \"continueLine\": \"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C3\u03C5\u03BD\u03B5\u03C7\u03AF\u03C3\u03B5\u03C4\u03B5 \u03BD\u03B1 \u03C3\u03C7\u03B5\u03B4\u03B9\u03AC\u03B6\u03B5\u03C4\u03B5\",\n    \"finishLine\": \"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03C3\u03B5 \u03BF\u03C0\u03BF\u03B9\u03BF\u03BD\u03B4\u03AE\u03C0\u03BF\u03C4\u03B5 \u03C5\u03C0\u03AC\u03C1\u03C7\u03BF\u03BD \u03C3\u03B7\u03BC\u03B5\u03AF\u03BF \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03BF\u03BB\u03BF\u03BA\u03BB\u03B7\u03C1\u03C9\u03B8\u03B5\u03AF\",\n    \"finishPoly\": \"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03C3\u03C4\u03BF \u03C0\u03C1\u03CE\u03C4\u03BF \u03C3\u03B7\u03BC\u03B5\u03AF\u03BF \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03B5\u03BB\u03B5\u03B9\u03CE\u03C3\u03B5\u03C4\u03B5\",\n    \"finishRect\": \"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03B5\u03BB\u03B5\u03B9\u03CE\u03C3\u03B5\u03C4\u03B5\",\n    \"startCircle\": \"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03BF\u03C0\u03BF\u03B8\u03B5\u03C4\u03AE\u03C3\u03B5\u03C4\u03B5 \u03BA\u03AD\u03BD\u03C4\u03C1\u03BF \u039A\u03CD\u03BA\u03BB\u03BF\u03C5\",\n    \"finishCircle\": \"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03BF\u03BB\u03BF\u03BA\u03BB\u03B7\u03C1\u03CE\u03C3\u03B5\u03C4\u03B5 \u03C4\u03BF\u03BD \u039A\u03CD\u03BA\u03BB\u03BF\",\n    \"placeCircleMarker\": \"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03BF\u03C0\u03BF\u03B8\u03B5\u03C4\u03AE\u03C3\u03B5\u03C4\u03B5 \u039A\u03C5\u03BA\u03BB\u03B9\u03BA\u03CC \u0394\u03B5\u03AF\u03BA\u03C4\u03B7\"\n  },\n  \"actions\": {\n    \"finish\": \"\u03A4\u03AD\u03BB\u03BF\u03C2\",\n    \"cancel\": \"\u0391\u03BA\u03CD\u03C1\u03C9\u03C3\u03B7\",\n    \"removeLastVertex\": \"\u039A\u03B1\u03C4\u03AC\u03C1\u03B3\u03B7\u03C3\u03B7 \u03C4\u03B5\u03BB\u03B5\u03C5\u03C4\u03B1\u03AF\u03BF\u03C5 \u03C3\u03B7\u03BC\u03B5\u03AF\u03BF\u03C5\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"\u03A3\u03C7\u03B5\u03B4\u03AF\u03B1\u03C3\u03B7 \u0394\u03B5\u03AF\u03BA\u03C4\u03B7\",\n    \"drawPolyButton\": \"\u03A3\u03C7\u03B5\u03B4\u03AF\u03B1\u03C3\u03B7 \u03A0\u03BF\u03BB\u03C5\u03B3\u03CE\u03BD\u03BF\u03C5\",\n    \"drawLineButton\": \"\u03A3\u03C7\u03B5\u03B4\u03AF\u03B1\u03C3\u03B7 \u0393\u03C1\u03B1\u03BC\u03BC\u03AE\u03C2\",\n    \"drawCircleButton\": \"\u03A3\u03C7\u03B5\u03B4\u03AF\u03B1\u03C3\u03B7 \u039A\u03CD\u03BA\u03BB\u03BF\u03C5\",\n    \"drawRectButton\": \"\u03A3\u03C7\u03B5\u03B4\u03AF\u03B1\u03C3\u03B7 \u039F\u03C1\u03B8\u03BF\u03B3\u03C9\u03BD\u03AF\u03BF\u03C5\",\n    \"editButton\": \"\u0395\u03C0\u03B5\u03BE\u03B5\u03C1\u03B3\u03B1\u03C3\u03AF\u03B1 \u0395\u03C0\u03B9\u03C0\u03AD\u03B4\u03C9\u03BD\",\n    \"dragButton\": \"\u039C\u03B5\u03C4\u03B1\u03C6\u03BF\u03C1\u03AC \u0395\u03C0\u03B9\u03C0\u03AD\u03B4\u03C9\u03BD\",\n    \"cutButton\": \"\u0391\u03C0\u03BF\u03BA\u03BF\u03C0\u03AE \u0395\u03C0\u03B9\u03C0\u03AD\u03B4\u03C9\u03BD\",\n    \"deleteButton\": \"\u039A\u03B1\u03C4\u03AC\u03C1\u03B3\u03B7\u03C3\u03B7 \u0395\u03C0\u03B9\u03C0\u03AD\u03B4\u03C9\u03BD\",\n    \"drawCircleMarkerButton\": \"\u03A3\u03C7\u03B5\u03B4\u03AF\u03B1\u03C3\u03B7 \u039A\u03C5\u03BA\u03BB\u03B9\u03BA\u03BF\u03CD \u0394\u03B5\u03AF\u03BA\u03C4\u03B7\",\n    \"snappingButton\": \"\u03A0\u03C1\u03BF\u03C3\u03BA\u03CC\u03BB\u03BB\u03B7\u03C3\u03B7 \u03C4\u03BF\u03C5 \u0394\u03B5\u03AF\u03BA\u03C4\u03B7 \u03BC\u03B5\u03C4\u03B1\u03C6\u03BF\u03C1\u03AC\u03C2 \u03C3\u03B5 \u03AC\u03BB\u03BB\u03B1 \u0395\u03C0\u03AF\u03C0\u03B5\u03B4\u03B1 \u03BA\u03B1\u03B9 \u039A\u03BF\u03C1\u03C5\u03C6\u03AD\u03C2\",\n    \"pinningButton\": \"\u03A0\u03B5\u03C1\u03B9\u03BA\u03BF\u03C0\u03AE \u03BA\u03BF\u03B9\u03BD\u03CE\u03BD \u03BA\u03BF\u03C1\u03C5\u03C6\u03CE\u03BD \u03BC\u03B1\u03B6\u03AF\",\n    \"rotateButton\": \"\u03A0\u03B5\u03C1\u03B9\u03C3\u03C4\u03C1\u03AD\u03C8\u03C4\u03B5 \u03C4\u03BF \u03C3\u03C4\u03C1\u03CE\u03BC\u03B1\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Kattintson a jel\u00F6l\u0151 elhelyez\u00E9s\u00E9hez\",\n    \"placeMarkerTouch\": \"\u00C9rintse meg a t\u00E9rk\u00E9pet a jel\u00F6l\u0151 elhelyez\u00E9s\u00E9hez\",\n    \"firstVertex\": \"Kattintson az els\u0151 pont elhelyez\u00E9s\u00E9hez\",\n    \"continueLine\": \"Kattintson a k\u00F6vetkez\u0151 pont elhelyez\u00E9s\u00E9hez\",\n    \"finishLine\": \"A befejez\u00E9shez kattintson egy megl\u00E9v\u0151 pontra\",\n    \"finishPoly\": \"A befejez\u00E9shez kattintson az els\u0151 pontra\",\n    \"finishRect\": \"Kattintson a befejez\u00E9shez\",\n    \"startCircle\": \"Kattintson a k\u00F6r k\u00F6z\u00E9ppontj\u00E1nak elhelyez\u00E9s\u00E9hez\",\n    \"finishCircle\": \"Kattintson a k\u00F6r befejez\u00E9s\u00E9hez\",\n    \"placeCircleMarker\": \"Kattintson a k\u00F6rjel\u00F6l\u0151 elhelyez\u00E9s\u00E9hez\"\n  },\n  \"actions\": {\n    \"finish\": \"Befejez\u00E9s\",\n    \"cancel\": \"M\u00E9gse\",\n    \"removeLastVertex\": \"Utols\u00F3 pont elt\u00E1vol\u00EDt\u00E1sa\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Jel\u00F6l\u0151 rajzol\u00E1sa\",\n    \"drawPolyButton\": \"Poligon rajzol\u00E1sa\",\n    \"drawLineButton\": \"Vonal rajzol\u00E1sa\",\n    \"drawCircleButton\": \"K\u00F6r rajzol\u00E1sa\",\n    \"drawRectButton\": \"N\u00E9gyzet rajzol\u00E1sa\",\n    \"editButton\": \"Elemek szerkeszt\u00E9se\",\n    \"dragButton\": \"Elemek mozgat\u00E1sa\",\n    \"cutButton\": \"Elemek v\u00E1g\u00E1sa\",\n    \"deleteButton\": \"Elemek t\u00F6rl\u00E9se\",\n    \"drawCircleMarkerButton\": \"K\u00F6r jel\u00F6l\u0151 rajzol\u00E1sa\",\n    \"snappingButton\": \"Kapcsolja a jel\u00F6lt\u0151t m\u00E1sik elemhez vagy ponthoz\",\n    \"pinningButton\": \"K\u00F6z\u00F6s pontok \u00F6sszek\u00F6t\u00E9se\",\n    \"rotateButton\": \"F\u00F3lia elforgat\u00E1sa\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Tryk for at placere en mark\u00F8r\",\n    \"placeMarkerTouch\": \"Tryk p\u00E5 kortet for at placere en mark\u00F8r\",\n    \"firstVertex\": \"Tryk for at placere det f\u00F8rste punkt\",\n    \"continueLine\": \"Tryk for at forts\u00E6tte linjen\",\n    \"finishLine\": \"Tryk p\u00E5 et eksisterende punkt for at afslutte\",\n    \"finishPoly\": \"Tryk p\u00E5 det f\u00F8rste punkt for at afslutte\",\n    \"finishRect\": \"Tryk for at afslutte\",\n    \"startCircle\": \"Tryk for at placere cirklens center\",\n    \"finishCircle\": \"Tryk for at afslutte cirklen\",\n    \"placeCircleMarker\": \"Tryk for at placere en cirkelmark\u00F8r\"\n  },\n  \"actions\": {\n    \"finish\": \"Afslut\",\n    \"cancel\": \"Afbryd\",\n    \"removeLastVertex\": \"Fjern sidste punkt\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Placer mark\u00F8r\",\n    \"drawPolyButton\": \"Tegn polygon\",\n    \"drawLineButton\": \"Tegn linje\",\n    \"drawCircleButton\": \"Tegn cirkel\",\n    \"drawRectButton\": \"Tegn firkant\",\n    \"editButton\": \"Rediger\",\n    \"dragButton\": \"Tr\u00E6k\",\n    \"cutButton\": \"Klip\",\n    \"deleteButton\": \"Fjern\",\n    \"drawCircleMarkerButton\": \"Tegn cirkelmark\u00F8r\",\n    \"snappingButton\": \"Fastg\u00F8r trukket mark\u00F8r til andre elementer\",\n    \"pinningButton\": \"Sammenl\u00E6g delte elementer\",\n    \"rotateButton\": \"Roter laget\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Klikk for \u00E5 plassere punkt\",\n    \"placeMarkerTouch\": \"Trykk p\u00E5 kartet for \u00E5 plassere et punkt\",\n    \"firstVertex\": \"Klikk for \u00E5 plassere f\u00F8rste punkt\",\n    \"continueLine\": \"Klikk for \u00E5 tegne videre\",\n    \"finishLine\": \"Klikk p\u00E5 et eksisterende punkt for \u00E5 fullf\u00F8re\",\n    \"finishPoly\": \"Klikk f\u00F8rste punkt for \u00E5 fullf\u00F8re\",\n    \"finishRect\": \"Klikk for \u00E5 fullf\u00F8re\",\n    \"startCircle\": \"Klikk for \u00E5 sette sirkel midtpunkt\",\n    \"finishCircle\": \"Klikk for \u00E5 fullf\u00F8re sirkel\",\n    \"placeCircleMarker\": \"Klikk for \u00E5 plassere sirkel\",\n    \"placeText\": \"Klikk for \u00E5 plassere tekst\"\n  },\n  \"actions\": {\n    \"finish\": \"Fullf\u00F8r\",\n    \"cancel\": \"Kanseller\",\n    \"removeLastVertex\": \"Fjern forrige punkt\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Tegn punkt\",\n    \"drawPolyButton\": \"Tegn flate\",\n    \"drawLineButton\": \"Tegn linje\",\n    \"drawCircleButton\": \"Tegn sirkel\",\n    \"drawRectButton\": \"Tegn rektangel\",\n    \"editButton\": \"Rediger objekter\",\n    \"dragButton\": \"Dra objekter\",\n    \"cutButton\": \"Kutt objekter\",\n    \"deleteButton\": \"Fjern objekter\",\n    \"drawCircleMarkerButton\": \"Tegn sirkel-punkt\",\n    \"snappingButton\": \"Fest dratt punkt til andre objekter og punkt\",\n    \"pinningButton\": \"Pin delte punkter sammen\",\n    \"rotateButton\": \"Rot\u00E9r objekter\",\n    \"drawTextButton\": \"Tegn tekst\",\n    \"scaleButton\": \"Skal\u00E9r objekter\",\n    \"autoTracingButton\": \"Automatisk sporing av linje\"\n  },\n  \"measurements\": {\n    \"totalLength\": \"Lengde\",\n    \"segmentLength\": \"Segmentlengde\",\n    \"area\": \"Omr\u00E5de\",\n    \"radius\": \"Radius\",\n    \"perimeter\": \"Omriss\",\n    \"height\": \"H\u00F8yde\",\n    \"width\": \"Bredde\",\n    \"coordinates\": \"Posisjon\",\n    \"coordinatesMarker\": \"Posisjonsmark\u00F8r\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u062C\u0627\u0646\u0645\u0627\u06CC\u06CC \u0646\u0634\u0627\u0646\",\n    \"placeMarkerTouch\": \"\u0631\u0648\u06CC \u0646\u0642\u0634\u0647 \u0636\u0631\u0628\u0647 \u0628\u0632\u0646\u06CC\u062F \u062A\u0627 \u0646\u0634\u0627\u0646 \u0628\u06AF\u0630\u0627\u0631\u06CC\u062F\",\n    \"firstVertex\": \"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u0631\u0633\u0645 \u0627\u0648\u0644\u06CC\u0646 \u0631\u0623\u0633\",\n    \"continueLine\": \"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u0627\u062F\u0627\u0645\u0647 \u0631\u0633\u0645\",\n    \"finishLine\": \"\u06A9\u0644\u06CC\u06A9 \u0631\u0648\u06CC \u0647\u0631 \u0646\u0634\u0627\u0646 \u0645\u0648\u062C\u0648\u062F \u0628\u0631\u0627\u06CC \u067E\u0627\u06CC\u0627\u0646\",\n    \"finishPoly\": \"\u06A9\u0644\u06CC\u06A9 \u0631\u0648\u06CC \u0627\u0648\u0644\u06CC\u0646 \u0646\u0634\u0627\u0646 \u0628\u0631\u0627\u06CC \u067E\u0627\u06CC\u0627\u0646\",\n    \"finishRect\": \"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u067E\u0627\u06CC\u0627\u0646\",\n    \"startCircle\": \"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u0631\u0633\u0645 \u0645\u0631\u06A9\u0632 \u062F\u0627\u06CC\u0631\u0647\",\n    \"finishCircle\": \"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u067E\u0627\u06CC\u0627\u0646 \u0631\u0633\u0645 \u062F\u0627\u06CC\u0631\u0647\",\n    \"placeCircleMarker\": \"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u0631\u0633\u0645 \u0646\u0634\u0627\u0646 \u062F\u0627\u06CC\u0631\u0647\",\n    \"placeText\": \"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u0646\u0648\u0634\u062A\u0646 \u0645\u062A\u0646\"\n  },\n  \"actions\": {\n    \"finish\": \"\u067E\u0627\u06CC\u0627\u0646\",\n    \"cancel\": \"\u0644\u0641\u0648\",\n    \"removeLastVertex\": \"\u062D\u0630\u0641 \u0622\u062E\u0631\u06CC\u0646 \u0631\u0623\u0633\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"\u062F\u0631\u062C \u0646\u0634\u0627\u0646\",\n    \"drawPolyButton\": \"\u0631\u0633\u0645 \u0686\u0646\u062F\u0636\u0644\u0639\u06CC\",\n    \"drawLineButton\": \"\u0631\u0633\u0645 \u062E\u0637\",\n    \"drawCircleButton\": \"\u0631\u0633\u0645 \u062F\u0627\u06CC\u0631\u0647\",\n    \"drawRectButton\": \"\u0631\u0633\u0645 \u0686\u0647\u0627\u0631\u0636\u0644\u0639\u06CC\",\n    \"editButton\": \"\u0648\u06CC\u0631\u0627\u06CC\u0634 \u0644\u0627\u06CC\u0647\u200C\u0647\u0627\",\n    \"dragButton\": \"\u062C\u0627\u0628\u062C\u0627\u06CC\u06CC \u0644\u0627\u06CC\u0647\u200C\u0647\u0627\",\n    \"cutButton\": \"\u0628\u0631\u0634 \u0644\u0627\u06CC\u0647\u200C\u0647\u0627\",\n    \"deleteButton\": \"\u062D\u0630\u0641 \u0644\u0627\u06CC\u0647\u200C\u0647\u0627\",\n    \"drawCircleMarkerButton\": \"\u0631\u0633\u0645 \u0646\u0634\u0627\u0646 \u062F\u0627\u06CC\u0631\u0647\",\n    \"snappingButton\": \"\u0646\u0634\u0627\u0646\u06AF\u0631 \u0631\u0627 \u0628\u0647 \u0644\u0627\u06CC\u0647\u200C\u0647\u0627 \u0648 \u0631\u0626\u0648\u0633 \u062F\u06CC\u06AF\u0631 \u0628\u06A9\u0634\u06CC\u062F\",\n    \"pinningButton\": \"\u0631\u0626\u0648\u0633 \u0645\u0634\u062A\u0631\u06A9 \u0631\u0627 \u0628\u0627 \u0647\u0645 \u067E\u06CC\u0646 \u06A9\u0646\u06CC\u062F\",\n    \"rotateButton\": \"\u0686\u0631\u062E\u0634 \u0644\u0627\u06CC\u0647\",\n    \"drawTextButton\": \"\u0631\u0633\u0645 \u0645\u062A\u0646\",\n    \"scaleButton\": \"\u0645\u0642\u06CC\u0627\u0633\u200C\u06AF\u0630\u0627\u0631\u06CC\",\n    \"autoTracingButton\": \"\u0631\u062F\u06CC\u0627\u0628 \u062E\u0648\u062F\u06A9\u0627\u0631\"\n  },\n  \"measurements\": {\n    \"totalLength\": \"\u0637\u0648\u0644\",\n    \"segmentLength\": \"\u0637\u0648\u0644 \u0628\u062E\u0634\",\n    \"area\": \"\u0646\u0627\u062D\u06CC\u0647\",\n    \"radius\": \"\u0634\u0639\u0627\u0639\",\n    \"perimeter\": \"\u0645\u062D\u06CC\u0637\",\n    \"height\": \"\u0627\u0631\u062A\u0641\u0627\u0639\",\n    \"width\": \"\u0639\u0631\u0636\",\n    \"coordinates\": \"\u0645\u0648\u0642\u0639\u06CC\u062A\",\n    \"coordinatesMarker\": \"\u0645\u0648\u0642\u0639\u06CC\u062A \u0646\u0634\u0627\u0646\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u043C\u0430\u0440\u043A\u0435\u0440\",\n    \"placeMarkerTouch\": \"\u0422\u043E\u0440\u043A\u043D\u0456\u0442\u044C\u0441\u044F \u043A\u0430\u0440\u0442\u0438, \u0449\u043E\u0431 \u0440\u043E\u0437\u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u043C\u0430\u0440\u043A\u0435\u0440\",\n    \"firstVertex\": \"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u043F\u0435\u0440\u0448\u0443 \u0432\u0435\u0440\u0448\u0438\u043D\u0443\",\n    \"continueLine\": \"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u043F\u0440\u043E\u0434\u043E\u0432\u0436\u0438\u0442\u0438 \u043C\u0430\u043B\u044E\u0432\u0430\u0442\u0438\",\n    \"finishLine\": \"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C \u0431\u0443\u0434\u044C-\u044F\u043A\u0438\u0439 \u0456\u0441\u043D\u0443\u044E\u0447\u0438\u0439 \u043C\u0430\u0440\u043A\u0435\u0440 \u0434\u043B\u044F \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u044F\",\n    \"finishPoly\": \"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u0435\u0440\u0448\u0438\u0439 \u043C\u0430\u0440\u043A\u0435\u0440, \u0449\u043E\u0431 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438\",\n    \"finishRect\": \"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438\",\n    \"startCircle\": \"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u0434\u043E\u0434\u0430\u0442\u0438 \u0446\u0435\u043D\u0442\u0440 \u043A\u043E\u043B\u0430\",\n    \"finishCircle\": \"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438 \u043A\u043E\u043B\u043E\",\n    \"placeCircleMarker\": \"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u043A\u0440\u0443\u0433\u043E\u0432\u0438\u0439 \u043C\u0430\u0440\u043A\u0435\u0440\"\n  },\n  \"actions\": {\n    \"finish\": \"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438\",\n    \"cancel\": \"\u0412\u0456\u0434\u043C\u0456\u043D\u0438\u0442\u0438\",\n    \"removeLastVertex\": \"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438 \u043F\u043E\u043F\u0435\u0440\u0435\u0434\u043D\u044E \u0432\u0435\u0440\u0448\u0438\u043D\u0443\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"\u041C\u0430\u043B\u044E\u0432\u0430\u0442\u0438 \u043C\u0430\u0440\u043A\u0435\u0440\",\n    \"drawPolyButton\": \"\u041C\u0430\u043B\u044E\u0432\u0430\u0442\u0438 \u043F\u043E\u043B\u0456\u0433\u043E\u043D\",\n    \"drawLineButton\": \"\u041C\u0430\u043B\u044E\u0432\u0430\u0442\u0438 \u043A\u0440\u0438\u0432\u0443\",\n    \"drawCircleButton\": \"\u041C\u0430\u043B\u044E\u0432\u0430\u0442\u0438 \u043A\u043E\u043B\u043E\",\n    \"drawRectButton\": \"\u041C\u0430\u043B\u044E\u0432\u0430\u0442\u0438 \u043F\u0440\u044F\u043C\u043E\u043A\u0443\u0442\u043D\u0438\u043A\",\n    \"editButton\": \"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u0448\u0430\u0440\u0438\",\n    \"dragButton\": \"\u041F\u0435\u0440\u0435\u043D\u0435\u0441\u0442\u0438 \u0448\u0430\u0440\u0438\",\n    \"cutButton\": \"\u0412\u0438\u0440\u0456\u0437\u0430\u0442\u0438 \u0448\u0430\u0440\u0438\",\n    \"deleteButton\": \"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438 \u0448\u0430\u0440\u0438\",\n    \"drawCircleMarkerButton\": \"\u041C\u0430\u043B\u044E\u0432\u0430\u0442\u0438 \u043A\u0440\u0443\u0433\u043E\u0432\u0438\u0439 \u043C\u0430\u0440\u043A\u0435\u0440\",\n    \"snappingButton\": \"\u041F\u0440\u0438\u0432\u2019\u044F\u0437\u0430\u0442\u0438 \u043F\u0435\u0440\u0435\u0442\u044F\u0433\u043D\u0443\u0442\u0438\u0439 \u043C\u0430\u0440\u043A\u0435\u0440 \u0434\u043E \u0456\u043D\u0448\u0438\u0445 \u0448\u0430\u0440\u0456\u0432 \u0442\u0430 \u0432\u0435\u0440\u0448\u0438\u043D\",\n    \"pinningButton\": \"\u0417\u0432'\u044F\u0437\u0430\u0442\u0438 \u0441\u043F\u0456\u043B\u044C\u043D\u0456 \u0432\u0435\u0440\u0448\u0438\u043D\u0438 \u0440\u0430\u0437\u043E\u043C\",\n    \"rotateButton\": \"\u041F\u043E\u0432\u0435\u0440\u043D\u0443\u0442\u0438 \u0448\u0430\u0440\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"\u0130\u015Faret\u00E7i yerle\u015Ftirmek i\u00E7in t\u0131klay\u0131n\",\n    \"placeMarkerTouch\": \"\u0130\u015Faret\u00E7i yerle\u015Ftirmek i\u00E7in haritaya dokunun\",\n    \"firstVertex\": \"\u0130lk tepe noktas\u0131n\u0131 yerle\u015Ftirmek i\u00E7in t\u0131klay\u0131n\",\n    \"continueLine\": \"\u00C7izime devam etmek i\u00E7in t\u0131klay\u0131n\",\n    \"finishLine\": \"Bitirmek i\u00E7in mevcut herhangi bir i\u015Faret\u00E7iyi t\u0131klay\u0131n\",\n    \"finishPoly\": \"Bitirmek i\u00E7in ilk i\u015Faret\u00E7iyi t\u0131klay\u0131n\",\n    \"finishRect\": \"Bitirmek i\u00E7in t\u0131klay\u0131n\",\n    \"startCircle\": \"Daire merkezine yerle\u015Ftirmek i\u00E7in t\u0131klay\u0131n\",\n    \"finishCircle\": \"Daireyi bitirmek i\u00E7in t\u0131klay\u0131n\",\n    \"placeCircleMarker\": \"Daire i\u015Faret\u00E7isi yerle\u015Ftirmek i\u00E7in t\u0131klay\u0131n\"\n  },\n  \"actions\": {\n    \"finish\": \"Bitir\",\n    \"cancel\": \"\u0130ptal\",\n    \"removeLastVertex\": \"Son k\u00F6\u015Feyi kald\u0131r\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"\u00C7izim \u0130\u015Faret\u00E7isi\",\n    \"drawPolyButton\": \"\u00C7okgenler \u00E7iz\",\n    \"drawLineButton\": \"\u00C7oklu \u00E7izgi \u00E7iz\",\n    \"drawCircleButton\": \"\u00C7ember \u00E7iz\",\n    \"drawRectButton\": \"Dikd\u00F6rtgen \u00E7iz\",\n    \"editButton\": \"Katmanlar\u0131 d\u00FCzenle\",\n    \"dragButton\": \"Katmanlar\u0131 s\u00FCr\u00FCkle\",\n    \"cutButton\": \"Katmanlar\u0131 kes\",\n    \"deleteButton\": \"Katmanlar\u0131 kald\u0131r\",\n    \"drawCircleMarkerButton\": \"Daire i\u015Faret\u00E7isi \u00E7iz\",\n    \"snappingButton\": \"S\u00FCr\u00FCklenen i\u015Faret\u00E7iyi di\u011Fer katmanlara ve k\u00F6\u015Felere yap\u0131\u015Ft\u0131r\",\n    \"pinningButton\": \"Payla\u015F\u0131lan k\u00F6\u015Feleri birbirine sabitle\",\n    \"rotateButton\": \"Katman\u0131 d\u00F6nd\u00FCr\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Kliknut\u00EDm vytvo\u0159\u00EDte zna\u010Dku\",\n    \"placeMarkerTouch\": \"Klepnut\u00EDm na mapu um\u00EDst\u00EDte zna\u010Dku\",\n    \"firstVertex\": \"Kliknut\u00EDm vytvo\u0159\u00EDte prvn\u00ED objekt\",\n    \"continueLine\": \"Kliknut\u00EDm pokra\u010Dujte v kreslen\u00ED\",\n    \"finishLine\": \"Kliknut\u00ED na libovolnou existuj\u00EDc\u00ED zna\u010Dku pro dokon\u010Den\u00ED\",\n    \"finishPoly\": \"Vyberte prvn\u00ED bod pro dokon\u010Den\u00ED\",\n    \"finishRect\": \"Klikn\u011Bte pro dokon\u010Den\u00ED\",\n    \"startCircle\": \"Kliknut\u00EDm p\u0159idejte st\u0159ed kruhu\",\n    \"finishCircle\": \"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u0437\u0430\u0434\u0430\u0442\u044C \u0440\u0430\u0434\u0438\u0443\u0441\",\n    \"placeCircleMarker\": \"Kliknut\u00EDm nastavte polom\u011Br\"\n  },\n  \"actions\": {\n    \"finish\": \"Dokon\u010Dit\",\n    \"cancel\": \"Zru\u0161it\",\n    \"removeLastVertex\": \"Zru\u0161it posledn\u00ED akci\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"P\u0159idat zna\u010Dku\",\n    \"drawPolyButton\": \"Nakreslit polygon\",\n    \"drawLineButton\": \"Nakreslit k\u0159ivku\",\n    \"drawCircleButton\": \"Nakreslit kruh\",\n    \"drawRectButton\": \"Nakreslit obd\u00E9ln\u00EDk\",\n    \"editButton\": \"Upravit vrstvu\",\n    \"dragButton\": \"P\u0159eneste vrstvu\",\n    \"cutButton\": \"Vyjmout vrstvu\",\n    \"deleteButton\": \"Smazat vrstvu\",\n    \"drawCircleMarkerButton\": \"P\u0159idat kruhovou zna\u010Dku\",\n    \"snappingButton\": \"Nav\u00E1zat ta\u017Enou zna\u010Dku k dal\u0161\u00EDm vrstv\u00E1m a vrchol\u016Fm\",\n    \"pinningButton\": \"Spojit spole\u010Dn\u00E9 body dohromady\",\n    \"rotateButton\": \"Oto\u010Dte vrstvu\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u30DE\u30FC\u30AB\u30FC\u3092\u914D\u7F6E\",\n    \"placeMarkerTouch\": \"\u5730\u56F3\u3092\u30BF\u30C3\u30D7\u3057\u3066\u30DE\u30FC\u30AB\u30FC\u3092\u914D\u7F6E\",\n    \"firstVertex\": \"\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u6700\u521D\u306E\u9802\u70B9\u3092\u914D\u7F6E\",\n    \"continueLine\": \"\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u63CF\u753B\u3092\u7D9A\u3051\u308B\",\n    \"finishLine\": \"\u4EFB\u610F\u306E\u30DE\u30FC\u30AB\u30FC\u3092\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u7D42\u4E86\",\n    \"finishPoly\": \"\u6700\u521D\u306E\u30DE\u30FC\u30AB\u30FC\u3092\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u7D42\u4E86\",\n    \"finishRect\": \"\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u7D42\u4E86\",\n    \"startCircle\": \"\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u5186\u306E\u4E2D\u5FC3\u3092\u914D\u7F6E\",\n    \"finishCircle\": \"\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u5186\u306E\u63CF\u753B\u3092\u7D42\u4E86\",\n    \"placeCircleMarker\": \"\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u5186\u30DE\u30FC\u30AB\u30FC\u3092\u914D\u7F6E\",\n    \"placeText\": \"\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u30C6\u30AD\u30B9\u30C8\u3092\u914D\u7F6E\"\n  },\n  \"actions\": {\n    \"finish\": \"\u7D42\u4E86\",\n    \"cancel\": \"\u30AD\u30E3\u30F3\u30BB\u30EB\",\n    \"removeLastVertex\": \"\u6700\u5F8C\u306E\u9802\u70B9\u3092\u524A\u9664\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"\u30DE\u30FC\u30AB\u30FC\u3092\u63CF\u753B\",\n    \"drawPolyButton\": \"\u30DD\u30EA\u30B4\u30F3\u3092\u63CF\u753B\",\n    \"drawLineButton\": \"\u6298\u308C\u7DDA\u3092\u63CF\u753B\",\n    \"drawCircleButton\": \"\u5186\u3092\u63CF\u753B\",\n    \"drawRectButton\": \"\u77E9\u5F62\u3092\u63CF\u753B\",\n    \"editButton\": \"\u30EC\u30A4\u30E4\u30FC\u3092\u7DE8\u96C6\",\n    \"dragButton\": \"\u30EC\u30A4\u30E4\u30FC\u3092\u30C9\u30E9\u30C3\u30B0\",\n    \"cutButton\": \"\u30EC\u30A4\u30E4\u30FC\u3092\u5207\u308A\u53D6\u308A\",\n    \"deleteButton\": \"\u30EC\u30A4\u30E4\u30FC\u3092\u524A\u9664\",\n    \"drawCircleMarkerButton\": \"\u5186\u30DE\u30FC\u30AB\u30FC\u3092\u63CF\u753B\",\n    \"snappingButton\": \"\u30C9\u30E9\u30C3\u30B0\u3057\u305F\u30DE\u30FC\u30AB\u30FC\u3092\u4ED6\u306E\u30EC\u30A4\u30E4\u30FC\u3084\u9802\u70B9\u306B\u30B9\u30CA\u30C3\u30D7\u3059\u308B\",\n    \"pinningButton\": \"\u5171\u6709\u3059\u308B\u9802\u70B9\u3092\u540C\u6642\u306B\u52D5\u304B\u3059\",\n    \"rotateButton\": \"\u30EC\u30A4\u30E4\u30FC\u3092\u56DE\u8EE2\",\n    \"drawTextButton\": \"\u30C6\u30AD\u30B9\u30C8\u3092\u63CF\u753B\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"Klikkaa asettaaksesi merkin\",\n    \"placeMarkerTouch\": \"Napauta karttaa asettaaksesi merkin\",\n    \"firstVertex\": \"Klikkaa asettaakseni ensimm\u00E4isen osuuden\",\n    \"continueLine\": \"Klikkaa jatkaaksesi piirt\u00E4mist\u00E4\",\n    \"finishLine\": \"Klikkaa olemassa olevaa merkki\u00E4 lopettaaksesi\",\n    \"finishPoly\": \"Klikkaa ensimm\u00E4ist\u00E4 merkki\u00E4 lopettaaksesi\",\n    \"finishRect\": \"Klikkaa lopettaaksesi\",\n    \"startCircle\": \"Klikkaa asettaaksesi ympyr\u00E4n keskipisteen\",\n    \"finishCircle\": \"Klikkaa lopettaaksesi ympyr\u00E4n\",\n    \"placeCircleMarker\": \"Klikkaa asettaaksesi ympyr\u00E4merkin\",\n    \"placeText\": \"Klikkaa asettaaksesi tekstin\"\n  },\n  \"actions\": {\n    \"finish\": \"Valmis\",\n    \"cancel\": \"Peruuta\",\n    \"removeLastVertex\": \"Poista viimeinen osuus\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"Piirr\u00E4 merkkej\u00E4\",\n    \"drawPolyButton\": \"Piirr\u00E4 monikulmioita\",\n    \"drawLineButton\": \"Piirr\u00E4 viivoja\",\n    \"drawCircleButton\": \"Piirr\u00E4 ympyr\u00E4\",\n    \"drawRectButton\": \"Piirr\u00E4 neliskulmioita\",\n    \"editButton\": \"Muokkaa\",\n    \"dragButton\": \"Siirr\u00E4\",\n    \"cutButton\": \"Leikkaa\",\n    \"deleteButton\": \"Poista\",\n    \"drawCircleMarkerButton\": \"Piirr\u00E4 ympyr\u00E4merkki\",\n    \"snappingButton\": \"Kiinnit\u00E4 siirrett\u00E4v\u00E4 merkki toisiin muotoihin\",\n    \"pinningButton\": \"Kiinnit\u00E4 jaetut muodot yhteen\",\n    \"rotateButton\": \"K\u00E4\u00E4nn\u00E4\",\n    \"drawTextButton\": \"Piirr\u00E4 teksti\u00E4\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"\uB9C8\uCEE4 \uC704\uCE58\uB97C \uD074\uB9AD\uD558\uC138\uC694\",\n    \"placeMarkerTouch\": \"\uC9C0\uB3C4\uB97C \uD0ED\uD558\uC5EC \uB9C8\uCEE4\uB97C \uBC30\uCE58\uD558\uC138\uC694\",\n    \"firstVertex\": \"\uCCAB\uBC88\uC9F8 \uAF2D\uC9C0\uC810 \uC704\uCE58\uC744 \uD074\uB9AD\uD558\uC138\uC694\",\n    \"continueLine\": \"\uACC4\uC18D \uADF8\uB9AC\uB824\uBA74 \uD074\uB9AD\uD558\uC138\uC694\",\n    \"finishLine\": \"\uB05D\uB0B4\uB824\uBA74 \uAE30\uC874 \uB9C8\uCEE4\uB97C \uD074\uB9AD\uD558\uC138\uC694\",\n    \"finishPoly\": \"\uB05D\uB0B4\uB824\uBA74 \uCC98\uC74C \uB9C8\uCEE4\uB97C \uD074\uB9AD\uD558\uC138\uC694\",\n    \"finishRect\": \"\uB05D\uB0B4\uB824\uBA74 \uD074\uB9AD\uD558\uC138\uC694\",\n    \"startCircle\": \"\uC6D0\uC758 \uC911\uC2EC\uC774 \uB420 \uC704\uCE58\uB97C \uD074\uB9AD\uD558\uC138\uC694\",\n    \"finishCircle\": \"\uC6D0\uC744 \uB05D\uB0B4\uB824\uBA74 \uD074\uB9AD\uD558\uC138\uC694\",\n    \"placeCircleMarker\": \"\uC6D0 \uB9C8\uCEE4 \uC704\uCE58\uB97C \uD074\uB9AD\uD558\uC138\uC694\",\n    \"placeText\": \"\uD14D\uC2A4\uD2B8 \uC704\uCE58\uB97C \uD074\uB9AD\uD558\uC138\uC694\"\n  },\n  \"actions\": {\n    \"finish\": \"\uB05D\uB0B4\uAE30\",\n    \"cancel\": \"\uCDE8\uC18C\",\n    \"removeLastVertex\": \"\uB9C8\uC9C0\uB9C9 \uAF2D\uC9C0\uC810 \uC81C\uAC70\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"\uB9C8\uCEE4 \uADF8\uB9AC\uAE30\",\n    \"drawPolyButton\": \"\uB2E4\uAC01\uD615 \uADF8\uB9AC\uAE30\",\n    \"drawLineButton\": \"\uB2E4\uAC01\uC120 \uADF8\uB9AC\uAE30\",\n    \"drawCircleButton\": \"\uC6D0 \uADF8\uB9AC\uAE30\",\n    \"drawRectButton\": \"\uC9C1\uC0AC\uAC01\uD615 \uADF8\uB9AC\uAE30\",\n    \"editButton\": \"\uB808\uC774\uC5B4 \uD3B8\uC9D1\uD558\uAE30\",\n    \"dragButton\": \"\uB808\uC774\uC5B4 \uB04C\uAE30\",\n    \"cutButton\": \"\uB808\uC774\uC5B4 \uC790\uB974\uAE30\",\n    \"deleteButton\": \"\uB808\uC774\uC5B4 \uC81C\uAC70\uD558\uAE30\",\n    \"drawCircleMarkerButton\": \"\uC6D0 \uB9C8\uCEE4 \uADF8\uB9AC\uAE30\",\n    \"snappingButton\": \"\uC7A1\uC544\uB048 \uB9C8\uCEE4\uB97C \uB2E4\uB978 \uB808\uC774\uC5B4 \uBC0F \uAF2D\uC9C0\uC810\uC5D0 \uB4E4\uB7EC\uBD99\uAC8C \uD558\uAE30\",\n    \"pinningButton\": \"\uACF5\uC720 \uAF2D\uC9C0\uC810\uC744 \uD568\uAED8 \uCC0D\uAE30\",\n    \"rotateButton\": \"\uB808\uC774\uC5B4 \uD68C\uC804\uD558\uAE30\",\n    \"drawTextButton\": \"\uD14D\uC2A4\uD2B8 \uADF8\uB9AC\uAE30\"\n  }\n}\n", "{\n  \"tooltips\": {\n    \"placeMarker\": \"\u041C\u0430\u0440\u043A\u0435\u0440\u0434\u0438 \u0436\u0430\u0439\u0433\u0430\u0448\u0442\u044B\u0440\u0443\u0443 \u04AF\u0447\u04AF\u043D \u0431\u0430\u0441\u044B\u04A3\u044B\u0437\",\n    \"placeMarkerTouch\": \"\u041C\u0430\u0440\u043A\u0435\u0440\u0434\u0438 \u0436\u0430\u0439\u0433\u0430\u0448\u0442\u044B\u0440\u0443\u0443 \u04AF\u0447\u04AF\u043D \u043A\u0430\u0440\u0442\u0430\u0433\u0430 \u0442\u0438\u0439\u0438\u04A3\u0438\u0437\",\n    \"firstVertex\": \"\u0411\u0438\u0440\u0438\u043D\u0447\u0438 \u0447\u043E\u043A\u0443\u043D\u0443 \u0436\u0430\u0439\u0433\u0430\u0448\u0442\u044B\u0440\u0443\u0443\u043D\u0443 \u04AF\u0447\u04AF\u043D \u0431\u0430\u0441\u044B\u04A3\u044B\u0437\",\n    \"continueLine\": \"\u0421\u04AF\u0440\u04E9\u0442 \u0442\u0430\u0440\u0442\u0443\u0443\u043D\u0443 \u0443\u043B\u0430\u043D\u0442\u0443\u0443 \u04AF\u0447\u04AF\u043D \u0431\u0430\u0441\u044B\u04A3\u044B\u0437\",\n    \"finishLine\": \"\u0410\u044F\u043A\u0442\u043E\u043E \u04AF\u0447\u04AF\u043D \u0443\u0447\u0443\u0440\u0434\u0430\u0433\u044B \u043C\u0430\u0440\u043A\u0435\u0440\u0434\u0438 \u0431\u0430\u0441\u044B\u04A3\u044B\u0437\",\n    \"finishPoly\": \"\u0411\u04AF\u0442\u04AF\u0440\u04AF\u04AF \u04AF\u0447\u04AF\u043D \u0431\u0438\u0440\u0438\u043D\u0447\u0438 \u043C\u0430\u0440\u043A\u0435\u0440\u0434\u0438 \u0431\u0430\u0441\u044B\u04A3\u044B\u0437\",\n    \"finishRect\": \"\u0411\u04AF\u0442\u04AF\u0440\u04AF\u04AF \u04AF\u0447\u04AF\u043D \u0431\u0430\u0441\u044B\u04A3\u044B\u0437\",\n    \"startCircle\": \"\u0410\u0439\u043B\u0430\u043D\u0430\u043D\u044B\u043D \u0431\u043E\u0440\u0431\u043E\u0440\u0443\u043D \u0436\u0430\u0439\u0433\u0430\u0448\u0442\u044B\u0440\u0443\u0443\u043D\u0443 \u04AF\u0447\u04AF\u043D \u0431\u0430\u0441\u044B\u04A3\u044B\u0437\",\n    \"finishCircle\": \"\u0410\u0439\u043B\u0430\u043D\u0430\u043D\u044B \u0431\u04AF\u0442\u04AF\u0440\u04AF\u04AF \u04AF\u0447\u04AF\u043D \u0431\u0430\u0441\u044B\u04A3\u044B\u0437\",\n    \"placeCircleMarker\": \"\u0422\u0435\u0433\u0435\u0440\u0435\u043A \u043C\u0430\u0440\u043A\u0435\u0440\u0434\u0438 \u0436\u0430\u0439\u0433\u0430\u0448\u0442\u044B\u0440\u0443\u0443 \u04AF\u0447\u04AF\u043D \u0431\u0430\u0441\u044B\u04A3\u044B\u0437\",\n    \"placeText\": \"\u0422\u0435\u043A\u0441\u0442\u0442\u0438 \u0436\u0430\u0439\u0433\u0430\u0448\u0442\u044B\u0440\u0443\u0443 \u04AF\u0447\u04AF\u043D \u0431\u0430\u0441\u044B\u04A3\u044B\u0437\"\n  },\n  \"actions\": {\n    \"finish\": \"\u0410\u044F\u0433\u044B\",\n    \"cancel\": \"\u0416\u043E\u043A \u043A\u044B\u043B\u0443\u0443\",\n    \"removeLastVertex\": \"\u0410\u043A\u044B\u0440\u043A\u044B \u0447\u043E\u043A\u0443\u043D\u0443 \u04E9\u0447\u04AF\u0440\u04AF\u04AF\"\n  },\n  \"buttonTitles\": {\n    \"drawMarkerButton\": \"\u041C\u0430\u0440\u043A\u0435\u0440\u0434\u0438 \u0447\u0438\u0437\u0443\u0443\",\n    \"drawPolyButton\": \"\u041F\u043E\u043B\u0438\u0433\u043E\u043D \u0447\u0438\u0437\u0443\u0443\",\n    \"drawLineButton\": \"\u041F\u043E\u043B\u0438\u043B\u0438\u043D\u0438\u044F \u0447\u0438\u0437\u0443\u0443\",\n    \"drawCircleButton\": \"\u0414\u0430\u0439\u044B\u043D\u0434\u044B \u0447\u0438\u0437\u0443\u0443\",\n    \"drawRectButton\": \"\u041F\u0440\u044F\u043C\u043E\u0443\u0433\u043E\u043B\u044C\u043D\u0438\u043A \u0447\u0438\u0437\u0443\u0443\",\n    \"editButton\": \"\u0421\u043B\u043E\u043E\u043F\u0442\u0443 \u0442\u04AF\u0437\u04E9\u0442\u04AF\u04AF\",\n    \"dragButton\": \"\u0421\u043B\u043E\u043E\u043F\u0442\u0443 \u043A\u0430\u0440\u0430\u043F \u0441\u04AF\u0439\u043B\u04E9\u04AF\",\n    \"cutButton\": \"\u0421\u043B\u043E\u043E\u043F\u0442\u0443\u043D \u0431\u0430\u0448\u044B\u043D \u043A\u0435\u0441\u04AF\u04AF\",\n    \"deleteButton\": \"\u0421\u043B\u043E\u043E\u043F\u0442\u0443\u043D \u04E9\u0447\u04AF\u0440\u04AF\u04AF\",\n    \"drawCircleMarkerButton\": \"\u0414\u0430\u0439\u044B\u043D\u0434\u044B \u043C\u0430\u0440\u043A\u0435\u0440\u0434\u0438 \u0447\u0438\u0437\u0443\u0443\",\n    \"snappingButton\": \"\u0411\u0430\u0448\u043A\u0430 \u0441\u043B\u043E\u043E\u043F\u0442\u043E\u0440\u0434\u0443\u043D \u0436\u0430\u043D\u0430 \u0432\u0435\u0440\u0442\u0435\u043A\u0441\u0442\u0435\u0440\u0434\u0438\u043D \u0430\u0440\u0430\u0441\u044B\u043D\u0430 \u0447\u0435\u043A\u0438\u043B\u0434\u04E9\u04E9\",\n    \"pinningButton\": \"\u0411\u04E9\u043B\u04AF\u0448\u043A\u04E9\u043D \u0432\u0435\u0440\u0442\u0435\u043A\u0441\u0442\u0435\u0440\u0434\u0438 \u0431\u0438\u0440\u0433\u0435 \u0442\u0443\u0442\u0443\u0448\u0442\u0443\u0440\u0443\u0443\",\n    \"rotateButton\": \"\u0421\u043B\u043E\u043E\u043F\u0442\u0443\u043D \u04E9\u0437\u0433\u04E9\u0440\u0442\u04AF\u04AF\",\n    \"drawTextButton\": \"\u0422\u0435\u043A\u0441\u0442 \u0447\u0438\u0437\u0443\u0443\",\n    \"scaleButton\": \"\u0421\u043B\u043E\u043E\u043F\u0442\u0443\u043D \u04E9\u043B\u0447\u04E9\u043C\u04AF\u043D \u04E9\u0437\u0433\u04E9\u0440\u0442\u04AF\u04AF\",\n    \"autoTracingButton\": \"\u0410\u0432\u0442\u043E\u043C\u0430\u0442\u0442\u044B\u043A \u0442\u0438\u0437\u043C\u0435\u0433\u0438 \u0447\u0438\u0437\u0443\u0443\"\n  },\n  \"measurements\": {\n    \"totalLength\": \"\u0423\u0437\u0443\u043D\u0434\u0443\u043A\",\n    \"segmentLength\": \"\u0421\u0435\u0433\u043C\u0435\u043D\u0442 \u0443\u0437\u0443\u043D\u0434\u0443\u0433\u0443\",\n    \"area\": \"\u0410\u0439\u043C\u0430\u043A\",\n    \"radius\": \"\u0420\u0430\u0434\u0438\u0443\u0441\",\n    \"perimeter\": \"\u041F\u0435\u0440\u0438\u043C\u0435\u0442\u0440\",\n    \"height\": \"\u0414\u0438\u0430\u043C\u0435\u0442\u0440\",\n    \"width\": \"\u041A\u0435\u043D\u0447\u0438\u043B\u0438\u043A\",\n    \"coordinates\": \"\u041A\u043E\u043E\u0440\u0434\u0438\u043D\u0430\u0442\u0442\u0430\u0440\",\n    \"coordinatesMarker\": \"\u041C\u0430\u0440\u043A\u0435\u0440\u0434\u0438\u043D \u043A\u043E\u043E\u0440\u0434\u0438\u043D\u0430\u0442\u0442\u0430\u0440\u044B\"\n  }\n}\n", "import en from './en.json';\nimport de from './de.json';\nimport it from './it.json';\nimport id from './id.json';\nimport ro from './ro.json';\nimport ru from './ru.json';\nimport es from './es.json';\nimport nl from './nl.json';\nimport fr from './fr.json';\nimport zh from './zh.json';\n\nimport zh_tw from './zh_tw.json';\n\nimport pt_br from './pt_br.json';\n\nimport pt_pt from './pt_pt.json';\nimport pl from './pl.json';\nimport sv from './sv.json';\nimport el from './el.json';\nimport hu from './hu.json';\nimport da from './da.json';\nimport no from './no.json';\nimport fa from './fa.json';\nimport ua from './ua.json';\nimport tr from './tr.json';\nimport cz from './cz.json';\nimport ja from './ja.json';\nimport fi from './fi.json';\nimport ko from './ko.json';\nimport ky from './ky.json';\n\nconst pt = pt_pt;\n\nexport default {\n  en,\n  de,\n  it,\n  id,\n  ro,\n  ru,\n  es,\n  nl,\n  fr,\n  pt,\n\n  pt_br,\n\n  pt_pt,\n  zh,\n\n  zh_tw,\n  pl,\n  sv,\n  el,\n  hu,\n  da,\n  no,\n  fa,\n  ua,\n  tr,\n  cz,\n  ja,\n  fi,\n  ko,\n  ky,\n};\n", "// this mixin adds a global edit mode to the map\nconst GlobalEditMode = {\n  _globalEditModeEnabled: false,\n  enableGlobalEditMode(o) {\n    const options = {\n      ...o,\n    };\n    // set status\n    this._globalEditModeEnabled = true;\n\n    // Set toolbar button to currect status\n    this.Toolbar.toggleButton('editMode', this.globalEditModeEnabled());\n\n    // find all layers handled by leaflet-geoman\n    const layers = L.PM.Utils.findLayers(this.map);\n\n    // enable all layers\n    layers.forEach((layer) => {\n      if (this._isRelevantForEdit(layer)) {\n        layer.pm.enable(options);\n      }\n    });\n\n    if (!this.throttledReInitEdit) {\n      this.throttledReInitEdit = L.Util.throttle(\n        this.handleLayerAdditionInGlobalEditMode,\n        100,\n        this\n      );\n    }\n\n    // save the added layers into the _addedLayersEdit array, to read it later out\n    this._addedLayersEdit = {};\n    this.map.on('layeradd', this._layerAddedEdit, this);\n    // handle layers that are added while in edit mode\n    this.map.on('layeradd', this.throttledReInitEdit, this);\n\n    // fire event\n    this._fireGlobalEditModeToggled(true);\n  },\n  disableGlobalEditMode() {\n    // set status\n    this._globalEditModeEnabled = false;\n\n    // find all layers handles by leaflet-geoman\n    const layers = L.PM.Utils.findLayers(this.map);\n\n    // disable all layers\n    layers.forEach((layer) => {\n      layer.pm.disable();\n    });\n\n    // cleanup layer off event\n    this.map.off('layeradd', this._layerAddedEdit, this);\n    this.map.off('layeradd', this.throttledReInitEdit, this);\n\n    // Set toolbar button to currect status\n    this.Toolbar.toggleButton('editMode', this.globalEditModeEnabled());\n\n    // fire event\n    this._fireGlobalEditModeToggled(false);\n  },\n  // TODO: Remove in the next major release\n  globalEditEnabled() {\n    return this.globalEditModeEnabled();\n  },\n  globalEditModeEnabled() {\n    return this._globalEditModeEnabled;\n  },\n  // TODO: this should maybe removed, it will overwrite explicit options on the layers\n  toggleGlobalEditMode(options = this.globalOptions) {\n    if (this.globalEditModeEnabled()) {\n      // disable\n      this.disableGlobalEditMode();\n    } else {\n      // enable\n      this.enableGlobalEditMode(options);\n    }\n  },\n  handleLayerAdditionInGlobalEditMode() {\n    const layers = this._addedLayersEdit;\n    this._addedLayersEdit = {};\n    if (this.globalEditModeEnabled()) {\n      for (const id in layers) {\n        const layer = layers[id];\n        // when global edit mode is enabled and a layer is added to the map,\n        // enable edit for that layer if it's relevant\n\n        if (this._isRelevantForEdit(layer)) {\n          layer.pm.enable({ ...this.globalOptions });\n        }\n      }\n    }\n  },\n  _layerAddedEdit({ layer }) {\n    this._addedLayersEdit[L.stamp(layer)] = layer;\n  },\n  _isRelevantForEdit(layer) {\n    return (\n      layer.pm &&\n      !(layer instanceof L.LayerGroup) &&\n      ((!L.PM.optIn && !layer.options.pmIgnore) || // if optIn is not set / true and pmIgnore is not set / true (default)\n        (L.PM.optIn && layer.options.pmIgnore === false)) && // if optIn is true and pmIgnore is false\n      !layer._pmTempLayer &&\n      layer.pm.options.allowEditing\n    );\n  },\n};\n\nexport default GlobalEditMode;\n", "const GlobalDragMode = {\n  _globalDragModeEnabled: false,\n  enableGlobalDragMode() {\n    const layers = L.PM.Utils.findLayers(this.map);\n\n    this._globalDragModeEnabled = true;\n    this._addedLayersDrag = {};\n\n    layers.forEach((layer) => {\n      if (this._isRelevantForDrag(layer)) {\n        layer.pm.enableLayerDrag();\n      }\n    });\n\n    if (!this.throttledReInitDrag) {\n      this.throttledReInitDrag = L.Util.throttle(\n        this.reinitGlobalDragMode,\n        100,\n        this\n      );\n    }\n\n    // add map handler\n    this.map.on('layeradd', this._layerAddedDrag, this);\n    this.map.on('layeradd', this.throttledReInitDrag, this);\n\n    // toogle the button in the toolbar if this is called programatically\n    this.Toolbar.toggleButton('dragMode', this.globalDragModeEnabled());\n\n    this._fireGlobalDragModeToggled(true);\n  },\n  disableGlobalDragMode() {\n    const layers = L.PM.Utils.findLayers(this.map);\n\n    this._globalDragModeEnabled = false;\n\n    layers.forEach((layer) => {\n      layer.pm.disableLayerDrag();\n    });\n\n    // remove map handler\n    this.map.off('layeradd', this._layerAddedDrag, this);\n    this.map.off('layeradd', this.throttledReInitDrag, this);\n\n    // toogle the button in the toolbar if this is called programatically\n    this.Toolbar.toggleButton('dragMode', this.globalDragModeEnabled());\n\n    this._fireGlobalDragModeToggled(false);\n  },\n  globalDragModeEnabled() {\n    return !!this._globalDragModeEnabled;\n  },\n  toggleGlobalDragMode() {\n    if (this.globalDragModeEnabled()) {\n      this.disableGlobalDragMode();\n    } else {\n      this.enableGlobalDragMode();\n    }\n  },\n  reinitGlobalDragMode() {\n    const layers = this._addedLayersDrag;\n    this._addedLayersDrag = {};\n    if (this.globalDragModeEnabled()) {\n      for (const id in layers) {\n        const layer = layers[id];\n\n        if (this._isRelevantForDrag(layer)) {\n          layer.pm.enableLayerDrag();\n        }\n      }\n    }\n  },\n  _layerAddedDrag({ layer }) {\n    this._addedLayersDrag[L.stamp(layer)] = layer;\n  },\n  _isRelevantForDrag(layer) {\n    return (\n      layer.pm &&\n      !(layer instanceof L.LayerGroup) &&\n      ((!L.PM.optIn && !layer.options.pmIgnore) || // if optIn is not set / true and pmIgnore is not set / true (default)\n        (L.PM.optIn && layer.options.pmIgnore === false)) && // if optIn is true and pmIgnore is false\n      !layer._pmTempLayer &&\n      layer.pm.options.draggable\n    );\n  },\n};\n\nexport default GlobalDragMode;\n", "const GlobalRemovalMode = {\n  _globalRemovalModeEnabled: false,\n  enableGlobalRemovalMode() {\n    this._globalRemovalModeEnabled = true;\n    // handle existing layers\n    this.map.eachLayer((layer) => {\n      if (this._isRelevantForRemoval(layer)) {\n        if (layer.pm.enabled()) {\n          layer.pm.disable();\n        }\n        layer.on('click', this.removeLayer, this);\n      }\n    });\n\n    if (!this.throttledReInitRemoval) {\n      this.throttledReInitRemoval = L.Util.throttle(\n        this.handleLayerAdditionInGlobalRemovalMode,\n        100,\n        this\n      );\n    }\n    // save the added layers into the _addedLayersRemoval array, to read it later out\n    this._addedLayersRemoval = {};\n    // handle layers that are added while in removal mode\n    this.map.on('layeradd', this._layerAddedRemoval, this);\n    this.map.on('layeradd', this.throttledReInitRemoval, this);\n\n    // toogle the button in the toolbar if this is called programatically\n    this.Toolbar.toggleButton('removalMode', this.globalRemovalModeEnabled());\n\n    this._fireGlobalRemovalModeToggled(true);\n  },\n  disableGlobalRemovalMode() {\n    this._globalRemovalModeEnabled = false;\n    this.map.eachLayer((layer) => {\n      layer.off('click', this.removeLayer, this);\n    });\n\n    // remove map handler\n    this.map.off('layeradd', this._layerAddedRemoval, this);\n    this.map.off('layeradd', this.throttledReInitRemoval, this);\n\n    // toogle the button in the toolbar if this is called programatically\n    this.Toolbar.toggleButton('removalMode', this.globalRemovalModeEnabled());\n\n    this._fireGlobalRemovalModeToggled(false);\n  },\n  // TODO: Remove in the next major release\n  globalRemovalEnabled() {\n    return this.globalRemovalModeEnabled();\n  },\n  globalRemovalModeEnabled() {\n    return !!this._globalRemovalModeEnabled;\n  },\n  toggleGlobalRemovalMode() {\n    // toggle global edit mode\n    if (this.globalRemovalModeEnabled()) {\n      this.disableGlobalRemovalMode();\n    } else {\n      this.enableGlobalRemovalMode();\n    }\n  },\n  removeLayer(e) {\n    const layer = e.target;\n    // only remove layer, if it's handled by leaflet-geoman,\n    // not a tempLayer and not currently being dragged\n    const removeable =\n      this._isRelevantForRemoval(layer) && !layer.pm.dragging();\n\n    if (removeable) {\n      layer.removeFrom(this.map.pm._getContainingLayer());\n      layer.remove();\n      if (layer instanceof L.LayerGroup) {\n        this._fireRemoveLayerGroup(layer);\n        this._fireRemoveLayerGroup(this.map, layer);\n      } else {\n        layer.pm._fireRemove(layer);\n        layer.pm._fireRemove(this.map, layer);\n      }\n    }\n  },\n  _isRelevantForRemoval(layer) {\n    return (\n      layer.pm &&\n      !(layer instanceof L.LayerGroup) &&\n      ((!L.PM.optIn && !layer.options.pmIgnore) || // if optIn is not set / true and pmIgnore is not set / true (default)\n        (L.PM.optIn && layer.options.pmIgnore === false)) && // if optIn is true and pmIgnore is false\n      !layer._pmTempLayer &&\n      layer.pm.options.allowRemoval\n    );\n  },\n  handleLayerAdditionInGlobalRemovalMode() {\n    const layers = this._addedLayersRemoval;\n    this._addedLayersRemoval = {};\n    if (this.globalRemovalModeEnabled()) {\n      for (const id in layers) {\n        const layer = layers[id];\n        if (this._isRelevantForRemoval(layer)) {\n          if (layer.pm.enabled()) {\n            layer.pm.disable();\n          }\n          layer.on('click', this.removeLayer, this);\n        }\n      }\n    }\n  },\n  _layerAddedRemoval({ layer }) {\n    this._addedLayersRemoval[L.stamp(layer)] = layer;\n  },\n};\n\nexport default GlobalRemovalMode;\n", "const GlobalRotateMode = {\n  _globalRotateModeEnabled: false,\n  enableGlobalRotateMode() {\n    this._globalRotateModeEnabled = true;\n    const layers = L.PM.Utils.findLayers(this.map).filter(\n      (l) => l instanceof L.Polyline\n    );\n    layers.forEach((layer) => {\n      if (this._isRelevantForRotate(layer)) {\n        layer.pm.enableRotate();\n      }\n    });\n\n    if (!this.throttledReInitRotate) {\n      this.throttledReInitRotate = L.Util.throttle(\n        this.handleLayerAdditionInGlobalRotateMode,\n        100,\n        this\n      );\n    }\n\n    this._addedLayersRotate = {};\n    // handle layers that are added while in rotate mode\n    this.map.on('layeradd', this._layerAddedRotate, this);\n    this.map.on('layeradd', this.throttledReInitRotate, this);\n\n    // toogle the button in the toolbar if this is called programatically\n    this.Toolbar.toggleButton('rotateMode', this.globalRotateModeEnabled());\n    this._fireGlobalRotateModeToggled();\n  },\n  disableGlobalRotateMode() {\n    this._globalRotateModeEnabled = false;\n    const layers = L.PM.Utils.findLayers(this.map).filter(\n      (l) => l instanceof L.Polyline\n    );\n    layers.forEach((layer) => {\n      layer.pm.disableRotate();\n    });\n\n    // remove map handler\n    this.map.off('layeradd', this._layerAddedRotate, this);\n    this.map.off('layeradd', this.throttledReInitRotate, this);\n\n    // toogle the button in the toolbar if this is called programatically\n    this.Toolbar.toggleButton('rotateMode', this.globalRotateModeEnabled());\n    this._fireGlobalRotateModeToggled();\n  },\n  globalRotateModeEnabled() {\n    return !!this._globalRotateModeEnabled;\n  },\n  toggleGlobalRotateMode() {\n    if (this.globalRotateModeEnabled()) {\n      this.disableGlobalRotateMode();\n    } else {\n      this.enableGlobalRotateMode();\n    }\n  },\n  _isRelevantForRotate(layer) {\n    return (\n      layer.pm &&\n      layer instanceof L.Polyline &&\n      !(layer instanceof L.LayerGroup) &&\n      ((!L.PM.optIn && !layer.options.pmIgnore) || // if optIn is not set / true and pmIgnore is not set / true (default)\n        (L.PM.optIn && layer.options.pmIgnore === false)) && // if optIn is true and pmIgnore is false\n      !layer._pmTempLayer &&\n      layer.pm.options.allowRotation\n    );\n  },\n  handleLayerAdditionInGlobalRotateMode() {\n    const layers = this._addedLayersRotate;\n    this._addedLayersRotate = {};\n    if (this.globalRotateModeEnabled()) {\n      for (const id in layers) {\n        const layer = layers[id];\n        if (this._isRelevantForRemoval(layer)) {\n          layer.pm.enableRotate();\n        }\n      }\n    }\n  },\n  _layerAddedRotate({ layer }) {\n    this._addedLayersRotate[L.stamp(layer)] = layer;\n  },\n};\nexport default GlobalRotateMode;\n", "import merge from 'lodash/merge';\n\nconst EventMixin = {\n  // Draw Events\n  // Fired when enableDraw() is called -> draw start\n  _fireDrawStart(source = 'Draw', customPayload = {}) {\n    this.__fire(\n      this._map,\n      'pm:drawstart',\n      {\n        shape: this._shape,\n        workingLayer: this._layer,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when disableDraw() is called -> draw stop\n  _fireDrawEnd(source = 'Draw', customPayload = {}) {\n    this.__fire(\n      this._map,\n      'pm:drawend',\n      {\n        shape: this._shape,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when layer is created while drawing\n  _fireCreate(layer, source = 'Draw', customPayload = {}) {\n    this.__fire(\n      this._map,\n      'pm:create',\n      {\n        shape: this._shape,\n        marker: layer, // TODO: Deprecated\n        layer,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when Circle / CircleMarker center is placed\n  // if source == \"Draw\" then `workingLayer` is passed else `layer`\n  _fireCenterPlaced(source = 'Draw', customPayload = {}) {\n    const workingLayer = source === 'Draw' ? this._layer : undefined;\n    const layer = source !== 'Draw' ? this._layer : undefined;\n\n    this.__fire(\n      this._layer,\n      'pm:centerplaced',\n      {\n        shape: this._shape,\n        workingLayer,\n        layer,\n        latlng: this._layer.getLatLng(),\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when layer is cutted\n  // TODO: is Cut \"Draw\" or \"Edit\"? The event `pm:edit` in the same scope is called as source \"Edit\"\n  _fireCut(\n    fireLayer,\n    layer,\n    originalLayer,\n    source = 'Draw',\n    customPayload = {}\n  ) {\n    this.__fire(\n      fireLayer,\n      'pm:cut',\n      {\n        shape: this._shape,\n        layer,\n        originalLayer,\n      },\n      source,\n      customPayload\n    );\n  },\n\n  // Edit Events\n  // Fired when layer is edited / changed\n  _fireEdit(fireLayer = this._layer, source = 'Edit', customPayload = {}) {\n    this.__fire(\n      fireLayer,\n      'pm:edit',\n      { layer: this._layer, shape: this.getShape() },\n      source,\n      customPayload\n    );\n  },\n  // Fired when layer is enabled for editing\n  _fireEnable(source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:enable',\n      { layer: this._layer, shape: this.getShape() },\n      source,\n      customPayload\n    );\n  },\n  // Fired when layer is disabled for editing\n  _fireDisable(source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:disable',\n      { layer: this._layer, shape: this.getShape() },\n      source,\n      customPayload\n    );\n  },\n  // Fired when layer is disabled and was edited / changed\n  _fireUpdate(source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:update',\n      { layer: this._layer, shape: this.getShape() },\n      source,\n      customPayload\n    );\n  },\n  // Fired when a vertex-marker is started dragging\n  // indexPath is only passed from Line / Polygon\n  _fireMarkerDragStart(\n    e,\n    indexPath = undefined,\n    source = 'Edit',\n    customPayload = {}\n  ) {\n    this.__fire(\n      this._layer,\n      'pm:markerdragstart',\n      {\n        layer: this._layer,\n        markerEvent: e,\n        shape: this.getShape(),\n        indexPath,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired while dragging a vertex-marker\n  // indexPath is only passed from Line / Polygon\n  _fireMarkerDrag(\n    e,\n    indexPath = undefined,\n    source = 'Edit',\n    customPayload = {}\n  ) {\n    this.__fire(\n      this._layer,\n      'pm:markerdrag',\n      {\n        layer: this._layer,\n        markerEvent: e,\n        shape: this.getShape(),\n        indexPath,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when a vertex-marker is stopped dragging\n  // indexPath and intersectionReset is only passed from Line / Polygon\n  _fireMarkerDragEnd(\n    e,\n    indexPath = undefined,\n    intersectionReset = undefined,\n    source = 'Edit',\n    customPayload = {}\n  ) {\n    this.__fire(\n      this._layer,\n      'pm:markerdragend',\n      {\n        layer: this._layer,\n        markerEvent: e,\n        shape: this.getShape(),\n        indexPath,\n        intersectionReset,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when a layer is started dragging\n  _fireDragStart(source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:dragstart',\n      {\n        layer: this._layer,\n        shape: this.getShape(),\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired while dragging a layer\n  _fireDrag(e, source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:drag',\n      { ...e, shape: this.getShape() },\n      source,\n      customPayload\n    );\n  },\n  // Fired when a layer is stopped dragging\n  _fireDragEnd(source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:dragend',\n      {\n        layer: this._layer,\n        shape: this.getShape(),\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when layer is enabled for editing\n  _fireDragEnable(source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:dragenable',\n      { layer: this._layer, shape: this.getShape() },\n      source,\n      customPayload\n    );\n  },\n  // Fired when layer is disabled for editing\n  _fireDragDisable(source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:dragdisable',\n      { layer: this._layer, shape: this.getShape() },\n      source,\n      customPayload\n    );\n  },\n  // Fired when a layer is removed\n  _fireRemove(\n    fireLayer,\n    refLayer = fireLayer,\n    source = 'Edit',\n    customPayload = {}\n  ) {\n    this.__fire(\n      fireLayer,\n      'pm:remove',\n      { layer: refLayer, shape: this.getShape() },\n      source,\n      customPayload\n    );\n  },\n  // Fired when a vertex-marker is created\n  _fireVertexAdded(\n    marker,\n    indexPath,\n    latlng,\n    source = 'Edit',\n    customPayload = {}\n  ) {\n    this.__fire(\n      this._layer,\n      'pm:vertexadded',\n      {\n        layer: this._layer,\n        workingLayer: this._layer,\n        marker,\n        indexPath,\n        latlng,\n        shape: this.getShape(),\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when a vertex-marker is removed\n  _fireVertexRemoved(marker, indexPath, source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:vertexremoved',\n      {\n        layer: this._layer,\n        marker,\n        indexPath,\n        shape: this.getShape(),\n        // TODO: maybe add latlng as well?\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when a vertex-marker is clicked\n  _fireVertexClick(e, indexPath, source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:vertexclick',\n      {\n        layer: this._layer,\n        markerEvent: e,\n        indexPath,\n        shape: this.getShape(),\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when a Line / Polygon has self intersection\n  _fireIntersect(\n    intersection,\n    fireLayer = this._layer,\n    source = 'Edit',\n    customPayload = {}\n  ) {\n    this.__fire(\n      fireLayer,\n      'pm:intersect',\n      {\n        layer: this._layer,\n        intersection,\n        shape: this.getShape(),\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when coords of a layer are reset. E.g. by self-intersection\n  _fireLayerReset(e, indexPath, source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:layerreset',\n      {\n        layer: this._layer,\n        markerEvent: e,\n        indexPath,\n        shape: this.getShape(),\n      },\n      source,\n      customPayload\n    );\n  },\n\n  // Fired coordinates of the layer changed\n  _fireChange(latlngs, source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:change',\n      {\n        layer: this._layer,\n        latlngs,\n        shape: this.getShape(),\n      },\n      source,\n      customPayload\n    );\n  },\n\n  // Fired when text of a text layer changed\n  _fireTextChange(text, source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:textchange',\n      {\n        layer: this._layer,\n        text,\n        shape: this.getShape(),\n      },\n      source,\n      customPayload\n    );\n  },\n\n  // Fired when text layer focused\n  _fireTextFocus(source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:textfocus',\n      {\n        layer: this._layer,\n        shape: this.getShape(),\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when text layer blurred\n  _fireTextBlur(source = 'Edit', customPayload = {}) {\n    this.__fire(\n      this._layer,\n      'pm:textblur',\n      {\n        layer: this._layer,\n        shape: this.getShape(),\n      },\n      source,\n      customPayload\n    );\n  },\n\n  // Snapping Events\n  // Fired during a marker move/drag and other layers are existing\n  _fireSnapDrag(fireLayer, eventInfo, source = 'Snapping', customPayload = {}) {\n    this.__fire(fireLayer, 'pm:snapdrag', eventInfo, source, customPayload);\n  },\n  // Fired when a vertex is snapped\n  _fireSnap(fireLayer, eventInfo, source = 'Snapping', customPayload = {}) {\n    this.__fire(fireLayer, 'pm:snap', eventInfo, source, customPayload);\n  },\n  // Fired when a vertex is unsnapped\n  _fireUnsnap(fireLayer, eventInfo, source = 'Snapping', customPayload = {}) {\n    this.__fire(fireLayer, 'pm:unsnap', eventInfo, source, customPayload);\n  },\n\n  // Rotation Events\n  // Fired when rotation is enabled\n  _fireRotationEnable(\n    fireLayer,\n    helpLayer,\n    source = 'Rotation',\n    customPayload = {}\n  ) {\n    this.__fire(\n      fireLayer,\n      'pm:rotateenable',\n      {\n        layer: this._layer,\n        helpLayer: this._rotatePoly,\n        shape: this.getShape(),\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when rotation is disabled\n  _fireRotationDisable(fireLayer, source = 'Rotation', customPayload = {}) {\n    this.__fire(\n      fireLayer,\n      'pm:rotatedisable',\n      {\n        layer: this._layer,\n        shape: this.getShape(),\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when rotation starts\n  _fireRotationStart(\n    fireLayer,\n    originLatLngs,\n    source = 'Rotation',\n    customPayload = {}\n  ) {\n    this.__fire(\n      fireLayer,\n      'pm:rotatestart',\n      {\n        layer: this._rotationLayer,\n        helpLayer: this._layer,\n        startAngle: this._startAngle,\n        originLatLngs,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired while rotation\n  _fireRotation(\n    fireLayer,\n    angleDiff,\n    oldLatLngs,\n    rotationLayer = this._rotationLayer,\n    source = 'Rotation',\n    customPayload = {}\n  ) {\n    this.__fire(\n      fireLayer,\n      'pm:rotate',\n      {\n        layer: rotationLayer,\n        helpLayer: this._layer,\n        startAngle: this._startAngle,\n        angle: rotationLayer.pm.getAngle(),\n        angleDiff,\n        oldLatLngs,\n        newLatLngs: rotationLayer.getLatLngs(),\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when rotation ends\n  _fireRotationEnd(\n    fireLayer,\n    startAngle,\n    originLatLngs,\n    source = 'Rotation',\n    customPayload = {}\n  ) {\n    this.__fire(\n      fireLayer,\n      'pm:rotateend',\n      {\n        layer: this._rotationLayer,\n        helpLayer: this._layer,\n        startAngle,\n        angle: this._rotationLayer.pm.getAngle(),\n        originLatLngs,\n        newLatLngs: this._rotationLayer.getLatLngs(),\n      },\n      source,\n      customPayload\n    );\n  },\n\n  // Global Events\n  // Fired when a Toolbar action is clicked\n  _fireActionClick(\n    action,\n    btnName,\n    button,\n    source = 'Toolbar',\n    customPayload = {}\n  ) {\n    // this._map is used because this is fired from L.Controls (PMButton)\n    this.__fire(\n      this._map,\n      'pm:actionclick',\n      {\n        text: action.text,\n        action,\n        btnName,\n        button,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when a Toolbar button is clicked\n  _fireButtonClick(btnName, button, source = 'Toolbar', customPayload = {}) {\n    // this._map is used because this is fired from L.Controls (PMButton)\n    this.__fire(\n      this._map,\n      'pm:buttonclick',\n      { btnName, button },\n      source,\n      customPayload\n    );\n  },\n  // Fired when language is changed\n  _fireLangChange(\n    oldLang,\n    activeLang,\n    fallback,\n    translations,\n    source = 'Global',\n    customPayload = {}\n  ) {\n    this.__fire(\n      this.map,\n      'pm:langchange',\n      {\n        oldLang,\n        activeLang,\n        fallback,\n        translations,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when Drag Mode is toggled.\n  _fireGlobalDragModeToggled(enabled, source = 'Global', customPayload = {}) {\n    this.__fire(\n      this.map,\n      'pm:globaldragmodetoggled',\n      {\n        enabled,\n        map: this.map,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when Edit Mode is toggled.\n  _fireGlobalEditModeToggled(enabled, source = 'Global', customPayload = {}) {\n    this.__fire(\n      this.map,\n      'pm:globaleditmodetoggled',\n      {\n        enabled,\n        map: this.map,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when Removal Mode is toggled.\n  _fireGlobalRemovalModeToggled(\n    enabled,\n    source = 'Global',\n    customPayload = {}\n  ) {\n    this.__fire(\n      this.map,\n      'pm:globalremovalmodetoggled',\n      {\n        enabled,\n        map: this.map,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when Cut Mode is toggled.\n  _fireGlobalCutModeToggled(source = 'Global', customPayload = {}) {\n    this.__fire(\n      this._map,\n      'pm:globalcutmodetoggled',\n      {\n        enabled: !!this._enabled,\n        map: this._map,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when Draw Mode is toggled.\n  _fireGlobalDrawModeToggled(source = 'Global', customPayload = {}) {\n    this.__fire(\n      this._map,\n      'pm:globaldrawmodetoggled',\n      {\n        enabled: this._enabled,\n        shape: this._shape,\n        map: this._map,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when Rotation Mode is toggled.\n  _fireGlobalRotateModeToggled(source = 'Global', customPayload = {}) {\n    this.__fire(\n      this.map,\n      'pm:globalrotatemodetoggled',\n      {\n        enabled: this.globalRotateModeEnabled(),\n        map: this.map,\n      },\n      source,\n      customPayload\n    );\n  },\n  // Fired when LayerGroup is removed\n  _fireRemoveLayerGroup(\n    fireLayer,\n    refLayer = fireLayer,\n    source = 'Edit',\n    customPayload = {}\n  ) {\n    this.__fire(\n      fireLayer,\n      'pm:remove',\n      { layer: refLayer, shape: undefined },\n      source,\n      customPayload\n    );\n  },\n  // Fired when `keydown` or `keyup` on the document is fired.\n  _fireKeyeventEvent(\n    event,\n    eventType,\n    focusOn,\n    source = 'Global',\n    customPayload = {}\n  ) {\n    this.__fire(\n      this.map,\n      'pm:keyevent',\n      {\n        event,\n        eventType,\n        focusOn,\n      },\n      source,\n      customPayload\n    );\n  },\n\n  // private (very private) fire function\n  __fire(fireLayer, type, payload, source, customPayload = {}) {\n    payload = merge(payload, customPayload, { source });\n    L.PM.Utils._fireEvent(fireLayer, type, payload);\n  },\n};\n\nexport default EventMixin;\n", "// use function to create a new mixin object for keeping isolation\n// to make it work for multiple map instances\nconst createKeyboardMixins = () => ({\n  _lastEvents: { keydown: undefined, keyup: undefined, current: undefined },\n  _initKeyListener(map) {\n    this.map = map;\n    L.DomEvent.on(document, 'keydown keyup', this._onKeyListener, this);\n    L.DomEvent.on(window, 'blur', this._onBlur, this);\n    // clean up global listeners when current map instance is destroyed\n    map.once('unload', this._unbindKeyListenerEvents, this);\n  },\n  _handleEscapeKey(e) {\n    const pm = this.map.pm;\n    const globalOptions = pm.getGlobalOptions();\n\n    // Only handle Escape if the option is enabled\n    if (!globalOptions.exitModeOnEscape) {\n      return false;\n    }\n\n    // Check if any mode is active\n    const hasActiveMode =\n      pm.globalDrawModeEnabled() ||\n      pm.globalEditModeEnabled() ||\n      pm.globalDragModeEnabled() ||\n      pm.globalRemovalModeEnabled() ||\n      pm.globalRotateModeEnabled() ||\n      pm.globalCutModeEnabled();\n\n    if (!hasActiveMode) {\n      return false;\n    }\n\n    // Prevent default browser behavior (focus ring, etc.)\n    e.preventDefault();\n\n    // Disable all active modes\n    // 1. Disable draw mode if active\n    if (pm.globalDrawModeEnabled()) {\n      pm.disableDraw();\n    }\n\n    // 2. Disable global edit mode if active\n    if (pm.globalEditModeEnabled()) {\n      pm.disableGlobalEditMode();\n    }\n\n    // 3. Disable global drag mode if active\n    if (pm.globalDragModeEnabled()) {\n      pm.disableGlobalDragMode();\n    }\n\n    // 4. Disable global removal mode if active\n    if (pm.globalRemovalModeEnabled()) {\n      pm.disableGlobalRemovalMode();\n    }\n\n    // 5. Disable global rotate mode if active\n    if (pm.globalRotateModeEnabled()) {\n      pm.disableGlobalRotateMode();\n    }\n\n    // 6. Disable global cut mode if active\n    if (pm.globalCutModeEnabled()) {\n      pm.disableGlobalCutMode();\n    }\n\n    return true;\n  },\n  _handleEnterKey(e) {\n    const pm = this.map.pm;\n    const globalOptions = pm.getGlobalOptions();\n\n    // Only handle Enter if the option is enabled\n    if (!globalOptions.finishOnEnter) {\n      return false;\n    }\n\n    // Only handle Enter for draw mode\n    const activeShape = pm.Draw.getActiveShape();\n    if (!activeShape) {\n      return false;\n    }\n\n    // Get the active draw instance\n    const drawInstance = pm.Draw[activeShape];\n    if (!drawInstance || !drawInstance._finishShape) {\n      return false;\n    }\n\n    // Check if the shape can be finished (has enough vertices)\n    // For shapes that support _finishShape, try to finish\n    // The _finishShape method itself checks if there are enough vertices\n    const canFinish = this._canFinishShape(drawInstance, activeShape);\n    if (!canFinish) {\n      return false;\n    }\n\n    // Prevent default behavior\n    e.preventDefault();\n\n    // Finish the shape\n    drawInstance._finishShape();\n\n    return true;\n  },\n  _canFinishShape(drawInstance, activeShape) {\n    // Check if we can finish the current shape based on vertex count\n    // Different shapes have different minimum vertex requirements\n\n    // Shapes that don't support multi-vertex drawing\n    if (['Marker', 'CircleMarker', 'Text'].includes(activeShape)) {\n      return false;\n    }\n\n    // For Rectangle, check if drawing is in progress (has start point)\n    if (activeShape === 'Rectangle') {\n      return drawInstance._startMarker !== undefined;\n    }\n\n    // For Circle, check if center has been placed (added to layer group)\n    if (activeShape === 'Circle') {\n      return (\n        drawInstance._centerMarker &&\n        drawInstance._layerGroup?.hasLayer(drawInstance._centerMarker)\n      );\n    }\n\n    // For Line, Polygon, Cut - need to check vertex count\n    if (drawInstance._layer && drawInstance._layer.getLatLngs) {\n      const coords = drawInstance._layer.getLatLngs();\n\n      // Line needs at least 2 points (uses flat coords)\n      if (activeShape === 'Line') {\n        const flatCoords = coords.flat ? coords.flat() : coords;\n        return flatCoords.length >= 2;\n      }\n\n      // Polygon and Cut need at least 3 points\n      // Polygon's _finishShape checks coords.length directly (not flattened)\n      if (activeShape === 'Polygon' || activeShape === 'Cut') {\n        return coords.length >= 3;\n      }\n    }\n\n    return false;\n  },\n  _unbindKeyListenerEvents() {\n    L.DomEvent.off(document, 'keydown keyup', this._onKeyListener, this);\n    L.DomEvent.off(window, 'blur', this._onBlur, this);\n  },\n  _onKeyListener(e) {\n    let focusOn = 'document';\n\n    // .contains only supported since IE9, if you want to use Geoman with IE8 or lower you need to implement a polyfill for .contains\n    // with focusOn the user can add a check if the key was pressed while the user interacts with the map\n    if (this.map.getContainer().contains(e.target)) {\n      focusOn = 'map';\n    }\n\n    const data = { event: e, eventType: e.type, focusOn };\n    this._lastEvents[e.type] = data;\n    this._lastEvents.current = data;\n\n    this.map.pm._fireKeyeventEvent(e, e.type, focusOn);\n\n    // Handle special keys on keydown\n    if (e.type === 'keydown') {\n      // Handle Escape key to exit active modes\n      if (e.key === 'Escape') {\n        this._handleEscapeKey(e);\n      }\n      // Handle Enter key to finish drawing\n      if (e.key === 'Enter') {\n        this._handleEnterKey(e);\n      }\n    }\n  },\n  _onBlur(e) {\n    e.altKey = false;\n    const data = { event: e, eventType: e.type, focusOn: 'document' };\n    this._lastEvents[e.type] = data;\n    this._lastEvents.current = data;\n  },\n  getLastKeyEvent(type = 'current') {\n    return this._lastEvents[type];\n  },\n  isShiftKeyPressed() {\n    return this._lastEvents.current?.event.shiftKey;\n  },\n  isAltKeyPressed() {\n    return this._lastEvents.current?.event.altKey;\n  },\n  isCtrlKeyPressed() {\n    return this._lastEvents.current?.event.ctrlKey;\n  },\n  isMetaKeyPressed() {\n    return this._lastEvents.current?.event.metaKey;\n  },\n  getPressedKey() {\n    return this._lastEvents.current?.event.key;\n  },\n});\n\nexport default createKeyboardMixins;\n", "import get from 'lodash/get';\nimport translations from '../../assets/translations';\n\nexport function getTranslation(path) {\n  const lang = L.PM.activeLang;\n  // if translation is not found, fallback to english\n  return get(translations[lang], path) || get(translations.en, path) || path;\n}\n\nexport function hasFinePointer() {\n  // If matchMedia is unavailable (older browsers), assume desktop\n  if (!window.matchMedia) {\n    return true;\n  }\n  // Only treat as touch device if coarse pointer is explicitly detected.\n  // This handles headless browsers (like Cypress) where neither fine nor coarse may match.\n  const hasCoarse = window.matchMedia('(pointer: coarse)').matches;\n  if (hasCoarse) {\n    return false;\n  }\n  // Default to desktop behavior\n  return true;\n}\n\nexport function hasValues(list) {\n  for (let i = 0; i < list.length; i += 1) {\n    const item = list[i];\n\n    if (Array.isArray(item)) {\n      if (hasValues(item)) {\n        return true;\n      }\n    } else if (item !== null && item !== undefined && item !== '') {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function removeEmptyCoordRings(arr) {\n  return arr.reduce((result, item) => {\n    if (item.length !== 0) {\n      const newItem = Array.isArray(item) ? removeEmptyCoordRings(item) : item;\n      if (Array.isArray(newItem)) {\n        if (newItem.length !== 0) {\n          result.push(newItem);\n        }\n      } else {\n        result.push(newItem);\n      }\n    }\n    return result;\n  }, []);\n}\n\n// Code from https://stackoverflow.com/a/24153998/8283938\nfunction destinationVincenty(lonlat, brng, dist) {\n  // rewritten to work with leaflet\n  const VincentyConstants = {\n    a: L.CRS.Earth.R,\n    b: 6356752.3142,\n    f: 1 / 298.257223563,\n  };\n\n  const { a, b, f } = VincentyConstants;\n  const lon1 = lonlat.lng;\n  const lat1 = lonlat.lat;\n  const s = dist;\n  const pi = Math.PI;\n  const alpha1 = (brng * pi) / 180; // converts brng degrees to radius\n  const sinAlpha1 = Math.sin(alpha1);\n  const cosAlpha1 = Math.cos(alpha1);\n  const tanU1 =\n    (1 - f) * Math.tan((lat1 * pi) / 180 /* converts lat1 degrees to radius */);\n  const cosU1 = 1 / Math.sqrt(1 + tanU1 * tanU1);\n  const sinU1 = tanU1 * cosU1;\n  const sigma1 = Math.atan2(tanU1, cosAlpha1);\n  const sinAlpha = cosU1 * sinAlpha1;\n  const cosSqAlpha = 1 - sinAlpha * sinAlpha;\n  const uSq = (cosSqAlpha * (a * a - b * b)) / (b * b);\n  const A = 1 + (uSq / 16384) * (4096 + uSq * (-768 + uSq * (320 - 175 * uSq)));\n  const B = (uSq / 1024) * (256 + uSq * (-128 + uSq * (74 - 47 * uSq)));\n  let sigma = s / (b * A);\n  let sigmaP = 2 * Math.PI;\n\n  let cos2SigmaM;\n  let sinSigma;\n  let cosSigma;\n  while (Math.abs(sigma - sigmaP) > 1e-12) {\n    cos2SigmaM = Math.cos(2 * sigma1 + sigma);\n    sinSigma = Math.sin(sigma);\n    cosSigma = Math.cos(sigma);\n    const deltaSigma =\n      B *\n      sinSigma *\n      (cos2SigmaM +\n        (B / 4) *\n          (cosSigma * (-1 + 2 * cos2SigmaM * cos2SigmaM) -\n            (B / 6) *\n              cos2SigmaM *\n              (-3 + 4 * sinSigma * sinSigma) *\n              (-3 + 4 * cos2SigmaM * cos2SigmaM)));\n    sigmaP = sigma;\n    sigma = s / (b * A) + deltaSigma;\n  }\n  const tmp = sinU1 * sinSigma - cosU1 * cosSigma * cosAlpha1;\n  const lat2 = Math.atan2(\n    sinU1 * cosSigma + cosU1 * sinSigma * cosAlpha1,\n    (1 - f) * Math.sqrt(sinAlpha * sinAlpha + tmp * tmp)\n  );\n  const lambda = Math.atan2(\n    sinSigma * sinAlpha1,\n    cosU1 * cosSigma - sinU1 * sinSigma * cosAlpha1\n  );\n  const C = (f / 16) * cosSqAlpha * (4 + f * (4 - 3 * cosSqAlpha));\n  const lam =\n    lambda -\n    (1 - C) *\n      f *\n      sinAlpha *\n      (sigma +\n        C *\n          sinSigma *\n          (cos2SigmaM + C * cosSigma * (-1 + 2 * cos2SigmaM * cos2SigmaM)));\n  // const revAz = Math.atan2(sinAlpha, -tmp);  // final bearing\n  const lamFunc = lon1 + (lam * 180) / pi; // converts lam radius to degrees\n  const lat2a = (lat2 * 180) / pi; // converts lat2a radius to degrees\n\n  return L.latLng(lamFunc, lat2a);\n}\n\nexport function createGeodesicPolygon(\n  origin,\n  radius,\n  sides,\n  rotation,\n  withBearing = true\n) {\n  let trueAngle;\n  let newLonlat;\n  let geomPoint;\n  const points = [];\n\n  for (let i = 0; i < sides; i += 1) {\n    if (withBearing) {\n      trueAngle = (i * 360) / sides + rotation;\n      newLonlat = destinationVincenty(origin, trueAngle, radius);\n      geomPoint = L.latLng(newLonlat.lng, newLonlat.lat);\n    } else {\n      const pLat = origin.lat + Math.cos((2 * i * Math.PI) / sides) * radius;\n      const pLng = origin.lng + Math.sin((2 * i * Math.PI) / sides) * radius;\n      geomPoint = L.latLng(pLat, pLng);\n    }\n    points.push(geomPoint);\n  }\n\n  return points;\n}\n\n/* Copied from L.GeometryUtil */\nfunction destination(latlng, heading, distance) {\n  heading = (heading + 360) % 360;\n  const rad = Math.PI / 180;\n  const radInv = 180 / Math.PI;\n  const { R } = L.CRS.Earth; // approximation of Earth's radius\n  const lon1 = latlng.lng * rad;\n  const lat1 = latlng.lat * rad;\n  const rheading = heading * rad;\n  const sinLat1 = Math.sin(lat1);\n  const cosLat1 = Math.cos(lat1);\n  const cosDistR = Math.cos(distance / R);\n  const sinDistR = Math.sin(distance / R);\n  const lat2 = Math.asin(\n    sinLat1 * cosDistR + cosLat1 * sinDistR * Math.cos(rheading)\n  );\n  let lon2 =\n    lon1 +\n    Math.atan2(\n      Math.sin(rheading) * sinDistR * cosLat1,\n      cosDistR - sinLat1 * Math.sin(lat2)\n    );\n  lon2 *= radInv;\n\n  const optA = lon2 - 360;\n  const optB = lon2 < -180 ? lon2 + 360 : lon2;\n\n  lon2 = lon2 > 180 ? optA : optB;\n  return L.latLng([lat2 * radInv, lon2]);\n}\n/* Copied from L.GeometryUtil */\nexport function calcAngle(map, latlngA, latlngB) {\n  const pointA = map.latLngToContainerPoint(latlngA);\n  const pointB = map.latLngToContainerPoint(latlngB);\n  let angleDeg =\n    (Math.atan2(pointB.y - pointA.y, pointB.x - pointA.x) * 180) / Math.PI + 90;\n  angleDeg += angleDeg < 0 ? 360 : 0;\n  return angleDeg;\n}\n\nexport function destinationOnLine(map, latlngA, latlngB, distance) {\n  const angleDeg = calcAngle(map, latlngA, latlngB);\n  return destination(latlngA, angleDeg, distance);\n}\n\n// this function is used with the .sort(prioritiseSort(key, sortingOrder)) function of arrays\nexport function prioritiseSort(key, _sortingOrder, order = 'asc') {\n  /* the sorting order has all possible keys (lowercase) with the index and then it is sorted by the key on the object */\n\n  if (!_sortingOrder || Object.keys(_sortingOrder).length === 0) {\n    return (a, b) => a - b; // default sort method\n  }\n\n  // change the keys to lowercase\n  const keys = Object.keys(_sortingOrder);\n  let objKey;\n  let n = keys.length - 1;\n  const sortingOrder = {};\n  while (n >= 0) {\n    objKey = keys[n];\n    sortingOrder[objKey.toLowerCase()] = _sortingOrder[objKey];\n    n -= 1;\n  }\n\n  function getShape(layer) {\n    if (layer instanceof L.Marker) {\n      return 'Marker';\n    }\n    if (layer instanceof L.Circle) {\n      return 'Circle';\n    }\n    if (layer instanceof L.CircleMarker) {\n      return 'CircleMarker';\n    }\n    if (layer instanceof L.Rectangle) {\n      return 'Rectangle';\n    }\n    if (layer instanceof L.Polygon) {\n      return 'Polygon';\n    }\n    if (layer instanceof L.Polyline) {\n      return 'Line';\n    }\n    return undefined;\n  }\n\n  return (a, b) => {\n    let keyA;\n    let keyB;\n    if (key === 'instanceofShape') {\n      keyA = getShape(a.layer).toLowerCase();\n      keyB = getShape(b.layer).toLowerCase();\n      if (!keyA || !keyB) return 0;\n    } else {\n      if (!a.hasOwnProperty(key) || !b.hasOwnProperty(key)) return 0;\n      keyA = a[key].toLowerCase();\n      keyB = b[key].toLowerCase();\n    }\n\n    const first =\n      keyA in sortingOrder ? sortingOrder[keyA] : Number.MAX_SAFE_INTEGER;\n\n    const second =\n      keyB in sortingOrder ? sortingOrder[keyB] : Number.MAX_SAFE_INTEGER;\n\n    let result = 0;\n    if (first < second) result = -1;\n    else if (first > second) result = 1;\n    return order === 'desc' ? result * -1 : result;\n  };\n}\n\nexport function copyLatLngs(layer, latlngs = layer.getLatLngs()) {\n  if (layer instanceof L.Polygon) {\n    return L.polygon(latlngs).getLatLngs();\n  }\n  return L.polyline(latlngs).getLatLngs();\n}\n\n// Replaces the lat value with the MAX_LATITUDE of CRS if it is lower / higher\nexport function fixLatOffset(latlng, map) {\n  if (map.options.crs?.projection?.MAX_LATITUDE) {\n    const max = map.options.crs?.projection?.MAX_LATITUDE;\n    latlng.lat = Math.max(Math.min(max, latlng.lat), -max);\n  }\n  return latlng;\n}\n\nexport function getRenderer(layer) {\n  return (\n    layer.options.renderer ||\n    (layer._map &&\n      (layer._map._getPaneRenderer(layer.options.pane) ||\n        layer._map.options.renderer ||\n        layer._map._renderer)) ||\n    layer._renderer\n  );\n}\n", "/**\n * Resolves a language code to a translation key.\n *\n * This function handles:\n * - Exact matches (e.g., 'en', 'de', 'pt_br')\n * - ISO 639-1 (2-letter) codes (e.g., 'en', 'fr')\n * - ISO 639-3 (3-letter) codes (e.g., 'jam', 'yue')\n * - Locale formats (e.g., 'pt-BR', 'zh_TW', 'en-US')\n *\n * @param {string} lang - The language code to resolve\n * @param {Object} availableTranslations - Object with available translation keys\n * @returns {string} - The resolved language key\n */\nexport function resolveLanguageCode(lang, availableTranslations) {\n  // Normalize the language code to lowercase and trim any whitespace\n  lang = lang.trim().toLowerCase();\n\n  // First, check if the exact language code exists in translations\n  // This handles both 2-letter (ISO 639-1) and 3-letter (ISO 639-3) codes\n  if (availableTranslations[lang]) {\n    return lang;\n  }\n\n  // Handle formats like 'fr-FR', 'fr-fr', 'fr_FR', 'pt_BR', etc.\n  const normalizedLang = lang.replace(/[-_\\s]/g, '_');\n  // Match language codes: 2-3 letter primary tag, optionally followed by separator and 2-3 letter region\n  const match = normalizedLang.match(/^([a-z]{2,3})(?:_([a-z]{2,3}))?$/);\n\n  if (match) {\n    // Construct potential keys to search for in the translations object\n    const potentialKeys = [];\n    if (match[2]) {\n      potentialKeys.push(`${match[1]}_${match[2]}`); // e.g., 'pt_br'\n    }\n    potentialKeys.push(match[1]); // e.g., 'pt'\n\n    // Search through the translations object for a matching key\n    for (const key of potentialKeys) {\n      if (availableTranslations[key]) {\n        return key;\n      }\n    }\n  }\n\n  // If no match found, return original lang (will use fallback mechanism or custom translation)\n  return lang;\n}\n\n/**\n * Parses a language code into its components.\n *\n * @param {string} lang - The language code to parse\n * @returns {{ primary: string, region: string | null } | null} - Parsed components or null if invalid\n */\nexport function parseLanguageCode(lang) {\n  if (!lang || typeof lang !== 'string') {\n    return null;\n  }\n\n  const normalized = lang\n    .trim()\n    .toLowerCase()\n    .replace(/[-_\\s]/g, '_');\n  const match = normalized.match(/^([a-z]{2,3})(?:_([a-z]{2,3}))?$/);\n\n  if (!match) {\n    return null;\n  }\n\n  return {\n    primary: match[1],\n    region: match[2] || null,\n  };\n}\n\n/**\n * Validates if a string is a valid language code format.\n *\n * @param {string} lang - The language code to validate\n * @returns {boolean} - True if valid format\n */\nexport function isValidLanguageCode(lang) {\n  if (!lang || typeof lang !== 'string') {\n    return false;\n  }\n\n  const normalized = lang\n    .trim()\n    .toLowerCase()\n    .replace(/[-_\\s]/g, '_');\n  return /^[a-z]{2,3}(_[a-z]{2,3})?$/.test(normalized);\n}\n", "import { getTranslation } from '../helpers';\nimport EventMixin from '../Mixins/Events';\n\nconst PMButton = L.Control.extend({\n  includes: [EventMixin],\n  options: {\n    position: 'topleft',\n    disableByOtherButtons: true,\n  },\n  // TODO: clean up variable names like _button should be _options and that domNodeVariable stuff\n  initialize(options) {\n    // replaced setOptions with this because classNames returned undefined \uD83E\uDD14\n    this._button = L.Util.extend({}, this.options, options);\n  },\n  onAdd(map) {\n    this._map = map;\n    if (!this._map.pm.Toolbar.options.oneBlock) {\n      if (this._button.tool === 'edit') {\n        this._container = this._map.pm.Toolbar.editContainer;\n      } else if (this._button.tool === 'options') {\n        this._container = this._map.pm.Toolbar.optionsContainer;\n      } else if (this._button.tool === 'custom') {\n        this._container = this._map.pm.Toolbar.customContainer;\n      } else {\n        this._container = this._map.pm.Toolbar.drawContainer;\n      }\n    } else {\n      this._container = this._map.pm.Toolbar._createContainer(\n        this.options.position\n      );\n    }\n    this._renderButton();\n\n    return this._container;\n  },\n  _renderButton() {\n    const oldDomNode = this.buttonsDomNode;\n    this.buttonsDomNode = this._makeButton(this._button);\n    if (oldDomNode) {\n      oldDomNode.replaceWith(this.buttonsDomNode);\n    } else {\n      this._container.appendChild(this.buttonsDomNode);\n    }\n  },\n  onRemove() {\n    this.buttonsDomNode.remove();\n\n    return this._container;\n  },\n  getText() {\n    return this._button.text;\n  },\n  getIconUrl() {\n    return this._button.iconUrl;\n  },\n  destroy() {\n    this._button = {};\n    this._update();\n  },\n  toggle(e) {\n    if (typeof e === 'boolean') {\n      this._button.toggleStatus = e;\n    } else {\n      this._button.toggleStatus = !this._button.toggleStatus;\n    }\n    this._applyStyleClasses();\n    this._updateActiveAction(this._button);\n\n    return this._button.toggleStatus;\n  },\n  toggled() {\n    return this._button.toggleStatus;\n  },\n  onCreate() {\n    this.toggle(false);\n  },\n  disable() {\n    this.toggle(false); // is needed to prevent active button disabled\n    this._button.disabled = true;\n    this._updateDisabled();\n  },\n  enable() {\n    this._button.disabled = false;\n    this._updateDisabled();\n    this._updateActiveAction(this._button);\n  },\n  _triggerClick(e) {\n    if (e) {\n      // is needed to prevent scrolling when clicking on a-element with href=\"a\"\n      e.preventDefault();\n    }\n    if (this._button.disabled) {\n      return;\n    }\n    // TODO is this a big change when we change from e to a object with the event and the button? Now it's the second argument\n    this._button.onClick(e, { button: this, event: e });\n    this._clicked(e);\n    this._button.afterClick(e, { button: this, event: e });\n  },\n  _makeButton(button) {\n    const pos = this.options.position.indexOf('right') > -1 ? 'pos-right' : '';\n\n    // button container\n    const buttonContainer = L.DomUtil.create(\n      'div',\n      `button-container  ${pos}`,\n      this._container\n    );\n\n    if (button.title) {\n      buttonContainer.setAttribute('title', button.title);\n    }\n\n    // the button itself\n    const newButton = L.DomUtil.create(\n      'a',\n      'leaflet-buttons-control-button',\n      buttonContainer\n    );\n    newButton.setAttribute('role', 'button');\n    newButton.setAttribute('tabindex', '0');\n    newButton.href = '#';\n\n    // the buttons actions\n    const actionContainer = L.DomUtil.create(\n      'div',\n      `leaflet-pm-actions-container ${pos}`,\n      buttonContainer\n    );\n\n    const activeActions = button.actions;\n\n    const actions = {\n      cancel: {\n        text: getTranslation('actions.cancel'),\n        title: getTranslation('actions.cancel'),\n        onClick() {\n          this._triggerClick();\n        },\n      },\n      finishMode: {\n        text: getTranslation('actions.finish'),\n        title: getTranslation('actions.finish'),\n        onClick() {\n          this._triggerClick();\n        },\n      },\n      removeLastVertex: {\n        text: getTranslation('actions.removeLastVertex'),\n        title: getTranslation('actions.removeLastVertex'),\n        onClick() {\n          this._map.pm.Draw[button.jsClass]._removeLastVertex();\n        },\n      },\n      finish: {\n        text: getTranslation('actions.finish'),\n        title: getTranslation('actions.finish'),\n        onClick(e) {\n          this._map.pm.Draw[button.jsClass]._finishShape(e);\n        },\n      },\n    };\n\n    button._preparedActions = activeActions.map((_action) => {\n      const name = typeof _action === 'string' ? _action : _action.name;\n      let action;\n      if (actions[name]) {\n        action = actions[name];\n      } else if (_action.text) {\n        action = _action;\n      } else {\n        return action;\n      }\n      const actionNode = L.DomUtil.create(\n        'a',\n        `leaflet-pm-action ${pos} action-${name}`,\n        actionContainer\n      );\n      actionNode.setAttribute('role', 'button');\n      actionNode.setAttribute('tabindex', '0');\n      actionNode.href = '#';\n\n      if (action.title) {\n        actionNode.title = action.title;\n      }\n\n      actionNode.innerHTML = action.text;\n\n      L.DomEvent.disableClickPropagation(actionNode);\n      L.DomEvent.on(actionNode, 'click', L.DomEvent.stop);\n\n      action._node = actionNode;\n\n      if (!button.disabled) {\n        if (action.onClick) {\n          const actionClick = (e) => {\n            // is needed to prevent scrolling when clicking on a-element with href=\"a\"\n            e.preventDefault();\n            let btnName = '';\n            const { buttons } = this._map.pm.Toolbar;\n            for (const btn in buttons) {\n              if (buttons[btn]._button === button) {\n                btnName = btn;\n                break;\n              }\n            }\n            this._fireActionClick(action, btnName, button);\n          };\n\n          L.DomEvent.addListener(actionNode, 'click', actionClick, this);\n          L.DomEvent.addListener(actionNode, 'click', action.onClick, this);\n          L.DomEvent.addListener(actionNode, 'click', () =>\n            this._updateActiveAction(button)\n          );\n        }\n      }\n      return action;\n    });\n    this._updateActiveAction(button);\n\n    if (button.toggleStatus) {\n      L.DomUtil.addClass(buttonContainer, 'active');\n    }\n\n    const image = L.DomUtil.create('div', 'control-icon', newButton);\n\n    if (button.iconUrl) {\n      image.setAttribute('src', button.iconUrl);\n    }\n    if (button.className) {\n      L.DomUtil.addClass(image, button.className);\n    }\n\n    L.DomEvent.disableClickPropagation(newButton);\n    L.DomEvent.on(newButton, 'click', L.DomEvent.stop);\n\n    if (!button.disabled) {\n      // before the actual click, trigger a click on currently toggled buttons to\n      // untoggle them and their functionality\n      L.DomEvent.addListener(newButton, 'click', this._onBtnClick, this);\n      L.DomEvent.addListener(newButton, 'click', this._triggerClick, this);\n    }\n\n    if (button.disabled) {\n      L.DomUtil.addClass(newButton, 'pm-disabled');\n      newButton.setAttribute('aria-disabled', 'true');\n    }\n\n    return buttonContainer;\n  },\n\n  _applyStyleClasses() {\n    if (!this._container) {\n      return;\n    }\n\n    if (!this._button.toggleStatus || this._button.cssToggle === false) {\n      L.DomUtil.removeClass(this.buttonsDomNode, 'active');\n      L.DomUtil.removeClass(this._container, 'activeChild');\n    } else {\n      L.DomUtil.addClass(this.buttonsDomNode, 'active');\n      L.DomUtil.addClass(this._container, 'activeChild');\n    }\n  },\n\n  _onBtnClick() {\n    if (this._button.disabled) {\n      return;\n    }\n    if (this._button.disableOtherButtons) {\n      this._map.pm.Toolbar.triggerClickOnToggledButtons(this);\n    }\n    let btnName = '';\n    const { buttons } = this._map.pm.Toolbar;\n    for (const btn in buttons) {\n      if (buttons[btn]._button === this._button) {\n        btnName = btn;\n        break;\n      }\n    }\n    this._fireButtonClick(btnName, this._button);\n  },\n\n  _clicked() {\n    if (this._button.doToggle) {\n      this.toggle();\n    }\n  },\n\n  _updateDisabled() {\n    if (!this._container) {\n      return;\n    }\n\n    const className = 'pm-disabled';\n    const button = this.buttonsDomNode.children[0];\n\n    if (this._button.disabled) {\n      L.DomUtil.addClass(button, className);\n      button.setAttribute('aria-disabled', 'true');\n    } else {\n      L.DomUtil.removeClass(button, className);\n      button.setAttribute('aria-disabled', 'false');\n    }\n  },\n  _updateActiveAction(button) {\n    button._preparedActions?.forEach((action) => {\n      if (action?._node) {\n        if (action.isActive && action.isActive.call(this)) {\n          L.DomUtil.addClass(action._node, 'active-action');\n        } else {\n          L.DomUtil.removeClass(action._node, 'active-action');\n        }\n      }\n    });\n  },\n});\n\nexport default PMButton;\n", "import PMButton from './L.Controls';\n\nimport { getTranslation } from '../helpers';\n\nL.Control.PMButton = PMButton;\n\nconst Toolbar = L.Class.extend({\n  options: {\n    drawMarker: true,\n    drawRectangle: true,\n    drawPolyline: true,\n    drawPolygon: true,\n    drawCircle: true,\n    drawCircleMarker: true,\n    drawText: true,\n    editMode: true,\n    dragMode: true,\n    cutPolygon: true,\n    removalMode: true,\n    rotateMode: true,\n    snappingOption: true,\n    drawControls: true,\n    editControls: true,\n    optionsControls: true,\n    customControls: true,\n    oneBlock: false,\n    position: 'topleft',\n    positions: {\n      draw: '',\n      edit: '',\n      options: '',\n      custom: '',\n    },\n  },\n  customButtons: [],\n  initialize(map) {\n    // For some reason there is an reference between multiple maps instances\n    this.customButtons = [];\n    this.options.positions = {\n      draw: '',\n      edit: '',\n      options: '',\n      custom: '',\n    };\n\n    this.init(map);\n  },\n  reinit() {\n    const addControls = this.isVisible;\n\n    this.removeControls();\n    this._defineButtons();\n\n    if (addControls) {\n      this.addControls();\n    }\n  },\n  init(map) {\n    this.map = map;\n\n    this.buttons = {};\n    this.isVisible = false;\n    this.drawContainer = L.DomUtil.create(\n      'div',\n      'leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control'\n    );\n    this.editContainer = L.DomUtil.create(\n      'div',\n      'leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control'\n    );\n    this.optionsContainer = L.DomUtil.create(\n      'div',\n      'leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control'\n    );\n    this.customContainer = L.DomUtil.create(\n      'div',\n      'leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control'\n    );\n\n    this._defineButtons();\n  },\n  _createContainer(name) {\n    const container = `${name}Container`;\n    if (!this[container]) {\n      this[container] = L.DomUtil.create(\n        'div',\n        `leaflet-pm-toolbar leaflet-pm-${name} leaflet-bar leaflet-control`\n      );\n    }\n    return this[container];\n  },\n  getButtons() {\n    return this.buttons;\n  },\n\n  addControls(options = this.options) {\n    // adds all buttons to the map specified inside options\n\n    // make button renaming backwards compatible\n    if (typeof options.editPolygon !== 'undefined') {\n      options.editMode = options.editPolygon;\n    }\n    if (typeof options.deleteLayer !== 'undefined') {\n      options.removalMode = options.deleteLayer;\n    }\n\n    // first set the options\n    L.Util.setOptions(this, options);\n\n    this.applyIconStyle();\n\n    this.isVisible = true;\n    // now show the specified buttons\n    this._showHideButtons();\n  },\n  applyIconStyle() {\n    const buttons = this.getButtons();\n\n    const iconClasses = {\n      geomanIcons: {\n        drawMarker: 'control-icon leaflet-pm-icon-marker',\n        drawPolyline: 'control-icon leaflet-pm-icon-polyline',\n        drawRectangle: 'control-icon leaflet-pm-icon-rectangle',\n        drawPolygon: 'control-icon leaflet-pm-icon-polygon',\n        drawCircle: 'control-icon leaflet-pm-icon-circle',\n        drawCircleMarker: 'control-icon leaflet-pm-icon-circle-marker',\n        editMode: 'control-icon leaflet-pm-icon-edit',\n        dragMode: 'control-icon leaflet-pm-icon-drag',\n        cutPolygon: 'control-icon leaflet-pm-icon-cut',\n        removalMode: 'control-icon leaflet-pm-icon-delete',\n        drawText: 'control-icon leaflet-pm-icon-text',\n      },\n    };\n\n    for (const name in buttons) {\n      const button = buttons[name];\n\n      L.Util.setOptions(button, {\n        className: iconClasses.geomanIcons[name],\n      });\n    }\n  },\n  removeControls() {\n    // grab all buttons to loop through\n    const buttons = this.getButtons();\n\n    // remove all buttons\n    for (const btn in buttons) {\n      buttons[btn].remove();\n    }\n\n    this.isVisible = false;\n  },\n  deleteControl(name) {\n    const btnName = this._btnNameMapping(name);\n    if (this.buttons[btnName]) {\n      this.buttons[btnName].remove();\n      delete this.buttons[btnName];\n    }\n  },\n  toggleControls(options = this.options) {\n    if (this.isVisible) {\n      this.removeControls();\n    } else {\n      this.addControls(options);\n    }\n  },\n  _addButton(name, button) {\n    this.buttons[name] = button;\n    this.options[name] = !!this.options[name] || false;\n\n    return this.buttons[name];\n  },\n  triggerClickOnToggledButtons(exceptThisButton) {\n    // this function is used when - e.g. drawing mode is enabled and a possible\n    // other active mode (like removal tool) is already active.\n    // we can't have two active modes because of possible event conflicts\n    // so, we trigger a click on all currently active (toggled) buttons\n\n    for (const name in this.buttons) {\n      const button = this.buttons[name];\n      if (\n        button._button.disableByOtherButtons &&\n        button !== exceptThisButton &&\n        button.toggled()\n      ) {\n        button._triggerClick();\n      }\n    }\n  },\n  toggleButton(name, status, disableOthers = true) {\n    // does not fire the events/functionality of the button\n    // this just changes the state and is used if a functionality (like Draw)\n    // is enabled manually via script\n\n    // backwards compatibility with button rename\n    if (name === 'editPolygon') {\n      name = 'editMode';\n    }\n    if (name === 'deleteLayer') {\n      name = 'removalMode';\n    }\n\n    const toggleBtnName = name;\n\n    // as some mode got enabled, we still have to trigger the click on the other buttons\n    // to disable their mode\n    if (disableOthers) {\n      this.triggerClickOnToggledButtons(this.buttons[toggleBtnName]);\n    }\n\n    if (!this.buttons[toggleBtnName]) {\n      return false;\n    }\n    // now toggle the state of the button\n    return this.buttons[toggleBtnName].toggle(status);\n  },\n  _defineButtons() {\n    // some buttons are still in their respective classes, like L.PM.Draw.Polygon\n    const drawMarkerButton = {\n      className: 'control-icon leaflet-pm-icon-marker',\n      title: getTranslation('buttonTitles.drawMarkerButton'),\n      jsClass: 'Marker',\n      onClick: () => {},\n      afterClick: (e, ctx) => {\n        // toggle drawing mode\n        this.map.pm.Draw[ctx.button._button.jsClass].toggle();\n      },\n      doToggle: true,\n      toggleStatus: false,\n      disableOtherButtons: true,\n      position: this.options.position,\n      actions: ['cancel'],\n    };\n\n    const drawPolyButton = {\n      title: getTranslation('buttonTitles.drawPolyButton'),\n      className: 'control-icon leaflet-pm-icon-polygon',\n      jsClass: 'Polygon',\n      onClick: () => {},\n      afterClick: (e, ctx) => {\n        // toggle drawing mode\n        this.map.pm.Draw[ctx.button._button.jsClass].toggle();\n      },\n      doToggle: true,\n      toggleStatus: false,\n      disableOtherButtons: true,\n      position: this.options.position,\n      actions: ['finish', 'removeLastVertex', 'cancel'],\n    };\n\n    const drawLineButton = {\n      className: 'control-icon leaflet-pm-icon-polyline',\n      title: getTranslation('buttonTitles.drawLineButton'),\n      jsClass: 'Line',\n      onClick: () => {},\n      afterClick: (e, ctx) => {\n        // toggle drawing mode\n        this.map.pm.Draw[ctx.button._button.jsClass].toggle();\n      },\n      doToggle: true,\n      toggleStatus: false,\n      disableOtherButtons: true,\n      position: this.options.position,\n      actions: ['finish', 'removeLastVertex', 'cancel'],\n    };\n\n    const drawCircleButton = {\n      title: getTranslation('buttonTitles.drawCircleButton'),\n      className: 'control-icon leaflet-pm-icon-circle',\n      jsClass: 'Circle',\n      onClick: () => {},\n      afterClick: (e, ctx) => {\n        // toggle drawing mode\n        this.map.pm.Draw[ctx.button._button.jsClass].toggle();\n      },\n      doToggle: true,\n      toggleStatus: false,\n      disableOtherButtons: true,\n      position: this.options.position,\n      actions: ['cancel'],\n    };\n\n    const drawCircleMarkerButton = {\n      title: getTranslation('buttonTitles.drawCircleMarkerButton'),\n      className: 'control-icon leaflet-pm-icon-circle-marker',\n      jsClass: 'CircleMarker',\n      onClick: () => {},\n      afterClick: (e, ctx) => {\n        // toggle drawing mode\n        this.map.pm.Draw[ctx.button._button.jsClass].toggle();\n      },\n      doToggle: true,\n      toggleStatus: false,\n      disableOtherButtons: true,\n      position: this.options.position,\n      actions: ['cancel'],\n    };\n\n    const drawRectButton = {\n      title: getTranslation('buttonTitles.drawRectButton'),\n      className: 'control-icon leaflet-pm-icon-rectangle',\n      jsClass: 'Rectangle',\n      onClick: () => {},\n      afterClick: (e, ctx) => {\n        // toggle drawing mode\n        this.map.pm.Draw[ctx.button._button.jsClass].toggle();\n      },\n      doToggle: true,\n      toggleStatus: false,\n      disableOtherButtons: true,\n      position: this.options.position,\n      actions: ['cancel'],\n    };\n\n    const editButton = {\n      title: getTranslation('buttonTitles.editButton'),\n      className: 'control-icon leaflet-pm-icon-edit',\n      onClick: () => {},\n      afterClick: () => {\n        this.map.pm.toggleGlobalEditMode();\n      },\n      doToggle: true,\n      toggleStatus: false,\n      disableOtherButtons: true,\n      position: this.options.position,\n      tool: 'edit',\n      actions: ['finishMode'],\n    };\n\n    const dragButton = {\n      title: getTranslation('buttonTitles.dragButton'),\n      className: 'control-icon leaflet-pm-icon-drag',\n      onClick: () => {},\n      afterClick: () => {\n        this.map.pm.toggleGlobalDragMode();\n      },\n      doToggle: true,\n      toggleStatus: false,\n      disableOtherButtons: true,\n      position: this.options.position,\n      tool: 'edit',\n      actions: ['finishMode'],\n    };\n\n    const cutButton = {\n      title: getTranslation('buttonTitles.cutButton'),\n      className: 'control-icon leaflet-pm-icon-cut',\n      jsClass: 'Cut',\n      onClick: () => {},\n      afterClick: (e, ctx) => {\n        // enable polygon drawing mode without snap\n        this.map.pm.Draw[ctx.button._button.jsClass].toggle({\n          snappable: true,\n          cursorMarker: true,\n          allowSelfIntersection: false,\n        });\n      },\n      doToggle: true,\n      toggleStatus: false,\n      disableOtherButtons: true,\n      position: this.options.position,\n      tool: 'edit',\n      actions: ['finish', 'removeLastVertex', 'cancel'],\n    };\n\n    const deleteButton = {\n      title: getTranslation('buttonTitles.deleteButton'),\n      className: 'control-icon leaflet-pm-icon-delete',\n      onClick: () => {},\n      afterClick: () => {\n        this.map.pm.toggleGlobalRemovalMode();\n      },\n      doToggle: true,\n      toggleStatus: false,\n      disableOtherButtons: true,\n      position: this.options.position,\n      tool: 'edit',\n      actions: ['finishMode'],\n    };\n\n    const rotateButton = {\n      title: getTranslation('buttonTitles.rotateButton'),\n      className: 'control-icon leaflet-pm-icon-rotate',\n      onClick: () => {},\n      afterClick: () => {\n        this.map.pm.toggleGlobalRotateMode();\n      },\n      doToggle: true,\n      toggleStatus: false,\n      disableOtherButtons: true,\n      position: this.options.position,\n      tool: 'edit',\n      actions: ['finishMode'],\n    };\n\n    const drawTextButton = {\n      className: 'control-icon leaflet-pm-icon-text',\n      title: getTranslation('buttonTitles.drawTextButton'),\n      jsClass: 'Text',\n      onClick: () => {},\n      afterClick: (e, ctx) => {\n        // toggle drawing mode\n        this.map.pm.Draw[ctx.button._button.jsClass].toggle();\n      },\n      doToggle: true,\n      toggleStatus: false,\n      disableOtherButtons: true,\n      position: this.options.position,\n      actions: ['cancel'],\n    };\n\n    this._addButton('drawMarker', new L.Control.PMButton(drawMarkerButton));\n    this._addButton('drawPolyline', new L.Control.PMButton(drawLineButton));\n    this._addButton('drawRectangle', new L.Control.PMButton(drawRectButton));\n    this._addButton('drawPolygon', new L.Control.PMButton(drawPolyButton));\n    this._addButton('drawCircle', new L.Control.PMButton(drawCircleButton));\n    this._addButton(\n      'drawCircleMarker',\n      new L.Control.PMButton(drawCircleMarkerButton)\n    );\n    this._addButton('drawText', new L.Control.PMButton(drawTextButton));\n    this._addButton('editMode', new L.Control.PMButton(editButton));\n    this._addButton('dragMode', new L.Control.PMButton(dragButton));\n    this._addButton('cutPolygon', new L.Control.PMButton(cutButton));\n    this._addButton('removalMode', new L.Control.PMButton(deleteButton));\n    this._addButton('rotateMode', new L.Control.PMButton(rotateButton));\n  },\n\n  _showHideButtons() {\n    // if Toolbar is not visible, we don't need to update button positions\n    if (!this.isVisible) {\n      return;\n    }\n\n    // remove all buttons, that's because the Toolbar can be added again with\n    // different options so it's basically a reset and add again\n    this.removeControls();\n    // we need to set isVisible = true again, because removeControls() set it to false\n    this.isVisible = true;\n\n    const buttons = this.getButtons();\n    let ignoreBtns = [];\n\n    if (this.options.drawControls === false) {\n      ignoreBtns = ignoreBtns.concat(\n        Object.keys(buttons).filter((btn) => !buttons[btn]._button.tool)\n      );\n    }\n    if (this.options.editControls === false) {\n      ignoreBtns = ignoreBtns.concat(\n        Object.keys(buttons).filter(\n          (btn) => buttons[btn]._button.tool === 'edit'\n        )\n      );\n    }\n    if (this.options.optionsControls === false) {\n      ignoreBtns = ignoreBtns.concat(\n        Object.keys(buttons).filter(\n          (btn) => buttons[btn]._button.tool === 'options'\n        )\n      );\n    }\n    if (this.options.customControls === false) {\n      ignoreBtns = ignoreBtns.concat(\n        Object.keys(buttons).filter(\n          (btn) => buttons[btn]._button.tool === 'custom'\n        )\n      );\n    }\n\n    for (const btn in buttons) {\n      if (this.options[btn] && ignoreBtns.indexOf(btn) === -1) {\n        // if options say the button should be visible, add it to the map\n        let block = buttons[btn]._button.tool;\n        if (!block) {\n          // undefined is the draw block\n          block = 'draw';\n        }\n        buttons[btn].setPosition(this._getBtnPosition(block));\n        buttons[btn].addTo(this.map);\n      }\n    }\n  },\n  _getBtnPosition(block) {\n    return this.options.positions && this.options.positions[block]\n      ? this.options.positions[block]\n      : this.options.position;\n  },\n  setBlockPosition(block, position) {\n    this.options.positions[block] = position;\n    this._showHideButtons();\n    this.changeControlOrder();\n  },\n  getBlockPositions() {\n    return this.options.positions;\n  },\n  copyDrawControl(copyInstance, options) {\n    if (!options) {\n      throw new TypeError('Button has no name');\n    } else if (typeof options !== 'object') {\n      // if only the name is passed and no options object\n      options = { name: options };\n    }\n\n    const instance = this._btnNameMapping(copyInstance);\n\n    if (!options.name) {\n      throw new TypeError('Button has no name');\n    }\n\n    if (this.buttons[options.name]) {\n      throw new TypeError('Button with this name already exists');\n    }\n    const drawInstance = this.map.pm.Draw.createNewDrawInstance(\n      options.name,\n      instance\n    );\n\n    const btn = this.buttons[instance]._button;\n    options = { ...btn, ...options };\n    const control = this.createCustomControl(options);\n    return { drawInstance, control };\n  },\n  createCustomControl(options) {\n    if (!options.name) {\n      throw new TypeError('Button has no name');\n    }\n\n    if (this.buttons[options.name]) {\n      throw new TypeError('Button with this name already exists');\n    }\n    if (!options.onClick) {\n      options.onClick = () => {};\n    }\n    if (!options.afterClick) {\n      options.afterClick = () => {};\n    }\n    if (options.toggle !== false) {\n      options.toggle = true;\n    }\n\n    if (options.block) {\n      options.block = options.block.toLowerCase();\n    }\n    if (!options.block || options.block === 'draw') {\n      options.block = '';\n    }\n\n    if (!options.className) {\n      options.className = 'control-icon';\n    } else if (options.className.indexOf('control-icon') === -1) {\n      options.className = `control-icon ${options.className}`;\n    }\n\n    const _options = {\n      tool: options.block,\n      className: options.className,\n      title: options.title || '',\n      jsClass: options.name,\n      onClick: options.onClick,\n      afterClick: options.afterClick,\n      doToggle: options.toggle,\n      toggleStatus: false,\n      disableOtherButtons: options.disableOtherButtons ?? true,\n      disableByOtherButtons: options.disableByOtherButtons ?? true,\n      cssToggle: options.toggle,\n      position: this.options.position,\n      actions: options.actions || [],\n      disabled: !!options.disabled,\n    };\n\n    if (this.options[options.name] !== false) {\n      this.options[options.name] = true;\n    }\n\n    const control = this._addButton(\n      options.name,\n      new L.Control.PMButton(_options)\n    );\n    this.changeControlOrder();\n    return control;\n  },\n  controlExists(name) {\n    return Boolean(this.getButton(name));\n  },\n  getButton(name) {\n    return this.getButtons()[name];\n  },\n  getButtonsInBlock(name) {\n    const buttonsInBlock = {};\n    if (name) {\n      for (const buttonName in this.getButtons()) {\n        const button = this.getButtons()[buttonName];\n        // draw controls doesn't have a block\n        if (\n          button._button.tool === name ||\n          (name === 'draw' && !button._button.tool)\n        ) {\n          buttonsInBlock[buttonName] = button;\n        }\n      }\n    }\n    return buttonsInBlock;\n  },\n  changeControlOrder(order = []) {\n    const shapeMapping = this._shapeMapping();\n\n    const _order = [];\n    order.forEach((shape) => {\n      if (shapeMapping[shape]) {\n        _order.push(shapeMapping[shape]);\n      } else {\n        _order.push(shape);\n      }\n    });\n\n    const buttons = this.getButtons();\n\n    // This steps are needed to create a new Object which contains the buttons in the correct sorted order.\n    const newbtnorder = {};\n    _order.forEach((control) => {\n      if (buttons[control]) {\n        newbtnorder[control] = buttons[control];\n      }\n    });\n\n    const drawBtns = Object.keys(buttons).filter(\n      (btn) =>\n        !buttons[btn]._button.tool || buttons[btn]._button.tool === 'draw'\n    );\n    drawBtns.forEach((btn) => {\n      if (_order.indexOf(btn) === -1) {\n        newbtnorder[btn] = buttons[btn];\n      }\n    });\n    const editBtns = Object.keys(buttons).filter(\n      (btn) => buttons[btn]._button.tool === 'edit'\n    );\n    editBtns.forEach((btn) => {\n      if (_order.indexOf(btn) === -1) {\n        newbtnorder[btn] = buttons[btn];\n      }\n    });\n    const optionsBtns = Object.keys(buttons).filter(\n      (btn) => buttons[btn]._button.tool === 'options'\n    );\n    optionsBtns.forEach((btn) => {\n      if (_order.indexOf(btn) === -1) {\n        newbtnorder[btn] = buttons[btn];\n      }\n    });\n    const customBtns = Object.keys(buttons).filter(\n      (btn) => buttons[btn]._button.tool === 'custom'\n    );\n    customBtns.forEach((btn) => {\n      if (_order.indexOf(btn) === -1) {\n        newbtnorder[btn] = buttons[btn];\n      }\n    });\n    // To add all other buttons they are not in a container from above (maybe added manually by a developer)\n    Object.keys(buttons).forEach((btn) => {\n      if (_order.indexOf(btn) === -1) {\n        newbtnorder[btn] = buttons[btn];\n      }\n    });\n\n    this.map.pm.Toolbar.buttons = newbtnorder;\n    this._showHideButtons();\n  },\n  getControlOrder() {\n    const buttons = this.getButtons();\n    const order = [];\n    for (const btn in buttons) {\n      order.push(btn);\n    }\n    return order;\n  },\n  changeActionsOfControl(name, actions) {\n    const btnName = this._btnNameMapping(name);\n\n    if (!btnName) {\n      throw new TypeError('No name passed');\n    }\n    if (!actions) {\n      throw new TypeError('No actions passed');\n    }\n\n    if (!this.buttons[btnName]) {\n      throw new TypeError('Button with this name not exists');\n    }\n    this.buttons[btnName]._button.actions = actions;\n    this.changeControlOrder();\n  },\n  setButtonDisabled(name, state) {\n    const btnName = this._btnNameMapping(name);\n    if (state) {\n      this.buttons[btnName].disable();\n    } else {\n      this.buttons[btnName].enable();\n    }\n  },\n  _shapeMapping() {\n    return {\n      Marker: 'drawMarker',\n      Circle: 'drawCircle',\n      Polygon: 'drawPolygon',\n      Rectangle: 'drawRectangle',\n      Polyline: 'drawPolyline',\n      Line: 'drawPolyline',\n      CircleMarker: 'drawCircleMarker',\n      Edit: 'editMode',\n      Drag: 'dragMode',\n      Cut: 'cutPolygon',\n      Removal: 'removalMode',\n      Rotate: 'rotateMode',\n      Text: 'drawText',\n    };\n  },\n  _btnNameMapping(name) {\n    const shapeMapping = this._shapeMapping();\n    return shapeMapping[name] ? shapeMapping[name] : name;\n  },\n});\n\nexport default Toolbar;\n", "import merge from 'lodash/merge';\nimport SnapMixin from '../Mixins/Snapping';\nimport EventMixin from '../Mixins/Events';\n\nconst Draw = L.Class.extend({\n  includes: [SnapMixin, EventMixin],\n  options: {\n    snappable: true, // TODO: next major Release, rename it to allowSnapping\n    snapDistance: 20,\n    snapMiddle: false,\n    allowSelfIntersection: true,\n    tooltips: true,\n    templineStyle: {},\n    hintlineStyle: {\n      color: '#3388ff',\n      dashArray: '5,5',\n    },\n    pathOptions: null,\n    cursorMarker: true,\n    finishOn: null,\n    markerStyle: {\n      draggable: true,\n      icon: L.icon(),\n    },\n    hideMiddleMarkers: false,\n    minRadiusCircle: null,\n    maxRadiusCircle: null,\n    minRadiusCircleMarker: null,\n    maxRadiusCircleMarker: null,\n    resizeableCircleMarker: false,\n    resizeableCircle: true,\n    markerEditable: true,\n    continueDrawing: false,\n    snapSegment: true,\n    requireSnapToFinish: false,\n    rectangleAngle: 0,\n    textOptions: {\n      text: null,\n      focusAfterDraw: null,\n      removeIfEmpty: null,\n      className: null,\n    },\n    snapVertex: true,\n  },\n  setOptions(options) {\n    L.Util.setOptions(this, options);\n    this.setStyle(this.options);\n  },\n  setStyle() {},\n  getOptions() {\n    return this.options;\n  },\n  initialize(map) {\n    // Overwriting the default tooltipAnchor of the default Marker Icon, because the tooltip functionality was updated but not the anchor in the Icon\n    // Issue https://github.com/Leaflet/Leaflet/issues/7302 - Leaflet v1.7.1\n    const defaultIcon = new L.Icon.Default();\n    defaultIcon.options.tooltipAnchor = [0, 0];\n    this.options.markerStyle.icon = defaultIcon;\n\n    // save the map\n    this._map = map;\n\n    // define all possible shapes that can be drawn\n    this.shapes = [\n      'Marker',\n      'CircleMarker',\n      'Line',\n      'Polygon',\n      'Rectangle',\n      'Circle',\n      'Cut',\n      'Text',\n    ];\n\n    // initiate drawing class for our shapes\n    this.shapes.forEach((shape) => {\n      this[shape] = new L.PM.Draw[shape](this._map);\n    });\n\n    // TODO: Remove this with the next major release\n    this.Marker.setOptions({ continueDrawing: true });\n    this.CircleMarker.setOptions({ continueDrawing: true });\n  },\n  setPathOptions(options, mergeOptions = false) {\n    if (!mergeOptions) {\n      this.options.pathOptions = options;\n    } else {\n      this.options.pathOptions = merge(this.options.pathOptions, options);\n    }\n  },\n  getShapes() {\n    // if somebody wants to know what shapes are available\n    return this.shapes;\n  },\n  getShape() {\n    // return the shape of the current drawing layer\n    return this._shape;\n  },\n  enable(shape, options) {\n    if (!shape) {\n      throw new Error(\n        `Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(\n          ','\n        )}`\n      );\n    }\n\n    // disable drawing for all shapes\n    this.disable();\n\n    // enable draw for a shape\n    this[shape].enable(options);\n  },\n  disable() {\n    // there can only be one drawing mode active at a time on a map\n    // so it doesn't matter which one should be disabled.\n    // just disable all of them\n    this.shapes.forEach((shape) => {\n      this[shape].disable();\n    });\n  },\n  addControls() {\n    // add control buttons for our shapes\n    this.shapes.forEach((shape) => {\n      this[shape].addButton();\n    });\n  },\n  getActiveShape() {\n    // returns the active shape\n    let enabledShape;\n    this.shapes.forEach((shape) => {\n      if (this[shape]._enabled) {\n        enabledShape = shape;\n      }\n    });\n    return enabledShape;\n  },\n  _setGlobalDrawMode() {\n    // extended to all PM.Draw shapes\n    if (this._shape === 'Cut') {\n      this._fireGlobalCutModeToggled();\n    } else {\n      this._fireGlobalDrawModeToggled();\n    }\n\n    const layers = [];\n    this._map.eachLayer((layer) => {\n      if (\n        layer instanceof L.Polyline ||\n        layer instanceof L.Marker ||\n        layer instanceof L.Circle ||\n        layer instanceof L.CircleMarker ||\n        layer instanceof L.ImageOverlay\n      ) {\n        // filter out everything that's leaflet-geoman specific temporary stuff\n        if (!layer._pmTempLayer) {\n          layers.push(layer);\n        }\n      }\n    });\n\n    if (this._enabled) {\n      layers.forEach((layer) => {\n        L.PM.Utils.disablePopup(layer);\n      });\n    } else {\n      layers.forEach((layer) => {\n        L.PM.Utils.enablePopup(layer);\n      });\n    }\n  },\n\n  createNewDrawInstance(name, jsClass) {\n    const instance = this._getShapeFromBtnName(jsClass);\n    if (this[name]) {\n      throw new TypeError('Draw Type already exists');\n    }\n    if (!L.PM.Draw[instance]) {\n      throw new TypeError(`There is no class L.PM.Draw.${instance}`);\n    }\n\n    this[name] = new L.PM.Draw[instance](this._map);\n    this[name].toolbarButtonName = name;\n    this[name]._shape = name;\n    this.shapes.push(name);\n\n    // needed when extended / copied from a custom instance\n    if (this[jsClass]) {\n      this[name].setOptions(this[jsClass].options);\n    }\n    // Re-init the options, so it is not referenced with the default Draw class\n    this[name].setOptions(this[name].options);\n\n    return this[name];\n  },\n  _getShapeFromBtnName(name) {\n    const shapeMapping = {\n      drawMarker: 'Marker',\n      drawCircle: 'Circle',\n      drawPolygon: 'Polygon',\n      drawPolyline: 'Line',\n      drawRectangle: 'Rectangle',\n      drawCircleMarker: 'CircleMarker',\n      editMode: 'Edit',\n      dragMode: 'Drag',\n      cutPolygon: 'Cut',\n      removalMode: 'Removal',\n      rotateMode: 'Rotate',\n      drawText: 'Text',\n    };\n\n    if (shapeMapping[name]) {\n      return shapeMapping[name];\n    }\n    return this[name] ? this[name]._shape : name;\n  },\n  _finishLayer(layer) {\n    if (layer.pm) {\n      // add the pm options from drawing to the new layer (edit)\n      layer.pm.setOptions(this.options);\n      // set the shape (can be a custom shape)\n      layer.pm._shape = this._shape;\n      // apply the map to the new created layer in the pm object\n      layer.pm._map = this._map;\n    }\n    this._addDrawnLayerProp(layer);\n  },\n  _addDrawnLayerProp(layer) {\n    layer._drawnByGeoman = true;\n  },\n  _setPane(layer, type) {\n    if (type === 'layerPane') {\n      layer.options.pane =\n        (this._map.pm.globalOptions.panes &&\n          this._map.pm.globalOptions.panes.layerPane) ||\n        'overlayPane';\n    } else if (type === 'vertexPane') {\n      layer.options.pane =\n        (this._map.pm.globalOptions.panes &&\n          this._map.pm.globalOptions.panes.vertexPane) ||\n        'markerPane';\n    } else if (type === 'markerPane') {\n      layer.options.pane =\n        (this._map.pm.globalOptions.panes &&\n          this._map.pm.globalOptions.panes.markerPane) ||\n        'markerPane';\n    }\n  },\n  _isFirstLayer() {\n    const map = this._map || this._layer._map;\n    return map.pm.getGeomanLayers().length === 0;\n  },\n});\n\nexport default Draw;\n", "import { hasValues, prioritiseSort } from '../helpers';\n\nconst SnapMixin = {\n  _initSnappableMarkers() {\n    this.options.snapDistance = this.options.snapDistance || 30;\n    this.options.snapSegment =\n      this.options.snapSegment === undefined ? true : this.options.snapSegment;\n\n    this._assignEvents(this._markers);\n\n    this._layer.off('pm:dragstart', this._unsnap, this);\n    this._layer.on('pm:dragstart', this._unsnap, this);\n  },\n  _disableSnapping() {\n    this._layer.off('pm:dragstart', this._unsnap, this);\n  },\n  _assignEvents(markerArr) {\n    // loop through marker array and assign events to the markers\n    markerArr.forEach((marker) => {\n      // if the marker is another array (Multipolygon stuff), recursively do this again\n      if (Array.isArray(marker)) {\n        this._assignEvents(marker);\n        return;\n      }\n\n      // add handleSnapping event on drag\n      marker.off('drag', this._handleSnapping, this);\n      marker.on('drag', this._handleSnapping, this);\n\n      // cleanup event on dragend\n      marker.off('dragend', this._cleanupSnapping, this);\n      marker.on('dragend', this._cleanupSnapping, this);\n    });\n  },\n  _cleanupSnapping(e) {\n    if (e) {\n      // reset snap flag of the dragged helper-marker\n      const marker = e.target;\n      marker._snapped = false;\n    }\n    // delete it, we need to refresh this with each start of a drag because\n    // meanwhile, new layers could've been added to the map\n    delete this._snapList;\n\n    if (this.throttledList) {\n      this._map.off('layeradd', this.throttledList, this);\n      this.throttledList = undefined;\n    }\n\n    // remove map event\n    this._map.off('layerremove', this._handleSnapLayerRemoval, this);\n\n    if (this.debugIndicatorLines) {\n      this.debugIndicatorLines.forEach((line) => {\n        line.remove();\n      });\n    }\n  },\n  _handleThrottleSnapping() {\n    // we check if the throttledList is existing, else the function is deleted but the `layeradd` event calls it.\n    // this made problems when layer was removed and added to the map in the `pm:create` event\n    if (this.throttledList) {\n      this._createSnapList();\n    }\n  },\n  _handleSnapping(e, selfSnapOnly = false) {\n    const marker = e.target;\n    marker._snapped = false;\n\n    if (!this.throttledList) {\n      this.throttledList = L.Util.throttle(\n        this._handleThrottleSnapping,\n        100,\n        this\n      );\n    }\n\n    // if snapping is disabled via holding ALT during drag, stop right here\n    // we need to check for the altKey on the move event, because keydown event is to slow ...\n    if (e?.originalEvent?.altKey || this._map?.pm?.Keyboard.isAltKeyPressed()) {\n      return false;\n    }\n\n    // Determine which snap list to use\n    let snapList;\n    if (selfSnapOnly) {\n      // Self-snap mode: only snap to _otherSnapLayers (first point of current polygon)\n      // This allows polygon completion even when global snapping is disabled\n      if (!this._otherSnapLayers || this._otherSnapLayers.length === 0) {\n        return false;\n      }\n      snapList = this._otherSnapLayers;\n    } else {\n      // Normal mode: create full snap list of all snappable layers\n      // this isn't inside a movestart/dragstart callback because middlemarkers are initialized\n      // after dragstart/movestart so it wouldn't fire for them\n      if (this._snapList === undefined) {\n        this._createSnapList();\n\n        // re-create the snaplist again when a layer is added during draw\n        this._map.off('layeradd', this.throttledList, this);\n        this._map.on('layeradd', this.throttledList, this);\n      }\n      snapList = this._snapList;\n    }\n\n    // if there are no layers to snap to, stop here\n    if (snapList.length <= 0) {\n      return false;\n    }\n\n    // get the closest layer, it's closest latlng, segment and the distance\n    const closestLayer = this._calcClosestLayer(marker.getLatLng(), snapList);\n\n    // if no layers found. Can happen when circle is the only visible layer on the map and the hidden snapping-border circle layer is also on the map\n    if (Object.keys(closestLayer).length === 0) {\n      return false;\n    }\n\n    const isMarker =\n      closestLayer.layer instanceof L.Marker ||\n      closestLayer.layer instanceof L.CircleMarker ||\n      !this.options.snapSegment;\n\n    // find the final latlng that we want to snap to\n    let snapLatLng;\n    if (!isMarker) {\n      snapLatLng = this._checkPrioritiySnapping(closestLayer);\n    } else {\n      snapLatLng = closestLayer.latlng;\n    }\n\n    // minimal distance before marker snaps (in pixels)\n    const minDistance = this.options.snapDistance;\n\n    // event info for pm:snap and pm:unsnap\n    const eventInfo = {\n      marker,\n      shape: this._shape,\n      snapLatLng,\n      segment: closestLayer.segment,\n      layer: this._layer,\n      workingLayer: this._layer,\n      layerInteractedWith: closestLayer.layer, // for lack of a better property name\n      distance: closestLayer.distance,\n    };\n\n    this._fireSnapDrag(eventInfo.marker, eventInfo);\n    this._fireSnapDrag(this._layer, eventInfo);\n\n    if (closestLayer.distance < minDistance) {\n      // snap the marker\n      marker._orgLatLng = marker.getLatLng();\n      // TODO: if the origin marker has a altitude is applied to the snapped layer too, do we want this?\n      marker.setLatLng(snapLatLng);\n\n      marker._snapped = true;\n      marker._snapInfo = eventInfo;\n\n      const triggerSnap = () => {\n        this._snapLatLng = snapLatLng;\n        this._fireSnap(marker, eventInfo);\n        this._fireSnap(this._layer, eventInfo);\n      };\n\n      // check if the snapping position differs from the last snap\n      // Thanks Max & car2go Team\n      const a = this._snapLatLng || {};\n      const b = snapLatLng || {};\n\n      if (a.lat !== b.lat || a.lng !== b.lng) {\n        triggerSnap();\n      }\n    } else if (this._snapLatLng) {\n      // no more snapping\n\n      // if it was previously snapped...\n      // ...unsnap\n      this._unsnap(eventInfo);\n\n      marker._snapped = false;\n      marker._snapInfo = undefined;\n\n      // and fire unsnap event\n      this._fireUnsnap(eventInfo.marker, eventInfo);\n      this._fireUnsnap(this._layer, eventInfo);\n    }\n\n    return true;\n  },\n  _createSnapList() {\n    let layers = [];\n    const debugIndicatorLines = [];\n    const map = this._map;\n\n    map.off('layerremove', this._handleSnapLayerRemoval, this);\n    map.on('layerremove', this._handleSnapLayerRemoval, this);\n\n    // find all layers that are or inherit from Polylines... and markers that are not\n    // temporary markers of polygon-edits\n    map.eachLayer((layer) => {\n      if (\n        (layer instanceof L.Polyline ||\n          layer instanceof L.Marker ||\n          layer instanceof L.CircleMarker ||\n          layer instanceof L.ImageOverlay) &&\n        layer.options.snapIgnore !== true\n      ) {\n        // if snapIgnore === false the layer will be always snappable\n        if (\n          layer.options.snapIgnore === undefined &&\n          ((!L.PM.optIn && layer.options.pmIgnore === true) || // if optIn is not set and pmIgnore is true, the layer will be ignored\n            (L.PM.optIn && layer.options.pmIgnore !== false)) // if optIn is true and pmIgnore is not false, the layer will be ignored\n        ) {\n          return;\n        }\n\n        // adds a hidden polygon which matches the border of the circle\n        if (\n          (layer instanceof L.Circle || layer instanceof L.CircleMarker) &&\n          layer.pm &&\n          layer.pm._hiddenPolyCircle\n        ) {\n          layers.push(layer.pm._hiddenPolyCircle);\n        } else if (layer instanceof L.ImageOverlay) {\n          layer = L.rectangle(layer.getBounds());\n        }\n        layers.push(layer);\n\n        // this is for debugging\n        const debugLine = L.polyline([], { color: 'red', pmIgnore: true });\n        debugLine._pmTempLayer = true;\n        debugIndicatorLines.push(debugLine);\n        if (layer instanceof L.Circle || layer instanceof L.CircleMarker) {\n          debugIndicatorLines.push(debugLine);\n        }\n\n        // uncomment \uD83D\uDC47 this line to show helper lines for debugging\n        // debugLine.addTo(map);\n      }\n    });\n\n    // ...except myself\n    layers = layers.filter((layer) => this._layer !== layer);\n\n    // also remove everything that has no coordinates yet\n    layers = layers.filter(\n      (layer) => layer._latlng || (layer._latlngs && hasValues(layer._latlngs))\n    );\n\n    // finally remove everything that's leaflet-geoman specific temporary stuff\n    layers = layers.filter((layer) => !layer._pmTempLayer);\n\n    // save snaplist from layers and the other snap layers added from other classes/scripts\n    if (this._otherSnapLayers) {\n      this._otherSnapLayers.forEach(() => {\n        // this is for debugging\n        const debugLine = L.polyline([], { color: 'red', pmIgnore: true });\n        debugLine._pmTempLayer = true;\n        debugIndicatorLines.push(debugLine);\n      });\n      this._snapList = layers.concat(this._otherSnapLayers);\n    } else {\n      this._snapList = layers;\n    }\n\n    this.debugIndicatorLines = debugIndicatorLines;\n  },\n  _handleSnapLayerRemoval({ layer }) {\n    if (!layer._leaflet_id) {\n      return;\n    }\n    // find the layers index in snaplist\n    const index = this._snapList.findIndex(\n      (e) => e._leaflet_id === layer._leaflet_id\n    );\n    if (index > -1) {\n      // remove it from the snaplist\n      this._snapList.splice(index, 1);\n    }\n  },\n  _calcClosestLayer(latlng, layers) {\n    return this._calcClosestLayers(latlng, layers, 1)[0];\n  },\n  _calcClosestLayers(latlng, layers, amount = 1) {\n    // the closest polygon to our dragged marker latlng\n    let closestLayers = [];\n    let closestLayer = {};\n\n    // loop through the layers\n    layers.forEach((layer, index) => {\n      // For Circles and CircleMarkers to prevent that they snap to the own borders.\n      if (layer._parentCopy && layer._parentCopy === this._layer) {\n        return;\n      }\n      // if a polyline has only one coordinate\n      if (layer.getLatLngs?.().flat(5).length < 2) {\n        return;\n      }\n      // find the closest latlng, segment and the distance of this layer to the dragged marker latlng\n      const results = this._calcLayerDistances(latlng, layer);\n      results.distance = Math.floor(results.distance);\n\n      if (this.debugIndicatorLines) {\n        if (!this.debugIndicatorLines[index]) {\n          const debugLine = L.polyline([], { color: 'red', pmIgnore: true });\n          debugLine._pmTempLayer = true;\n          this.debugIndicatorLines[index] = debugLine;\n        }\n\n        // show indicator lines, it's for debugging\n        this.debugIndicatorLines[index].setLatLngs([latlng, results.latlng]);\n      }\n\n      // save the info if it doesn't exist or if the distance is smaller than the previous one\n      if (\n        amount === 1 &&\n        (closestLayer.distance === undefined ||\n          results.distance - 5 <= closestLayer.distance)\n      ) {\n        // if the layer is less then 5 pixels away, we treat it as same distance and sort it based on priority\n        if (results.distance + 5 < closestLayer.distance) {\n          closestLayers = [];\n        }\n        closestLayer = results;\n        closestLayer.layer = layer;\n        closestLayers.push(closestLayer);\n      } else if (amount !== 1) {\n        closestLayer = {};\n        closestLayer = results;\n        closestLayer.layer = layer;\n        closestLayers.push(closestLayer);\n      }\n    });\n    if (amount !== 1) {\n      // sort the layers by distance\n      closestLayers = closestLayers.sort((a, b) => a.distance - b.distance);\n    }\n\n    if (amount === -1) {\n      amount = closestLayers.length;\n    }\n\n    // return the closest layer and it's data\n    // if there is no closest layer, return an empty object\n    const result = this._getClosestLayerByPriority(closestLayers, amount);\n    if (L.Util.isArray(result)) {\n      return result;\n    }\n    return [result];\n  },\n  _calcLayerDistances(latlng, layer) {\n    const map = this._map;\n\n    // is this a marker?\n    const isMarker =\n      layer instanceof L.Marker || layer instanceof L.CircleMarker;\n\n    // is it a polygon?\n    const isPolygon = layer instanceof L.Polygon;\n\n    // the point P which we want to snap (probpably the marker that is dragged)\n    const P = latlng;\n\n    // the coords of the layer\n\n    if (isMarker) {\n      // return the info for the marker, no more calculations needed\n      const latlngs = layer.getLatLng();\n      return {\n        latlng: { ...latlngs },\n        distance: this._getDistance(map, latlngs, P),\n      };\n    }\n\n    return this._calcLatLngDistances(P, layer.getLatLngs(), map, isPolygon);\n  },\n  _calcLatLngDistances(latlng, latlngs, map, closedShape = false) {\n    // the closest coord of the layer\n    let closestCoord;\n\n    // the shortest distance from latlng to closestCoord\n    let shortestDistance;\n\n    // the closest segment (line between two points) of the layer\n    let closestSegment;\n\n    const loopThroughCoords = (coords) => {\n      coords.forEach((coord, index) => {\n        if (Array.isArray(coord)) {\n          loopThroughCoords(coord);\n          return;\n        }\n\n        if (this.options.snapSegment) {\n          // take this coord (A)...\n          const A = coord;\n          let nextIndex;\n\n          // and the next coord (B) as points\n          if (closedShape) {\n            nextIndex = index + 1 === coords.length ? 0 : index + 1;\n          } else {\n            nextIndex = index + 1 === coords.length ? undefined : index + 1;\n          }\n\n          const B = coords[nextIndex];\n          if (B) {\n            // calc the distance between latlng and AB-segment\n            const distance = this._getDistanceToSegment(map, latlng, A, B);\n\n            // is the distance shorter than the previous one? Save it and the segment\n            if (shortestDistance === undefined || distance < shortestDistance) {\n              shortestDistance = distance;\n              closestSegment = [A, B];\n            }\n          }\n        } else {\n          // Only snap on the coords\n          const distancePoint = this._getDistance(map, latlng, coord);\n\n          if (\n            shortestDistance === undefined ||\n            distancePoint < shortestDistance\n          ) {\n            shortestDistance = distancePoint;\n            closestCoord = coord;\n          }\n        }\n      });\n    };\n\n    loopThroughCoords(latlngs);\n\n    if (this.options.snapSegment) {\n      // now, take the closest segment (closestSegment) and calc the closest point to latlng on it.\n      const C = this._getClosestPointOnSegment(\n        map,\n        latlng,\n        closestSegment[0],\n        closestSegment[1]\n      );\n\n      // return the latlng of that sucker\n      return {\n        latlng: { ...C },\n        segment: closestSegment,\n        distance: shortestDistance,\n      };\n    }\n    // Only snap on the coords\n    // return the closest coord\n    return {\n      latlng: closestCoord,\n      distance: shortestDistance,\n    };\n  },\n  _getClosestLayerByPriority(layers, amount = 1) {\n    // sort the layers by creation, so it is snapping to the oldest layer from the same shape\n    layers = layers.sort((a, b) => a._leaflet_id - b._leaflet_id);\n\n    const shapes = [\n      'Marker',\n      'CircleMarker',\n      'Circle',\n      'Line',\n      'Polygon',\n      'Rectangle',\n    ];\n    const order = this._map.pm.globalOptions.snappingOrder || [];\n\n    let lastIndex = 0;\n    const prioOrder = {};\n    // merge user-preferred priority with default priority\n    order.concat(shapes).forEach((shape) => {\n      if (!prioOrder[shape]) {\n        lastIndex += 1;\n        prioOrder[shape] = lastIndex;\n      }\n    });\n\n    // sort layers by priority\n    layers.sort(prioritiseSort('instanceofShape', prioOrder));\n    if (amount === 1) {\n      return layers[0] || {};\n    }\n    return layers.slice(0, amount);\n  },\n  // we got the point we want to snap to (C), but we need to check if a coord of the polygon\n  // receives priority over C as the snapping point. Let's check this here\n  _checkPrioritiySnapping(closestLayer) {\n    const map = this._map;\n\n    // A and B are the points of the closest segment to P (the marker position we want to snap)\n    const A = closestLayer.segment[0];\n    const B = closestLayer.segment[1];\n\n    // C is the point we would snap to on the segment.\n    // The closest point on the closest segment of the closest polygon to P. That's right.\n    const C = closestLayer.latlng;\n\n    // the latlng we ultemately want to snap to\n    let snapLatlng = C;\n\n    if (this.options.snapVertex) {\n      // distances from A to C and B to C to check which one is closer to C\n      const distanceAC = this._getDistance(map, A, C);\n      const distanceBC = this._getDistance(map, B, C);\n\n      // closest latlng of A and B to C\n      let closestVertexLatLng = distanceAC < distanceBC ? A : B;\n\n      // distance between closestVertexLatLng and C\n      let shortestDistance = distanceAC < distanceBC ? distanceAC : distanceBC;\n\n      // snap to middle (M) of segment if option is enabled\n      if (this.options.snapMiddle) {\n        const M = L.PM.Utils.calcMiddleLatLng(map, A, B);\n        const distanceMC = this._getDistance(map, M, C);\n\n        if (distanceMC < distanceAC && distanceMC < distanceBC) {\n          // M is the nearest vertex\n          closestVertexLatLng = M;\n          shortestDistance = distanceMC;\n        }\n      }\n\n      // the distance that needs to be undercut to trigger priority\n      const priorityDistance = this.options.snapDistance;\n\n      // if C is closer to the closestVertexLatLng (A, B or M) than the snapDistance,\n      // the closestVertexLatLng has priority over C as the snapping point.\n      if (shortestDistance < priorityDistance) {\n        snapLatlng = closestVertexLatLng;\n      }\n    }\n\n    // return the copy of snapping point\n    return { ...snapLatlng };\n  },\n  _unsnap() {\n    // delete the last snap\n    delete this._snapLatLng;\n  },\n  _getClosestPointOnSegment(map, latlng, latlngA, latlngB) {\n    let maxzoom = map.getMaxZoom();\n    if (maxzoom === Infinity) {\n      maxzoom = map.getZoom();\n    }\n    const P = map.project(latlng, maxzoom);\n    const A = map.project(latlngA, maxzoom);\n    const B = map.project(latlngB, maxzoom);\n    const closest = L.LineUtil.closestPointOnSegment(P, A, B);\n    return map.unproject(closest, maxzoom);\n  },\n  _getDistanceToSegment(map, latlng, latlngA, latlngB) {\n    const P = map.latLngToContainerPoint(latlng);\n    const A = map.latLngToContainerPoint(latlngA);\n    const B = map.latLngToContainerPoint(latlngB);\n    return L.LineUtil.pointToSegmentDistance(P, A, B);\n  },\n  _getDistance(map, latlngA, latlngB) {\n    return map\n      .latLngToContainerPoint(latlngA)\n      .distanceTo(map.latLngToContainerPoint(latlngB));\n  },\n};\n\nexport default SnapMixin;\n", "import Draw from './L.PM.Draw';\nimport { getTranslation, hasFinePointer } from '../helpers';\n\nDraw.Marker = Draw.extend({\n  initialize(map) {\n    this._map = map;\n    this._shape = 'Marker';\n    this.toolbarButtonName = 'drawMarker';\n    // with _layerIsDragging we check if a marker is currently dragged and disable marker creation\n    this._layerIsDragging = false;\n  },\n  enable(options) {\n    // TODO: Think about if these options could be passed globally for all\n    // instances of L.PM.Draw. So a dev could set drawing style one time as some kind of config\n    L.Util.setOptions(this, options);\n\n    // change enabled state\n    this._enabled = true;\n\n    // Detect if device has a fine pointer (mouse) vs coarse pointer (touch)\n    this._isTouchDevice = !hasFinePointer();\n\n    // change map cursor\n    this._map.getContainer().classList.add('geoman-draw-cursor');\n\n    // create a marker on click on the map\n    this._map.on('click', this._createMarker, this);\n\n    // toggle the draw button of the Toolbar in case drawing mode got enabled without the button\n    this._map.pm.Toolbar.toggleButton(this.toolbarButtonName, true);\n\n    if (this._isTouchDevice) {\n      // Touch device: Create fixed-position hint instead of cursor-following marker\n      this._createTouchHint();\n\n      // Create a minimal hidden hint marker to satisfy the snappable mixin interface.\n      // Note: Snapping is effectively disabled on touch devices since there's no\n      // continuous cursor position to snap. The marker exists only for API compatibility.\n      this._hintMarker = L.marker(this._map.getCenter(), {\n        ...this.options.markerStyle,\n        opacity: 0,\n        interactive: false,\n      });\n      this._setPane(this._hintMarker, 'markerPane');\n      this._hintMarker._pmTempLayer = true;\n    } else {\n      // Desktop: Use existing hint marker behavior\n      this._hintMarker = L.marker(\n        this._map.getCenter(),\n        this.options.markerStyle\n      );\n      this._setPane(this._hintMarker, 'markerPane');\n      this._hintMarker._pmTempLayer = true;\n      this._hintMarker.addTo(this._map);\n\n      // add tooltip to hintmarker\n      if (this.options.tooltips) {\n        this._hintMarker\n          .bindTooltip(getTranslation('tooltips.placeMarker'), {\n            permanent: true,\n            offset: L.point(0, 10),\n            direction: 'bottom',\n            opacity: 0.8,\n          })\n          .openTooltip();\n      }\n\n      // sync hint marker with mouse cursor\n      this._map.on('mousemove', this._syncHintMarker, this);\n    }\n\n    // this is just to keep the snappable mixin happy\n    this._layer = this._hintMarker;\n\n    // enable edit mode for existing markers\n    if (this.options.markerEditable) {\n      this._map.eachLayer((layer) => {\n        if (this.isRelevantMarker(layer)) {\n          layer.pm.enable();\n        }\n      });\n    }\n\n    // fire drawstart event\n    this._fireDrawStart();\n    this._setGlobalDrawMode();\n  },\n  disable() {\n    // cancel, if drawing mode isn't even enabled\n    if (!this._enabled) {\n      return;\n    }\n\n    // change enabled state\n    this._enabled = false;\n\n    // reset cursor\n    this._map.getContainer().classList.remove('geoman-draw-cursor');\n\n    // undbind click event, don't create a marker on click anymore\n    this._map.off('click', this._createMarker, this);\n\n    // cleanup based on device type\n    if (this._isTouchDevice) {\n      this._removeTouchHint();\n      this._hintMarker = null;\n    } else {\n      this._hintMarker.remove();\n      this._map.off('mousemove', this._syncHintMarker, this);\n    }\n\n    // disable dragging and removing for all markers\n    this._map.eachLayer((layer) => {\n      if (this.isRelevantMarker(layer)) {\n        layer.pm.disable();\n      }\n    });\n\n    // toggle the draw button of the Toolbar in case drawing mode got disabled without the button\n    this._map.pm.Toolbar.toggleButton(this.toolbarButtonName, false);\n\n    // cleanup snapping\n    if (this.options.snappable) {\n      this._cleanupSnapping();\n    }\n\n    // fire drawend event\n    this._fireDrawEnd();\n    this._setGlobalDrawMode();\n  },\n  enabled() {\n    return this._enabled;\n  },\n  toggle(options) {\n    if (this.enabled()) {\n      this.disable();\n    } else {\n      this.enable(options);\n    }\n  },\n  isRelevantMarker(layer) {\n    return (\n      layer instanceof L.Marker &&\n      layer.pm &&\n      !layer._pmTempLayer &&\n      !layer.pm._initTextMarker\n    );\n  },\n  _syncHintMarker(e) {\n    // move the cursor marker\n    this._hintMarker.setLatLng(e.latlng);\n\n    // if snapping is enabled, do it\n    if (this.options.snappable) {\n      const fakeDragEvent = e;\n      fakeDragEvent.target = this._hintMarker;\n      this._handleSnapping(fakeDragEvent);\n    }\n\n    this._fireChange(this._hintMarker.getLatLng(), 'Draw');\n  },\n  _createMarker(e) {\n    if (!e.latlng || this._layerIsDragging) {\n      return;\n    }\n\n    // If snap finish is required but the last marker wasn't snapped, do not finish the shape!\n    if (\n      this.options.requireSnapToFinish &&\n      !this._hintMarker._snapped &&\n      !this._isFirstLayer()\n    ) {\n      return;\n    }\n\n    // assign the coordinate of the click to the hintMarker, that's necessary for\n    // mobile where the marker can't follow a cursor\n    if (!this._hintMarker._snapped) {\n      this._hintMarker.setLatLng(e.latlng);\n    }\n\n    // get coordinate for new vertex by hintMarker (cursor marker)\n    const latlng = this._hintMarker.getLatLng();\n\n    // create marker\n    const marker = new L.Marker(latlng, this.options.markerStyle);\n    this._setPane(marker, 'markerPane');\n    this._finishLayer(marker);\n\n    if (!marker.pm) {\n      // if pm is not create we don't apply dragging to the marker (draggable is applied to the marker, when it is added to the map )\n      marker.options.draggable = false;\n    }\n    // add marker to the map\n    marker.addTo(this._map.pm._getContainingLayer());\n\n    if (marker.pm && this.options.markerEditable) {\n      // enable editing for the marker\n      marker.pm.enable();\n    } else if (marker.dragging) {\n      marker.dragging.disable();\n    }\n\n    // fire the pm:create event and pass shape and marker\n    this._fireCreate(marker);\n\n    this._cleanupSnapping();\n\n    if (!this.options.continueDrawing) {\n      this.disable();\n    }\n  },\n  setStyle() {\n    if (this.options.markerStyle?.icon) {\n      this._hintMarker?.setIcon(this.options.markerStyle.icon);\n    }\n  },\n  _createTouchHint() {\n    if (!this.options.tooltips) {\n      return;\n    }\n    this._touchHint = L.DomUtil.create('div', 'leaflet-pm-touch-hint');\n    this._touchHint.textContent = getTranslation('tooltips.placeMarkerTouch');\n    this._map.getContainer().appendChild(this._touchHint);\n  },\n  _removeTouchHint() {\n    if (this._touchHint && this._touchHint.parentNode) {\n      this._touchHint.parentNode.removeChild(this._touchHint);\n      this._touchHint = null;\n    }\n  },\n});\n", "import {\n  BBox,\n  Feature,\n  FeatureCollection,\n  Geometry,\n  GeometryCollection,\n  GeometryObject,\n  LineString,\n  MultiLineString,\n  MultiPoint,\n  MultiPolygon,\n  Point,\n  Polygon,\n  Position,\n  GeoJsonProperties,\n} from \"geojson\";\n\nimport { Id } from \"./lib/geojson.js\";\nexport * from \"./lib/geojson.js\";\n\n/**\n * @module helpers\n */\n\n// TurfJS Combined Types\nexport type Coord = Feature<Point> | Point | Position;\n\n/**\n * Linear measurement units.\n *\n *  Warning. Be aware of the implications of using radian or degree units to\n * measure distance. The distance represented by a degree of longitude *varies*\n * depending on latitude.\n *\n * See https://www.thoughtco.com/degree-of-latitude-and-longitude-distance-4070616\n * for an illustration of this behaviour.\n *\n * @typedef\n */\nexport type Units =\n  | \"meters\"\n  | \"metres\"\n  | \"millimeters\"\n  | \"millimetres\"\n  | \"centimeters\"\n  | \"centimetres\"\n  | \"kilometers\"\n  | \"kilometres\"\n  | \"miles\"\n  | \"nauticalmiles\"\n  | \"inches\"\n  | \"yards\"\n  | \"feet\"\n  | \"radians\"\n  | \"degrees\";\n\n/**\n * Area measurement units.\n *\n * @typedef\n */\nexport type AreaUnits =\n  | Exclude<Units, \"radians\" | \"degrees\">\n  | \"acres\"\n  | \"hectares\";\n\n/**\n * Grid types.\n *\n * @typedef\n */\nexport type Grid = \"point\" | \"square\" | \"hex\" | \"triangle\";\n\n/**\n * Shorthand corner identifiers.\n *\n * @typedef\n */\nexport type Corners = \"sw\" | \"se\" | \"nw\" | \"ne\" | \"center\" | \"centroid\";\n\n/**\n * Geometries made up of lines i.e. lines and polygons.\n *\n * @typedef\n */\nexport type Lines = LineString | MultiLineString | Polygon | MultiPolygon;\n\n/**\n * Convenience type for all possible GeoJSON.\n *\n * @typedef\n */\nexport type AllGeoJSON =\n  | Feature\n  | FeatureCollection\n  | Geometry\n  | GeometryCollection;\n\n/**\n * The Earth radius in meters. Used by Turf modules that model the Earth as a sphere. The {@link https://en.wikipedia.org/wiki/Earth_radius#Arithmetic_mean_radius mean radius} was selected because it is {@link https://rosettacode.org/wiki/Haversine_formula#:~:text=This%20value%20is%20recommended recommended } by the Haversine formula (used by turf/distance) to reduce error.\n *\n * @constant\n */\nexport const earthRadius = 6371008.8;\n\n/**\n * Unit of measurement factors based on earthRadius.\n *\n * Keys are the name of the unit, values are the number of that unit in a single radian\n *\n * @constant\n */\nexport const factors: Record<Units, number> = {\n  centimeters: earthRadius * 100,\n  centimetres: earthRadius * 100,\n  degrees: 360 / (2 * Math.PI),\n  feet: earthRadius * 3.28084,\n  inches: earthRadius * 39.37,\n  kilometers: earthRadius / 1000,\n  kilometres: earthRadius / 1000,\n  meters: earthRadius,\n  metres: earthRadius,\n  miles: earthRadius / 1609.344,\n  millimeters: earthRadius * 1000,\n  millimetres: earthRadius * 1000,\n  nauticalmiles: earthRadius / 1852,\n  radians: 1,\n  yards: earthRadius * 1.0936,\n};\n\n/**\n\n * Area of measurement factors based on 1 square meter.\n *\n * @constant\n */\nexport const areaFactors: Record<AreaUnits, number> = {\n  acres: 0.000247105,\n  centimeters: 10000,\n  centimetres: 10000,\n  feet: 10.763910417,\n  hectares: 0.0001,\n  inches: 1550.003100006,\n  kilometers: 0.000001,\n  kilometres: 0.000001,\n  meters: 1,\n  metres: 1,\n  miles: 3.86e-7,\n  nauticalmiles: 2.9155334959812285e-7,\n  millimeters: 1000000,\n  millimetres: 1000000,\n  yards: 1.195990046,\n};\n\n/**\n * Wraps a GeoJSON {@link Geometry} in a GeoJSON {@link Feature}.\n *\n * @function\n * @param {GeometryObject} geometry input geometry\n * @param {GeoJsonProperties} [properties={}] an Object of key-value pairs to add as properties\n * @param {Object} [options={}] Optional Parameters\n * @param {BBox} [options.bbox] Bounding Box Array [west, south, east, north] associated with the Feature\n * @param {Id} [options.id] Identifier associated with the Feature\n * @returns {Feature<GeometryObject, GeoJsonProperties>} a GeoJSON Feature\n * @example\n * var geometry = {\n *   \"type\": \"Point\",\n *   \"coordinates\": [110, 50]\n * };\n *\n * var feature = turf.feature(geometry);\n *\n * //=feature\n */\nexport function feature<\n  G extends GeometryObject = Geometry,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  geom: G | null,\n  properties?: P,\n  options: { bbox?: BBox; id?: Id } = {}\n): Feature<G, P> {\n  const feat: any = { type: \"Feature\" };\n  if (options.id === 0 || options.id) {\n    feat.id = options.id;\n  }\n  if (options.bbox) {\n    feat.bbox = options.bbox;\n  }\n  feat.properties = properties || {};\n  feat.geometry = geom;\n  return feat;\n}\n\n/**\n * Creates a GeoJSON {@link Geometry} from a Geometry string type & coordinates.\n * For GeometryCollection type use `helpers.geometryCollection`\n *\n * @function\n * @param {(\"Point\" | \"LineString\" | \"Polygon\" | \"MultiPoint\" | \"MultiLineString\" | \"MultiPolygon\")} type Geometry Type\n * @param {Array<any>} coordinates Coordinates\n * @param {Object} [options={}] Optional Parameters\n * @returns {Geometry} a GeoJSON Geometry\n * @example\n * var type = \"Point\";\n * var coordinates = [110, 50];\n * var geometry = turf.geometry(type, coordinates);\n * // => geometry\n */\nexport function geometry<\n  T extends\n    | \"Point\"\n    | \"LineString\"\n    | \"Polygon\"\n    | \"MultiPoint\"\n    | \"MultiLineString\"\n    | \"MultiPolygon\",\n>(\n  type: T,\n  coordinates: any[],\n  _options: Record<string, never> = {}\n): Extract<Geometry, { type: T }> {\n  switch (type) {\n    case \"Point\":\n      return point(coordinates).geometry as Extract<Geometry, { type: T }>;\n    case \"LineString\":\n      return lineString(coordinates).geometry as Extract<Geometry, { type: T }>;\n    case \"Polygon\":\n      return polygon(coordinates).geometry as Extract<Geometry, { type: T }>;\n    case \"MultiPoint\":\n      return multiPoint(coordinates).geometry as Extract<Geometry, { type: T }>;\n    case \"MultiLineString\":\n      return multiLineString(coordinates).geometry as Extract<\n        Geometry,\n        { type: T }\n      >;\n    case \"MultiPolygon\":\n      return multiPolygon(coordinates).geometry as Extract<\n        Geometry,\n        { type: T }\n      >;\n    default:\n      throw new Error(type + \" is invalid\");\n  }\n}\n\n/**\n * Creates a {@link Point} {@link Feature} from a Position.\n *\n * @function\n * @param {Position} coordinates longitude, latitude position (each in decimal degrees)\n * @param {GeoJsonProperties} [properties={}] an Object of key-value pairs to add as properties\n * @param {Object} [options={}] Optional Parameters\n * @param {BBox} [options.bbox] Bounding Box Array [west, south, east, north] associated with the Feature\n * @param {Id} [options.id] Identifier associated with the Feature\n * @returns {Feature<Point, GeoJsonProperties>} a Point feature\n * @example\n * var point = turf.point([-75.343, 39.984]);\n *\n * //=point\n */\nexport function point<P extends GeoJsonProperties = GeoJsonProperties>(\n  coordinates: Position,\n  properties?: P,\n  options: { bbox?: BBox; id?: Id } = {}\n): Feature<Point, P> {\n  if (!coordinates) {\n    throw new Error(\"coordinates is required\");\n  }\n  if (!Array.isArray(coordinates)) {\n    throw new Error(\"coordinates must be an Array\");\n  }\n  if (coordinates.length < 2) {\n    throw new Error(\"coordinates must be at least 2 numbers long\");\n  }\n  if (!isNumber(coordinates[0]) || !isNumber(coordinates[1])) {\n    throw new Error(\"coordinates must contain numbers\");\n  }\n\n  const geom: Point = {\n    type: \"Point\",\n    coordinates,\n  };\n  return feature(geom, properties, options);\n}\n\n/**\n * Creates a {@link Point} {@link FeatureCollection} from an Array of Point coordinates.\n *\n * @function\n * @param {Position[]} coordinates an array of Points\n * @param {GeoJsonProperties} [properties={}] Translate these properties to each Feature\n * @param {Object} [options={}] Optional Parameters\n * @param {BBox} [options.bbox] Bounding Box Array [west, south, east, north]\n * associated with the FeatureCollection\n * @param {Id} [options.id] Identifier associated with the FeatureCollection\n * @returns {FeatureCollection<Point>} Point Feature\n * @example\n * var points = turf.points([\n *   [-75, 39],\n *   [-80, 45],\n *   [-78, 50]\n * ]);\n *\n * //=points\n */\nexport function points<P extends GeoJsonProperties = GeoJsonProperties>(\n  coordinates: Position[],\n  properties?: P,\n  options: { bbox?: BBox; id?: Id } = {}\n): FeatureCollection<Point, P> {\n  return featureCollection(\n    coordinates.map((coords) => {\n      return point(coords, properties);\n    }),\n    options\n  );\n}\n\n/**\n * Creates a {@link Polygon} {@link Feature} from an Array of LinearRings.\n *\n * @function\n * @param {Position[][]} coordinates an array of LinearRings\n * @param {GeoJsonProperties} [properties={}] an Object of key-value pairs to add as properties\n * @param {Object} [options={}] Optional Parameters\n * @param {BBox} [options.bbox] Bounding Box Array [west, south, east, north] associated with the Feature\n * @param {Id} [options.id] Identifier associated with the Feature\n * @returns {Feature<Polygon, GeoJsonProperties>} Polygon Feature\n * @example\n * var polygon = turf.polygon([[[-5, 52], [-4, 56], [-2, 51], [-7, 54], [-5, 52]]], { name: 'poly1' });\n *\n * //=polygon\n */\nexport function polygon<P extends GeoJsonProperties = GeoJsonProperties>(\n  coordinates: Position[][],\n  properties?: P,\n  options: { bbox?: BBox; id?: Id } = {}\n): Feature<Polygon, P> {\n  for (const ring of coordinates) {\n    if (ring.length < 4) {\n      throw new Error(\n        \"Each LinearRing of a Polygon must have 4 or more Positions.\"\n      );\n    }\n\n    if (ring[ring.length - 1].length !== ring[0].length) {\n      throw new Error(\"First and last Position are not equivalent.\");\n    }\n\n    for (let j = 0; j < ring[ring.length - 1].length; j++) {\n      // Check if first point of Polygon contains two numbers\n      if (ring[ring.length - 1][j] !== ring[0][j]) {\n        throw new Error(\"First and last Position are not equivalent.\");\n      }\n    }\n  }\n  const geom: Polygon = {\n    type: \"Polygon\",\n    coordinates,\n  };\n  return feature(geom, properties, options);\n}\n\n/**\n * Creates a {@link Polygon} {@link FeatureCollection} from an Array of Polygon coordinates.\n *\n * @function\n * @param {Position[][][]} coordinates an array of Polygon coordinates\n * @param {GeoJsonProperties} [properties={}] an Object of key-value pairs to add as properties\n * @param {Object} [options={}] Optional Parameters\n * @param {BBox} [options.bbox] Bounding Box Array [west, south, east, north] associated with the Feature\n * @param {Id} [options.id] Identifier associated with the FeatureCollection\n * @returns {FeatureCollection<Polygon, GeoJsonProperties>} Polygon FeatureCollection\n * @example\n * var polygons = turf.polygons([\n *   [[[-5, 52], [-4, 56], [-2, 51], [-7, 54], [-5, 52]]],\n *   [[[-15, 42], [-14, 46], [-12, 41], [-17, 44], [-15, 42]]],\n * ]);\n *\n * //=polygons\n */\nexport function polygons<P extends GeoJsonProperties = GeoJsonProperties>(\n  coordinates: Position[][][],\n  properties?: P,\n  options: { bbox?: BBox; id?: Id } = {}\n): FeatureCollection<Polygon, P> {\n  return featureCollection(\n    coordinates.map((coords) => {\n      return polygon(coords, properties);\n    }),\n    options\n  );\n}\n\n/**\n * Creates a {@link LineString} {@link Feature} from an Array of Positions.\n *\n * @function\n * @param {Position[]} coordinates an array of Positions\n * @param {GeoJsonProperties} [properties={}] an Object of key-value pairs to add as properties\n * @param {Object} [options={}] Optional Parameters\n * @param {BBox} [options.bbox] Bounding Box Array [west, south, east, north] associated with the Feature\n * @param {Id} [options.id] Identifier associated with the Feature\n * @returns {Feature<LineString, GeoJsonProperties>} LineString Feature\n * @example\n * var linestring1 = turf.lineString([[-24, 63], [-23, 60], [-25, 65], [-20, 69]], {name: 'line 1'});\n * var linestring2 = turf.lineString([[-14, 43], [-13, 40], [-15, 45], [-10, 49]], {name: 'line 2'});\n *\n * //=linestring1\n * //=linestring2\n */\nexport function lineString<P extends GeoJsonProperties = GeoJsonProperties>(\n  coordinates: Position[],\n  properties?: P,\n  options: { bbox?: BBox; id?: Id } = {}\n): Feature<LineString, P> {\n  if (coordinates.length < 2) {\n    throw new Error(\"coordinates must be an array of two or more positions\");\n  }\n  const geom: LineString = {\n    type: \"LineString\",\n    coordinates,\n  };\n  return feature(geom, properties, options);\n}\n\n/**\n * Creates a {@link LineString} {@link FeatureCollection} from an Array of LineString coordinates.\n *\n * @function\n * @param {Position[][]} coordinates an array of LinearRings\n * @param {GeoJsonProperties} [properties={}] an Object of key-value pairs to add as properties\n * @param {Object} [options={}] Optional Parameters\n * @param {BBox} [options.bbox] Bounding Box Array [west, south, east, north]\n * associated with the FeatureCollection\n * @param {Id} [options.id] Identifier associated with the FeatureCollection\n * @returns {FeatureCollection<LineString, GeoJsonProperties>} LineString FeatureCollection\n * @example\n * var linestrings = turf.lineStrings([\n *   [[-24, 63], [-23, 60], [-25, 65], [-20, 69]],\n *   [[-14, 43], [-13, 40], [-15, 45], [-10, 49]]\n * ]);\n *\n * //=linestrings\n */\nexport function lineStrings<P extends GeoJsonProperties = GeoJsonProperties>(\n  coordinates: Position[][],\n  properties?: P,\n  options: { bbox?: BBox; id?: Id } = {}\n): FeatureCollection<LineString, P> {\n  return featureCollection(\n    coordinates.map((coords) => {\n      return lineString(coords, properties);\n    }),\n    options\n  );\n}\n\n/**\n * Takes one or more {@link Feature|Features} and creates a {@link FeatureCollection}.\n *\n * @function\n * @param {Array<Feature<GeometryObject, GeoJsonProperties>>} features input features\n * @param {Object} [options={}] Optional Parameters\n * @param {BBox} [options.bbox] Bounding Box Array [west, south, east, north] associated with the Feature\n * @param {Id} [options.id] Identifier associated with the Feature\n * @returns {FeatureCollection<GeometryObject, GeoJsonProperties>} FeatureCollection of Features\n * @example\n * var locationA = turf.point([-75.343, 39.984], {name: 'Location A'});\n * var locationB = turf.point([-75.833, 39.284], {name: 'Location B'});\n * var locationC = turf.point([-75.534, 39.123], {name: 'Location C'});\n *\n * var collection = turf.featureCollection([\n *   locationA,\n *   locationB,\n *   locationC\n * ]);\n *\n * //=collection\n */\nexport function featureCollection<\n  G extends GeometryObject = Geometry,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  features: Array<Feature<G, P>>,\n  options: { bbox?: BBox; id?: Id } = {}\n): FeatureCollection<G, P> {\n  const fc: any = { type: \"FeatureCollection\" };\n  if (options.id) {\n    fc.id = options.id;\n  }\n  if (options.bbox) {\n    fc.bbox = options.bbox;\n  }\n  fc.features = features;\n  return fc;\n}\n\n/**\n * Creates a {@link Feature}<{@link MultiLineString}> based on a\n * coordinate array. Properties can be added optionally.\n *\n * @function\n * @param {Position[][]} coordinates an array of LineStrings\n * @param {GeoJsonProperties} [properties={}] an Object of key-value pairs to add as properties\n * @param {Object} [options={}] Optional Parameters\n * @param {BBox} [options.bbox] Bounding Box Array [west, south, east, north] associated with the Feature\n * @param {Id} [options.id] Identifier associated with the Feature\n * @returns {Feature<MultiLineString, GeoJsonProperties>} a MultiLineString feature\n * @throws {Error} if no coordinates are passed\n * @example\n * var multiLine = turf.multiLineString([[[0,0],[10,10]]]);\n *\n * //=multiLine\n */\nexport function multiLineString<\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  coordinates: Position[][],\n  properties?: P,\n  options: { bbox?: BBox; id?: Id } = {}\n): Feature<MultiLineString, P> {\n  const geom: MultiLineString = {\n    type: \"MultiLineString\",\n    coordinates,\n  };\n  return feature(geom, properties, options);\n}\n\n/**\n * Creates a {@link Feature}<{@link MultiPoint}> based on a\n * coordinate array. Properties can be added optionally.\n *\n * @function\n * @param {Position[]} coordinates an array of Positions\n * @param {GeoJsonProperties} [properties={}] an Object of key-value pairs to add as properties\n * @param {Object} [options={}] Optional Parameters\n * @param {BBox} [options.bbox] Bounding Box Array [west, south, east, north] associated with the Feature\n * @param {Id} [options.id] Identifier associated with the Feature\n * @returns {Feature<MultiPoint, GeoJsonProperties>} a MultiPoint feature\n * @throws {Error} if no coordinates are passed\n * @example\n * var multiPt = turf.multiPoint([[0,0],[10,10]]);\n *\n * //=multiPt\n */\nexport function multiPoint<P extends GeoJsonProperties = GeoJsonProperties>(\n  coordinates: Position[],\n  properties?: P,\n  options: { bbox?: BBox; id?: Id } = {}\n): Feature<MultiPoint, P> {\n  const geom: MultiPoint = {\n    type: \"MultiPoint\",\n    coordinates,\n  };\n  return feature(geom, properties, options);\n}\n\n/**\n * Creates a {@link Feature}<{@link MultiPolygon}> based on a\n * coordinate array. Properties can be added optionally.\n *\n * @function\n * @param {Position[][][]} coordinates an array of Polygons\n * @param {GeoJsonProperties} [properties={}] an Object of key-value pairs to add as properties\n * @param {Object} [options={}] Optional Parameters\n * @param {BBox} [options.bbox] Bounding Box Array [west, south, east, north] associated with the Feature\n * @param {Id} [options.id] Identifier associated with the Feature\n * @returns {Feature<MultiPolygon, GeoJsonProperties>} a multipolygon feature\n * @throws {Error} if no coordinates are passed\n * @example\n * var multiPoly = turf.multiPolygon([[[[0,0],[0,10],[10,10],[10,0],[0,0]]]]);\n *\n * //=multiPoly\n *\n */\nexport function multiPolygon<P extends GeoJsonProperties = GeoJsonProperties>(\n  coordinates: Position[][][],\n  properties?: P,\n  options: { bbox?: BBox; id?: Id } = {}\n): Feature<MultiPolygon, P> {\n  const geom: MultiPolygon = {\n    type: \"MultiPolygon\",\n    coordinates,\n  };\n  return feature(geom, properties, options);\n}\n\n/**\n * Creates a Feature<GeometryCollection> based on a\n * coordinate array. Properties can be added optionally.\n *\n * @function\n * @param {Array<Point | LineString | Polygon | MultiPoint | MultiLineString | MultiPolygon>} geometries an array of GeoJSON Geometries\n * @param {GeoJsonProperties} [properties={}] an Object of key-value pairs to add as properties\n * @param {Object} [options={}] Optional Parameters\n * @param {BBox} [options.bbox] Bounding Box Array [west, south, east, north] associated with the Feature\n * @param {Id} [options.id] Identifier associated with the Feature\n * @returns {Feature<GeometryCollection, GeoJsonProperties>} a GeoJSON GeometryCollection Feature\n * @example\n * var pt = turf.geometry(\"Point\", [100, 0]);\n * var line = turf.geometry(\"LineString\", [[101, 0], [102, 1]]);\n * var collection = turf.geometryCollection([pt, line]);\n *\n * // => collection\n */\nexport function geometryCollection<\n  G extends\n    | Point\n    | LineString\n    | Polygon\n    | MultiPoint\n    | MultiLineString\n    | MultiPolygon,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  geometries: Array<G>,\n  properties?: P,\n  options: { bbox?: BBox; id?: Id } = {}\n): Feature<GeometryCollection<G>, P> {\n  const geom: GeometryCollection<G> = {\n    type: \"GeometryCollection\",\n    geometries,\n  };\n  return feature(geom, properties, options);\n}\n\n/**\n * Round number to precision\n *\n * @function\n * @param {number} num Number\n * @param {number} [precision=0] Precision\n * @returns {number} rounded number\n * @example\n * turf.round(120.4321)\n * //=120\n *\n * turf.round(120.4321, 2)\n * //=120.43\n */\nexport function round(num: number, precision = 0): number {\n  if (precision && !(precision >= 0)) {\n    throw new Error(\"precision must be a positive number\");\n  }\n  const multiplier = Math.pow(10, precision || 0);\n  return Math.round(num * multiplier) / multiplier;\n}\n\n/**\n * Convert a distance measurement (assuming a spherical Earth) from radians to a more friendly unit.\n * Valid units: miles, nauticalmiles, inches, yards, meters, metres, kilometers, centimeters, feet\n *\n * @function\n * @param {number} radians in radians across the sphere\n * @param {Units} [units=\"kilometers\"] can be degrees, radians, miles, inches, yards, metres,\n * meters, kilometres, kilometers.\n * @returns {number} distance\n */\nexport function radiansToLength(\n  radians: number,\n  units: Units = \"kilometers\"\n): number {\n  const factor = factors[units];\n  if (!factor) {\n    throw new Error(units + \" units is invalid\");\n  }\n  return radians * factor;\n}\n\n/**\n * Convert a distance measurement (assuming a spherical Earth) from a real-world unit into radians\n * Valid units: miles, nauticalmiles, inches, yards, meters, metres, kilometers, centimeters, feet\n *\n * @function\n * @param {number} distance in real units\n * @param {Units} [units=\"kilometers\"] can be degrees, radians, miles, inches, yards, metres,\n * meters, kilometres, kilometers.\n * @returns {number} radians\n */\nexport function lengthToRadians(\n  distance: number,\n  units: Units = \"kilometers\"\n): number {\n  const factor = factors[units];\n  if (!factor) {\n    throw new Error(units + \" units is invalid\");\n  }\n  return distance / factor;\n}\n\n/**\n * Convert a distance measurement (assuming a spherical Earth) from a real-world unit into degrees\n * Valid units: miles, nauticalmiles, inches, yards, meters, metres, centimeters, kilometres, feet\n *\n * @function\n * @param {number} distance in real units\n * @param {Units} [units=\"kilometers\"] can be degrees, radians, miles, inches, yards, metres,\n * meters, kilometres, kilometers.\n * @returns {number} degrees\n */\nexport function lengthToDegrees(distance: number, units?: Units): number {\n  return radiansToDegrees(lengthToRadians(distance, units));\n}\n\n/**\n * Converts any bearing angle from the north line direction (positive clockwise)\n * and returns an angle between 0-360 degrees (positive clockwise), 0 being the north line\n *\n * @function\n * @param {number} bearing angle, between -180 and +180 degrees\n * @returns {number} angle between 0 and 360 degrees\n */\nexport function bearingToAzimuth(bearing: number): number {\n  let angle = bearing % 360;\n  if (angle < 0) {\n    angle += 360;\n  }\n  return angle;\n}\n\n/**\n * Converts any azimuth angle from the north line direction (positive clockwise)\n * and returns an angle between -180 and +180 degrees (positive clockwise), 0 being the north line\n *\n * @function\n * @param {number} angle between 0 and 360 degrees\n * @returns {number} bearing between -180 and +180 degrees\n */\nexport function azimuthToBearing(angle: number): number {\n  // Ignore full revolutions (multiples of 360)\n  angle = angle % 360;\n\n  if (angle > 180) {\n    return angle - 360;\n  } else if (angle < -180) {\n    return angle + 360;\n  }\n\n  return angle;\n}\n\n/**\n * Converts an angle in radians to degrees\n *\n * @function\n * @param {number} radians angle in radians\n * @returns {number} degrees between 0 and 360 degrees\n */\nexport function radiansToDegrees(radians: number): number {\n  // % (2 * Math.PI) radians in case someone passes value > 2\n  const normalisedRadians = radians % (2 * Math.PI);\n  return (normalisedRadians * 180) / Math.PI;\n}\n\n/**\n * Converts an angle in degrees to radians\n *\n * @function\n * @param {number} degrees angle between 0 and 360 degrees\n * @returns {number} angle in radians\n */\nexport function degreesToRadians(degrees: number): number {\n  // % 360 degrees in case someone passes value > 360\n  const normalisedDegrees = degrees % 360;\n  return (normalisedDegrees * Math.PI) / 180;\n}\n\n/**\n * Converts a length from one unit to another.\n *\n * @function\n * @param {number} length Length to be converted\n * @param {Units} [originalUnit=\"kilometers\"] Input length unit\n * @param {Units} [finalUnit=\"kilometers\"] Returned length unit\n * @returns {number} The converted length\n */\nexport function convertLength(\n  length: number,\n  originalUnit: Units = \"kilometers\",\n  finalUnit: Units = \"kilometers\"\n): number {\n  if (!(length >= 0)) {\n    throw new Error(\"length must be a positive number\");\n  }\n  return radiansToLength(lengthToRadians(length, originalUnit), finalUnit);\n}\n\n/**\n * Converts an area from one unit to another.\n *\n * @function\n * @param {number} area Area to be converted\n * @param {AreaUnits} [originalUnit=\"meters\"] Input area unit\n * @param {AreaUnits} [finalUnit=\"kilometers\"] Returned area unit\n * @returns {number} The converted length\n */\nexport function convertArea(\n  area: number,\n  originalUnit: AreaUnits = \"meters\",\n  finalUnit: AreaUnits = \"kilometers\"\n): number {\n  if (!(area >= 0)) {\n    throw new Error(\"area must be a positive number\");\n  }\n\n  const startFactor = areaFactors[originalUnit];\n  if (!startFactor) {\n    throw new Error(\"invalid original units\");\n  }\n\n  const finalFactor = areaFactors[finalUnit];\n  if (!finalFactor) {\n    throw new Error(\"invalid final units\");\n  }\n\n  return (area / startFactor) * finalFactor;\n}\n\n/**\n * isNumber\n *\n * @function\n * @param {any} num Number to validate\n * @returns {boolean} true/false\n * @example\n * turf.isNumber(123)\n * //=true\n * turf.isNumber('foo')\n * //=false\n */\nexport function isNumber(num: any): boolean {\n  return !isNaN(num) && num !== null && !Array.isArray(num);\n}\n\n/**\n * isObject\n *\n * @function\n * @param {any} input variable to validate\n * @returns {boolean} true/false, including false for Arrays and Functions\n * @example\n * turf.isObject({elevation: 10})\n * //=true\n * turf.isObject('foo')\n * //=false\n */\nexport function isObject(input: any): boolean {\n  return input !== null && typeof input === \"object\" && !Array.isArray(input);\n}\n\n/**\n * Validate BBox\n *\n * @private\n * @param {any} bbox BBox to validate\n * @returns {void}\n * @throws {Error} if BBox is not valid\n * @example\n * validateBBox([-180, -40, 110, 50])\n * //=OK\n * validateBBox([-180, -40])\n * //=Error\n * validateBBox('Foo')\n * //=Error\n * validateBBox(5)\n * //=Error\n * validateBBox(null)\n * //=Error\n * validateBBox(undefined)\n * //=Error\n */\nexport function validateBBox(bbox: any): void {\n  if (!bbox) {\n    throw new Error(\"bbox is required\");\n  }\n  if (!Array.isArray(bbox)) {\n    throw new Error(\"bbox must be an Array\");\n  }\n  if (bbox.length !== 4 && bbox.length !== 6) {\n    throw new Error(\"bbox must be an Array of 4 or 6 numbers\");\n  }\n  bbox.forEach((num) => {\n    if (!isNumber(num)) {\n      throw new Error(\"bbox must only contain numbers\");\n    }\n  });\n}\n\n/**\n * Validate Id\n *\n * @private\n * @param {any} id Id to validate\n * @returns {void}\n * @throws {Error} if Id is not valid\n * @example\n * validateId([-180, -40, 110, 50])\n * //=Error\n * validateId([-180, -40])\n * //=Error\n * validateId('Foo')\n * //=OK\n * validateId(5)\n * //=OK\n * validateId(null)\n * //=Error\n * validateId(undefined)\n * //=Error\n */\nexport function validateId(id: any): void {\n  if (!id) {\n    throw new Error(\"id is required\");\n  }\n  if ([\"string\", \"number\"].indexOf(typeof id) === -1) {\n    throw new Error(\"id must be a number or a string\");\n  }\n}\n", "import {\n  Feature,\n  FeatureCollection,\n  LineString,\n  MultiLineString,\n  MultiPolygon,\n  Point,\n  Polygon,\n} from \"geojson\";\nimport { point } from \"@turf/helpers\";\n\n/**\n * Takes a {@link LineString|linestring}, {@link MultiLineString|multi-linestring},\n * {@link MultiPolygon|multi-polygon} or {@link Polygon|polygon} and\n * returns {@link Point|points} at all self-intersections.\n *\n * @function\n * @param {Feature<LineString|MultiLineString|MultiPolygon|Polygon>} featureIn input feature\n * @returns {FeatureCollection<Point>} self-intersections\n * @example\n * var poly = turf.polygon([[\n *   [-12.034835, 8.901183],\n *   [-12.060413, 8.899826],\n *   [-12.03638, 8.873199],\n *   [-12.059383, 8.871418],\n *   [-12.034835, 8.901183]\n * ]]);\n *\n * var kinks = turf.kinks(poly);\n *\n * //addToMap\n * var addToMap = [poly, kinks]\n */\nfunction kinks<T extends LineString | MultiLineString | Polygon | MultiPolygon>(\n  featureIn: Feature<T> | T\n): FeatureCollection<Point> {\n  let coordinates: any;\n  let feature: any;\n  const results: FeatureCollection<Point> = {\n    type: \"FeatureCollection\",\n    features: [],\n  };\n  if (featureIn.type === \"Feature\") {\n    feature = featureIn.geometry;\n  } else {\n    feature = featureIn;\n  }\n  if (feature.type === \"LineString\") {\n    coordinates = [feature.coordinates];\n  } else if (feature.type === \"MultiLineString\") {\n    coordinates = feature.coordinates;\n  } else if (feature.type === \"MultiPolygon\") {\n    coordinates = [].concat(...feature.coordinates);\n  } else if (feature.type === \"Polygon\") {\n    coordinates = feature.coordinates;\n  } else {\n    throw new Error(\n      \"Input must be a LineString, MultiLineString, \" +\n        \"Polygon, or MultiPolygon Feature or Geometry\"\n    );\n  }\n  coordinates.forEach((line1: any) => {\n    coordinates.forEach((line2: any) => {\n      for (let i = 0; i < line1.length - 1; i++) {\n        // start iteration at i, intersections for k < i have already\n        // been checked in previous outer loop iterations\n        for (let k = i; k < line2.length - 1; k++) {\n          if (line1 === line2) {\n            // segments are adjacent and always share a vertex, not a kink\n            if (Math.abs(i - k) === 1) {\n              continue;\n            }\n            // first and last segment in a closed lineString or ring always share a vertex, not a kink\n            if (\n              // segments are first and last segment of lineString\n              i === 0 &&\n              k === line1.length - 2 &&\n              // lineString is closed\n              line1[i][0] === line1[line1.length - 1][0] &&\n              line1[i][1] === line1[line1.length - 1][1]\n            ) {\n              continue;\n            }\n          }\n\n          const intersection: any = lineIntersects(\n            line1[i][0],\n            line1[i][1],\n            line1[i + 1][0],\n            line1[i + 1][1],\n            line2[k][0],\n            line2[k][1],\n            line2[k + 1][0],\n            line2[k + 1][1]\n          );\n          if (intersection) {\n            results.features.push(point([intersection[0], intersection[1]]));\n          }\n        }\n      }\n    });\n  });\n  return results;\n}\n\n// modified from http://jsfiddle.net/justin_c_rounds/Gd2S2/light/\nfunction lineIntersects(\n  line1StartX: any,\n  line1StartY: any,\n  line1EndX: any,\n  line1EndY: any,\n  line2StartX: any,\n  line2StartY: any,\n  line2EndX: any,\n  line2EndY: any\n) {\n  // if the lines intersect, the result contains the x and y of the\n  // intersection (treating the lines as infinite) and booleans for whether\n  // line segment 1 or line segment 2 contain the point\n  let denominator;\n  let a;\n  let b;\n  let numerator1;\n  let numerator2;\n  const result = {\n    x: null,\n    y: null,\n    onLine1: false,\n    onLine2: false,\n  };\n  denominator =\n    (line2EndY - line2StartY) * (line1EndX - line1StartX) -\n    (line2EndX - line2StartX) * (line1EndY - line1StartY);\n  if (denominator === 0) {\n    if (result.x !== null && result.y !== null) {\n      return result;\n    } else {\n      return false;\n    }\n  }\n  a = line1StartY - line2StartY;\n  b = line1StartX - line2StartX;\n  numerator1 = (line2EndX - line2StartX) * a - (line2EndY - line2StartY) * b;\n  numerator2 = (line1EndX - line1StartX) * a - (line1EndY - line1StartY) * b;\n  a = numerator1 / denominator;\n  b = numerator2 / denominator;\n\n  // if we cast these lines infinitely in both directions, they intersect here:\n  result.x = line1StartX + a * (line1EndX - line1StartX);\n  result.y = line1StartY + a * (line1EndY - line1StartY);\n\n  // if line1 is a segment and line2 is infinite, they intersect if:\n  if (a >= 0 && a <= 1) {\n    result.onLine1 = true;\n  }\n  // if line2 is a segment and line1 is infinite, they intersect if:\n  if (b >= 0 && b <= 1) {\n    result.onLine2 = true;\n  }\n  // if line1 and line2 are segments, they intersect if both of the above are true\n  if (result.onLine1 && result.onLine2) {\n    return [result.x, result.y];\n  } else {\n    return false;\n  }\n}\n\nexport { kinks };\nexport default kinks;\n", "import kinks from '@turf/kinks';\nimport Draw from './L.PM.Draw';\n\nimport { getTranslation } from '../helpers';\n\nDraw.Line = Draw.extend({\n  initialize(map) {\n    this._map = map;\n    this._shape = 'Line';\n    this.toolbarButtonName = 'drawPolyline';\n    this._doesSelfIntersect = false;\n  },\n  enable(options) {\n    L.Util.setOptions(this, options);\n\n    // enable draw mode\n    this._enabled = true;\n\n    this._markers = [];\n\n    // create a new layergroup\n    this._layerGroup = new L.FeatureGroup();\n    this._layerGroup._pmTempLayer = true;\n    this._layerGroup.addTo(this._map);\n\n    // this is the polyLine that'll make up the polygon\n    this._layer = L.polyline([], {\n      ...this.options.templineStyle,\n      pmIgnore: false,\n    });\n    this._setPane(this._layer, 'layerPane');\n    this._layer._pmTempLayer = true;\n    this._layerGroup.addLayer(this._layer);\n\n    // this is the hintline from the mouse cursor to the last marker\n    this._hintline = L.polyline([], this.options.hintlineStyle);\n    this._setPane(this._hintline, 'layerPane');\n    this._hintline._pmTempLayer = true;\n    this._layerGroup.addLayer(this._hintline);\n\n    // this is the hintmarker on the mouse cursor\n    this._hintMarker = L.marker(this._map.getCenter(), {\n      interactive: false, // always vertex marker below will be triggered from the click event -> _finishShape #911\n      zIndexOffset: 100,\n      icon: L.divIcon({ className: 'marker-icon cursor-marker' }),\n    });\n    this._setPane(this._hintMarker, 'vertexPane');\n    this._hintMarker._pmTempLayer = true;\n    this._layerGroup.addLayer(this._hintMarker);\n\n    // show the hintmarker if the option is set\n    if (this.options.cursorMarker) {\n      L.DomUtil.addClass(this._hintMarker._icon, 'visible');\n    }\n\n    // add tooltip to hintmarker\n    if (this.options.tooltips) {\n      this._hintMarker\n        .bindTooltip(getTranslation('tooltips.firstVertex'), {\n          permanent: true,\n          offset: L.point(0, 10),\n          direction: 'bottom',\n\n          opacity: 0.8,\n        })\n        .openTooltip();\n    }\n\n    // change map cursor\n    this._map.getContainer().classList.add('geoman-draw-cursor');\n\n    // create a polygon-point on click\n    this._map.on('click', this._createVertex, this);\n\n    // finish on layer event\n    // #http://leafletjs.com/reference.html#interactive-layer-click\n    if (this.options.finishOn && this.options.finishOn !== 'snap') {\n      this._map.on(this.options.finishOn, this._finishShape, this);\n    }\n\n    // prevent zoom on double click if finishOn is === dblclick\n    if (this.options.finishOn === 'dblclick') {\n      this.tempMapDoubleClickZoomState = this._map.doubleClickZoom._enabled;\n\n      if (this.tempMapDoubleClickZoomState) {\n        this._map.doubleClickZoom.disable();\n      }\n    }\n\n    // sync hint marker with mouse cursor\n    this._map.on('mousemove', this._syncHintMarker, this);\n\n    // sync the hintline with hint marker\n    this._hintMarker.on('move', this._syncHintLine, this);\n\n    // toggle the draw button of the Toolbar in case drawing mode got enabled without the button\n    this._map.pm.Toolbar.toggleButton(this.toolbarButtonName, true);\n\n    // an array used in the snapping mixin.\n    // TODO: think about moving this somewhere else?\n    this._otherSnapLayers = [];\n\n    // make sure intersection is not set while start drawing\n    this.isRed = false;\n\n    // fire drawstart event\n    this._fireDrawStart();\n    this._setGlobalDrawMode();\n  },\n  disable() {\n    // disable draw mode\n\n    // cancel, if drawing mode isn't even enabled\n    if (!this._enabled) {\n      return;\n    }\n\n    this._enabled = false;\n\n    // reset cursor\n    this._map.getContainer().classList.remove('geoman-draw-cursor');\n\n    // unbind listeners\n    this._map.off('click', this._createVertex, this);\n    this._map.off('mousemove', this._syncHintMarker, this);\n    if (this.options.finishOn && this.options.finishOn !== 'snap') {\n      this._map.off(this.options.finishOn, this._finishShape, this);\n    }\n\n    if (this.tempMapDoubleClickZoomState) {\n      this._map.doubleClickZoom.enable();\n    }\n\n    // remove layer\n    this._map.removeLayer(this._layerGroup);\n\n    // toggle the draw button of the Toolbar in case drawing mode got disabled without the button\n    this._map.pm.Toolbar.toggleButton(this.toolbarButtonName, false);\n\n    // cleanup snapping\n    if (this.options.snappable) {\n      this._cleanupSnapping();\n    }\n\n    // fire drawend event\n    this._fireDrawEnd();\n    this._setGlobalDrawMode();\n  },\n  enabled() {\n    return this._enabled;\n  },\n  toggle(options) {\n    if (this.enabled()) {\n      this.disable();\n    } else {\n      this.enable(options);\n    }\n  },\n  _syncHintLine() {\n    const polyPoints = this._layer.getLatLngs();\n\n    if (polyPoints.length > 0) {\n      const lastPolygonPoint = polyPoints[polyPoints.length - 1];\n\n      // set coords for hintline from marker to last vertex of drawin polyline\n      this._hintline.setLatLngs([\n        lastPolygonPoint,\n        this._hintMarker.getLatLng(),\n      ]);\n    }\n  },\n  _syncHintMarker(e) {\n    // move the cursor marker\n    this._hintMarker.setLatLng(e.latlng);\n\n    // if snapping is enabled, do it\n    if (this.options.snappable) {\n      const fakeDragEvent = e;\n      fakeDragEvent.target = this._hintMarker;\n      this._handleSnapping(fakeDragEvent);\n    } else if (this._otherSnapLayers && this._otherSnapLayers.length > 0) {\n      // Even when global snapping is disabled, allow self-snapping to the\n      // first point of the current polygon to enable shape completion\n      const fakeDragEvent = e;\n      fakeDragEvent.target = this._hintMarker;\n      this._handleSnapping(fakeDragEvent, true);\n    }\n\n    // if self-intersection is forbidden, handle it\n    if (!this.options.allowSelfIntersection) {\n      this._handleSelfIntersection(true, this._hintMarker.getLatLng());\n    }\n    const latlngs = this._layer._defaultShape().slice();\n    latlngs.push(this._hintMarker.getLatLng());\n    this._change(latlngs);\n  },\n  hasSelfIntersection() {\n    // check for self intersection of the layer and return true/false\n    const selfIntersection = kinks(this._layer.toGeoJSON(15));\n    return selfIntersection.features.length > 0;\n  },\n  _handleSelfIntersection(addVertex, latlng) {\n    // ok we need to check the self intersection here\n    // problem: during draw, the marker on the cursor is not yet part\n    // of the layer. So we need to clone the layer, add the\n    // potential new vertex (cursor markers latlngs) and check the self\n    // intersection on the clone. Phew... - let's do it \uD83D\uDCAA\n\n    // clone layer (polyline is enough, even when it's a polygon)\n    const clone = L.polyline(this._layer.getLatLngs());\n\n    if (addVertex) {\n      // get vertex from param or from hintmarker\n      if (!latlng) {\n        latlng = this._hintMarker.getLatLng();\n      }\n\n      // add the vertex\n      clone.addLatLng(latlng);\n    }\n\n    // check the self intersection\n    const selfIntersection = kinks(clone.toGeoJSON(15));\n    this._doesSelfIntersect = selfIntersection.features.length > 0;\n\n    // change the style based on self intersection\n    if (this._doesSelfIntersect) {\n      if (!this.isRed) {\n        this.isRed = true;\n        this._hintline.setStyle({\n          color: '#f00000ff',\n        });\n        // fire intersect event\n        this._fireIntersect(selfIntersection, this._map, 'Draw');\n      }\n    } else if (!this._hintline.isEmpty()) {\n      this.isRed = false;\n      this._hintline.setStyle(this.options.hintlineStyle);\n    }\n  },\n  _createVertex(e) {\n    // don't create a vertex if we have a selfIntersection and it is not allowed\n    if (!this.options.allowSelfIntersection) {\n      this._handleSelfIntersection(true, e.latlng);\n\n      if (this._doesSelfIntersect) {\n        return;\n      }\n    }\n\n    // assign the coordinate of the click to the hintMarker, that's necessary for\n    // mobile where the marker can't follow a cursor\n    if (!this._hintMarker._snapped) {\n      this._hintMarker.setLatLng(e.latlng);\n    }\n\n    // get coordinate for new vertex by hintMarker (cursor marker)\n    const latlng = this._hintMarker.getLatLng();\n\n    // check if the first and this vertex have the same latlng\n    // or the last vertex and the hintMarker have the same latlng (dbl-click)\n    const latlngs = this._layer.getLatLngs();\n\n    const lastLatLng = latlngs[latlngs.length - 1];\n    if (\n      latlng.equals(latlngs[0]) ||\n      (latlngs.length > 0 && latlng.equals(lastLatLng))\n    ) {\n      // yes? finish the polygon\n      this._finishShape();\n\n      // \"why?\", you ask? Because this happens when we snap the last vertex to the first one\n      // and then click without hitting the last marker. Click happens on the map\n      // in 99% of cases it's because the user wants to finish the polygon. So...\n      return;\n    }\n\n    this._layer._latlngInfo = this._layer._latlngInfo || [];\n    this._layer._latlngInfo.push({\n      latlng,\n      snapInfo: this._hintMarker._snapInfo,\n    });\n\n    this._layer.addLatLng(latlng);\n    const newMarker = this._createMarker(latlng);\n    this._setTooltipText();\n\n    this._setHintLineAfterNewVertex(latlng);\n\n    this._fireVertexAdded(newMarker, undefined, latlng, 'Draw');\n    this._change(this._layer.getLatLngs());\n    // check if we should finish on snap\n    if (this.options.finishOn === 'snap' && this._hintMarker._snapped) {\n      this._finishShape(e);\n    }\n  },\n  _setHintLineAfterNewVertex(hintMarkerLatLng) {\n    // make the new drawn line (with another style) visible\n    this._hintline.setLatLngs([hintMarkerLatLng, hintMarkerLatLng]);\n  },\n  _removeLastVertex() {\n    const markers = this._markers;\n\n    // if all markers are gone, cancel drawing\n    if (markers.length <= 1) {\n      this.disable();\n      return;\n    }\n\n    // remove last coords\n    let coords = this._layer.getLatLngs();\n\n    const removedMarker = markers[markers.length - 1];\n\n    // the index path to the marker inside the multidimensional marker array\n    const { indexPath } = L.PM.Utils.findDeepMarkerIndex(\n      markers,\n      removedMarker\n    );\n\n    // remove last marker from array\n    markers.pop();\n\n    // remove that marker\n    this._layerGroup.removeLayer(removedMarker);\n\n    const markerPrevious = markers[markers.length - 1];\n\n    // no need for findDeepMarkerIndex because the coords are always flat (Polyline) no matter if Line or Polygon\n    const indexMarkerPrev = coords.indexOf(markerPrevious.getLatLng());\n\n    // +1 don't cut out the previous marker\n    coords = coords.slice(0, indexMarkerPrev + 1);\n\n    // update layer with new coords\n    this._layer.setLatLngs(coords);\n    this._layer._latlngInfo.pop();\n\n    // sync the hintline again\n    this._syncHintLine();\n    this._setTooltipText();\n\n    this._fireVertexRemoved(removedMarker, indexPath, 'Draw');\n    this._change(this._layer.getLatLngs());\n  },\n  _finishShape() {\n    // if self intersection is not allowed, do not finish the shape!\n    if (!this.options.allowSelfIntersection) {\n      this._handleSelfIntersection(false);\n\n      if (this._doesSelfIntersect) {\n        return;\n      }\n    }\n\n    // If snap finish is required but the last marker wasn't snapped, do not finish the shape!\n    if (\n      this.options.requireSnapToFinish &&\n      !this._hintMarker._snapped &&\n      !this._isFirstLayer()\n    ) {\n      return;\n    }\n\n    // get coordinates\n    const coords = this._layer.getLatLngs();\n\n    // if there is only one coords, don't finish the shape!\n    if (coords.length <= 1) {\n      return;\n    }\n\n    // create the leaflet shape and add it to the map\n    const polylineLayer = L.polyline(coords, this.options.pathOptions);\n    this._setPane(polylineLayer, 'layerPane');\n    this._finishLayer(polylineLayer);\n    polylineLayer.addTo(this._map.pm._getContainingLayer());\n\n    // fire the pm:create event and pass shape and layer\n    this._fireCreate(polylineLayer);\n\n    if (this.options.snappable) {\n      this._cleanupSnapping();\n    }\n\n    const hintMarkerLatLng = this._hintMarker.getLatLng();\n\n    // disable drawing\n    this.disable();\n    if (this.options.continueDrawing) {\n      this.enable();\n      this._hintMarker.setLatLng(hintMarkerLatLng);\n    }\n  },\n  _createMarker(latlng) {\n    // create the new marker\n    const marker = new L.Marker(latlng, {\n      draggable: false,\n      icon: L.divIcon({ className: 'marker-icon' }),\n    });\n    this._setPane(marker, 'vertexPane');\n    marker._pmTempLayer = true;\n\n    // add it to the map\n    this._layerGroup.addLayer(marker);\n    this._markers.push(marker);\n\n    // a click on any marker finishes this shape\n    marker.on('click', this._finishShape, this);\n\n    return marker;\n  },\n  _setTooltipText() {\n    const { length } = this._layer.getLatLngs().flat();\n    let text = '';\n\n    // handle tooltip text\n    if (length <= 1) {\n      text = getTranslation('tooltips.continueLine');\n    } else {\n      text = getTranslation('tooltips.finishLine');\n    }\n    this._hintMarker.setTooltipContent(text);\n  },\n  _change(latlngs) {\n    this._fireChange(latlngs, 'Draw');\n  },\n  setStyle() {\n    this._layer?.setStyle(this.options.templineStyle);\n    this._hintline?.setStyle(this.options.hintlineStyle);\n  },\n});\n", "import Draw from './L.PM.Draw';\nimport { getTranslation } from '../helpers';\n\nDraw.Polygon = Draw.Line.extend({\n  initialize(map) {\n    this._map = map;\n    this._shape = 'Polygon';\n    this.toolbarButtonName = 'drawPolygon';\n  },\n  enable(options) {\n    L.PM.Draw.Line.prototype.enable.call(this, options);\n    // Overwrite the shape \"Line\" of this._layer\n    this._layer.pm._shape = 'Polygon';\n  },\n  _createMarker(latlng) {\n    // create the new marker\n    const marker = new L.Marker(latlng, {\n      draggable: false,\n      icon: L.divIcon({ className: 'marker-icon' }),\n    });\n    this._setPane(marker, 'vertexPane');\n\n    // mark this marker as temporary\n    marker._pmTempLayer = true;\n\n    // add it to the map\n    this._layerGroup.addLayer(marker);\n    this._markers.push(marker);\n\n    // if the first marker gets clicked again, finish this shape\n    if (this._layer.getLatLngs().flat().length === 1) {\n      marker.on('click', this._finishShape, this);\n\n      // add the first vertex to \"other snapping layers\" so the polygon is easier to finish\n      this._tempSnapLayerIndex = this._otherSnapLayers.push(marker) - 1;\n\n      if (this.options.snappable) {\n        this._cleanupSnapping();\n      }\n    } else {\n      // add a click event w/ no handler to the marker\n      // event won't bubble so prevents creation of identical markers in same polygon\n      // fixes issue where double click during poly creation when allowSelfIntersection: false caused it to break\n      marker.on('click', () => 1);\n    }\n\n    return marker;\n  },\n  _setTooltipText() {\n    const { length } = this._layer.getLatLngs().flat();\n    let text = '';\n\n    // handle tooltip text\n    if (length <= 2) {\n      text = getTranslation('tooltips.continueLine');\n    } else {\n      text = getTranslation('tooltips.finishPoly');\n    }\n    this._hintMarker.setTooltipContent(text);\n  },\n  _finishShape() {\n    // if self intersection is not allowed, do not finish the shape!\n    if (!this.options.allowSelfIntersection) {\n      // Check if polygon intersects when is completed and the line between the last and the first point is drawn\n      this._handleSelfIntersection(true, this._layer.getLatLngs()[0]);\n\n      if (this._doesSelfIntersect) {\n        return;\n      }\n    }\n\n    // If snap finish is required but the last marker wasn't snapped, do not finish the shape!\n    if (\n      this.options.requireSnapToFinish &&\n      !this._hintMarker._snapped &&\n      !this._isFirstLayer()\n    ) {\n      return;\n    }\n\n    // get coordinates\n    const coords = this._layer.getLatLngs();\n\n    // only finish the shape if there are 3 or more vertices\n    if (coords.length <= 2) {\n      return;\n    }\n\n    const polygonLayer = L.polygon(coords, this.options.pathOptions);\n    this._setPane(polygonLayer, 'layerPane');\n    this._finishLayer(polygonLayer);\n    polygonLayer.addTo(this._map.pm._getContainingLayer());\n\n    // fire the pm:create event and pass shape and layer\n    this._fireCreate(polygonLayer);\n\n    // clean up snapping states\n    this._cleanupSnapping();\n\n    // remove the first vertex from \"other snapping layers\"\n    this._otherSnapLayers.splice(this._tempSnapLayerIndex, 1);\n    delete this._tempSnapLayerIndex;\n\n    const hintMarkerLatLng = this._hintMarker.getLatLng();\n\n    // disable drawing\n    this.disable();\n    if (this.options.continueDrawing) {\n      this.enable();\n      this._hintMarker.setLatLng(hintMarkerLatLng);\n    }\n  },\n});\n", "import Draw from './L.PM.Draw';\nimport { fixLatOffset, getTranslation } from '../helpers';\n\nDraw.Rectangle = Draw.extend({\n  initialize(map) {\n    this._map = map;\n    this._shape = 'Rectangle';\n    this.toolbarButtonName = 'drawRectangle';\n  },\n  enable(options) {\n    // TODO: Think about if these options could be passed globally for all\n    // instances of L.PM.Draw. So a dev could set drawing style one time as some kind of config\n    L.Util.setOptions(this, options);\n\n    // enable draw mode\n    this._enabled = true;\n\n    // create a new layergroup\n    this._layerGroup = new L.FeatureGroup();\n    this._layerGroup._pmTempLayer = true;\n    this._layerGroup.addTo(this._map);\n\n    // the rectangle we want to draw\n    this._layer = L.rectangle(\n      [\n        [0, 0],\n        [0, 0],\n      ],\n      this.options.pathOptions\n    );\n    this._setPane(this._layer, 'layerPane');\n    this._layer._pmTempLayer = true;\n\n    // this is the marker at the origin of the rectangle\n    // this needs to be present, for tracking purposes, but we'll make it invisible if a user doesn't want to see it!\n    this._startMarker = L.marker(this._map.getCenter(), {\n      icon: L.divIcon({ className: 'marker-icon rect-start-marker' }),\n      draggable: false,\n      zIndexOffset: -100,\n      opacity: this.options.cursorMarker ? 1 : 0,\n    });\n    this._setPane(this._startMarker, 'vertexPane');\n    this._startMarker._pmTempLayer = true;\n    this._layerGroup.addLayer(this._startMarker);\n\n    // this is the hintmarker on the mouse cursor\n    this._hintMarker = L.marker(this._map.getCenter(), {\n      zIndexOffset: 150,\n      icon: L.divIcon({ className: 'marker-icon cursor-marker' }),\n    });\n    this._setPane(this._hintMarker, 'vertexPane');\n    this._hintMarker._pmTempLayer = true;\n    this._layerGroup.addLayer(this._hintMarker);\n\n    // show the hintmarker if the option is set\n    if (this.options.cursorMarker) {\n      L.DomUtil.addClass(this._hintMarker._icon, 'visible');\n    }\n\n    // add tooltip to hintmarker\n    if (this.options.tooltips) {\n      this._hintMarker\n        .bindTooltip(getTranslation('tooltips.firstVertex'), {\n          permanent: true,\n          offset: L.point(0, 10),\n          direction: 'bottom',\n\n          opacity: 0.8,\n        })\n        .openTooltip();\n    }\n\n    if (this.options.cursorMarker) {\n      // Add two more matching style markers, if cursor marker is rendered\n      this._styleMarkers = [];\n      for (let i = 0; i < 2; i += 1) {\n        const styleMarker = L.marker(this._map.getCenter(), {\n          icon: L.divIcon({\n            className: 'marker-icon rect-style-marker',\n          }),\n          draggable: false,\n          zIndexOffset: 100,\n        });\n        this._setPane(styleMarker, 'vertexPane');\n        styleMarker._pmTempLayer = true;\n        this._layerGroup.addLayer(styleMarker);\n\n        this._styleMarkers.push(styleMarker);\n      }\n    }\n\n    // change map cursor\n    this._map.getContainer().classList.add('geoman-draw-cursor');\n\n    // create a polygon-point on click\n    this._map.on('click', this._placeStartingMarkers, this);\n\n    // sync hint marker with mouse cursor\n    this._map.on('mousemove', this._syncHintMarker, this);\n\n    // toggle the draw button of the Toolbar in case drawing mode got enabled without the button\n    this._map.pm.Toolbar.toggleButton(this.toolbarButtonName, true);\n\n    // an array used in the snapping mixin.\n    // TODO: think about moving this somewhere else?\n    this._otherSnapLayers = [];\n\n    // fire drawstart event\n    this._fireDrawStart();\n    this._setGlobalDrawMode();\n  },\n  disable() {\n    // disable drawing mode\n\n    // cancel, if drawing mode isn't event enabled\n    if (!this._enabled) {\n      return;\n    }\n\n    this._enabled = false;\n\n    // reset cursor\n    this._map.getContainer().classList.remove('geoman-draw-cursor');\n\n    // unbind listeners\n    this._map.off('click', this._finishShape, this);\n    this._map.off('click', this._placeStartingMarkers, this);\n    this._map.off('mousemove', this._syncHintMarker, this);\n\n    // remove helping layers\n    this._map.removeLayer(this._layerGroup);\n\n    // toggle the draw button of the Toolbar in case drawing mode got disabled without the button\n    this._map.pm.Toolbar.toggleButton(this.toolbarButtonName, false);\n\n    // cleanup snapping\n    if (this.options.snappable) {\n      this._cleanupSnapping();\n    }\n    // fire drawend event\n    this._fireDrawEnd();\n    this._setGlobalDrawMode();\n  },\n  enabled() {\n    return this._enabled;\n  },\n  toggle(options) {\n    if (this.enabled()) {\n      this.disable();\n    } else {\n      this.enable(options);\n    }\n  },\n  _placeStartingMarkers(e) {\n    // assign the coordinate of the click to the hintMarker, that's necessary for\n    // mobile where the marker can't follow a cursor\n    if (!this._hintMarker._snapped) {\n      this._hintMarker.setLatLng(e.latlng);\n    }\n\n    // get coordinate for new vertex by hintMarker (cursor marker)\n    const latlng = this._hintMarker.getLatLng();\n\n    // show and place start marker\n    L.DomUtil.addClass(this._startMarker._icon, 'visible');\n    this._startMarker.setLatLng(latlng);\n\n    // if we have the other two visibilty markers, show and place them now\n    if (this.options.cursorMarker && this._styleMarkers) {\n      this._styleMarkers.forEach((styleMarker) => {\n        L.DomUtil.addClass(styleMarker._icon, 'visible');\n        styleMarker.setLatLng(latlng);\n      });\n    }\n\n    this._map.off('click', this._placeStartingMarkers, this);\n    this._map.on('click', this._finishShape, this);\n\n    // change tooltip text\n    this._hintMarker.setTooltipContent(getTranslation('tooltips.finishRect'));\n\n    this._setRectangleOrigin();\n  },\n  _setRectangleOrigin() {\n    const latlng = this._startMarker.getLatLng();\n\n    if (latlng) {\n      // show it first\n      this._layerGroup.addLayer(this._layer);\n\n      this._layer.setLatLngs([latlng, latlng]);\n\n      this._hintMarker.on('move', this._syncRectangleSize, this);\n    }\n  },\n  _syncHintMarker(e) {\n    // move the cursor marker\n    this._hintMarker.setLatLng(e.latlng);\n\n    // if snapping is enabled, do it\n    if (this.options.snappable) {\n      const fakeDragEvent = e;\n      fakeDragEvent.target = this._hintMarker;\n      this._handleSnapping(fakeDragEvent);\n    }\n\n    const latlngs =\n      this._layerGroup && this._layerGroup.hasLayer(this._layer)\n        ? this._layer.getLatLngs()\n        : [this._hintMarker.getLatLng()];\n    this._fireChange(latlngs, 'Draw');\n  },\n  _syncRectangleSize() {\n    const A = fixLatOffset(this._startMarker.getLatLng(), this._map);\n    const B = fixLatOffset(this._hintMarker.getLatLng(), this._map);\n\n    // Create a (maybe rotated) box using corners A & B (A = Starting Position, B = Current Mouse Position)\n    const corners = L.PM.Utils._getRotatedRectangle(\n      A,\n      B,\n      this.options.rectangleAngle || 0,\n      this._map\n    );\n    this._layer.setLatLngs(corners);\n\n    // Add matching style markers, if cursor marker is shown\n    if (this.options.cursorMarker && this._styleMarkers) {\n      const unmarkedCorners = [];\n\n      // Find two corners not currently occupied by starting marker and hint marker\n      corners.forEach((corner) => {\n        // the default equals margin is 1.0e-9 but in other crs projections the latlng equality can be slightly different after `_getRotatedRectangle`, so we make the precession a little bit lower\n        if (!corner.equals(A, 1.0e-8) && !corner.equals(B, 1.0e-8)) {\n          unmarkedCorners.push(corner);\n        }\n      });\n\n      // Reposition style markers\n      unmarkedCorners.forEach((unmarkedCorner, index) => {\n        try {\n          this._styleMarkers[index].setLatLng(unmarkedCorner);\n        } catch (e) {\n          // ignore error - should be fixed with the next mousemove\n        }\n      });\n    }\n  },\n  _findCorners() {\n    const latlngs = this._layer.getLatLngs()[0];\n    return L.PM.Utils._getRotatedRectangle(\n      latlngs[0],\n      latlngs[2],\n      this.options.rectangleAngle || 0,\n      this._map\n    );\n  },\n  _finishShape(e) {\n    // assign the coordinate of the click to the hintMarker, that's necessary for\n    // mobile where the marker can't follow a cursor\n    if (e?.latlng && !this._hintMarker._snapped) {\n      this._hintMarker.setLatLng(e.latlng);\n    }\n\n    // get coordinate for new vertex by hintMarker (cursor marker)\n    const B = this._hintMarker.getLatLng();\n    // get already placed corner from the startmarker\n    const A = this._startMarker.getLatLng();\n\n    // If snap finish is required but the last marker wasn't snapped, do not finish the shape!\n    if (\n      this.options.requireSnapToFinish &&\n      !this._hintMarker._snapped &&\n      !this._isFirstLayer()\n    ) {\n      return;\n    }\n\n    if (A.equals(B)) {\n      // rectangle has only one point\n      return;\n    }\n\n    // create the final rectangle layer, based on opposite corners A & B\n    const rectangleLayer = L.rectangle([A, B], this.options.pathOptions);\n\n    // rectangle can only initialized with bounds (not working with rotation) so we update the latlngs\n    if (this.options.rectangleAngle) {\n      const corners = L.PM.Utils._getRotatedRectangle(\n        A,\n        B,\n        this.options.rectangleAngle || 0,\n        this._map\n      );\n      rectangleLayer.setLatLngs(corners);\n      if (rectangleLayer.pm) {\n        rectangleLayer.pm._setAngle(this.options.rectangleAngle || 0);\n      }\n    }\n\n    this._setPane(rectangleLayer, 'layerPane');\n    this._finishLayer(rectangleLayer);\n    rectangleLayer.addTo(this._map.pm._getContainingLayer());\n\n    // fire the pm:create event and pass shape and layer\n    this._fireCreate(rectangleLayer);\n\n    const hintMarkerLatLng = this._hintMarker.getLatLng();\n\n    // disable drawing\n    this.disable();\n    if (this.options.continueDrawing) {\n      this.enable();\n      this._hintMarker.setLatLng(hintMarkerLatLng);\n    }\n  },\n  setStyle() {\n    this._layer?.setStyle(this.options.pathOptions);\n  },\n});\n", "import Draw from './L.PM.Draw';\nimport { destinationOnLine, getTranslation } from '../helpers';\n\nDraw.CircleMarker = Draw.extend({\n  initialize(map) {\n    this._map = map;\n    this._shape = 'CircleMarker';\n    this.toolbarButtonName = 'drawCircleMarker';\n    // with _layerIsDragging we check if a circlemarker is currently dragged and disable marker creation\n    this._layerIsDragging = false;\n    this._BaseCircleClass = L.CircleMarker;\n    this._minRadiusOption = 'minRadiusCircleMarker';\n    this._maxRadiusOption = 'maxRadiusCircleMarker';\n    this._editableOption = 'resizeableCircleMarker';\n    this._defaultRadius = 10;\n  },\n  enable(options) {\n    // TODO: Think about if these options could be passed globally for all\n    // instances of L.PM.Draw. So a dev could set drawing style one time as some kind of config\n    L.Util.setOptions(this, options);\n    // TODO: remove with next major release\n    if (this.options.editable) {\n      this.options.resizeableCircleMarker = this.options.editable;\n      delete this.options.editable;\n    }\n\n    // change enabled state\n    this._enabled = true;\n\n    // toggle the draw button of the Toolbar in case drawing mode got enabled without the button\n    this._map.pm.Toolbar.toggleButton(this.toolbarButtonName, true);\n\n    // change map cursor\n    this._map.getContainer().classList.add('geoman-draw-cursor');\n\n    // Draw the CircleMarker like a Circle\n    if (this.options[this._editableOption]) {\n      // we need to set the radius to 0 without overwriting the CircleMarker style\n      const templineStyle = {};\n      L.extend(templineStyle, this.options.templineStyle);\n      templineStyle.radius = 0;\n\n      // create a new layergroup\n      this._layerGroup = new L.FeatureGroup();\n      this._layerGroup._pmTempLayer = true;\n      this._layerGroup.addTo(this._map);\n\n      // this is the circle we want to draw\n      this._layer = new this._BaseCircleClass(\n        this._map.getCenter(),\n        templineStyle\n      );\n      this._setPane(this._layer, 'layerPane');\n      this._layer._pmTempLayer = true;\n\n      // this is the marker in the center of the circle\n      this._centerMarker = L.marker(this._map.getCenter(), {\n        icon: L.divIcon({ className: 'marker-icon' }),\n        draggable: false,\n        zIndexOffset: 100,\n      });\n      this._setPane(this._centerMarker, 'vertexPane');\n      this._centerMarker._pmTempLayer = true;\n\n      // this is the hintmarker on the mouse cursor\n      this._hintMarker = L.marker(this._map.getCenter(), {\n        zIndexOffset: 110,\n        icon: L.divIcon({ className: 'marker-icon cursor-marker' }),\n      });\n      this._setPane(this._hintMarker, 'vertexPane');\n      this._hintMarker._pmTempLayer = true;\n      this._layerGroup.addLayer(this._hintMarker);\n\n      // show the hintmarker if the option is set\n      if (this.options.cursorMarker) {\n        L.DomUtil.addClass(this._hintMarker._icon, 'visible');\n      }\n\n      // add tooltip to hintmarker\n      if (this.options.tooltips) {\n        this._hintMarker\n          .bindTooltip(getTranslation('tooltips.startCircle'), {\n            permanent: true,\n            offset: L.point(0, 10),\n            direction: 'bottom',\n\n            opacity: 0.8,\n          })\n          .openTooltip();\n      }\n\n      // this is the hintline from the hint marker to the center marker\n      this._hintline = L.polyline([], this.options.hintlineStyle);\n      this._setPane(this._hintline, 'layerPane');\n      this._hintline._pmTempLayer = true;\n      this._layerGroup.addLayer(this._hintline);\n      // create a polygon-point on click\n      this._map.on('click', this._placeCenterMarker, this);\n    } else {\n      // create a marker on click on the map\n      this._map.on('click', this._createMarker, this);\n\n      // this is the hintmarker on the mouse cursor\n      this._hintMarker = new this._BaseCircleClass(this._map.getCenter(), {\n        radius: this._defaultRadius,\n        ...this.options.templineStyle,\n      });\n      this._setPane(this._hintMarker, 'layerPane');\n      this._hintMarker._pmTempLayer = true;\n      this._hintMarker.addTo(this._map);\n      // this is just to keep the snappable mixin happy\n      this._layer = this._hintMarker;\n\n      // add tooltip to hintmarker\n      if (this.options.tooltips) {\n        this._hintMarker\n          .bindTooltip(getTranslation('tooltips.placeCircleMarker'), {\n            permanent: true,\n            offset: L.point(0, 10),\n            direction: 'bottom',\n\n            opacity: 0.8,\n          })\n          .openTooltip();\n      }\n    }\n\n    // sync hint marker with mouse cursor\n    this._map.on('mousemove', this._syncHintMarker, this);\n\n    this._extendingEnable();\n\n    // an array used in the snapping mixin.\n    // TODO: think about moving this somewhere else?\n    this._otherSnapLayers = [];\n\n    // fire drawstart event\n    this._fireDrawStart();\n    this._setGlobalDrawMode();\n  },\n  _extendingEnable() {\n    if (!this.options[this._editableOption] && this.options.markerEditable) {\n      // enable edit mode for existing markers\n      this._map.eachLayer((layer) => {\n        if (this.isRelevantMarker(layer)) {\n          layer.pm.enable();\n        }\n      });\n    }\n\n    // Must be named bringToBack to work with Leaflet functions.\n    this._layer.bringToBack();\n  },\n  disable() {\n    // cancel, if drawing mode isn't even enabled\n    if (!this._enabled) {\n      return;\n    }\n    // change enabled state\n    this._enabled = false;\n\n    // reset cursor\n    this._map.getContainer().classList.remove('geoman-draw-cursor');\n\n    // disable when drawing like a Circle\n    if (this.options[this._editableOption]) {\n      // unbind listeners\n      this._map.off('click', this._finishShape, this);\n      this._map.off('click', this._placeCenterMarker, this);\n\n      // remove helping layers\n      this._map.removeLayer(this._layerGroup);\n    } else {\n      // undbind click event, don't create a marker on click anymore\n      this._map.off('click', this._createMarker, this);\n\n      this._extendingDisable();\n\n      // remove hint marker\n      this._hintMarker.remove();\n    }\n\n    // remove event listener to sync hint marker\n    this._map.off('mousemove', this._syncHintMarker, this);\n\n    // toggle the draw button of the Toolbar in case drawing mode got disabled without the button\n    this._map.pm.Toolbar.toggleButton(this.toolbarButtonName, false);\n\n    // cleanup snapping\n    if (this.options.snappable) {\n      this._cleanupSnapping();\n    }\n\n    // fire drawend event\n    this._fireDrawEnd();\n    this._setGlobalDrawMode();\n  },\n  _extendingDisable() {\n    // disable dragging and removing for all markers\n    this._map.eachLayer((layer) => {\n      if (this.isRelevantMarker(layer)) {\n        layer.pm.disable();\n      }\n    });\n  },\n  enabled() {\n    return this._enabled;\n  },\n  toggle(options) {\n    if (this.enabled()) {\n      this.disable();\n    } else {\n      this.enable(options);\n    }\n  },\n  _placeCenterMarker(e) {\n    // assign the coordinate of the click to the hintMarker, that's necessary for\n    // mobile where the marker can't follow a cursor\n    if (!this._hintMarker._snapped) {\n      this._hintMarker.setLatLng(e.latlng);\n    }\n\n    this._layerGroup.addLayer(this._layer);\n    this._layerGroup.addLayer(this._centerMarker);\n\n    // get coordinate for new vertex by hintMarker (cursor marker)\n    const latlng = this._hintMarker.getLatLng();\n\n    this._centerMarker.setLatLng(latlng);\n\n    this._map.off('click', this._placeCenterMarker, this);\n    this._map.on('click', this._finishShape, this);\n\n    this._placeCircleCenter();\n  },\n  _placeCircleCenter() {\n    const latlng = this._centerMarker.getLatLng();\n\n    if (latlng) {\n      this._layer.setLatLng(latlng);\n\n      // sync the hintline with hint marker\n      this._hintMarker.on('move', this._syncHintLine, this);\n      this._hintMarker.on('move', this._syncCircleRadius, this);\n\n      this._hintMarker.setTooltipContent(\n        getTranslation('tooltips.finishCircle')\n      );\n\n      this._fireCenterPlaced();\n      this._fireChange(this._layer.getLatLng(), 'Draw');\n    }\n  },\n  _syncHintLine() {\n    const latlng = this._centerMarker.getLatLng();\n    const secondLatLng = this._getNewDestinationOfHintMarker();\n    // set coords for hintline from marker to last vertex of drawin polyline\n    this._hintline.setLatLngs([latlng, secondLatLng]);\n  },\n  _syncCircleRadius() {\n    const A = this._centerMarker.getLatLng();\n    const B = this._hintMarker.getLatLng();\n\n    const distance = this._distanceCalculation(A, B);\n\n    if (\n      this.options[this._minRadiusOption] &&\n      distance < this.options[this._minRadiusOption]\n    ) {\n      this._layer.setRadius(this.options[this._minRadiusOption]);\n    } else if (\n      this.options[this._maxRadiusOption] &&\n      distance > this.options[this._maxRadiusOption]\n    ) {\n      this._layer.setRadius(this.options[this._maxRadiusOption]);\n    } else {\n      this._layer.setRadius(distance);\n    }\n  },\n  _syncHintMarker(e) {\n    // move the cursor marker\n    this._hintMarker.setLatLng(e.latlng);\n    // calculate the new latlng of marker if radius is out of min/max\n    this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker());\n\n    // if snapping is enabled, do it\n    if (this.options.snappable) {\n      const fakeDragEvent = e;\n      fakeDragEvent.target = this._hintMarker;\n      this._handleSnapping(fakeDragEvent);\n    }\n\n    this._handleHintMarkerSnapping();\n\n    const latlng =\n      this._layerGroup && this._layerGroup.hasLayer(this._centerMarker)\n        ? this._centerMarker.getLatLng()\n        : this._hintMarker.getLatLng();\n    this._fireChange(latlng, 'Draw');\n  },\n  isRelevantMarker(layer) {\n    return (\n      layer instanceof L.CircleMarker &&\n      !(layer instanceof L.Circle) &&\n      layer.pm &&\n      !layer._pmTempLayer\n    );\n  },\n  _createMarker(e) {\n    // If snap finish is required but the last marker wasn't snapped, do not finish the shape!\n    if (\n      this.options.requireSnapToFinish &&\n      !this._hintMarker._snapped &&\n      !this._isFirstLayer()\n    ) {\n      return;\n    }\n\n    // with _layerIsDragging we check if a circlemarker is currently dragged\n    if (!e.latlng || this._layerIsDragging) {\n      return;\n    }\n\n    // assign the coordinate of the click to the hintMarker, that's necessary for\n    // mobile where the marker can't follow a cursor\n    if (!this._hintMarker._snapped) {\n      this._hintMarker.setLatLng(e.latlng);\n    }\n\n    // get coordinate for new vertex by hintMarker (cursor marker)\n    const latlng = this._hintMarker.getLatLng();\n\n    // create marker\n    const marker = new this._BaseCircleClass(latlng, {\n      radius: this._defaultRadius,\n      ...this.options.pathOptions,\n    });\n    this._setPane(marker, 'layerPane');\n    this._finishLayer(marker);\n    // add marker to the map\n    marker.addTo(this._map.pm._getContainingLayer());\n\n    this._extendingCreateMarker(marker);\n\n    // fire the pm:create event and pass shape and marker\n    this._fireCreate(marker);\n\n    this._cleanupSnapping();\n\n    if (!this.options.continueDrawing) {\n      this.disable();\n    }\n  },\n  _extendingCreateMarker(marker) {\n    if (marker.pm && this.options.markerEditable) {\n      // enable editing for the marker\n      marker.pm.enable();\n    }\n  },\n  _finishShape(e) {\n    // If snap finish is required but the last marker wasn't snapped, do not finish the shape!\n    if (\n      this.options.requireSnapToFinish &&\n      !this._hintMarker._snapped &&\n      !this._isFirstLayer()\n    ) {\n      return;\n    }\n\n    // assign the coordinate of the click to the hintMarker, that's necessary for\n    // mobile where the marker can't follow a cursor\n    if (e?.latlng && !this._hintMarker._snapped) {\n      this._hintMarker.setLatLng(e.latlng);\n    }\n\n    const center = this._centerMarker.getLatLng();\n    let radius = this._defaultRadius;\n    if (this.options[this._editableOption]) {\n      // calc the radius\n      const latlng = this._hintMarker.getLatLng();\n      radius = this._distanceCalculation(center, latlng);\n      if (\n        this.options[this._minRadiusOption] &&\n        radius < this.options[this._minRadiusOption]\n      ) {\n        radius = this.options[this._minRadiusOption];\n      } else if (\n        this.options[this._maxRadiusOption] &&\n        radius > this.options[this._maxRadiusOption]\n      ) {\n        radius = this.options[this._maxRadiusOption];\n      }\n    }\n\n    const options = { ...this.options.pathOptions, radius };\n\n    // create the final circle layer\n    const circleLayer = new this._BaseCircleClass(center, options);\n    this._setPane(circleLayer, 'layerPane');\n    this._finishLayer(circleLayer);\n    circleLayer.addTo(this._map.pm._getContainingLayer());\n\n    if (circleLayer.pm) {\n      // create polygon around the circle border\n      circleLayer.pm._updateHiddenPolyCircle();\n    }\n\n    // fire the pm:create event and pass shape and layer\n    this._fireCreate(circleLayer);\n\n    const hintMarkerLatLng = this._hintMarker.getLatLng();\n\n    // disable drawing\n    this.disable();\n    if (this.options.continueDrawing) {\n      this.enable();\n      this._hintMarker.setLatLng(hintMarkerLatLng);\n    }\n  },\n  _getNewDestinationOfHintMarker() {\n    let secondLatLng = this._hintMarker.getLatLng();\n    if (this.options[this._editableOption]) {\n      if (!this._layerGroup.hasLayer(this._centerMarker)) {\n        return secondLatLng;\n      }\n\n      const latlng = this._centerMarker.getLatLng();\n\n      const distance = this._distanceCalculation(latlng, secondLatLng);\n\n      if (\n        this.options[this._minRadiusOption] &&\n        distance < this.options[this._minRadiusOption]\n      ) {\n        secondLatLng = destinationOnLine(\n          this._map,\n          latlng,\n          secondLatLng,\n          this._getMinDistanceInMeter()\n        );\n      } else if (\n        this.options[this._maxRadiusOption] &&\n        distance > this.options[this._maxRadiusOption]\n      ) {\n        secondLatLng = destinationOnLine(\n          this._map,\n          latlng,\n          secondLatLng,\n          this._getMaxDistanceInMeter()\n        );\n      }\n    }\n    return secondLatLng;\n  },\n  _getMinDistanceInMeter() {\n    return L.PM.Utils.pxRadiusToMeterRadius(\n      this.options[this._minRadiusOption],\n      this._map,\n      this._centerMarker.getLatLng()\n    );\n  },\n  _getMaxDistanceInMeter() {\n    return L.PM.Utils.pxRadiusToMeterRadius(\n      this.options[this._maxRadiusOption],\n      this._map,\n      this._centerMarker.getLatLng()\n    );\n  },\n  _handleHintMarkerSnapping() {\n    if (this.options[this._editableOption]) {\n      if (this._hintMarker._snapped) {\n        const latlng = this._centerMarker.getLatLng();\n        const secondLatLng = this._hintMarker.getLatLng();\n        const distance = this._distanceCalculation(latlng, secondLatLng);\n\n        if (!this._layerGroup.hasLayer(this._centerMarker)) {\n          // do nothing\n        } else if (\n          this.options[this._minRadiusOption] &&\n          distance < this.options[this._minRadiusOption]\n        ) {\n          this._hintMarker.setLatLng(this._hintMarker._orgLatLng);\n        } else if (\n          this.options[this._maxRadiusOption] &&\n          distance > this.options[this._maxRadiusOption]\n        ) {\n          this._hintMarker.setLatLng(this._hintMarker._orgLatLng);\n        }\n      }\n      // calculate the new latlng of marker if the snapped latlng radius is out of min/max\n      this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker());\n    }\n  },\n  setStyle() {\n    const templineStyle = {};\n    L.extend(templineStyle, this.options.templineStyle);\n    if (this.options[this._editableOption]) {\n      templineStyle.radius = 0;\n    }\n    this._layer?.setStyle(templineStyle);\n    this._hintline?.setStyle(this.options.hintlineStyle);\n  },\n  _distanceCalculation(A, B) {\n    return this._map.project(A).distanceTo(this._map.project(B));\n  },\n});\n", "import Draw from './L.PM.Draw';\n\nDraw.Circle = Draw.CircleMarker.extend({\n  initialize(map) {\n    this._map = map;\n    this._shape = 'Circle';\n    this.toolbarButtonName = 'drawCircle';\n    this._BaseCircleClass = L.Circle;\n    this._minRadiusOption = 'minRadiusCircle';\n    this._maxRadiusOption = 'maxRadiusCircle';\n    this._editableOption = 'resizeableCircle';\n    this._defaultRadius = 100;\n  },\n  _extendingEnable() {},\n  _extendingDisable() {},\n  _extendingCreateMarker() {},\n  isRelevantMarker() {},\n  _getMinDistanceInMeter() {\n    return this.options[this._minRadiusOption];\n  },\n  _getMaxDistanceInMeter() {\n    return this.options[this._maxRadiusOption];\n  },\n  _distanceCalculation(A, B) {\n    return this._map.distance(A, B);\n  },\n});\n", "class TinyQueue {\n    constructor(data = [], compare = defaultCompare) {\n        this.data = data;\n        this.length = this.data.length;\n        this.compare = compare;\n\n        if (this.length > 0) {\n            for (let i = (this.length >> 1) - 1; i >= 0; i--) this._down(i);\n        }\n    }\n\n    push(item) {\n        this.data.push(item);\n        this.length++;\n        this._up(this.length - 1);\n    }\n\n    pop() {\n        if (this.length === 0) return undefined;\n\n        const top = this.data[0];\n        const bottom = this.data.pop();\n        this.length--;\n\n        if (this.length > 0) {\n            this.data[0] = bottom;\n            this._down(0);\n        }\n\n        return top;\n    }\n\n    peek() {\n        return this.data[0];\n    }\n\n    _up(pos) {\n        const {data, compare} = this;\n        const item = data[pos];\n\n        while (pos > 0) {\n            const parent = (pos - 1) >> 1;\n            const current = data[parent];\n            if (compare(item, current) >= 0) break;\n            data[pos] = current;\n            pos = parent;\n        }\n\n        data[pos] = item;\n    }\n\n    _down(pos) {\n        const {data, compare} = this;\n        const halfLength = this.length >> 1;\n        const item = data[pos];\n\n        while (pos < halfLength) {\n            let left = (pos << 1) + 1;\n            let best = data[left];\n            const right = left + 1;\n\n            if (right < this.length && compare(data[right], best) < 0) {\n                left = right;\n                best = data[right];\n            }\n            if (compare(best, item) >= 0) break;\n\n            data[pos] = best;\n            pos = left;\n        }\n\n        data[pos] = item;\n    }\n}\n\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nfunction checkWhichEventIsLeft (e1, e2) {\n    if (e1.p.x > e2.p.x) return 1\n    if (e1.p.x < e2.p.x) return -1\n\n    if (e1.p.y !== e2.p.y) return e1.p.y > e2.p.y ? 1 : -1\n    return 1\n}\n\nfunction checkWhichSegmentHasRightEndpointFirst (seg1, seg2) {\n    if (seg1.rightSweepEvent.p.x > seg2.rightSweepEvent.p.x) return 1\n    if (seg1.rightSweepEvent.p.x < seg2.rightSweepEvent.p.x) return -1\n\n    if (seg1.rightSweepEvent.p.y !== seg2.rightSweepEvent.p.y) return seg1.rightSweepEvent.p.y < seg2.rightSweepEvent.p.y ? 1 : -1\n    return 1\n}\n\nclass Event {\n\n    constructor (p, featureId, ringId, eventId) {\n        this.p = {\n            x: p[0],\n            y: p[1]\n        };\n        this.featureId = featureId;\n        this.ringId = ringId;\n        this.eventId = eventId;\n\n        this.otherEvent = null;\n        this.isLeftEndpoint = null;\n    }\n\n    isSamePoint (eventToCheck) {\n        return this.p.x === eventToCheck.p.x && this.p.y === eventToCheck.p.y\n    }\n}\n\nfunction fillEventQueue (geojson, eventQueue) {\n    if (geojson.type === 'FeatureCollection') {\n        const features = geojson.features;\n        for (let i = 0; i < features.length; i++) {\n            processFeature(features[i], eventQueue);\n        }\n    } else {\n        processFeature(geojson, eventQueue);\n    }\n}\n\nlet featureId = 0;\nlet ringId = 0;\nlet eventId = 0;\nfunction processFeature (featureOrGeometry, eventQueue) {\n    const geom = featureOrGeometry.type === 'Feature' ? featureOrGeometry.geometry : featureOrGeometry;\n    let coords = geom.coordinates;\n    // standardise the input\n    if (geom.type === 'Polygon' || geom.type === 'MultiLineString') coords = [coords];\n    if (geom.type === 'LineString') coords = [[coords]];\n\n    for (let i = 0; i < coords.length; i++) {\n        for (let ii = 0; ii < coords[i].length; ii++) {\n            let currentP = coords[i][ii][0];\n            let nextP = null;\n            ringId = ringId + 1;\n            for (let iii = 0; iii < coords[i][ii].length - 1; iii++) {\n                nextP = coords[i][ii][iii + 1];\n\n                const e1 = new Event(currentP, featureId, ringId, eventId);\n                const e2 = new Event(nextP, featureId, ringId, eventId + 1);\n\n                e1.otherEvent = e2;\n                e2.otherEvent = e1;\n\n                if (checkWhichEventIsLeft(e1, e2) > 0) {\n                    e2.isLeftEndpoint = true;\n                    e1.isLeftEndpoint = false;\n                } else {\n                    e1.isLeftEndpoint = true;\n                    e2.isLeftEndpoint = false;\n                }\n                eventQueue.push(e1);\n                eventQueue.push(e2);\n\n                currentP = nextP;\n                eventId = eventId + 1;\n            }\n        }\n    }\n    featureId = featureId + 1;\n}\n\nclass Segment {\n\n    constructor (event) {\n        this.leftSweepEvent = event;\n        this.rightSweepEvent = event.otherEvent;\n    }\n}\n\nfunction testSegmentIntersect (seg1, seg2) {\n    if (seg1 === null || seg2 === null) return false\n\n    if (seg1.leftSweepEvent.ringId === seg2.leftSweepEvent.ringId &&\n        (seg1.rightSweepEvent.isSamePoint(seg2.leftSweepEvent) ||\n        seg1.rightSweepEvent.isSamePoint(seg2.leftSweepEvent) ||\n        seg1.rightSweepEvent.isSamePoint(seg2.rightSweepEvent) ||\n        seg1.leftSweepEvent.isSamePoint(seg2.leftSweepEvent) ||\n        seg1.leftSweepEvent.isSamePoint(seg2.rightSweepEvent))) return false\n\n    const x1 = seg1.leftSweepEvent.p.x;\n    const y1 = seg1.leftSweepEvent.p.y;\n    const x2 = seg1.rightSweepEvent.p.x;\n    const y2 = seg1.rightSweepEvent.p.y;\n    const x3 = seg2.leftSweepEvent.p.x;\n    const y3 = seg2.leftSweepEvent.p.y;\n    const x4 = seg2.rightSweepEvent.p.x;\n    const y4 = seg2.rightSweepEvent.p.y;\n\n    const denom = ((y4 - y3) * (x2 - x1)) - ((x4 - x3) * (y2 - y1));\n    const numeA = ((x4 - x3) * (y1 - y3)) - ((y4 - y3) * (x1 - x3));\n    const numeB = ((x2 - x1) * (y1 - y3)) - ((y2 - y1) * (x1 - x3));\n\n    if (denom === 0) {\n        if (numeA === 0 && numeB === 0) return false\n        return false\n    }\n\n    const uA = numeA / denom;\n    const uB = numeB / denom;\n\n    if (uA >= 0 && uA <= 1 && uB >= 0 && uB <= 1) {\n        const x = x1 + (uA * (x2 - x1));\n        const y = y1 + (uA * (y2 - y1));\n        return [x, y]\n    }\n    return false\n}\n\n// import {debugEventAndSegments, debugRemovingSegment} from './debug'\n\nfunction runCheck (eventQueue, ignoreSelfIntersections) {\n    ignoreSelfIntersections = ignoreSelfIntersections ? ignoreSelfIntersections : false;\n\n    const intersectionPoints = [];\n    const outQueue = new TinyQueue([], checkWhichSegmentHasRightEndpointFirst);\n\n    while (eventQueue.length) {\n        const event = eventQueue.pop();\n        if (event.isLeftEndpoint) {\n            // debugEventAndSegments(event.p, outQueue.data)\n            const segment = new Segment(event);\n            for (let i = 0; i < outQueue.data.length; i++) {\n                const otherSeg = outQueue.data[i];\n                if (ignoreSelfIntersections) {\n                    if (otherSeg.leftSweepEvent.featureId === event.featureId) continue\n                }\n                const intersection = testSegmentIntersect(segment, otherSeg);\n                if (intersection !== false) intersectionPoints.push(intersection);\n            }\n            outQueue.push(segment);\n        } else if (event.isLeftEndpoint === false) {\n            outQueue.pop();\n            // const seg = outQueue.pop()\n            // debugRemovingSegment(event.p, seg)\n        }\n    }\n    return intersectionPoints\n}\n\nfunction sweeplineIntersections (geojson, ignoreSelfIntersections) {\n    const eventQueue = new TinyQueue([], checkWhichEventIsLeft);\n    fillEventQueue(geojson, eventQueue);\n    return runCheck(eventQueue, ignoreSelfIntersections)\n}\n\nexport default sweeplineIntersections;\n", "import { feature, featureCollection, point } from \"@turf/helpers\";\nimport {\n  Feature,\n  FeatureCollection,\n  LineString,\n  MultiLineString,\n  MultiPolygon,\n  Point,\n  Polygon,\n} from \"geojson\";\nimport type { Intersection } from \"sweepline-intersections\";\nimport { sweeplineIntersections as findIntersections } from \"./lib/sweepline-intersections-export.js\";\n\n/**\n * Takes any LineString or Polygon GeoJSON and returns the intersecting point(s).\n *\n * @function\n * @param {GeoJSON} line1 any LineString or Polygon\n * @param {GeoJSON} line2 any LineString or Polygon\n * @param {Object} [options={}] Optional parameters\n * @param {boolean} [options.removeDuplicates=true] remove duplicate intersections\n * @param {boolean} [options.ignoreSelfIntersections=true] ignores self-intersections on input features\n * @returns {FeatureCollection<Point>} point(s) that intersect both\n * @example\n * var line1 = turf.lineString([[126, -11], [129, -21]]);\n * var line2 = turf.lineString([[123, -18], [131, -14]]);\n * var intersects = turf.lineIntersect(line1, line2);\n *\n * //addToMap\n * var addToMap = [line1, line2, intersects]\n */\nfunction lineIntersect<\n  G1 extends LineString | MultiLineString | Polygon | MultiPolygon,\n  G2 extends LineString | MultiLineString | Polygon | MultiPolygon,\n>(\n  line1: FeatureCollection<G1> | Feature<G1> | G1,\n  line2: FeatureCollection<G2> | Feature<G2> | G2,\n  options: {\n    removeDuplicates?: boolean;\n    ignoreSelfIntersections?: boolean;\n  } = {}\n): FeatureCollection<Point> {\n  const { removeDuplicates = true, ignoreSelfIntersections = true } = options;\n  let features: Feature<G1 | G2>[] = [];\n  if (line1.type === \"FeatureCollection\")\n    features = features.concat(line1.features);\n  else if (line1.type === \"Feature\") features.push(line1);\n  else if (\n    line1.type === \"LineString\" ||\n    line1.type === \"Polygon\" ||\n    line1.type === \"MultiLineString\" ||\n    line1.type === \"MultiPolygon\"\n  ) {\n    features.push(feature(line1));\n  }\n\n  if (line2.type === \"FeatureCollection\")\n    features = features.concat(line2.features);\n  else if (line2.type === \"Feature\") features.push(line2);\n  else if (\n    line2.type === \"LineString\" ||\n    line2.type === \"Polygon\" ||\n    line2.type === \"MultiLineString\" ||\n    line2.type === \"MultiPolygon\"\n  ) {\n    features.push(feature(line2));\n  }\n\n  const intersections = findIntersections(\n    featureCollection(features),\n    ignoreSelfIntersections\n  );\n\n  let results: Intersection[] = [];\n  if (removeDuplicates) {\n    const unique: Record<string, boolean> = {};\n    intersections.forEach((intersection) => {\n      const key = intersection.join(\",\");\n      if (!unique[key]) {\n        unique[key] = true;\n        results.push(intersection);\n      }\n    });\n  } else {\n    results = intersections;\n  }\n  return featureCollection(results.map((r) => point(r)));\n}\n\nexport { lineIntersect };\nexport default lineIntersect;\n", "// Get around problems with moduleResolution node16 and some older libraries.\n// Manifests as \"This expression is not callable ... has no call signatures\"\n// https://stackoverflow.com/a/74709714\n\nimport lib from \"sweepline-intersections\";\n\nexport const sweeplineIntersections = lib as unknown as typeof lib.default;\n", "import rbush from \"rbush\";\nimport { featureCollection } from \"@turf/helpers\";\nimport { featureEach } from \"@turf/meta\";\nimport { bbox as turfBBox } from \"@turf/bbox\";\nimport {\n  BBox,\n  Feature,\n  FeatureCollection,\n  GeoJsonProperties,\n  Geometry,\n} from \"geojson\";\n\n/**\n * @module rbush\n */\n\n/**\n * Converts GeoJSON to {minX, minY, maxX, maxY} schema\n *\n * @memberof rbush\n * @private\n * @param {BBox|FeatureCollection|Feature} geojson feature(s) to retrieve BBox from\n * @returns {Object} converted to {minX, minY, maxX, maxY}\n */\nfunction toBBox(geojson: BBox | FeatureCollection | Feature) {\n  var bbox;\n  if ((geojson as any).bbox) bbox = (geojson as any).bbox;\n  else if (Array.isArray(geojson) && geojson.length === 4) bbox = geojson;\n  else if (Array.isArray(geojson) && geojson.length === 6)\n    bbox = [geojson[0], geojson[1], geojson[3], geojson[4]];\n  else if (geojson.type === \"Feature\") bbox = turfBBox(geojson);\n  else if (geojson.type === \"FeatureCollection\") bbox = turfBBox(geojson);\n  else throw new Error(\"invalid geojson\");\n\n  return {\n    minX: bbox[0],\n    minY: bbox[1],\n    maxX: bbox[2],\n    maxY: bbox[3],\n  };\n}\n\nclass RBush<G extends Geometry, P extends GeoJsonProperties> {\n  private tree: rbush<Feature<G, P>>;\n\n  constructor(maxEntries = 9) {\n    this.tree = new rbush<Feature<G, P>>(maxEntries);\n    // When we load features into the underlying rbush instance, it has to be able to correctly\n    // handle GeoJSON bbox values while inserting into the data structure. The rest of the API\n    // can just be a passthrough wrapping class.\n    this.tree.toBBox = toBBox;\n  }\n\n  /**\n   * [insert](https://github.com/mourner/rbush#data-format)\n   *\n   * @memberof rbush\n   * @param {Feature} feature insert single GeoJSON Feature\n   * @returns {RBush} GeoJSON RBush\n   * @example\n   * var poly = turf.polygon([[[-78, 41], [-67, 41], [-67, 48], [-78, 48], [-78, 41]]]);\n   * tree.insert(poly)\n   */\n  insert(feature: Feature<G, P>): RBush<G, P> {\n    if (feature.type !== \"Feature\") throw new Error(\"invalid feature\");\n    feature.bbox = feature.bbox ? feature.bbox : turfBBox(feature);\n    this.tree.insert(feature);\n    return this;\n  }\n\n  /**\n   * [load](https://github.com/mourner/rbush#bulk-inserting-data)\n   *\n   * @memberof rbush\n   * @param {FeatureCollection|Array<Feature>} features load entire GeoJSON FeatureCollection\n   * @returns {RBush} GeoJSON RBush\n   * @example\n   * var polys = turf.polygons([\n   *     [[[-78, 41], [-67, 41], [-67, 48], [-78, 48], [-78, 41]]],\n   *     [[[-93, 32], [-83, 32], [-83, 39], [-93, 39], [-93, 32]]]\n   * ]);\n   * tree.load(polys);\n   */\n  load(features: FeatureCollection<G, P> | Feature<G, P>[]): RBush<G, P> {\n    var load: Feature<G, P>[] = [];\n    // Load an Array of Features\n    if (Array.isArray(features)) {\n      features.forEach(function (feature) {\n        if (feature.type !== \"Feature\") throw new Error(\"invalid features\");\n        feature.bbox = feature.bbox ? feature.bbox : turfBBox(feature);\n        load.push(feature);\n      });\n    } else {\n      // Load a FeatureCollection\n      featureEach(features, function (feature) {\n        if (feature.type !== \"Feature\") throw new Error(\"invalid features\");\n        feature.bbox = feature.bbox ? feature.bbox : turfBBox(feature);\n        load.push(feature);\n      });\n    }\n    this.tree.load(load);\n    return this;\n  }\n\n  /**\n   * [remove](https://github.com/mourner/rbush#removing-data)\n   *\n   * @memberof rbush\n   * @param {Feature} feature remove single GeoJSON Feature\n   * @param {Function} equals Pass a custom equals function to compare by value for removal.\n   * @returns {RBush} GeoJSON RBush\n   * @example\n   * var poly = turf.polygon([[[-78, 41], [-67, 41], [-67, 48], [-78, 48], [-78, 41]]]);\n   *\n   * tree.remove(poly);\n   */\n  remove(\n    feature: Feature<G, P>,\n    equals?: (a: Feature<G, P>, b: Feature<G, P>) => boolean\n  ) {\n    if (feature.type !== \"Feature\") throw new Error(\"invalid feature\");\n    feature.bbox = feature.bbox ? feature.bbox : turfBBox(feature);\n    this.tree.remove(feature, equals);\n    return this;\n  }\n\n  /**\n   * [clear](https://github.com/mourner/rbush#removing-data)\n   *\n   * @memberof rbush\n   * @returns {RBush} GeoJSON Rbush\n   * @example\n   * tree.clear()\n   */\n  clear() {\n    this.tree.clear();\n    return this;\n  }\n\n  /**\n   * [search](https://github.com/mourner/rbush#search)\n   *\n   * @memberof rbush\n   * @param {BBox|FeatureCollection|Feature} geojson search with GeoJSON\n   * @returns {FeatureCollection} all features that intersects with the given GeoJSON.\n   * @example\n   * var poly = turf.polygon([[[-78, 41], [-67, 41], [-67, 48], [-78, 48], [-78, 41]]]);\n   *\n   * tree.search(poly);\n   */\n  search(geojson: Feature | FeatureCollection | BBox): FeatureCollection<G, P> {\n    var features = this.tree.search(toBBox(geojson));\n    return featureCollection(features);\n  }\n\n  /**\n   * [collides](https://github.com/mourner/rbush#collisions)\n   *\n   * @memberof rbush\n   * @param {BBox|FeatureCollection|Feature} geojson collides with GeoJSON\n   * @returns {boolean} true if there are any items intersecting the given GeoJSON, otherwise false.\n   * @example\n   * var poly = turf.polygon([[[-78, 41], [-67, 41], [-67, 48], [-78, 48], [-78, 41]]]);\n   *\n   * tree.collides(poly);\n   */\n  collides(geojson: Feature | FeatureCollection | BBox): boolean {\n    return this.tree.collides(toBBox(geojson));\n  }\n\n  /**\n   * [all](https://github.com/mourner/rbush#search)\n   *\n   * @memberof rbush\n   * @returns {FeatureCollection} all the features in RBush\n   * @example\n   * tree.all()\n   */\n  all() {\n    const features = this.tree.all();\n    return featureCollection(features);\n  }\n\n  /**\n   * [toJSON](https://github.com/mourner/rbush#export-and-import)\n   *\n   * @memberof rbush\n   * @returns {any} export data as JSON object\n   * @example\n   * var exported = tree.toJSON()\n   */\n  toJSON() {\n    return this.tree.toJSON();\n  }\n\n  /**\n   * [fromJSON](https://github.com/mourner/rbush#export-and-import)\n   *\n   * @memberof rbush\n   * @param {any} json import previously exported data\n   * @returns {RBush} GeoJSON RBush\n   * @example\n   * var exported = {\n   *   \"children\": [\n   *     {\n   *       \"type\": \"Feature\",\n   *       \"geometry\": {\n   *         \"type\": \"Point\",\n   *         \"coordinates\": [110, 50]\n   *       },\n   *       \"properties\": {},\n   *       \"bbox\": [110, 50, 110, 50]\n   *     }\n   *   ],\n   *   \"height\": 1,\n   *   \"leaf\": true,\n   *   \"minX\": 110,\n   *   \"minY\": 50,\n   *   \"maxX\": 110,\n   *   \"maxY\": 50\n   * }\n   * tree.fromJSON(exported)\n   */\n  fromJSON(json: any): RBush<G, P> {\n    this.tree.fromJSON(json);\n    return this;\n  }\n}\n\n/**\n * GeoJSON implementation of [RBush](https://github.com/mourner/rbush#rbush) spatial index.\n *\n * @function rbush\n * @param {number} [maxEntries=9] defines the maximum number of entries in a tree node. 9 (used by default) is a\n * reasonable choice for most applications. Higher value means faster insertion and slower search, and vice versa.\n * @returns {RBush} GeoJSON RBush\n * @example\n * var geojsonRbush = require('geojson-rbush').default;\n * var tree = geojsonRbush();\n */\nfunction geojsonRbush<\n  G extends Geometry,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(maxEntries?: number) {\n  return new RBush<G, P>(maxEntries);\n}\n\nexport { geojsonRbush };\nexport default geojsonRbush;\n", "import { feature, point, lineString, isObject } from \"@turf/helpers\";\nimport {\n  Point,\n  LineString,\n  Polygon,\n  MultiLineString,\n  MultiPolygon,\n  FeatureCollection,\n  Feature,\n  Geometry,\n  GeometryObject,\n  GeometryCollection,\n  GeoJsonProperties,\n  BBox,\n  GeoJsonTypes,\n} from \"geojson\";\nimport { AllGeoJSON, Lines, Id } from \"@turf/helpers\";\n\n/**\n * Callback for coordEach\n *\n * @callback coordEachCallback\n * @param {number[]} currentCoord The current coordinate being processed.\n * @param {number} coordIndex The current index of the coordinate being processed.\n * @param {number} featureIndex The current index of the Feature being processed.\n * @param {number} multiFeatureIndex The current index of the Multi-Feature being processed.\n * @param {number} geometryIndex The current index of the Geometry being processed.\n * @returns {void}\n */\n\n/**\n * Iterate over coordinates in any GeoJSON object, similar to Array.forEach()\n *\n * @function\n * @param {AllGeoJSON} geojson any GeoJSON object\n * @param {coordEachCallback} callback a method that takes (currentCoord, coordIndex, featureIndex, multiFeatureIndex)\n * @param {boolean} [excludeWrapCoord=false] whether or not to include the final coordinate of LinearRings that wraps the ring in its iteration.\n * @returns {void}\n * @example\n * var features = turf.featureCollection([\n *   turf.point([26, 37], {\"foo\": \"bar\"}),\n *   turf.point([36, 53], {\"hello\": \"world\"})\n * ]);\n *\n * turf.coordEach(features, function (currentCoord, coordIndex, featureIndex, multiFeatureIndex, geometryIndex) {\n *   //=currentCoord\n *   //=coordIndex\n *   //=featureIndex\n *   //=multiFeatureIndex\n *   //=geometryIndex\n * });\n */\nfunction coordEach(\n  geojson: AllGeoJSON,\n  callback: (\n    currentCoord: number[],\n    coordIndex: number,\n    featureIndex: number,\n    multiFeatureIndex: number,\n    geometryIndex: number\n  ) => void,\n  excludeWrapCoord?: boolean\n): void {\n  // Handles null Geometry -- Skips this GeoJSON\n  if (geojson === null) return;\n  var j,\n    k,\n    l,\n    geometry,\n    stopG,\n    coords,\n    geometryMaybeCollection,\n    wrapShrink = 0,\n    coordIndex = 0,\n    isGeometryCollection,\n    type = geojson.type,\n    isFeatureCollection = type === \"FeatureCollection\",\n    isFeature = type === \"Feature\",\n    // @ts-expect-error: Known type conflict\n    stop = isFeatureCollection ? geojson.features.length : 1;\n\n  // This logic may look a little weird. The reason why it is that way\n  // is because it's trying to be fast. GeoJSON supports multiple kinds\n  // of objects at its root: FeatureCollection, Features, Geometries.\n  // This function has the responsibility of handling all of them, and that\n  // means that some of the `for` loops you see below actually just don't apply\n  // to certain inputs. For instance, if you give this just a\n  // Point geometry, then both loops are short-circuited and all we do\n  // is gradually rename the input until it's called 'geometry'.\n  //\n  // This also aims to allocate as few resources as possible: just a\n  // few numbers and booleans, rather than any temporary arrays as would\n  // be required with the normalization approach.\n  for (var featureIndex = 0; featureIndex < stop; featureIndex++) {\n    geometryMaybeCollection = isFeatureCollection\n      ? // @ts-expect-error: Known type conflict\n        geojson.features[featureIndex].geometry\n      : isFeature\n        ? // @ts-expect-error: Known type conflict\n          geojson.geometry\n        : geojson;\n    isGeometryCollection = geometryMaybeCollection\n      ? geometryMaybeCollection.type === \"GeometryCollection\"\n      : false;\n    stopG = isGeometryCollection\n      ? geometryMaybeCollection.geometries.length\n      : 1;\n\n    for (var geomIndex = 0; geomIndex < stopG; geomIndex++) {\n      var multiFeatureIndex = 0;\n      var geometryIndex = 0;\n      geometry = isGeometryCollection\n        ? geometryMaybeCollection.geometries[geomIndex]\n        : geometryMaybeCollection;\n\n      // Handles null Geometry -- Skips this geometry\n      if (geometry === null) continue;\n      coords = geometry.coordinates;\n      var geomType = geometry.type;\n\n      wrapShrink =\n        excludeWrapCoord &&\n        (geomType === \"Polygon\" || geomType === \"MultiPolygon\")\n          ? 1\n          : 0;\n\n      switch (geomType) {\n        case null:\n          break;\n        case \"Point\":\n          if (\n            // @ts-expect-error: Known type conflict\n            callback(\n              coords,\n              coordIndex,\n              featureIndex,\n              multiFeatureIndex,\n              geometryIndex\n            ) === false\n          )\n            // @ts-expect-error: Known type conflict\n            return false;\n          coordIndex++;\n          multiFeatureIndex++;\n          break;\n        case \"LineString\":\n        case \"MultiPoint\":\n          for (j = 0; j < coords.length; j++) {\n            if (\n              // @ts-expect-error: Known type conflict\n              callback(\n                coords[j],\n                coordIndex,\n                featureIndex,\n                multiFeatureIndex,\n                geometryIndex\n              ) === false\n            )\n              // @ts-expect-error: Known type conflict\n              return false;\n            coordIndex++;\n            if (geomType === \"MultiPoint\") multiFeatureIndex++;\n          }\n          if (geomType === \"LineString\") multiFeatureIndex++;\n          break;\n        case \"Polygon\":\n        case \"MultiLineString\":\n          for (j = 0; j < coords.length; j++) {\n            for (k = 0; k < coords[j].length - wrapShrink; k++) {\n              if (\n                // @ts-expect-error: Known type conflict\n                callback(\n                  coords[j][k],\n                  coordIndex,\n                  featureIndex,\n                  multiFeatureIndex,\n                  geometryIndex\n                ) === false\n              )\n                // @ts-expect-error: Known type conflict\n                return false;\n              coordIndex++;\n            }\n            if (geomType === \"MultiLineString\") multiFeatureIndex++;\n            if (geomType === \"Polygon\") geometryIndex++;\n          }\n          if (geomType === \"Polygon\") multiFeatureIndex++;\n          break;\n        case \"MultiPolygon\":\n          for (j = 0; j < coords.length; j++) {\n            geometryIndex = 0;\n            for (k = 0; k < coords[j].length; k++) {\n              for (l = 0; l < coords[j][k].length - wrapShrink; l++) {\n                if (\n                  // @ts-expect-error: Known type conflict\n                  callback(\n                    coords[j][k][l],\n                    coordIndex,\n                    featureIndex,\n                    multiFeatureIndex,\n                    geometryIndex\n                  ) === false\n                )\n                  // @ts-expect-error: Known type conflict\n                  return false;\n                coordIndex++;\n              }\n              geometryIndex++;\n            }\n            multiFeatureIndex++;\n          }\n          break;\n        case \"GeometryCollection\":\n          for (j = 0; j < geometry.geometries.length; j++)\n            if (\n              // @ts-expect-error: Known type conflict\n              coordEach(geometry.geometries[j], callback, excludeWrapCoord) ===\n              false\n            )\n              // @ts-expect-error: Known type conflict\n              return false;\n          break;\n        default:\n          throw new Error(\"Unknown Geometry Type\");\n      }\n    }\n  }\n}\n\n/**\n * Callback for coordReduce\n *\n * The first time the callback function is called, the values provided as arguments depend\n * on whether the reduce method has an initialValue argument.\n *\n * If an initialValue is provided to the reduce method:\n *  - The previousValue argument is initialValue.\n *  - The currentValue argument is the value of the first element present in the array.\n *\n * If an initialValue is not provided:\n *  - The previousValue argument is the value of the first element present in the array.\n *  - The currentValue argument is the value of the second element present in the array.\n *\n * @callback coordReduceCallback\n * @param {Reducer} previousValue The accumulated value previously returned in the last invocation\n * of the callback, or initialValue, if supplied.\n * @param {number[]} currentCoord The current coordinate being processed.\n * @param {number} coordIndex The current index of the coordinate being processed.\n * Starts at index 0, if an initialValue is provided, and at index 1 otherwise.\n * @param {number} featureIndex The current index of the Feature being processed.\n * @param {number} multiFeatureIndex The current index of the Multi-Feature being processed.\n * @param {number} geometryIndex The current index of the Geometry being processed.\n * @returns {Reducer}\n */\n\n/**\n * Reduce coordinates in any GeoJSON object, similar to Array.reduce()\n *\n * @function\n * @param {AllGeoJSON} geojson any GeoJSON object\n * @param {coordReduceCallback} callback a method that takes (previousValue, currentCoord, coordIndex)\n * @param {Reducer} [initialValue] Value to use as the first argument to the first call of the callback.\n * @param {boolean} [excludeWrapCoord=false] whether or not to include the final coordinate of LinearRings that wraps the ring in its iteration.\n * @returns {Reducer} The value that results from the reduction.\n * @example\n * var features = turf.featureCollection([\n *   turf.point([26, 37], {\"foo\": \"bar\"}),\n *   turf.point([36, 53], {\"hello\": \"world\"})\n * ]);\n *\n * turf.coordReduce(features, function (previousValue, currentCoord, coordIndex, featureIndex, multiFeatureIndex, geometryIndex) {\n *   //=previousValue\n *   //=currentCoord\n *   //=coordIndex\n *   //=featureIndex\n *   //=multiFeatureIndex\n *   //=geometryIndex\n *   return currentCoord;\n * });\n */\nfunction coordReduce<Reducer>(\n  geojson: AllGeoJSON,\n  callback: (\n    previousValue: Reducer,\n    currentCoord: number[],\n    coordIndex: number,\n    featureIndex: number,\n    multiFeatureIndex: number,\n    geometryIndex: number\n  ) => Reducer,\n  initialValue?: Reducer,\n  excludeWrapCoord?: boolean\n): Reducer {\n  var previousValue = initialValue;\n  coordEach(\n    geojson,\n    function (\n      currentCoord,\n      coordIndex,\n      featureIndex,\n      multiFeatureIndex,\n      geometryIndex\n    ) {\n      if (coordIndex === 0 && initialValue === undefined)\n        // @ts-expect-error: Known type conflict\n        previousValue = currentCoord;\n      else\n        previousValue = callback(\n          // @ts-expect-error: Known type conflict\n          previousValue,\n          currentCoord,\n          coordIndex,\n          featureIndex,\n          multiFeatureIndex,\n          geometryIndex\n        );\n    },\n    excludeWrapCoord\n  );\n  // @ts-expect-error: Known type conflict\n  return previousValue;\n}\n\n/**\n * Callback for propEach\n *\n * @callback propEachCallback\n * @param {GeoJsonProperties} currentProperties The current Properties being processed.\n * @param {number} featureIndex The current index of the Feature being processed.\n * @returns {void}\n */\n\n/**\n * Iterate over properties in any GeoJSON object, similar to Array.forEach()\n *\n * @function\n * @param {FeatureCollection|Feature} geojson any GeoJSON object\n * @param {propEachCallback} callback a method that takes (currentProperties, featureIndex)\n * @returns {void}\n * @example\n * var features = turf.featureCollection([\n *     turf.point([26, 37], {foo: 'bar'}),\n *     turf.point([36, 53], {hello: 'world'})\n * ]);\n *\n * turf.propEach(features, function (currentProperties, featureIndex) {\n *   //=currentProperties\n *   //=featureIndex\n * });\n */\nfunction propEach<Props extends GeoJsonProperties>(\n  geojson: Feature<any> | FeatureCollection<any> | Feature<GeometryCollection>,\n  callback: (currentProperties: Props, featureIndex: number) => void\n): void {\n  var i;\n  switch (geojson.type) {\n    case \"FeatureCollection\":\n      for (i = 0; i < geojson.features.length; i++) {\n        // @ts-expect-error: Known type conflict\n        if (callback(geojson.features[i].properties, i) === false) break;\n      }\n      break;\n    case \"Feature\":\n      // @ts-expect-error: Known type conflict\n      callback(geojson.properties, 0);\n      break;\n  }\n}\n\n/**\n * Callback for propReduce\n *\n * The first time the callback function is called, the values provided as arguments depend\n * on whether the reduce method has an initialValue argument.\n *\n * If an initialValue is provided to the reduce method:\n *  - The previousValue argument is initialValue.\n *  - The currentValue argument is the value of the first element present in the array.\n *\n * If an initialValue is not provided:\n *  - The previousValue argument is the value of the first element present in the array.\n *  - The currentValue argument is the value of the second element present in the array.\n *\n * @callback propReduceCallback\n * @param {Reducer} previousValue The accumulated value previously returned in the last invocation\n * of the callback, or initialValue, if supplied.\n * @param {GeoJsonProperties} currentProperties The current Properties being processed.\n * @param {number} featureIndex The current index of the Feature being processed.\n * @returns {Reducer}\n */\n\n/**\n * Reduce properties in any GeoJSON object into a single value,\n * similar to how Array.reduce works. However, in this case we lazily run\n * the reduction, so an array of all properties is unnecessary.\n *\n * @function\n * @param {FeatureCollection|Feature|Geometry} geojson any GeoJSON object\n * @param {propReduceCallback} callback a method that takes (previousValue, currentProperties, featureIndex)\n * @param {Reducer} [initialValue] Value to use as the first argument to the first call of the callback.\n * @returns {Reducer} The value that results from the reduction.\n * @example\n * var features = turf.featureCollection([\n *     turf.point([26, 37], {foo: 'bar'}),\n *     turf.point([36, 53], {hello: 'world'})\n * ]);\n *\n * turf.propReduce(features, function (previousValue, currentProperties, featureIndex) {\n *   //=previousValue\n *   //=currentProperties\n *   //=featureIndex\n *   return currentProperties\n * });\n */\nfunction propReduce<Reducer, P extends GeoJsonProperties = GeoJsonProperties>(\n  geojson: Feature<any, P> | FeatureCollection<any, P> | Geometry,\n  callback: (\n    previousValue: Reducer,\n    currentProperties: P,\n    featureIndex: number\n  ) => Reducer,\n  initialValue?: Reducer\n): Reducer {\n  var previousValue = initialValue;\n  // @ts-expect-error: Known type conflict\n  propEach(geojson, function (currentProperties, featureIndex) {\n    if (featureIndex === 0 && initialValue === undefined)\n      // @ts-expect-error: Known type conflict\n      previousValue = currentProperties;\n    else\n      // @ts-expect-error: Known type conflict\n      previousValue = callback(previousValue, currentProperties, featureIndex);\n  });\n  // @ts-expect-error: Known type conflict\n  return previousValue;\n}\n\n/**\n * Callback for featureEach\n *\n * @callback featureEachCallback\n * @param {Feature<any>} currentFeature The current Feature being processed.\n * @param {number} featureIndex The current index of the Feature being processed.\n * @returns {void}\n */\n\n/**\n * Iterate over features in any GeoJSON object, similar to\n * Array.forEach.\n *\n * @function\n * @param {FeatureCollection|Feature|Feature<GeometryCollection>} geojson any GeoJSON object\n * @param {featureEachCallback} callback a method that takes (currentFeature, featureIndex)\n * @returns {void}\n * @example\n * var features = turf.featureCollection([\n *   turf.point([26, 37], {foo: 'bar'}),\n *   turf.point([36, 53], {hello: 'world'})\n * ]);\n *\n * turf.featureEach(features, function (currentFeature, featureIndex) {\n *   //=currentFeature\n *   //=featureIndex\n * });\n */\nfunction featureEach<\n  G extends GeometryObject,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  geojson:\n    | Feature<G, P>\n    | FeatureCollection<G, P>\n    | Feature<GeometryCollection, P>,\n  callback: (currentFeature: Feature<G, P>, featureIndex: number) => void\n): void {\n  if (geojson.type === \"Feature\") {\n    // @ts-expect-error: Known type conflict\n    callback(geojson, 0);\n  } else if (geojson.type === \"FeatureCollection\") {\n    for (var i = 0; i < geojson.features.length; i++) {\n      // @ts-expect-error: Known type conflict\n      if (callback(geojson.features[i], i) === false) break;\n    }\n  }\n}\n\n/**\n * Callback for featureReduce\n *\n * The first time the callback function is called, the values provided as arguments depend\n * on whether the reduce method has an initialValue argument.\n *\n * If an initialValue is provided to the reduce method:\n *  - The previousValue argument is initialValue.\n *  - The currentValue argument is the value of the first element present in the array.\n *\n * If an initialValue is not provided:\n *  - The previousValue argument is the value of the first element present in the array.\n *  - The currentValue argument is the value of the second element present in the array.\n *\n * @callback featureReduceCallback\n * @param {Reducer} previousValue The accumulated value previously returned in the last invocation\n * of the callback, or initialValue, if supplied.\n * @param {Feature} currentFeature The current Feature being processed.\n * @param {number} featureIndex The current index of the Feature being processed.\n * @returns {Reducer}\n */\n\n/**\n * Reduce features in any GeoJSON object, similar to Array.reduce().\n *\n * @function\n * @param {FeatureCollection|Feature|Feature<GeometryCollection>} geojson any GeoJSON object\n * @param {featureReduceCallback} callback a method that takes (previousValue, currentFeature, featureIndex)\n * @param {Reducer} [initialValue] Value to use as the first argument to the first call of the callback.\n * @returns {Reducer} The value that results from the reduction.\n * @example\n * var features = turf.featureCollection([\n *   turf.point([26, 37], {\"foo\": \"bar\"}),\n *   turf.point([36, 53], {\"hello\": \"world\"})\n * ]);\n *\n * turf.featureReduce(features, function (previousValue, currentFeature, featureIndex) {\n *   //=previousValue\n *   //=currentFeature\n *   //=featureIndex\n *   return currentFeature\n * });\n */\nfunction featureReduce<\n  Reducer,\n  G extends GeometryObject,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  geojson:\n    | Feature<G, P>\n    | FeatureCollection<G, P>\n    | Feature<GeometryCollection, P>,\n  callback: (\n    previousValue: Reducer,\n    currentFeature: Feature<G, P>,\n    featureIndex: number\n  ) => Reducer,\n  initialValue?: Reducer\n): Reducer {\n  var previousValue = initialValue;\n  featureEach(geojson, function (currentFeature, featureIndex) {\n    if (featureIndex === 0 && initialValue === undefined)\n      // @ts-expect-error: Known type conflict\n      previousValue = currentFeature;\n    // @ts-expect-error: Known type conflict\n    else previousValue = callback(previousValue, currentFeature, featureIndex);\n  });\n  // @ts-expect-error: Known type conflict\n  return previousValue;\n}\n\n/**\n * Get all coordinates from any GeoJSON object.\n *\n * @function\n * @param {AllGeoJSON} geojson any GeoJSON object\n * @returns {Array<Array<number>>} coordinate position array\n * @example\n * var features = turf.featureCollection([\n *   turf.point([26, 37], {foo: 'bar'}),\n *   turf.point([36, 53], {hello: 'world'})\n * ]);\n *\n * var coords = turf.coordAll(features);\n * //= [[26, 37], [36, 53]]\n */\nfunction coordAll(geojson: AllGeoJSON): number[][] {\n  // @ts-expect-error: Known type conflict\n  var coords = [];\n  coordEach(geojson, function (coord) {\n    coords.push(coord);\n  });\n  // @ts-expect-error: Known type conflict\n  return coords;\n}\n\n/**\n * Callback for geomEach\n *\n * @callback geomEachCallback\n * @param {GeometryObject} currentGeometry The current Geometry being processed.\n * @param {number} featureIndex The current index of the Feature being processed.\n * @param {GeoJsonProperties} featureProperties The current Feature Properties being processed.\n * @param {BBox} featureBBox The current Feature BBox being processed.\n * @param {Id} featureId The current Feature Id being processed.\n * @returns {void}\n */\n\n/**\n * Iterate over each geometry in any GeoJSON object, similar to Array.forEach()\n *\n * @function\n * @param {FeatureCollection|Feature|Geometry|GeometryObject|Feature<GeometryCollection>} geojson any GeoJSON object\n * @param {geomEachCallback} callback a method that takes (currentGeometry, featureIndex, featureProperties, featureBBox, featureId)\n * @returns {void}\n * @example\n * var features = turf.featureCollection([\n *     turf.point([26, 37], {foo: 'bar'}),\n *     turf.point([36, 53], {hello: 'world'})\n * ]);\n *\n * turf.geomEach(features, function (currentGeometry, featureIndex, featureProperties, featureBBox, featureId) {\n *   //=currentGeometry\n *   //=featureIndex\n *   //=featureProperties\n *   //=featureBBox\n *   //=featureId\n * });\n */\nfunction geomEach<\n  G extends GeometryObject | null,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  geojson:\n    | Feature<G, P>\n    | FeatureCollection<G, P>\n    | G\n    | GeometryCollection\n    | Feature<GeometryCollection, P>,\n  callback: (\n    currentGeometry: G,\n    featureIndex: number,\n    featureProperties: P,\n    featureBBox: BBox,\n    featureId: Id\n  ) => void\n): void {\n  var i,\n    j,\n    g,\n    geometry,\n    stopG,\n    geometryMaybeCollection,\n    isGeometryCollection,\n    featureProperties,\n    featureBBox,\n    featureId,\n    featureIndex = 0,\n    // @ts-expect-error: Known type conflict\n    isFeatureCollection = geojson.type === \"FeatureCollection\",\n    // @ts-expect-error: Known type conflict\n    isFeature = geojson.type === \"Feature\",\n    // @ts-expect-error: Known type conflict\n    stop = isFeatureCollection ? geojson.features.length : 1;\n\n  // This logic may look a little weird. The reason why it is that way\n  // is because it's trying to be fast. GeoJSON supports multiple kinds\n  // of objects at its root: FeatureCollection, Features, Geometries.\n  // This function has the responsibility of handling all of them, and that\n  // means that some of the `for` loops you see below actually just don't apply\n  // to certain inputs. For instance, if you give this just a\n  // Point geometry, then both loops are short-circuited and all we do\n  // is gradually rename the input until it's called 'geometry'.\n  //\n  // This also aims to allocate as few resources as possible: just a\n  // few numbers and booleans, rather than any temporary arrays as would\n  // be required with the normalization approach.\n  for (i = 0; i < stop; i++) {\n    geometryMaybeCollection = isFeatureCollection\n      ? // @ts-expect-error: Known type conflict\n        geojson.features[i].geometry\n      : isFeature\n        ? // @ts-expect-error: Known type conflict\n          geojson.geometry\n        : geojson;\n    featureProperties = isFeatureCollection\n      ? // @ts-expect-error: Known type conflict\n        geojson.features[i].properties\n      : isFeature\n        ? // @ts-expect-error: Known type conflict\n          geojson.properties\n        : {};\n    featureBBox = isFeatureCollection\n      ? // @ts-expect-error: Known type conflict\n        geojson.features[i].bbox\n      : isFeature\n        ? // @ts-expect-error: Known type conflict\n          geojson.bbox\n        : undefined;\n    featureId = isFeatureCollection\n      ? // @ts-expect-error: Known type conflict\n        geojson.features[i].id\n      : isFeature\n        ? // @ts-expect-error: Known type conflict\n          geojson.id\n        : undefined;\n    isGeometryCollection = geometryMaybeCollection\n      ? geometryMaybeCollection.type === \"GeometryCollection\"\n      : false;\n    stopG = isGeometryCollection\n      ? geometryMaybeCollection.geometries.length\n      : 1;\n\n    for (g = 0; g < stopG; g++) {\n      geometry = isGeometryCollection\n        ? geometryMaybeCollection.geometries[g]\n        : geometryMaybeCollection;\n\n      // Handle null Geometry\n      if (geometry === null) {\n        if (\n          // @ts-expect-error: Known type conflict\n          callback(\n            // @ts-expect-error: Known type conflict\n            null,\n            featureIndex,\n            featureProperties,\n            featureBBox,\n            featureId\n          ) === false\n        )\n          // @ts-expect-error: Known type conflict\n          return false;\n        continue;\n      }\n      switch (geometry.type) {\n        case \"Point\":\n        case \"LineString\":\n        case \"MultiPoint\":\n        case \"Polygon\":\n        case \"MultiLineString\":\n        case \"MultiPolygon\": {\n          if (\n            // @ts-expect-error: Known type conflict\n            callback(\n              geometry,\n              featureIndex,\n              featureProperties,\n              featureBBox,\n              featureId\n            ) === false\n          )\n            // @ts-expect-error: Known type conflict\n            return false;\n          break;\n        }\n        case \"GeometryCollection\": {\n          for (j = 0; j < geometry.geometries.length; j++) {\n            if (\n              // @ts-expect-error: Known type conflict\n              callback(\n                geometry.geometries[j],\n                featureIndex,\n                featureProperties,\n                featureBBox,\n                featureId\n              ) === false\n            )\n              // @ts-expect-error: Known type conflict\n              return false;\n          }\n          break;\n        }\n        default:\n          throw new Error(\"Unknown Geometry Type\");\n      }\n    }\n    // Only increase `featureIndex` per each feature\n    featureIndex++;\n  }\n}\n\n/**\n * Callback for geomReduce\n *\n * The first time the callback function is called, the values provided as arguments depend\n * on whether the reduce method has an initialValue argument.\n *\n * If an initialValue is provided to the reduce method:\n *  - The previousValue argument is initialValue.\n *  - The currentValue argument is the value of the first element present in the array.\n *\n * If an initialValue is not provided:\n *  - The previousValue argument is the value of the first element present in the array.\n *  - The currentValue argument is the value of the second element present in the array.\n *\n * @callback geomReduceCallback\n * @param {Reducer} previousValue The accumulated value previously returned in the last invocation\n * of the callback, or initialValue, if supplied.\n * @param {GeometryObject} currentGeometry The current Geometry being processed.\n * @param {number} featureIndex The current index of the Feature being processed.\n * @param {GeoJsonProperties} featureProperties The current Feature Properties being processed.\n * @param {BBox} featureBBox The current Feature BBox being processed.\n * @param {Id} featureId The current Feature Id being processed.\n * @returns {Reducer}\n */\n\n/**\n * Reduce geometry in any GeoJSON object, similar to Array.reduce().\n *\n * @function\n * @param {FeatureCollection|Feature|GeometryObject|GeometryCollection|Feature<GeometryCollection>} geojson any GeoJSON object\n * @param {geomReduceCallback} callback a method that takes (previousValue, currentGeometry, featureIndex, featureProperties, featureBBox, featureId)\n * @param {Reducer} [initialValue] Value to use as the first argument to the first call of the callback.\n * @returns {Reducer} The value that results from the reduction.\n * @example\n * var features = turf.featureCollection([\n *     turf.point([26, 37], {foo: 'bar'}),\n *     turf.point([36, 53], {hello: 'world'})\n * ]);\n *\n * turf.geomReduce(features, function (previousValue, currentGeometry, featureIndex, featureProperties, featureBBox, featureId) {\n *   //=previousValue\n *   //=currentGeometry\n *   //=featureIndex\n *   //=featureProperties\n *   //=featureBBox\n *   //=featureId\n *   return currentGeometry\n * });\n */\nfunction geomReduce<\n  Reducer,\n  G extends GeometryObject,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  geojson:\n    | Feature<G, P>\n    | FeatureCollection<G, P>\n    | G\n    | GeometryCollection\n    | Feature<GeometryCollection, P>,\n  callback: (\n    previousValue: Reducer,\n    currentGeometry: G,\n    featureIndex: number,\n    featureProperties: P,\n    featureBBox: BBox,\n    featureId: Id\n  ) => Reducer,\n  initialValue?: Reducer\n): Reducer {\n  var previousValue = initialValue;\n  geomEach(\n    geojson,\n    function (\n      currentGeometry,\n      featureIndex,\n      featureProperties,\n      featureBBox,\n      featureId\n    ) {\n      if (featureIndex === 0 && initialValue === undefined)\n        // @ts-expect-error: Known type conflict\n        previousValue = currentGeometry;\n      else\n        previousValue = callback(\n          // @ts-expect-error: Known type conflict\n          previousValue,\n          currentGeometry,\n          featureIndex,\n          featureProperties,\n          featureBBox,\n          featureId\n        );\n    }\n  );\n  // @ts-expect-error: Known type conflict\n  return previousValue;\n}\n\n/**\n * Callback for flattenEach\n *\n * @callback flattenEachCallback\n * @param {Feature} currentFeature The current flattened feature being processed.\n * @param {number} featureIndex The current index of the Feature being processed.\n * @param {number} multiFeatureIndex The current index of the Multi-Feature being processed.\n * @returns {void}\n */\n\n/**\n * Iterate over flattened features in any GeoJSON object, similar to\n * Array.forEach.\n *\n * @function\n * @param {FeatureCollection|Feature|GeometryObject|GeometryCollection|Feature<GeometryCollection>} geojson any GeoJSON object\n * @param {flattenEachCallback} callback a method that takes (currentFeature, featureIndex, multiFeatureIndex)\n * @returns {void}\n * @example\n * var features = turf.featureCollection([\n *     turf.point([26, 37], {foo: 'bar'}),\n *     turf.multiPoint([[40, 30], [36, 53]], {hello: 'world'})\n * ]);\n *\n * turf.flattenEach(features, function (currentFeature, featureIndex, multiFeatureIndex) {\n *   //=currentFeature\n *   //=featureIndex\n *   //=multiFeatureIndex\n * });\n */\nfunction flattenEach<\n  G extends GeometryObject = GeometryObject,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  geojson:\n    | Feature<G, P>\n    | FeatureCollection<G, P>\n    | G\n    | GeometryCollection\n    | Feature<GeometryCollection, P>,\n  callback: (\n    currentFeature: Feature<G, P>,\n    featureIndex: number,\n    multiFeatureIndex: number\n  ) => void\n): void {\n  geomEach(geojson, function (geometry, featureIndex, properties, bbox, id) {\n    // Callback for single geometry\n    var type = geometry === null ? null : geometry.type;\n    switch (type) {\n      case null:\n      case \"Point\":\n      case \"LineString\":\n      case \"Polygon\":\n        if (\n          // @ts-expect-error: Known type conflict\n          callback(\n            feature(geometry, properties, { bbox: bbox, id: id }),\n            featureIndex,\n            0\n          ) === false\n        )\n          return false;\n        return;\n    }\n\n    var geomType;\n\n    // Callback for multi-geometry\n    switch (type) {\n      case \"MultiPoint\":\n        geomType = \"Point\";\n        break;\n      case \"MultiLineString\":\n        geomType = \"LineString\";\n        break;\n      case \"MultiPolygon\":\n        geomType = \"Polygon\";\n        break;\n    }\n\n    for (\n      var multiFeatureIndex = 0;\n      // @ts-expect-error: Known type conflict\n      multiFeatureIndex < geometry.coordinates.length;\n      multiFeatureIndex++\n    ) {\n      // @ts-expect-error: Known type conflict\n      var coordinate = geometry.coordinates[multiFeatureIndex];\n      var geom = {\n        type: geomType,\n        coordinates: coordinate,\n      };\n      if (\n        // @ts-expect-error: Known type conflict\n        callback(feature(geom, properties), featureIndex, multiFeatureIndex) ===\n        false\n      )\n        return false;\n    }\n  });\n}\n\n/**\n * Callback for flattenReduce\n *\n * The first time the callback function is called, the values provided as arguments depend\n * on whether the reduce method has an initialValue argument.\n *\n * If an initialValue is provided to the reduce method:\n *  - The previousValue argument is initialValue.\n *  - The currentValue argument is the value of the first element present in the array.\n *\n * If an initialValue is not provided:\n *  - The previousValue argument is the value of the first element present in the array.\n *  - The currentValue argument is the value of the second element present in the array.\n *\n * @callback flattenReduceCallback\n * @param {Reducer} previousValue The accumulated value previously returned in the last invocation\n * of the callback, or initialValue, if supplied.\n * @param {Feature} currentFeature The current Feature being processed.\n * @param {number} featureIndex The current index of the Feature being processed.\n * @param {number} multiFeatureIndex The current index of the Multi-Feature being processed.\n * @returns {Reducer}\n */\n\n/**\n * Reduce flattened features in any GeoJSON object, similar to Array.reduce().\n *\n * @function\n * @param {FeatureCollection|Feature|GeometryObject|GeometryCollection|Feature<GeometryCollection>} geojson any GeoJSON object\n * @param {flattenReduceCallback} callback a method that takes (previousValue, currentFeature, featureIndex, multiFeatureIndex)\n * @param {Reducer} [initialValue] Value to use as the first argument to the first call of the callback.\n * @returns {Reducer} The value that results from the reduction.\n * @example\n * var features = turf.featureCollection([\n *     turf.point([26, 37], {foo: 'bar'}),\n *     turf.multiPoint([[40, 30], [36, 53]], {hello: 'world'})\n * ]);\n *\n * turf.flattenReduce(features, function (previousValue, currentFeature, featureIndex, multiFeatureIndex) {\n *   //=previousValue\n *   //=currentFeature\n *   //=featureIndex\n *   //=multiFeatureIndex\n *   return currentFeature\n * });\n */\nfunction flattenReduce<\n  Reducer,\n  G extends GeometryObject,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  geojson:\n    | Feature<G, P>\n    | FeatureCollection<G, P>\n    | G\n    | GeometryCollection\n    | Feature<GeometryCollection, P>,\n  callback: (\n    previousValue: Reducer,\n    currentFeature: Feature<G, P>,\n    featureIndex: number,\n    multiFeatureIndex: number\n  ) => Reducer,\n  initialValue?: Reducer\n): Reducer {\n  var previousValue = initialValue;\n  flattenEach(\n    geojson,\n    function (currentFeature, featureIndex, multiFeatureIndex) {\n      if (\n        featureIndex === 0 &&\n        multiFeatureIndex === 0 &&\n        initialValue === undefined\n      )\n        // @ts-expect-error: Known type conflict\n        previousValue = currentFeature;\n      else\n        previousValue = callback(\n          // @ts-expect-error: Known type conflict\n          previousValue,\n          currentFeature,\n          featureIndex,\n          multiFeatureIndex\n        );\n    }\n  );\n  // @ts-expect-error: Known type conflict\n  return previousValue;\n}\n\n/**\n * Callback for segmentEach\n *\n * @callback segmentEachCallback\n * @param {Feature<LineString>} currentSegment The current Segment being processed.\n * @param {number} featureIndex The current index of the Feature being processed.\n * @param {number} multiFeatureIndex The current index of the Multi-Feature being processed.\n * @param {number} geometryIndex The current index of the Geometry being processed.\n * @param {number} segmentIndex The current index of the Segment being processed.\n * @returns {void}\n */\n\n/**\n * Iterate over 2-vertex line segment in any GeoJSON object, similar to Array.forEach()\n * (Multi)Point geometries do not contain segments therefore they are ignored during this operation.\n *\n * @param {AllGeoJSON} geojson any GeoJSON\n * @param {segmentEachCallback} callback a method that takes (currentSegment, featureIndex, multiFeatureIndex, geometryIndex, segmentIndex)\n * @returns {void}\n * @example\n * var polygon = turf.polygon([[[-50, 5], [-40, -10], [-50, -10], [-40, 5], [-50, 5]]]);\n *\n * // Iterate over GeoJSON by 2-vertex segments\n * turf.segmentEach(polygon, function (currentSegment, featureIndex, multiFeatureIndex, geometryIndex, segmentIndex) {\n *   //=currentSegment\n *   //=featureIndex\n *   //=multiFeatureIndex\n *   //=geometryIndex\n *   //=segmentIndex\n * });\n *\n * // Calculate the total number of segments\n * var total = 0;\n * turf.segmentEach(polygon, function () {\n *     total++;\n * });\n */\nfunction segmentEach<P extends GeoJsonProperties = GeoJsonProperties>(\n  geojson: AllGeoJSON,\n  callback: (\n    currentSegment?: Feature<LineString, P>,\n    featureIndex?: number,\n    multiFeatureIndex?: number,\n    segmentIndex?: number,\n    geometryIndex?: number\n  ) => void\n): void {\n  flattenEach(geojson, function (feature, featureIndex, multiFeatureIndex) {\n    var segmentIndex = 0;\n\n    // Exclude null Geometries\n    if (!feature.geometry) return;\n    // (Multi)Point geometries do not contain segments therefore they are ignored during this operation.\n    var type = feature.geometry.type;\n    if (type === \"Point\" || type === \"MultiPoint\") return;\n\n    // Generate 2-vertex line segments\n    // @ts-expect-error: Known type conflict\n    var previousCoords;\n    var previousFeatureIndex = 0;\n    var previousMultiIndex = 0;\n    var prevGeomIndex = 0;\n    if (\n      // @ts-expect-error: Known type conflict\n      coordEach(\n        feature,\n        function (\n          currentCoord,\n          coordIndex,\n          featureIndexCoord,\n          multiPartIndexCoord,\n          geometryIndex\n        ) {\n          // Simulating a meta.coordReduce() since `reduce` operations cannot be stopped by returning `false`\n          if (\n            // @ts-expect-error: Known type conflict\n            previousCoords === undefined ||\n            featureIndex > previousFeatureIndex ||\n            multiPartIndexCoord > previousMultiIndex ||\n            geometryIndex > prevGeomIndex\n          ) {\n            previousCoords = currentCoord;\n            previousFeatureIndex = featureIndex;\n            previousMultiIndex = multiPartIndexCoord;\n            prevGeomIndex = geometryIndex;\n            segmentIndex = 0;\n            return;\n          }\n          var currentSegment = lineString(\n            // @ts-expect-error: Known type conflict\n            [previousCoords, currentCoord],\n            feature.properties\n          );\n          if (\n            // @ts-expect-error: Known type conflict\n            callback(\n              // @ts-expect-error: Known type conflict\n              currentSegment,\n              featureIndex,\n              multiFeatureIndex,\n              geometryIndex,\n              segmentIndex\n            ) === false\n          )\n            return false;\n          segmentIndex++;\n          previousCoords = currentCoord;\n        }\n      ) === false\n    )\n      return false;\n  });\n}\n\n/**\n * Callback for segmentReduce\n *\n * The first time the callback function is called, the values provided as arguments depend\n * on whether the reduce method has an initialValue argument.\n *\n * If an initialValue is provided to the reduce method:\n *  - The previousValue argument is initialValue.\n *  - The currentValue argument is the value of the first element present in the array.\n *\n * If an initialValue is not provided:\n *  - The previousValue argument is the value of the first element present in the array.\n *  - The currentValue argument is the value of the second element present in the array.\n *\n * @callback segmentReduceCallback\n * @param {Reducer} previousValue The accumulated value previously returned in the last invocation\n * of the callback, or initialValue, if supplied.\n * @param {Feature<LineString>} currentSegment The current Segment being processed.\n * @param {number} featureIndex The current index of the Feature being processed.\n * @param {number} multiFeatureIndex The current index of the Multi-Feature being processed.\n * @param {number} geometryIndex The current index of the Geometry being processed.\n * @param {number} segmentIndex The current index of the Segment being processed.\n * @returns {Reducer}\n */\n\n/**\n * Reduce 2-vertex line segment in any GeoJSON object, similar to Array.reduce()\n * (Multi)Point geometries do not contain segments therefore they are ignored during this operation.\n *\n * @param {FeatureCollection|Feature|Geometry} geojson any GeoJSON\n * @param {segmentReduceCallback} callback a method that takes (previousValue, currentSegment, currentIndex)\n * @param {Reducer} [initialValue] Value to use as the first argument to the first call of the callback.\n * @returns {Reducer}\n * @example\n * var polygon = turf.polygon([[[-50, 5], [-40, -10], [-50, -10], [-40, 5], [-50, 5]]]);\n *\n * // Iterate over GeoJSON by 2-vertex segments\n * turf.segmentReduce(polygon, function (previousSegment, currentSegment, featureIndex, multiFeatureIndex, geometryIndex, segmentIndex) {\n *   //= previousSegment\n *   //= currentSegment\n *   //= featureIndex\n *   //= multiFeatureIndex\n *   //= geometryIndex\n *   //= segmentIndex\n *   return currentSegment\n * });\n *\n * // Calculate the total number of segments\n * var initialValue = 0\n * var total = turf.segmentReduce(polygon, function (previousValue) {\n *     previousValue++;\n *     return previousValue;\n * }, initialValue);\n */\nfunction segmentReduce<\n  Reducer,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  geojson:\n    | FeatureCollection<Lines, P>\n    | Feature<Lines, P>\n    | Lines\n    | Feature<GeometryCollection, P>\n    | GeometryCollection,\n  callback: (\n    previousValue?: Reducer,\n    currentSegment?: Feature<LineString, P>,\n    featureIndex?: number,\n    multiFeatureIndex?: number,\n    segmentIndex?: number,\n    geometryIndex?: number\n  ) => Reducer,\n  initialValue?: Reducer\n): Reducer {\n  var previousValue = initialValue;\n  var started = false;\n  segmentEach(\n    geojson,\n    function (\n      currentSegment,\n      featureIndex,\n      multiFeatureIndex,\n      geometryIndex,\n      segmentIndex\n    ) {\n      if (started === false && initialValue === undefined)\n        // @ts-expect-error: Known type conflict\n        previousValue = currentSegment;\n      else\n        previousValue = callback(\n          previousValue,\n          // @ts-expect-error: Known type conflict\n          currentSegment,\n          featureIndex,\n          multiFeatureIndex,\n          geometryIndex,\n          segmentIndex\n        );\n      started = true;\n    }\n  );\n  // @ts-expect-error: Known type conflict\n  return previousValue;\n}\n\n/**\n * Callback for lineEach\n *\n * @callback lineEachCallback\n * @param {Feature<LineString>} currentLine The current LineString|LinearRing being processed\n * @param {number} featureIndex The current index of the Feature being processed\n * @param {number} multiFeatureIndex The current index of the Multi-Feature being processed\n * @param {number} geometryIndex The current index of the Geometry being processed\n * @returns {void}\n */\n\n/**\n * Iterate over line or ring coordinates in LineString, Polygon, MultiLineString, MultiPolygon Features or Geometries,\n * similar to Array.forEach.\n *\n * @function\n * @param {FeatureCollection<Lines>|Feature<Lines>|Lines|Feature<GeometryCollection>|GeometryCollection} geojson object\n * @param {lineEachCallback} callback a method that takes (currentLine, featureIndex, multiFeatureIndex, geometryIndex)\n * @returns {void}\n * @example\n * var multiLine = turf.multiLineString([\n *   [[26, 37], [35, 45]],\n *   [[36, 53], [38, 50], [41, 55]]\n * ]);\n *\n * turf.lineEach(multiLine, function (currentLine, featureIndex, multiFeatureIndex, geometryIndex) {\n *   //=currentLine\n *   //=featureIndex\n *   //=multiFeatureIndex\n *   //=geometryIndex\n * });\n */\nfunction lineEach<P extends GeoJsonProperties = GeoJsonProperties>(\n  geojson:\n    | FeatureCollection<Lines, P>\n    | Feature<Lines, P>\n    | Lines\n    | Feature<GeometryCollection, P>\n    | GeometryCollection,\n  callback: (\n    currentLine: Feature<LineString, P>,\n    featureIndex?: number,\n    multiFeatureIndex?: number,\n    geometryIndex?: number\n  ) => void\n): void {\n  // validation\n  if (!geojson) throw new Error(\"geojson is required\");\n\n  flattenEach(geojson, function (feature, featureIndex, multiFeatureIndex) {\n    if (feature.geometry === null) return;\n    var type = feature.geometry.type;\n    var coords = feature.geometry.coordinates;\n    switch (type) {\n      case \"LineString\":\n        // @ts-expect-error: Known type conflict\n        if (callback(feature, featureIndex, multiFeatureIndex, 0, 0) === false)\n          return false;\n        break;\n      case \"Polygon\":\n        for (\n          var geometryIndex = 0;\n          geometryIndex < coords.length;\n          geometryIndex++\n        ) {\n          if (\n            // @ts-expect-error: Known type conflict\n            callback(\n              // @ts-expect-error: Known type conflict\n              lineString(coords[geometryIndex], feature.properties),\n              featureIndex,\n              multiFeatureIndex,\n              geometryIndex\n            ) === false\n          )\n            return false;\n        }\n        break;\n    }\n  });\n}\n\n/**\n * Callback for lineReduce\n *\n * The first time the callback function is called, the values provided as arguments depend\n * on whether the reduce method has an initialValue argument.\n *\n * If an initialValue is provided to the reduce method:\n *  - The previousValue argument is initialValue.\n *  - The currentValue argument is the value of the first element present in the array.\n *\n * If an initialValue is not provided:\n *  - The previousValue argument is the value of the first element present in the array.\n *  - The currentValue argument is the value of the second element present in the array.\n *\n * @callback lineReduceCallback\n * @param {Reducer} previousValue The accumulated value previously returned in the last invocation\n * of the callback, or initialValue, if supplied.\n * @param {Feature<LineString>} currentLine The current LineString|LinearRing being processed.\n * @param {number} featureIndex The current index of the Feature being processed\n * @param {number} multiFeatureIndex The current index of the Multi-Feature being processed\n * @param {number} geometryIndex The current index of the Geometry being processed\n * @returns {Reducer}\n */\n\n/**\n * Reduce features in any GeoJSON object, similar to Array.reduce().\n *\n * @function\n * @param {FeatureCollection<Lines>|Feature<Lines>|Lines|Feature<GeometryCollection>|GeometryCollection} geojson object\n * @param {Function} callback a method that takes (previousValue, currentLine, featureIndex, multiFeatureIndex, geometryIndex)\n * @param {Reducer} [initialValue] Value to use as the first argument to the first call of the callback.\n * @returns {Reducer} The value that results from the reduction.\n * @example\n * var multiPoly = turf.multiPolygon([\n *   turf.polygon([[[12,48],[2,41],[24,38],[12,48]], [[9,44],[13,41],[13,45],[9,44]]]),\n *   turf.polygon([[[5, 5], [0, 0], [2, 2], [4, 4], [5, 5]]])\n * ]);\n *\n * turf.lineReduce(multiPoly, function (previousValue, currentLine, featureIndex, multiFeatureIndex, geometryIndex) {\n *   //=previousValue\n *   //=currentLine\n *   //=featureIndex\n *   //=multiFeatureIndex\n *   //=geometryIndex\n *   return currentLine\n * });\n */\nfunction lineReduce<Reducer, P extends GeoJsonProperties = GeoJsonProperties>(\n  geojson:\n    | FeatureCollection<Lines, P>\n    | Feature<Lines, P>\n    | Lines\n    | Feature<GeometryCollection, P>\n    | GeometryCollection,\n  callback: (\n    previousValue?: Reducer,\n    currentLine?: Feature<LineString, P>,\n    featureIndex?: number,\n    multiFeatureIndex?: number,\n    geometryIndex?: number\n  ) => Reducer,\n  initialValue?: Reducer\n): Reducer {\n  var previousValue = initialValue;\n  lineEach(\n    geojson,\n    function (currentLine, featureIndex, multiFeatureIndex, geometryIndex) {\n      if (featureIndex === 0 && initialValue === undefined)\n        // @ts-expect-error: Known type conflict\n        previousValue = currentLine;\n      else\n        previousValue = callback(\n          previousValue,\n          currentLine,\n          featureIndex,\n          multiFeatureIndex,\n          geometryIndex\n        );\n    }\n  );\n  // @ts-expect-error: Known type conflict\n  return previousValue;\n}\n\n/**\n * Finds a particular 2-vertex LineString Segment from a GeoJSON using `@turf/meta` indexes.\n *\n * Negative indexes are permitted.\n * Point & MultiPoint will always return null.\n *\n * @param {FeatureCollection|Feature|Geometry} geojson Any GeoJSON Feature or Geometry\n * @param {Object} [options={}] Optional parameters\n * @param {number} [options.featureIndex=0] Feature Index\n * @param {number} [options.multiFeatureIndex=0] Multi-Feature Index\n * @param {number} [options.geometryIndex=0] Geometry Index\n * @param {number} [options.segmentIndex=0] Segment Index\n * @param {Object} [options.properties={}] Translate Properties to output LineString\n * @param {BBox} [options.bbox={}] Translate BBox to output LineString\n * @param {number|string} [options.id={}] Translate Id to output LineString\n * @returns {Feature<LineString>} 2-vertex GeoJSON Feature LineString\n * @example\n * var multiLine = turf.multiLineString([\n *     [[10, 10], [50, 30], [30, 40]],\n *     [[-10, -10], [-50, -30], [-30, -40]]\n * ]);\n *\n * // First Segment (defaults are 0)\n * turf.findSegment(multiLine);\n * // => Feature<LineString<[[10, 10], [50, 30]]>>\n *\n * // First Segment of 2nd Multi Feature\n * turf.findSegment(multiLine, {multiFeatureIndex: 1});\n * // => Feature<LineString<[[-10, -10], [-50, -30]]>>\n *\n * // Last Segment of Last Multi Feature\n * turf.findSegment(multiLine, {multiFeatureIndex: -1, segmentIndex: -1});\n * // => Feature<LineString<[[-50, -30], [-30, -40]]>>\n */\nfunction findSegment<\n  G extends LineString | MultiLineString | Polygon | MultiPolygon,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  geojson: Feature<G, P> | FeatureCollection<G, P> | G,\n  options?: {\n    featureIndex?: number;\n    multiFeatureIndex?: number;\n    geometryIndex?: number;\n    segmentIndex?: number;\n    properties?: P;\n    bbox?: BBox;\n    id?: Id;\n  }\n): Feature<LineString, P> {\n  // Optional Parameters\n  options = options || {};\n  if (!isObject(options)) throw new Error(\"options is invalid\");\n  var featureIndex = options.featureIndex || 0;\n  var multiFeatureIndex = options.multiFeatureIndex || 0;\n  var geometryIndex = options.geometryIndex || 0;\n  var segmentIndex = options.segmentIndex || 0;\n\n  // Find FeatureIndex\n  var properties = options.properties;\n  var geometry;\n\n  switch (geojson.type) {\n    case \"FeatureCollection\":\n      if (featureIndex < 0)\n        featureIndex = geojson.features.length + featureIndex;\n      properties = properties || geojson.features[featureIndex].properties;\n      geometry = geojson.features[featureIndex].geometry;\n      break;\n    case \"Feature\":\n      properties = properties || geojson.properties;\n      geometry = geojson.geometry;\n      break;\n    case \"Point\" as GeoJsonTypes:\n    case \"MultiPoint\" as GeoJsonTypes:\n      // @ts-expect-error: Known type conflict\n      return null;\n    case \"LineString\":\n    case \"Polygon\":\n    case \"MultiLineString\":\n    case \"MultiPolygon\":\n      geometry = geojson;\n      break;\n    default:\n      throw new Error(\"geojson is invalid\");\n  }\n\n  // Find SegmentIndex\n  // @ts-expect-error: Known type conflict\n  if (geometry === null) return null;\n  var coords = geometry.coordinates;\n  switch (geometry.type) {\n    case \"Point\" as GeoJsonTypes:\n    case \"MultiPoint\" as GeoJsonTypes:\n      // @ts-expect-error: Known type conflict\n      return null;\n    case \"LineString\":\n      if (segmentIndex < 0) segmentIndex = coords.length + segmentIndex - 1;\n      return lineString(\n        // @ts-expect-error: Known type conflict\n        [coords[segmentIndex], coords[segmentIndex + 1]],\n        properties,\n        options\n      );\n    case \"Polygon\":\n      if (geometryIndex < 0) geometryIndex = coords.length + geometryIndex;\n      if (segmentIndex < 0)\n        segmentIndex = coords[geometryIndex].length + segmentIndex - 1;\n      return lineString(\n        [\n          // @ts-expect-error: Known type conflict\n          coords[geometryIndex][segmentIndex],\n          // @ts-expect-error: Known type conflict\n          coords[geometryIndex][segmentIndex + 1],\n        ],\n        properties,\n        options\n      );\n    case \"MultiLineString\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      if (segmentIndex < 0)\n        segmentIndex = coords[multiFeatureIndex].length + segmentIndex - 1;\n      return lineString(\n        [\n          // @ts-expect-error: Known type conflict\n          coords[multiFeatureIndex][segmentIndex],\n          // @ts-expect-error: Known type conflict\n          coords[multiFeatureIndex][segmentIndex + 1],\n        ],\n        properties,\n        options\n      );\n    case \"MultiPolygon\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      if (geometryIndex < 0)\n        geometryIndex = coords[multiFeatureIndex].length + geometryIndex;\n      if (segmentIndex < 0)\n        segmentIndex =\n          // @ts-expect-error: Known type conflict\n          coords[multiFeatureIndex][geometryIndex].length - segmentIndex - 1;\n      return lineString(\n        [\n          // @ts-expect-error: Known type conflict\n          coords[multiFeatureIndex][geometryIndex][segmentIndex],\n          // @ts-expect-error: Known type conflict\n          coords[multiFeatureIndex][geometryIndex][segmentIndex + 1],\n        ],\n        properties,\n        options\n      );\n  }\n  throw new Error(\"geojson is invalid\");\n}\n\n/**\n * Finds a particular Point from a GeoJSON using `@turf/meta` indexes.\n *\n * Negative indexes are permitted.\n *\n * @param {FeatureCollection|Feature|Geometry} geojson Any GeoJSON Feature or Geometry\n * @param {Object} [options={}] Optional parameters\n * @param {number} [options.featureIndex=0] Feature Index\n * @param {number} [options.multiFeatureIndex=0] Multi-Feature Index\n * @param {number} [options.geometryIndex=0] Geometry Index\n * @param {number} [options.coordIndex=0] Coord Index\n * @param {Object} [options.properties={}] Translate Properties to output Point\n * @param {BBox} [options.bbox={}] Translate BBox to output Point\n * @param {number|string} [options.id={}] Translate Id to output Point\n * @returns {Feature<Point>} 2-vertex GeoJSON Feature Point\n * @example\n * var multiLine = turf.multiLineString([\n *     [[10, 10], [50, 30], [30, 40]],\n *     [[-10, -10], [-50, -30], [-30, -40]]\n * ]);\n *\n * // First Segment (defaults are 0)\n * turf.findPoint(multiLine);\n * // => Feature<Point<[10, 10]>>\n *\n * // First Segment of the 2nd Multi-Feature\n * turf.findPoint(multiLine, {multiFeatureIndex: 1});\n * // => Feature<Point<[-10, -10]>>\n *\n * // Last Segment of last Multi-Feature\n * turf.findPoint(multiLine, {multiFeatureIndex: -1, coordIndex: -1});\n * // => Feature<Point<[-30, -40]>>\n */\nfunction findPoint<\n  G extends GeometryObject,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  geojson: Feature<G, P> | FeatureCollection<G, P> | G,\n  options?: {\n    featureIndex?: number;\n    multiFeatureIndex?: number;\n    geometryIndex?: number;\n    coordIndex?: number;\n    properties?: P;\n    bbox?: BBox;\n    id?: Id;\n  }\n): Feature<Point, P> {\n  // Optional Parameters\n  options = options || {};\n  if (!isObject(options)) throw new Error(\"options is invalid\");\n  var featureIndex = options.featureIndex || 0;\n  var multiFeatureIndex = options.multiFeatureIndex || 0;\n  var geometryIndex = options.geometryIndex || 0;\n  var coordIndex = options.coordIndex || 0;\n\n  // Find FeatureIndex\n  var properties = options.properties;\n  var geometry;\n\n  switch (geojson.type) {\n    case \"FeatureCollection\":\n      if (featureIndex < 0)\n        featureIndex = geojson.features.length + featureIndex;\n      properties = properties || geojson.features[featureIndex].properties;\n      geometry = geojson.features[featureIndex].geometry;\n      break;\n    case \"Feature\":\n      properties = properties || geojson.properties;\n      geometry = geojson.geometry;\n      break;\n    case \"Point\":\n    case \"MultiPoint\":\n      // @ts-expect-error: Known type conflict\n      return null;\n    case \"LineString\":\n    case \"Polygon\":\n    case \"MultiLineString\":\n    case \"MultiPolygon\":\n      geometry = geojson;\n      break;\n    default:\n      throw new Error(\"geojson is invalid\");\n  }\n\n  // Find Coord Index\n  // @ts-expect-error: Known type conflict\n  if (geometry === null) return null;\n  // @ts-expect-error: Known type conflict\n  var coords = geometry.coordinates;\n  switch (geometry.type) {\n    case \"Point\":\n      return point(coords, properties, options);\n    case \"MultiPoint\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      return point(coords[multiFeatureIndex], properties, options);\n    case \"LineString\":\n      if (coordIndex < 0) coordIndex = coords.length + coordIndex;\n      return point(coords[coordIndex], properties, options);\n    case \"Polygon\":\n      if (geometryIndex < 0) geometryIndex = coords.length + geometryIndex;\n      if (coordIndex < 0)\n        coordIndex = coords[geometryIndex].length + coordIndex;\n      return point(coords[geometryIndex][coordIndex], properties, options);\n    case \"MultiLineString\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      if (coordIndex < 0)\n        coordIndex = coords[multiFeatureIndex].length + coordIndex;\n      return point(coords[multiFeatureIndex][coordIndex], properties, options);\n    case \"MultiPolygon\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      if (geometryIndex < 0)\n        geometryIndex = coords[multiFeatureIndex].length + geometryIndex;\n      if (coordIndex < 0)\n        coordIndex =\n          coords[multiFeatureIndex][geometryIndex].length - coordIndex;\n      return point(\n        coords[multiFeatureIndex][geometryIndex][coordIndex],\n        properties,\n        options\n      );\n  }\n  throw new Error(\"geojson is invalid\");\n}\n\nexport {\n  coordReduce,\n  coordEach,\n  propEach,\n  propReduce,\n  featureReduce,\n  featureEach,\n  coordAll,\n  geomReduce,\n  geomEach,\n  flattenReduce,\n  flattenEach,\n  segmentReduce,\n  segmentEach,\n  lineReduce,\n  lineEach,\n  findSegment,\n  findPoint,\n};\n", "import { BBox } from \"geojson\";\nimport { AllGeoJSON } from \"@turf/helpers\";\nimport { coordEach } from \"@turf/meta\";\n\n/**\n * Calculates the bounding box for any GeoJSON object, including FeatureCollection.\n * Uses geojson.bbox if available and options.recompute is not set.\n *\n * @function\n * @param {GeoJSON} geojson any GeoJSON object\n * @param {Object} [options={}] Optional parameters\n * @param {boolean} [options.recompute] Whether to ignore an existing bbox property on geojson\n * @returns {BBox} bbox extent in [minX, minY, maxX, maxY] order\n * @example\n * var line = turf.lineString([[-74, 40], [-78, 42], [-82, 35]]);\n * var bbox = turf.bbox(line);\n * var bboxPolygon = turf.bboxPolygon(bbox);\n *\n * //addToMap\n * var addToMap = [line, bboxPolygon]\n */\nfunction bbox(\n  geojson: AllGeoJSON,\n  options: {\n    recompute?: boolean;\n  } = {}\n): BBox {\n  if (geojson.bbox != null && true !== options.recompute) {\n    return geojson.bbox;\n  }\n  const result: BBox = [Infinity, Infinity, -Infinity, -Infinity];\n  coordEach(geojson, (coord) => {\n    if (result[0] > coord[0]) {\n      result[0] = coord[0];\n    }\n    if (result[1] > coord[1]) {\n      result[1] = coord[1];\n    }\n    if (result[2] < coord[0]) {\n      result[2] = coord[0];\n    }\n    if (result[3] < coord[1]) {\n      result[3] = coord[1];\n    }\n  });\n  return result;\n}\n\nexport { bbox };\nexport default bbox;\n", "import { coordEach } from \"@turf/meta\";\nimport { AllGeoJSON, isObject } from \"@turf/helpers\";\n\n/**\n * Takes a GeoJSON Feature or FeatureCollection and truncates the precision of the geometry.\n *\n * @function\n * @param {GeoJSON} geojson any GeoJSON Feature, FeatureCollection, Geometry or GeometryCollection.\n * @param {Object} [options={}] Optional parameters\n * @param {number} [options.precision=6] coordinate decimal precision\n * @param {number} [options.coordinates=3] maximum number of coordinates (primarly used to remove z coordinates)\n * @param {boolean} [options.mutate=false] allows GeoJSON input to be mutated (significant performance increase if true)\n * @returns {GeoJSON} layer with truncated geometry\n * @example\n * var point = turf.point([\n *     70.46923055566859,\n *     58.11088890802906,\n *     1508\n * ]);\n * var options = {precision: 3, coordinates: 2};\n * var truncated = turf.truncate(point, options);\n * //=truncated.geometry.coordinates => [70.469, 58.111]\n *\n * //addToMap\n * var addToMap = [truncated];\n */\nfunction truncate<T extends AllGeoJSON>(\n  geojson: T,\n  options?: {\n    precision?: number;\n    coordinates?: number;\n    mutate?: boolean;\n  }\n): T {\n  // Optional parameters\n  options = options ?? {};\n  if (!isObject(options)) throw new Error(\"options is invalid\");\n  var precision = options.precision;\n  var coordinates = options.coordinates;\n  var mutate = options.mutate;\n\n  // default params\n  precision =\n    precision === undefined || precision === null || isNaN(precision)\n      ? 6\n      : precision;\n  coordinates =\n    coordinates === undefined || coordinates === null || isNaN(coordinates)\n      ? 3\n      : coordinates;\n\n  // validation\n  if (!geojson) throw new Error(\"<geojson> is required\");\n  if (typeof precision !== \"number\")\n    throw new Error(\"<precision> must be a number\");\n  if (typeof coordinates !== \"number\")\n    throw new Error(\"<coordinates> must be a number\");\n\n  // prevent input mutation\n  if (mutate === false || mutate === undefined)\n    geojson = JSON.parse(JSON.stringify(geojson));\n\n  var factor = Math.pow(10, precision);\n\n  // Truncate Coordinates\n  coordEach(geojson, function (coords) {\n    truncateCoords(coords, factor, coordinates!);\n  });\n  return geojson;\n}\n\n/**\n * Truncate Coordinates - Mutates coordinates in place\n *\n * @private\n * @param {Array<any>} coords Geometry Coordinates\n * @param {number} factor rounding factor for coordinate decimal precision\n * @param {number} coordinates maximum number of coordinates (primarly used to remove z coordinates)\n * @returns {Array<any>} mutated coordinates\n */\nfunction truncateCoords(coords: number[], factor: number, coordinates: number) {\n  // Remove extra coordinates (usually elevation coordinates and more)\n  if (coords.length > coordinates) coords.splice(coordinates, coords.length);\n\n  // Truncate coordinate decimals\n  for (var i = 0; i < coords.length; i++) {\n    coords[i] = Math.round(coords[i] * factor) / factor;\n  }\n  return coords;\n}\n\nexport { truncate };\nexport default truncate;\n", "import {\n  Feature,\n  FeatureCollection,\n  Geometry,\n  LineString,\n  MultiPoint,\n  MultiLineString,\n  MultiPolygon,\n  Point,\n  Polygon,\n} from \"geojson\";\nimport { isNumber } from \"@turf/helpers\";\n\n/**\n * Unwrap a coordinate from a Point Feature, Geometry or a single coordinate.\n *\n * @function\n * @param {Array<number>|Geometry<Point>|Feature<Point>} coord GeoJSON Point or an Array of numbers\n * @returns {Array<number>} coordinates\n * @example\n * var pt = turf.point([10, 10]);\n *\n * var coord = turf.getCoord(pt);\n * //= [10, 10]\n */\nfunction getCoord(coord: Feature<Point> | Point | number[]): number[] {\n  if (!coord) {\n    throw new Error(\"coord is required\");\n  }\n\n  if (!Array.isArray(coord)) {\n    if (\n      coord.type === \"Feature\" &&\n      coord.geometry !== null &&\n      coord.geometry.type === \"Point\"\n    ) {\n      return [...coord.geometry.coordinates];\n    }\n    if (coord.type === \"Point\") {\n      return [...coord.coordinates];\n    }\n  }\n  if (\n    Array.isArray(coord) &&\n    coord.length >= 2 &&\n    !Array.isArray(coord[0]) &&\n    !Array.isArray(coord[1])\n  ) {\n    return [...coord];\n  }\n\n  throw new Error(\"coord must be GeoJSON Point or an Array of numbers\");\n}\n\n/**\n * Unwrap coordinates from a Feature, Geometry Object or an Array\n *\n * @function\n * @param {Array<any>|Geometry|Feature} coords Feature, Geometry Object or an Array\n * @returns {Array<any>} coordinates\n * @example\n * var poly = turf.polygon([[[119.32, -8.7], [119.55, -8.69], [119.51, -8.54], [119.32, -8.7]]]);\n *\n * var coords = turf.getCoords(poly);\n * //= [[[119.32, -8.7], [119.55, -8.69], [119.51, -8.54], [119.32, -8.7]]]\n */\nfunction getCoords<\n  G extends\n    | Point\n    | LineString\n    | Polygon\n    | MultiPoint\n    | MultiLineString\n    | MultiPolygon,\n>(coords: any[] | Feature<G> | G): any[] {\n  if (Array.isArray(coords)) {\n    return coords;\n  }\n\n  // Feature\n  if (coords.type === \"Feature\") {\n    if (coords.geometry !== null) {\n      return coords.geometry.coordinates;\n    }\n  } else {\n    // Geometry\n    if (coords.coordinates) {\n      return coords.coordinates;\n    }\n  }\n\n  throw new Error(\n    \"coords must be GeoJSON Feature, Geometry Object or an Array\"\n  );\n}\n\n/**\n * Checks if coordinates contains a number\n *\n * @function\n * @param {Array<any>} coordinates GeoJSON Coordinates\n * @returns {boolean} true if Array contains a number\n */\nfunction containsNumber(coordinates: any[]): boolean {\n  if (\n    coordinates.length > 1 &&\n    isNumber(coordinates[0]) &&\n    isNumber(coordinates[1])\n  ) {\n    return true;\n  }\n\n  if (Array.isArray(coordinates[0]) && coordinates[0].length) {\n    return containsNumber(coordinates[0]);\n  }\n  throw new Error(\"coordinates must only contain numbers\");\n}\n\n/**\n * Enforce expectations about types of GeoJSON objects for Turf.\n *\n * @function\n * @param {GeoJSON} value any GeoJSON object\n * @param {string} type expected GeoJSON type\n * @param {string} name name of calling function\n * @throws {Error} if value is not the expected type.\n */\nfunction geojsonType(value: any, type: string, name: string): void {\n  if (!type || !name) {\n    throw new Error(\"type and name required\");\n  }\n\n  if (!value || value.type !== type) {\n    throw new Error(\n      \"Invalid input to \" +\n        name +\n        \": must be a \" +\n        type +\n        \", given \" +\n        value.type\n    );\n  }\n}\n\n/**\n * Enforce expectations about types of {@link Feature} inputs for Turf.\n * Internally this uses {@link geojsonType} to judge geometry types.\n *\n * @function\n * @param {Feature} feature a feature with an expected geometry type\n * @param {string} type expected GeoJSON type\n * @param {string} name name of calling function\n * @throws {Error} error if value is not the expected type.\n */\nfunction featureOf(feature: Feature<any>, type: string, name: string): void {\n  if (!feature) {\n    throw new Error(\"No feature passed\");\n  }\n  if (!name) {\n    throw new Error(\".featureOf() requires a name\");\n  }\n  if (!feature || feature.type !== \"Feature\" || !feature.geometry) {\n    throw new Error(\n      \"Invalid input to \" + name + \", Feature with geometry required\"\n    );\n  }\n  if (!feature.geometry || feature.geometry.type !== type) {\n    throw new Error(\n      \"Invalid input to \" +\n        name +\n        \": must be a \" +\n        type +\n        \", given \" +\n        feature.geometry.type\n    );\n  }\n}\n\n/**\n * Enforce expectations about types of {@link FeatureCollection} inputs for Turf.\n * Internally this uses {@link geojsonType} to judge geometry types.\n *\n * @function\n * @param {FeatureCollection} featureCollection a FeatureCollection for which features will be judged\n * @param {string} type expected GeoJSON type\n * @param {string} name name of calling function\n * @throws {Error} if value is not the expected type.\n */\nfunction collectionOf(\n  featureCollection: FeatureCollection<any>,\n  type: string,\n  name: string\n) {\n  if (!featureCollection) {\n    throw new Error(\"No featureCollection passed\");\n  }\n  if (!name) {\n    throw new Error(\".collectionOf() requires a name\");\n  }\n  if (!featureCollection || featureCollection.type !== \"FeatureCollection\") {\n    throw new Error(\n      \"Invalid input to \" + name + \", FeatureCollection required\"\n    );\n  }\n  for (const feature of featureCollection.features) {\n    if (!feature || feature.type !== \"Feature\" || !feature.geometry) {\n      throw new Error(\n        \"Invalid input to \" + name + \", Feature with geometry required\"\n      );\n    }\n    if (!feature.geometry || feature.geometry.type !== type) {\n      throw new Error(\n        \"Invalid input to \" +\n          name +\n          \": must be a \" +\n          type +\n          \", given \" +\n          feature.geometry.type\n      );\n    }\n  }\n}\n\n/**\n * Get Geometry from Feature or Geometry Object\n *\n * @param {Feature|Geometry} geojson GeoJSON Feature or Geometry Object\n * @returns {Geometry|null} GeoJSON Geometry Object\n * @throws {Error} if geojson is not a Feature or Geometry Object\n * @example\n * var point = {\n *   \"type\": \"Feature\",\n *   \"properties\": {},\n *   \"geometry\": {\n *     \"type\": \"Point\",\n *     \"coordinates\": [110, 40]\n *   }\n * }\n * var geom = turf.getGeom(point)\n * //={\"type\": \"Point\", \"coordinates\": [110, 40]}\n */\nfunction getGeom<G extends Geometry>(geojson: Feature<G> | G): G {\n  if (geojson.type === \"Feature\") {\n    return geojson.geometry;\n  }\n  return geojson;\n}\n\n/**\n * Get GeoJSON object's type, Geometry type is prioritize.\n *\n * @param {GeoJSON} geojson GeoJSON object\n * @param {string} [name=\"geojson\"] name of the variable to display in error message (unused)\n * @returns {string} GeoJSON type\n * @example\n * var point = {\n *   \"type\": \"Feature\",\n *   \"properties\": {},\n *   \"geometry\": {\n *     \"type\": \"Point\",\n *     \"coordinates\": [110, 40]\n *   }\n * }\n * var geom = turf.getType(point)\n * //=\"Point\"\n */\nfunction getType(\n  geojson: Feature<any> | FeatureCollection<any> | Geometry,\n  _name?: string\n): string {\n  if (geojson.type === \"FeatureCollection\") {\n    return \"FeatureCollection\";\n  }\n  if (geojson.type === \"GeometryCollection\") {\n    return \"GeometryCollection\";\n  }\n  if (geojson.type === \"Feature\" && geojson.geometry !== null) {\n    return geojson.geometry.type;\n  }\n  return geojson.type;\n}\n\nexport {\n  getCoord,\n  getCoords,\n  containsNumber,\n  geojsonType,\n  featureOf,\n  collectionOf,\n  getGeom,\n  getType,\n};\n// No default export!\n", "import {\n  BBox,\n  Feature,\n  FeatureCollection,\n  LineString,\n  MultiLineString,\n  MultiPolygon,\n  Polygon,\n} from \"geojson\";\nimport { featureCollection, lineString } from \"@turf/helpers\";\nimport { getCoords } from \"@turf/invariant\";\nimport { flattenEach } from \"@turf/meta\";\n\n/**\n * Creates a {@link FeatureCollection} of 2-vertex {@link LineString} segments from a\n * {@link LineString|(Multi)LineString} or {@link Polygon|(Multi)Polygon}.\n *\n * @function\n * @param {GeoJSON} geojson GeoJSON Polygon or LineString\n * @returns {FeatureCollection<LineString>} 2-vertex line segments\n * @example\n * var polygon = turf.polygon([[[-50, 5], [-40, -10], [-50, -10], [-40, 5], [-50, 5]]]);\n * var segments = turf.lineSegment(polygon);\n *\n * //addToMap\n * var addToMap = [polygon, segments]\n */\nfunction lineSegment<\n  G extends LineString | MultiLineString | Polygon | MultiPolygon,\n>(\n  geojson: Feature<G> | FeatureCollection<G> | G\n): FeatureCollection<LineString> {\n  if (!geojson) {\n    throw new Error(\"geojson is required\");\n  }\n\n  const results: Array<Feature<LineString>> = [];\n  flattenEach(geojson, (feature: Feature<any>) => {\n    lineSegmentFeature(feature, results);\n  });\n  return featureCollection(results);\n}\n\n/**\n * Line Segment\n *\n * @private\n * @param {Feature<LineString|Polygon>} geojson Line or polygon feature\n * @param {Array} results push to results\n * @returns {void}\n */\nfunction lineSegmentFeature(\n  geojson: Feature<LineString | Polygon>,\n  results: Array<Feature<LineString>>\n) {\n  let coords: number[][][] = [];\n  const geometry = geojson.geometry;\n  if (geometry !== null) {\n    switch (geometry.type) {\n      case \"Polygon\":\n        coords = getCoords(geometry);\n        break;\n      case \"LineString\":\n        coords = [getCoords(geometry)];\n    }\n    coords.forEach((coord) => {\n      const segments = createSegments(coord, geojson.properties);\n      segments.forEach((segment) => {\n        segment.id = results.length;\n        results.push(segment);\n      });\n    });\n  }\n}\n\n/**\n * Create Segments from LineString coordinates\n *\n * @private\n * @param {Array<Array<number>>} coords LineString coordinates\n * @param {*} properties GeoJSON properties\n * @returns {Array<Feature<LineString>>} line segments\n */\nfunction createSegments(coords: number[][], properties: any) {\n  const segments: Array<Feature<LineString>> = [];\n  coords.reduce((previousCoords, currentCoords) => {\n    const segment = lineString([previousCoords, currentCoords], properties);\n    segment.bbox = bbox(previousCoords, currentCoords);\n    segments.push(segment);\n    return currentCoords;\n  });\n  return segments;\n}\n\n/**\n * Create BBox between two coordinates (faster than @turf/bbox)\n *\n * @private\n * @param {Array<number>} coords1 Point coordinate\n * @param {Array<number>} coords2 Point coordinate\n * @returns {BBox} [west, south, east, north]\n */\nfunction bbox(coords1: number[], coords2: number[]): BBox {\n  const x1 = coords1[0];\n  const y1 = coords1[1];\n  const x2 = coords2[0];\n  const y2 = coords2[1];\n  const west = x1 < x2 ? x1 : x2;\n  const south = y1 < y2 ? y1 : y2;\n  const east = x1 > x2 ? x1 : x2;\n  const north = y1 > y2 ? y1 : y2;\n  return [west, south, east, north];\n}\n\nexport { lineSegment };\nexport default lineSegment;\n", "import { getCoord } from \"@turf/invariant\";\nimport { radiansToLength, degreesToRadians, Coord, Units } from \"@turf/helpers\";\n\n//http://en.wikipedia.org/wiki/Haversine_formula\n//http://www.movable-type.co.uk/scripts/latlong.html\n\n/**\n * Calculates the distance between two {@link Coord|coordinates} in degrees, radians, miles, or kilometers.\n * This uses the [Haversine formula](http://en.wikipedia.org/wiki/Haversine_formula) to account for global curvature.\n *\n * @function\n * @param {Coord} from origin coordinate\n * @param {Coord} to destination coordinate\n * @param {Object} [options={}] Optional parameters\n * @param {Units} [options.units='kilometers'] Supports all valid Turf {@link https://turfjs.org/docs/api/types/Units Units}.\n * @returns {number} distance between the two coordinates\n * @example\n * var from = turf.point([-75.343, 39.984]);\n * var to = turf.point([-75.534, 39.123]);\n * var options = {units: 'miles'};\n *\n * var distance = turf.distance(from, to, options);\n *\n * //addToMap\n * var addToMap = [from, to];\n * from.properties.distance = distance;\n * to.properties.distance = distance;\n */\nfunction distance(\n  from: Coord,\n  to: Coord,\n  options: {\n    units?: Units;\n  } = {}\n) {\n  var coordinates1 = getCoord(from);\n  var coordinates2 = getCoord(to);\n  var dLat = degreesToRadians(coordinates2[1] - coordinates1[1]);\n  var dLon = degreesToRadians(coordinates2[0] - coordinates1[0]);\n  var lat1 = degreesToRadians(coordinates1[1]);\n  var lat2 = degreesToRadians(coordinates2[1]);\n\n  var a =\n    Math.pow(Math.sin(dLat / 2), 2) +\n    Math.pow(Math.sin(dLon / 2), 2) * Math.cos(lat1) * Math.cos(lat2);\n\n  return radiansToLength(\n    2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)),\n    options.units\n  );\n}\n\nexport { distance };\nexport default distance;\n", "import { Feature, Point, Position, LineString, MultiLineString } from \"geojson\";\nimport { distance } from \"@turf/distance\";\nimport { flattenEach } from \"@turf/meta\";\nimport {\n  point,\n  degreesToRadians,\n  radiansToDegrees,\n  Coord,\n  Units,\n} from \"@turf/helpers\";\nimport { getCoord, getCoords } from \"@turf/invariant\";\n\n/**\n * Returns the nearest point on a line to a given point.\n *\n * If any of the segments in the input line string are antipodal and therefore\n * have an undefined arc, this function will instead return that the point lies\n * on the line.\n *\n *  We have begun the process of migrating to different return properties for\n * this function. The new properties we recommend using as of v7.4 are:\n * - lineStringIndex - point was found on the nth LineString of an input MultiLineString. Previously `multiFeatureIndex`\n * - segmentIndex - point was found on the nth segment of the above LineString. Previously `index`\n * - totalDistance - distance from the start of the overall MultiLineString. Previously `location`\n * - lineDistance - distance from the start of the relevant LineString\n * - segmentDistance - distance from the start of the relevant segment\n * - pointDistance - distance between found point is from input reference point. Previously `dist`\n *\n * multiFeatureIndex, index, location, and dist continue to work as previously\n * until at least the next major release.\n *\n * @function\n * @param {Geometry|Feature<LineString|MultiLineString>} lines Lines to snap to\n * @param {Geometry|Feature<Point>|number[]} inputPoint Point to snap from\n * @param {Object} [options={}] Optional parameters\n * @param {Units} [options.units='kilometers'] Supports all valid Turf {@link https://turfjs.org/docs/api/types/Units Units}\n * @returns {Feature<Point>} closest point on the `lines` to the `inputPoint`. The point will have the following properties: `lineStringIndex`: closest point was found on the nth LineString (only relevant if input is MultiLineString), `segmentIndex`: closest point was found on nth line segment of the LineString, `totalDistance`: distance along the line from the absolute start of the MultiLineString, `lineDistance`: distance along the line from the start of the LineString where the closest point was found, `segmentDistance`: distance along the line from the start of the line segment where the closest point was found, `pointDistance`: distance to the input point.\n * @example\n * var line = turf.lineString([\n *     [-77.031669, 38.878605],\n *     [-77.029609, 38.881946],\n *     [-77.020339, 38.884084],\n *     [-77.025661, 38.885821],\n *     [-77.021884, 38.889563],\n *     [-77.019824, 38.892368]\n * ]);\n * var inputPoint = turf.point([-77.037076, 38.884017]);\n *\n * var snapped = turf.nearestPointOnLine(line, inputPoint, {units: 'miles'});\n *\n * //addToMap\n * var addToMap = [line, inputPoint, snapped];\n * snapped.properties['marker-color'] = '#00f';\n */\nfunction nearestPointOnLine<G extends LineString | MultiLineString>(\n  lines: Feature<G> | G,\n  inputPoint: Coord,\n  options: { units?: Units } = {}\n): Feature<\n  Point,\n  {\n    lineStringIndex: number;\n    segmentIndex: number;\n    totalDistance: number;\n    lineDistance: number;\n    segmentDistance: number;\n    pointDistance: number;\n    multiFeatureIndex: number;\n    index: number;\n    location: number;\n    dist: number;\n    [key: string]: any;\n  }\n> {\n  if (!lines || !inputPoint) {\n    throw new Error(\"lines and inputPoint are required arguments\");\n  }\n\n  const inputPos = getCoord(inputPoint);\n\n  let closestPt = point([Infinity, Infinity], {\n    lineStringIndex: -1,\n    segmentIndex: -1,\n    totalDistance: -1,\n    lineDistance: -1,\n    segmentDistance: -1,\n    pointDistance: Infinity,\n    // deprecated properties START\n    multiFeatureIndex: -1,\n    index: -1,\n    location: -1,\n    dist: Infinity,\n    // deprecated properties END\n  });\n\n  let totalDistance = 0.0;\n  let lineDistance = 0.0;\n  let currentLineStringIndex = -1;\n  flattenEach(\n    lines,\n    function (line: any, _featureIndex: number, lineStringIndex: number) {\n      //reset lineDistance at each changed lineStringIndex\n      if (currentLineStringIndex !== lineStringIndex) {\n        currentLineStringIndex = lineStringIndex;\n        lineDistance = 0.0;\n      }\n\n      const coords: any = getCoords(line);\n      const maxSegmentIndex = coords.length - 2;\n\n      for (let i = 0; i < coords.length - 1; i++) {\n        //start - start of current line section\n        const start: Feature<Point, { dist: number }> = point(coords[i]);\n        const startPos = getCoord(start);\n\n        //stop - end of current line section\n        const stop: Feature<Point, { dist: number }> = point(coords[i + 1]);\n        const stopPos = getCoord(stop);\n\n        // segmentLength\n        const segmentLength = distance(start, stop, options);\n        let intersectPos: Position;\n        let wasEnd: boolean;\n\n        // Short circuit if snap point is start or end position of the line\n        // Test the end position first for consistency in case they are\n        // coincident\n        if (stopPos[0] === inputPos[0] && stopPos[1] === inputPos[1]) {\n          [intersectPos, wasEnd] = [stopPos, true];\n        } else if (startPos[0] === inputPos[0] && startPos[1] === inputPos[1]) {\n          [intersectPos, wasEnd] = [startPos, false];\n        } else {\n          // Otherwise, find the nearest point the hard way.\n          [intersectPos, wasEnd] = nearestPointOnSegment(\n            startPos,\n            stopPos,\n            inputPos\n          );\n        }\n\n        const pointDistance = distance(inputPoint, intersectPos, options);\n\n        if (pointDistance < closestPt.properties.pointDistance) {\n          const segmentDistance = distance(start, intersectPos, options);\n          closestPt = point(intersectPos, {\n            lineStringIndex: lineStringIndex,\n            // Legacy behaviour where index progresses to next segment if we\n            // went with the end point this iteration. Though make sure we\n            // only progress to the beginning of the next segment if one\n            // actually exists.\n            segmentIndex: wasEnd && i + 1 <= maxSegmentIndex ? i + 1 : i,\n            totalDistance: totalDistance + segmentDistance,\n            lineDistance: lineDistance + segmentDistance,\n            segmentDistance: segmentDistance,\n            pointDistance: pointDistance,\n            // deprecated properties START\n            multiFeatureIndex: -1,\n            index: -1,\n            location: -1,\n            dist: Infinity,\n            // deprecated properties END\n          });\n          closestPt.properties = {\n            ...closestPt.properties,\n            multiFeatureIndex: closestPt.properties.lineStringIndex,\n            index: closestPt.properties.segmentIndex,\n            location: closestPt.properties.totalDistance,\n            dist: closestPt.properties.pointDistance,\n            // deprecated properties END\n          };\n        }\n\n        // update totalDistance and lineDistance\n        totalDistance += segmentLength;\n        lineDistance += segmentLength;\n      }\n    }\n  );\n\n  return closestPt;\n}\n\n// A simple Vector3 type for cartesian operations.\ntype Vector = [number, number, number];\n\nfunction dot(v1: Vector, v2: Vector): number {\n  const [v1x, v1y, v1z] = v1;\n  const [v2x, v2y, v2z] = v2;\n  return v1x * v2x + v1y * v2y + v1z * v2z;\n}\n\n// https://en.wikipedia.org/wiki/Cross_product\nfunction cross(v1: Vector, v2: Vector): Vector {\n  const [v1x, v1y, v1z] = v1;\n  const [v2x, v2y, v2z] = v2;\n  return [v1y * v2z - v1z * v2y, v1z * v2x - v1x * v2z, v1x * v2y - v1y * v2x];\n}\n\nfunction magnitude(v: Vector): number {\n  return Math.sqrt(Math.pow(v[0], 2) + Math.pow(v[1], 2) + Math.pow(v[2], 2));\n}\n\nfunction normalize(v: Vector): Vector {\n  const mag = magnitude(v);\n  return [v[0] / mag, v[1] / mag, v[2] / mag];\n}\n\nfunction lngLatToVector(a: Position): Vector {\n  const lat = degreesToRadians(a[1]);\n  const lng = degreesToRadians(a[0]);\n  return [\n    Math.cos(lat) * Math.cos(lng),\n    Math.cos(lat) * Math.sin(lng),\n    Math.sin(lat),\n  ];\n}\n\nfunction vectorToLngLat(v: Vector): Position {\n  const [x, y, z] = v;\n  // Clamp the z-value to ensure that is inside the [-1, 1] domain as required\n  // by asin. Note therefore that this function should only be applied to unit\n  // vectors so z > 1 should not exist\n  const zClamp = Math.min(Math.max(z, -1), 1);\n  const lat = radiansToDegrees(Math.asin(zClamp));\n  const lng = radiansToDegrees(Math.atan2(y, x));\n\n  return [lng, lat];\n}\n\nfunction nearestPointOnSegment(\n  posA: Position, // start point of segment to measure to\n  posB: Position, // end point of segment to measure to\n  posC: Position // point to measure from\n): [Position, boolean] {\n  // Based heavily on this article on finding cross track distance to an arc:\n  // https://gis.stackexchange.com/questions/209540/projecting-cross-track-distance-on-great-circle\n\n  // Convert spherical (lng, lat) to cartesian vector coords (x, y, z)\n  // In the below https://tikz.net/spherical_1/ we convert lng () and lat ()\n  // into vectors with x, y, and z components with a length (r) of 1.\n  const A = lngLatToVector(posA); // the vector from 0,0,0 to posA\n  const B = lngLatToVector(posB); // ... to posB\n  const C = lngLatToVector(posC); // ... to posC\n\n  // The axis (normal vector) of the great circle plane containing the line segment\n  const segmentAxis = cross(A, B);\n\n  // Two degenerate cases exist for the segment axis cross product. The first is\n  // when vectors are aligned (within the bounds of floating point tolerance).\n  // The second is where vectors are antipodal (again within the bounds of\n  // tolerance. Both cases produce a [0, 0, 0] cross product which invalidates\n  // the rest of the algorithm, but each case must be handled separately:\n  // - The aligned case indicates coincidence of A and B. therefore this can be\n  //   an early return assuming the closest point is the end (for consistency).\n  // - The antipodal case is truly degenerate - an infinte number of great\n  //   circles are possible and one will always pass through C. However, given\n  //   that this case is both highly unlikely to occur in practice and that is\n  //   will usually be logically sound to return that the point is on the\n  //   segment, we choose to return the provided point.\n  if (segmentAxis[0] === 0 && segmentAxis[1] === 0 && segmentAxis[2] === 0) {\n    if (dot(A, B) > 0) {\n      return [[...posB], true];\n    } else {\n      return [[...posC], false];\n    }\n  }\n\n  // The axis of the great circle passing through the segment's axis and the\n  // target point\n  const targetAxis = cross(segmentAxis, C);\n\n  // This cross product also has a degenerate case where the segment axis is\n  // coincident with or antipodal to the target point. In this case the point\n  // is equidistant to the entire segment. For consistency, we early return the\n  // endpoint as the matching point.\n  if (targetAxis[0] === 0 && targetAxis[1] === 0 && targetAxis[2] === 0) {\n    return [[...posB], true];\n  }\n\n  // The line of intersection between the two great circle planes\n  const intersectionAxis = cross(targetAxis, segmentAxis);\n\n  // Vectors to the two points these great circles intersect are the normalized\n  // intersection and its antipodes\n  const I1 = normalize(intersectionAxis);\n  const I2: Vector = [-I1[0], -I1[1], -I1[2]];\n\n  // Figure out which is the closest intersection to this segment of the great circle\n  // Note that for points on a unit sphere, the dot product represents the\n  // cosine of the angle between the two vectors which monotonically increases\n  // the closer the two points are together and therefore determines proximity\n  const I = dot(C, I1) > dot(C, I2) ? I1 : I2;\n\n  // I is the closest intersection to the segment, though might not actually be\n  // ON the segment. To test whether the closest intersection lies on the arc or\n  // not, we do a cross product comparison to check rotation around the unit\n  // circle defined by the great circle plane.\n  const segmentAxisNorm = normalize(segmentAxis);\n  const cmpAI = dot(cross(A, I), segmentAxisNorm);\n  const cmpIB = dot(cross(I, B), segmentAxisNorm);\n\n  // When both comparisons are positive, the rotation from A to I to B is in the\n  // same direction, implying that I lies between A and B\n  if (cmpAI >= 0 && cmpIB >= 0) {\n    return [vectorToLngLat(I), false];\n  }\n\n  // Finally process the case where the intersection is not on the segment,\n  // using the dot product with the original point to find the closest endpoint\n  if (dot(A, C) > dot(B, C)) {\n    // Clone position when returning as it is reasonable to not expect structural\n    // sharing on the returned Position in all return cases\n    return [[...posA], false];\n  } else {\n    return [[...posB], true];\n  }\n}\n\nexport { nearestPointOnLine };\nexport default nearestPointOnLine;\n", "import { geojsonRbush as rbush } from \"@turf/geojson-rbush\";\nimport { truncate } from \"@turf/truncate\";\nimport { lineSegment } from \"@turf/line-segment\";\nimport { lineIntersect } from \"@turf/line-intersect\";\nimport { nearestPointOnLine } from \"@turf/nearest-point-on-line\";\nimport { getCoords, getCoord, getType } from \"@turf/invariant\";\nimport { featureEach, featureReduce, flattenEach } from \"@turf/meta\";\nimport { lineString, featureCollection, feature } from \"@turf/helpers\";\nimport {\n  Feature,\n  FeatureCollection,\n  GeoJsonTypes,\n  LineString,\n  MultiLineString,\n  MultiPoint,\n  MultiPolygon,\n  Point,\n  Polygon,\n} from \"geojson\";\n\ntype Splitter = Feature<\n  Point | MultiPoint | LineString | MultiLineString | Polygon | MultiPolygon\n>;\n\n/**\n * Split a LineString by another GeoJSON Feature.\n *\n * @function\n * @param {Feature<LineString>} line LineString Feature to split\n * @param {Feature<any>} splitter Feature used to split line\n * @returns {FeatureCollection<LineString>} Split LineStrings\n * @example\n * var line = turf.lineString([[120, -25], [145, -25]]);\n * var splitter = turf.lineString([[130, -15], [130, -35]]);\n *\n * var split = turf.lineSplit(line, splitter);\n *\n * //addToMap\n * var addToMap = [line, splitter, split]\n *\n * split.features[0].properties.stroke = \"red\";\n * split.features[1].properties.stroke = \"blue\";\n */\nfunction lineSplit<T extends LineString>(\n  line: Feature<T> | T,\n  splitter: Splitter\n): FeatureCollection<T> {\n  if (!line) throw new Error(\"line is required\");\n  if (!splitter) throw new Error(\"splitter is required\");\n\n  const lineType = getType(line) as Exclude<GeoJsonTypes, \"Feature\">;\n  const splitterType = getType(splitter) as Exclude<GeoJsonTypes, \"Feature\">;\n\n  if (lineType !== \"LineString\") throw new Error(\"line must be LineString\");\n  if (splitterType === \"FeatureCollection\")\n    throw new Error(\"splitter cannot be a FeatureCollection\");\n  if (splitterType === \"GeometryCollection\")\n    throw new Error(\"splitter cannot be a GeometryCollection\");\n\n  // remove excessive decimals from splitter\n  // to avoid possible approximation issues in rbush\n  var truncatedSplitter = truncate(splitter, { precision: 7 });\n\n  // Ensure we're consistently sending Feature<LineString> into the splitLine methods.\n  if (line.type !== \"Feature\") {\n    line = feature(line);\n  }\n\n  switch (splitterType) {\n    case \"Point\":\n      return splitLineWithPoint(\n        line as Feature<LineString>,\n        truncatedSplitter as Feature<Point>\n      ) as FeatureCollection<T>;\n    case \"MultiPoint\":\n      return splitLineWithPoints(\n        line as Feature<LineString>,\n        truncatedSplitter as Feature<MultiPoint>\n      ) as FeatureCollection<T>;\n    case \"LineString\":\n    case \"MultiLineString\":\n    case \"Polygon\":\n    case \"MultiPolygon\":\n      return splitLineWithPoints(\n        line as Feature<LineString>,\n        lineIntersect(\n          line,\n          truncatedSplitter as Feature<\n            LineString | MultiLineString | Polygon | MultiPolygon\n          >,\n          {\n            ignoreSelfIntersections: true,\n          }\n        )\n      ) as FeatureCollection<T>;\n  }\n}\n\n/**\n * Split LineString with MultiPoint\n *\n * @private\n * @param {Feature<LineString>} line LineString\n * @param {FeatureCollection<Point>} splitter Point\n * @returns {FeatureCollection<LineString>} split LineStrings\n */\nfunction splitLineWithPoints(\n  line: Feature<LineString>,\n  splitter: FeatureCollection<Point> | Feature<MultiPoint>\n) {\n  var results: Feature<LineString>[] = [];\n  var tree = rbush<LineString>();\n\n  flattenEach(\n    splitter as FeatureCollection<Point>, // this cast should be unnecessary (and is wrong, it could contain MultiPoints), but is a workaround for bad flattenEach typings\n    function (point: Feature<Point>) {\n      // Add index/id to features (needed for filter)\n      results.forEach(function (feature, index) {\n        feature.id = index;\n      });\n      // First Point - doesn't need to handle any previous line results\n      if (!results.length) {\n        results = splitLineWithPoint(line, point).features;\n        tree.load(featureCollection(results));\n        // Split with remaining points - lines might needed to be split multiple times\n      } else {\n        // Find all lines that are within the splitter's bbox\n        var search = tree.search(point);\n\n        if (search.features.length) {\n          // RBush might return multiple lines - only process the closest line to splitter\n          var closestLine = findClosestFeature(point, search);\n\n          // Remove closest line from results since this will be split into two lines\n          // This removes any duplicates inside the results & index\n          results = results.filter(function (feature) {\n            return feature.id !== closestLine.id;\n          });\n          tree.remove(closestLine);\n\n          // Append the two newly split lines into the results\n          featureEach(splitLineWithPoint(closestLine, point), function (line) {\n            results.push(line);\n            tree.insert(line);\n          });\n        }\n      }\n    }\n  );\n  return featureCollection(results);\n}\n\n/**\n * Split LineString with Point\n *\n * @private\n * @param {Feature<LineString>} line LineString\n * @param {Feature<Point>} splitter Point\n * @returns {FeatureCollection<LineString>} split LineStrings\n */\nfunction splitLineWithPoint(\n  line: Feature<LineString>,\n  splitter: Feature<Point>\n) {\n  var results = [];\n\n  // handle endpoints\n  var startPoint = getCoords(line)[0];\n  var endPoint = getCoords(line)[line.geometry.coordinates.length - 1];\n  if (\n    pointsEquals(startPoint, getCoord(splitter)) ||\n    pointsEquals(endPoint, getCoord(splitter))\n  )\n    return featureCollection([line]);\n\n  // Create spatial index\n  var tree = rbush<LineString>();\n  var segments = lineSegment(line);\n  tree.load(segments);\n\n  // Find all segments that are within bbox of splitter\n  var search = tree.search(splitter);\n\n  // Return itself if point is not within spatial index\n  if (!search.features.length) return featureCollection([line]);\n\n  // RBush might return multiple lines - only process the closest line to splitter\n  var closestSegment = findClosestFeature(splitter, search);\n\n  // Initial value is the first point of the first segments (beginning of line)\n  var initialValue = [startPoint];\n  var lastCoords = featureReduce(\n    segments,\n    function (previous, current, index) {\n      var currentCoords = getCoords(current)[1];\n      var splitterCoords = getCoord(splitter);\n\n      // Location where segment intersects with line\n      if (index === closestSegment.id) {\n        previous.push(splitterCoords);\n        results.push(lineString(previous));\n        // Don't duplicate splitter coordinate (Issue #688)\n        if (pointsEquals(splitterCoords, currentCoords))\n          return [splitterCoords];\n        return [splitterCoords, currentCoords];\n\n        // Keep iterating over coords until finished or intersection is found\n      } else {\n        previous.push(currentCoords);\n        return previous;\n      }\n    },\n    initialValue\n  );\n  // Append last line to final split results\n  if (lastCoords.length > 1) {\n    results.push(lineString(lastCoords));\n  }\n  return featureCollection(results);\n}\n\n/**\n * Find Closest Feature\n *\n * @private\n * @param {Feature<Point>} point Feature must be closest to this point\n * @param {FeatureCollection<LineString>} lines Collection of Features\n * @returns {Feature<LineString>} closest LineString\n */\nfunction findClosestFeature(\n  point: Feature<Point>,\n  lines: FeatureCollection<LineString>\n): Feature<LineString> {\n  if (!lines.features.length) throw new Error(\"lines must contain features\");\n  // Filter to one segment that is the closest to the line\n  if (lines.features.length === 1) return lines.features[0];\n\n  var closestFeature;\n  var closestDistance = Infinity;\n  featureEach(lines, function (segment) {\n    var pt = nearestPointOnLine(segment, point);\n    var dist = pt.properties.dist;\n    if (dist < closestDistance) {\n      closestFeature = segment;\n      closestDistance = dist;\n    }\n  });\n  return closestFeature!;\n}\n\n/**\n * Compares two points and returns if they are equals\n *\n * @private\n * @param {Array<number>} pt1 point\n * @param {Array<number>} pt2 point\n * @returns {boolean} true if they are equals\n */\nfunction pointsEquals(pt1: number[], pt2: number[]) {\n  return pt1[0] === pt2[0] && pt1[1] === pt2[1];\n}\n\nexport { Splitter, lineSplit };\nexport default lineSplit;\n", "export const epsilon = 1.1102230246251565e-16;\nexport const splitter = 134217729;\nexport const resulterrbound = (3 + 8 * epsilon) * epsilon;\n\n// fast_expansion_sum_zeroelim routine from oritinal code\nexport function sum(elen, e, flen, f, h) {\n    let Q, Qnew, hh, bvirt;\n    let enow = e[0];\n    let fnow = f[0];\n    let eindex = 0;\n    let findex = 0;\n    if ((fnow > enow) === (fnow > -enow)) {\n        Q = enow;\n        enow = e[++eindex];\n    } else {\n        Q = fnow;\n        fnow = f[++findex];\n    }\n    let hindex = 0;\n    if (eindex < elen && findex < flen) {\n        if ((fnow > enow) === (fnow > -enow)) {\n            Qnew = enow + Q;\n            hh = Q - (Qnew - enow);\n            enow = e[++eindex];\n        } else {\n            Qnew = fnow + Q;\n            hh = Q - (Qnew - fnow);\n            fnow = f[++findex];\n        }\n        Q = Qnew;\n        if (hh !== 0) {\n            h[hindex++] = hh;\n        }\n        while (eindex < elen && findex < flen) {\n            if ((fnow > enow) === (fnow > -enow)) {\n                Qnew = Q + enow;\n                bvirt = Qnew - Q;\n                hh = Q - (Qnew - bvirt) + (enow - bvirt);\n                enow = e[++eindex];\n            } else {\n                Qnew = Q + fnow;\n                bvirt = Qnew - Q;\n                hh = Q - (Qnew - bvirt) + (fnow - bvirt);\n                fnow = f[++findex];\n            }\n            Q = Qnew;\n            if (hh !== 0) {\n                h[hindex++] = hh;\n            }\n        }\n    }\n    while (eindex < elen) {\n        Qnew = Q + enow;\n        bvirt = Qnew - Q;\n        hh = Q - (Qnew - bvirt) + (enow - bvirt);\n        enow = e[++eindex];\n        Q = Qnew;\n        if (hh !== 0) {\n            h[hindex++] = hh;\n        }\n    }\n    while (findex < flen) {\n        Qnew = Q + fnow;\n        bvirt = Qnew - Q;\n        hh = Q - (Qnew - bvirt) + (fnow - bvirt);\n        fnow = f[++findex];\n        Q = Qnew;\n        if (hh !== 0) {\n            h[hindex++] = hh;\n        }\n    }\n    if (Q !== 0 || hindex === 0) {\n        h[hindex++] = Q;\n    }\n    return hindex;\n}\n\nexport function sum_three(alen, a, blen, b, clen, c, tmp, out) {\n    return sum(sum(alen, a, blen, b, tmp), tmp, clen, c, out);\n}\n\n// scale_expansion_zeroelim routine from oritinal code\nexport function scale(elen, e, b, h) {\n    let Q, sum, hh, product1, product0;\n    let bvirt, c, ahi, alo, bhi, blo;\n\n    c = splitter * b;\n    bhi = c - (c - b);\n    blo = b - bhi;\n    let enow = e[0];\n    Q = enow * b;\n    c = splitter * enow;\n    ahi = c - (c - enow);\n    alo = enow - ahi;\n    hh = alo * blo - (Q - ahi * bhi - alo * bhi - ahi * blo);\n    let hindex = 0;\n    if (hh !== 0) {\n        h[hindex++] = hh;\n    }\n    for (let i = 1; i < elen; i++) {\n        enow = e[i];\n        product1 = enow * b;\n        c = splitter * enow;\n        ahi = c - (c - enow);\n        alo = enow - ahi;\n        product0 = alo * blo - (product1 - ahi * bhi - alo * bhi - ahi * blo);\n        sum = Q + product0;\n        bvirt = sum - Q;\n        hh = Q - (sum - bvirt) + (product0 - bvirt);\n        if (hh !== 0) {\n            h[hindex++] = hh;\n        }\n        Q = product1 + sum;\n        hh = sum - (Q - product1);\n        if (hh !== 0) {\n            h[hindex++] = hh;\n        }\n    }\n    if (Q !== 0 || hindex === 0) {\n        h[hindex++] = Q;\n    }\n    return hindex;\n}\n\nexport function negate(elen, e) {\n    for (let i = 0; i < elen; i++) e[i] = -e[i];\n    return elen;\n}\n\nexport function estimate(elen, e) {\n    let Q = e[0];\n    for (let i = 1; i < elen; i++) Q += e[i];\n    return Q;\n}\n\nexport function vec(n) {\n    return new Float64Array(n);\n}\n", "import {epsilon, splitter, resulterrbound, estimate, vec, sum} from './util.js';\n\nconst ccwerrboundA = (3 + 16 * epsilon) * epsilon;\nconst ccwerrboundB = (2 + 12 * epsilon) * epsilon;\nconst ccwerrboundC = (9 + 64 * epsilon) * epsilon * epsilon;\n\nconst B = vec(4);\nconst C1 = vec(8);\nconst C2 = vec(12);\nconst D = vec(16);\nconst u = vec(4);\n\nfunction orient2dadapt(ax, ay, bx, by, cx, cy, detsum) {\n    let acxtail, acytail, bcxtail, bcytail;\n    let bvirt, c, ahi, alo, bhi, blo, _i, _j, _0, s1, s0, t1, t0, u3;\n\n    const acx = ax - cx;\n    const bcx = bx - cx;\n    const acy = ay - cy;\n    const bcy = by - cy;\n\n    s1 = acx * bcy;\n    c = splitter * acx;\n    ahi = c - (c - acx);\n    alo = acx - ahi;\n    c = splitter * bcy;\n    bhi = c - (c - bcy);\n    blo = bcy - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = acy * bcx;\n    c = splitter * acy;\n    ahi = c - (c - acy);\n    alo = acy - ahi;\n    c = splitter * bcx;\n    bhi = c - (c - bcx);\n    blo = bcx - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    B[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    B[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    B[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    B[3] = u3;\n\n    let det = estimate(4, B);\n    let errbound = ccwerrboundB * detsum;\n    if (det >= errbound || -det >= errbound) {\n        return det;\n    }\n\n    bvirt = ax - acx;\n    acxtail = ax - (acx + bvirt) + (bvirt - cx);\n    bvirt = bx - bcx;\n    bcxtail = bx - (bcx + bvirt) + (bvirt - cx);\n    bvirt = ay - acy;\n    acytail = ay - (acy + bvirt) + (bvirt - cy);\n    bvirt = by - bcy;\n    bcytail = by - (bcy + bvirt) + (bvirt - cy);\n\n    if (acxtail === 0 && acytail === 0 && bcxtail === 0 && bcytail === 0) {\n        return det;\n    }\n\n    errbound = ccwerrboundC * detsum + resulterrbound * Math.abs(det);\n    det += (acx * bcytail + bcy * acxtail) - (acy * bcxtail + bcx * acytail);\n    if (det >= errbound || -det >= errbound) return det;\n\n    s1 = acxtail * bcy;\n    c = splitter * acxtail;\n    ahi = c - (c - acxtail);\n    alo = acxtail - ahi;\n    c = splitter * bcy;\n    bhi = c - (c - bcy);\n    blo = bcy - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = acytail * bcx;\n    c = splitter * acytail;\n    ahi = c - (c - acytail);\n    alo = acytail - ahi;\n    c = splitter * bcx;\n    bhi = c - (c - bcx);\n    blo = bcx - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    u[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    u[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    u[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    u[3] = u3;\n    const C1len = sum(4, B, 4, u, C1);\n\n    s1 = acx * bcytail;\n    c = splitter * acx;\n    ahi = c - (c - acx);\n    alo = acx - ahi;\n    c = splitter * bcytail;\n    bhi = c - (c - bcytail);\n    blo = bcytail - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = acy * bcxtail;\n    c = splitter * acy;\n    ahi = c - (c - acy);\n    alo = acy - ahi;\n    c = splitter * bcxtail;\n    bhi = c - (c - bcxtail);\n    blo = bcxtail - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    u[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    u[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    u[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    u[3] = u3;\n    const C2len = sum(C1len, C1, 4, u, C2);\n\n    s1 = acxtail * bcytail;\n    c = splitter * acxtail;\n    ahi = c - (c - acxtail);\n    alo = acxtail - ahi;\n    c = splitter * bcytail;\n    bhi = c - (c - bcytail);\n    blo = bcytail - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = acytail * bcxtail;\n    c = splitter * acytail;\n    ahi = c - (c - acytail);\n    alo = acytail - ahi;\n    c = splitter * bcxtail;\n    bhi = c - (c - bcxtail);\n    blo = bcxtail - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    u[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    u[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    u[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    u[3] = u3;\n    const Dlen = sum(C2len, C2, 4, u, D);\n\n    return D[Dlen - 1];\n}\n\nexport function orient2d(ax, ay, bx, by, cx, cy) {\n    const detleft = (ay - cy) * (bx - cx);\n    const detright = (ax - cx) * (by - cy);\n    const det = detleft - detright;\n\n    const detsum = Math.abs(detleft + detright);\n    if (Math.abs(det) >= ccwerrboundA * detsum) return det;\n\n    return -orient2dadapt(ax, ay, bx, by, cx, cy, detsum);\n}\n\nexport function orient2dfast(ax, ay, bx, by, cx, cy) {\n    return (ay - cy) * (bx - cx) - (ax - cx) * (by - cy);\n}\n", "import {epsilon, splitter, resulterrbound, estimate, vec, sum, scale} from './util.js';\n\nconst o3derrboundA = (7 + 56 * epsilon) * epsilon;\nconst o3derrboundB = (3 + 28 * epsilon) * epsilon;\nconst o3derrboundC = (26 + 288 * epsilon) * epsilon * epsilon;\n\nconst bc = vec(4);\nconst ca = vec(4);\nconst ab = vec(4);\nconst at_b = vec(4);\nconst at_c = vec(4);\nconst bt_c = vec(4);\nconst bt_a = vec(4);\nconst ct_a = vec(4);\nconst ct_b = vec(4);\nconst bct = vec(8);\nconst cat = vec(8);\nconst abt = vec(8);\nconst u = vec(4);\n\nconst _8 = vec(8);\nconst _8b = vec(8);\nconst _16 = vec(8);\nconst _12 = vec(12);\n\nlet fin = vec(192);\nlet fin2 = vec(192);\n\nfunction finadd(finlen, alen, a) {\n    finlen = sum(finlen, fin, alen, a, fin2);\n    const tmp = fin; fin = fin2; fin2 = tmp;\n    return finlen;\n}\n\nfunction tailinit(xtail, ytail, ax, ay, bx, by, a, b) {\n    let bvirt, c, ahi, alo, bhi, blo, _i, _j, _k, _0, s1, s0, t1, t0, u3, negate;\n    if (xtail === 0) {\n        if (ytail === 0) {\n            a[0] = 0;\n            b[0] = 0;\n            return 1;\n        } else {\n            negate = -ytail;\n            s1 = negate * ax;\n            c = splitter * negate;\n            ahi = c - (c - negate);\n            alo = negate - ahi;\n            c = splitter * ax;\n            bhi = c - (c - ax);\n            blo = ax - bhi;\n            a[0] = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            a[1] = s1;\n            s1 = ytail * bx;\n            c = splitter * ytail;\n            ahi = c - (c - ytail);\n            alo = ytail - ahi;\n            c = splitter * bx;\n            bhi = c - (c - bx);\n            blo = bx - bhi;\n            b[0] = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            b[1] = s1;\n            return 2;\n        }\n    } else {\n        if (ytail === 0) {\n            s1 = xtail * ay;\n            c = splitter * xtail;\n            ahi = c - (c - xtail);\n            alo = xtail - ahi;\n            c = splitter * ay;\n            bhi = c - (c - ay);\n            blo = ay - bhi;\n            a[0] = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            a[1] = s1;\n            negate = -xtail;\n            s1 = negate * by;\n            c = splitter * negate;\n            ahi = c - (c - negate);\n            alo = negate - ahi;\n            c = splitter * by;\n            bhi = c - (c - by);\n            blo = by - bhi;\n            b[0] = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            b[1] = s1;\n            return 2;\n        } else {\n            s1 = xtail * ay;\n            c = splitter * xtail;\n            ahi = c - (c - xtail);\n            alo = xtail - ahi;\n            c = splitter * ay;\n            bhi = c - (c - ay);\n            blo = ay - bhi;\n            s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            t1 = ytail * ax;\n            c = splitter * ytail;\n            ahi = c - (c - ytail);\n            alo = ytail - ahi;\n            c = splitter * ax;\n            bhi = c - (c - ax);\n            blo = ax - bhi;\n            t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n            _i = s0 - t0;\n            bvirt = s0 - _i;\n            a[0] = s0 - (_i + bvirt) + (bvirt - t0);\n            _j = s1 + _i;\n            bvirt = _j - s1;\n            _0 = s1 - (_j - bvirt) + (_i - bvirt);\n            _i = _0 - t1;\n            bvirt = _0 - _i;\n            a[1] = _0 - (_i + bvirt) + (bvirt - t1);\n            u3 = _j + _i;\n            bvirt = u3 - _j;\n            a[2] = _j - (u3 - bvirt) + (_i - bvirt);\n            a[3] = u3;\n            s1 = ytail * bx;\n            c = splitter * ytail;\n            ahi = c - (c - ytail);\n            alo = ytail - ahi;\n            c = splitter * bx;\n            bhi = c - (c - bx);\n            blo = bx - bhi;\n            s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            t1 = xtail * by;\n            c = splitter * xtail;\n            ahi = c - (c - xtail);\n            alo = xtail - ahi;\n            c = splitter * by;\n            bhi = c - (c - by);\n            blo = by - bhi;\n            t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n            _i = s0 - t0;\n            bvirt = s0 - _i;\n            b[0] = s0 - (_i + bvirt) + (bvirt - t0);\n            _j = s1 + _i;\n            bvirt = _j - s1;\n            _0 = s1 - (_j - bvirt) + (_i - bvirt);\n            _i = _0 - t1;\n            bvirt = _0 - _i;\n            b[1] = _0 - (_i + bvirt) + (bvirt - t1);\n            u3 = _j + _i;\n            bvirt = u3 - _j;\n            b[2] = _j - (u3 - bvirt) + (_i - bvirt);\n            b[3] = u3;\n            return 4;\n        }\n    }\n}\n\nfunction tailadd(finlen, a, b, k, z) {\n    let bvirt, c, ahi, alo, bhi, blo, _i, _j, _k, _0, s1, s0, u3;\n    s1 = a * b;\n    c = splitter * a;\n    ahi = c - (c - a);\n    alo = a - ahi;\n    c = splitter * b;\n    bhi = c - (c - b);\n    blo = b - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    c = splitter * k;\n    bhi = c - (c - k);\n    blo = k - bhi;\n    _i = s0 * k;\n    c = splitter * s0;\n    ahi = c - (c - s0);\n    alo = s0 - ahi;\n    u[0] = alo * blo - (_i - ahi * bhi - alo * bhi - ahi * blo);\n    _j = s1 * k;\n    c = splitter * s1;\n    ahi = c - (c - s1);\n    alo = s1 - ahi;\n    _0 = alo * blo - (_j - ahi * bhi - alo * bhi - ahi * blo);\n    _k = _i + _0;\n    bvirt = _k - _i;\n    u[1] = _i - (_k - bvirt) + (_0 - bvirt);\n    u3 = _j + _k;\n    u[2] = _k - (u3 - _j);\n    u[3] = u3;\n    finlen = finadd(finlen, 4, u);\n    if (z !== 0) {\n        c = splitter * z;\n        bhi = c - (c - z);\n        blo = z - bhi;\n        _i = s0 * z;\n        c = splitter * s0;\n        ahi = c - (c - s0);\n        alo = s0 - ahi;\n        u[0] = alo * blo - (_i - ahi * bhi - alo * bhi - ahi * blo);\n        _j = s1 * z;\n        c = splitter * s1;\n        ahi = c - (c - s1);\n        alo = s1 - ahi;\n        _0 = alo * blo - (_j - ahi * bhi - alo * bhi - ahi * blo);\n        _k = _i + _0;\n        bvirt = _k - _i;\n        u[1] = _i - (_k - bvirt) + (_0 - bvirt);\n        u3 = _j + _k;\n        u[2] = _k - (u3 - _j);\n        u[3] = u3;\n        finlen = finadd(finlen, 4, u);\n    }\n    return finlen;\n}\n\nfunction orient3dadapt(ax, ay, az, bx, by, bz, cx, cy, cz, dx, dy, dz, permanent) {\n    let finlen;\n    let adxtail, bdxtail, cdxtail;\n    let adytail, bdytail, cdytail;\n    let adztail, bdztail, cdztail;\n    let bvirt, c, ahi, alo, bhi, blo, _i, _j, _k, _0, s1, s0, t1, t0, u3;\n\n    const adx = ax - dx;\n    const bdx = bx - dx;\n    const cdx = cx - dx;\n    const ady = ay - dy;\n    const bdy = by - dy;\n    const cdy = cy - dy;\n    const adz = az - dz;\n    const bdz = bz - dz;\n    const cdz = cz - dz;\n\n    s1 = bdx * cdy;\n    c = splitter * bdx;\n    ahi = c - (c - bdx);\n    alo = bdx - ahi;\n    c = splitter * cdy;\n    bhi = c - (c - cdy);\n    blo = cdy - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = cdx * bdy;\n    c = splitter * cdx;\n    ahi = c - (c - cdx);\n    alo = cdx - ahi;\n    c = splitter * bdy;\n    bhi = c - (c - bdy);\n    blo = bdy - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    bc[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    bc[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    bc[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    bc[3] = u3;\n    s1 = cdx * ady;\n    c = splitter * cdx;\n    ahi = c - (c - cdx);\n    alo = cdx - ahi;\n    c = splitter * ady;\n    bhi = c - (c - ady);\n    blo = ady - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = adx * cdy;\n    c = splitter * adx;\n    ahi = c - (c - adx);\n    alo = adx - ahi;\n    c = splitter * cdy;\n    bhi = c - (c - cdy);\n    blo = cdy - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    ca[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    ca[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    ca[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    ca[3] = u3;\n    s1 = adx * bdy;\n    c = splitter * adx;\n    ahi = c - (c - adx);\n    alo = adx - ahi;\n    c = splitter * bdy;\n    bhi = c - (c - bdy);\n    blo = bdy - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = bdx * ady;\n    c = splitter * bdx;\n    ahi = c - (c - bdx);\n    alo = bdx - ahi;\n    c = splitter * ady;\n    bhi = c - (c - ady);\n    blo = ady - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    ab[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    ab[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    ab[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    ab[3] = u3;\n\n    finlen = sum(\n        sum(\n            scale(4, bc, adz, _8), _8,\n            scale(4, ca, bdz, _8b), _8b, _16), _16,\n        scale(4, ab, cdz, _8), _8, fin);\n\n    let det = estimate(finlen, fin);\n    let errbound = o3derrboundB * permanent;\n    if (det >= errbound || -det >= errbound) {\n        return det;\n    }\n\n    bvirt = ax - adx;\n    adxtail = ax - (adx + bvirt) + (bvirt - dx);\n    bvirt = bx - bdx;\n    bdxtail = bx - (bdx + bvirt) + (bvirt - dx);\n    bvirt = cx - cdx;\n    cdxtail = cx - (cdx + bvirt) + (bvirt - dx);\n    bvirt = ay - ady;\n    adytail = ay - (ady + bvirt) + (bvirt - dy);\n    bvirt = by - bdy;\n    bdytail = by - (bdy + bvirt) + (bvirt - dy);\n    bvirt = cy - cdy;\n    cdytail = cy - (cdy + bvirt) + (bvirt - dy);\n    bvirt = az - adz;\n    adztail = az - (adz + bvirt) + (bvirt - dz);\n    bvirt = bz - bdz;\n    bdztail = bz - (bdz + bvirt) + (bvirt - dz);\n    bvirt = cz - cdz;\n    cdztail = cz - (cdz + bvirt) + (bvirt - dz);\n\n    if (adxtail === 0 && bdxtail === 0 && cdxtail === 0 &&\n        adytail === 0 && bdytail === 0 && cdytail === 0 &&\n        adztail === 0 && bdztail === 0 && cdztail === 0) {\n        return det;\n    }\n\n    errbound = o3derrboundC * permanent + resulterrbound * Math.abs(det);\n    det +=\n        adz * (bdx * cdytail + cdy * bdxtail - (bdy * cdxtail + cdx * bdytail)) + adztail * (bdx * cdy - bdy * cdx) +\n        bdz * (cdx * adytail + ady * cdxtail - (cdy * adxtail + adx * cdytail)) + bdztail * (cdx * ady - cdy * adx) +\n        cdz * (adx * bdytail + bdy * adxtail - (ady * bdxtail + bdx * adytail)) + cdztail * (adx * bdy - ady * bdx);\n    if (det >= errbound || -det >= errbound) {\n        return det;\n    }\n\n    const at_len = tailinit(adxtail, adytail, bdx, bdy, cdx, cdy, at_b, at_c);\n    const bt_len = tailinit(bdxtail, bdytail, cdx, cdy, adx, ady, bt_c, bt_a);\n    const ct_len = tailinit(cdxtail, cdytail, adx, ady, bdx, bdy, ct_a, ct_b);\n\n    const bctlen = sum(bt_len, bt_c, ct_len, ct_b, bct);\n    finlen = finadd(finlen, scale(bctlen, bct, adz, _16), _16);\n\n    const catlen = sum(ct_len, ct_a, at_len, at_c, cat);\n    finlen = finadd(finlen, scale(catlen, cat, bdz, _16), _16);\n\n    const abtlen = sum(at_len, at_b, bt_len, bt_a, abt);\n    finlen = finadd(finlen, scale(abtlen, abt, cdz, _16), _16);\n\n    if (adztail !== 0) {\n        finlen = finadd(finlen, scale(4, bc, adztail, _12), _12);\n        finlen = finadd(finlen, scale(bctlen, bct, adztail, _16), _16);\n    }\n    if (bdztail !== 0) {\n        finlen = finadd(finlen, scale(4, ca, bdztail, _12), _12);\n        finlen = finadd(finlen, scale(catlen, cat, bdztail, _16), _16);\n    }\n    if (cdztail !== 0) {\n        finlen = finadd(finlen, scale(4, ab, cdztail, _12), _12);\n        finlen = finadd(finlen, scale(abtlen, abt, cdztail, _16), _16);\n    }\n\n    if (adxtail !== 0) {\n        if (bdytail !== 0) {\n            finlen = tailadd(finlen, adxtail, bdytail, cdz, cdztail);\n        }\n        if (cdytail !== 0) {\n            finlen = tailadd(finlen, -adxtail, cdytail, bdz, bdztail);\n        }\n    }\n    if (bdxtail !== 0) {\n        if (cdytail !== 0) {\n            finlen = tailadd(finlen, bdxtail, cdytail, adz, adztail);\n        }\n        if (adytail !== 0) {\n            finlen = tailadd(finlen, -bdxtail, adytail, cdz, cdztail);\n        }\n    }\n    if (cdxtail !== 0) {\n        if (adytail !== 0) {\n            finlen = tailadd(finlen, cdxtail, adytail, bdz, bdztail);\n        }\n        if (bdytail !== 0) {\n            finlen = tailadd(finlen, -cdxtail, bdytail, adz, adztail);\n        }\n    }\n\n    return fin[finlen - 1];\n}\n\nexport function orient3d(ax, ay, az, bx, by, bz, cx, cy, cz, dx, dy, dz) {\n    const adx = ax - dx;\n    const bdx = bx - dx;\n    const cdx = cx - dx;\n    const ady = ay - dy;\n    const bdy = by - dy;\n    const cdy = cy - dy;\n    const adz = az - dz;\n    const bdz = bz - dz;\n    const cdz = cz - dz;\n\n    const bdxcdy = bdx * cdy;\n    const cdxbdy = cdx * bdy;\n\n    const cdxady = cdx * ady;\n    const adxcdy = adx * cdy;\n\n    const adxbdy = adx * bdy;\n    const bdxady = bdx * ady;\n\n    const det =\n        adz * (bdxcdy - cdxbdy) +\n        bdz * (cdxady - adxcdy) +\n        cdz * (adxbdy - bdxady);\n\n    const permanent =\n        (Math.abs(bdxcdy) + Math.abs(cdxbdy)) * Math.abs(adz) +\n        (Math.abs(cdxady) + Math.abs(adxcdy)) * Math.abs(bdz) +\n        (Math.abs(adxbdy) + Math.abs(bdxady)) * Math.abs(cdz);\n\n    const errbound = o3derrboundA * permanent;\n    if (det > errbound || -det > errbound) {\n        return det;\n    }\n\n    return orient3dadapt(ax, ay, az, bx, by, bz, cx, cy, cz, dx, dy, dz, permanent);\n}\n\nexport function orient3dfast(ax, ay, az, bx, by, bz, cx, cy, cz, dx, dy, dz) {\n    const adx = ax - dx;\n    const bdx = bx - dx;\n    const cdx = cx - dx;\n    const ady = ay - dy;\n    const bdy = by - dy;\n    const cdy = cy - dy;\n    const adz = az - dz;\n    const bdz = bz - dz;\n    const cdz = cz - dz;\n\n    return adx * (bdy * cdz - bdz * cdy) +\n        bdx * (cdy * adz - cdz * ady) +\n        cdx * (ady * bdz - adz * bdy);\n}\n", "import {epsilon, splitter, resulterrbound, estimate, vec, sum, sum_three, scale} from './util.js';\n\nconst iccerrboundA = (10 + 96 * epsilon) * epsilon;\nconst iccerrboundB = (4 + 48 * epsilon) * epsilon;\nconst iccerrboundC = (44 + 576 * epsilon) * epsilon * epsilon;\n\nconst bc = vec(4);\nconst ca = vec(4);\nconst ab = vec(4);\nconst aa = vec(4);\nconst bb = vec(4);\nconst cc = vec(4);\nconst u = vec(4);\nconst v = vec(4);\nconst axtbc = vec(8);\nconst aytbc = vec(8);\nconst bxtca = vec(8);\nconst bytca = vec(8);\nconst cxtab = vec(8);\nconst cytab = vec(8);\nconst abt = vec(8);\nconst bct = vec(8);\nconst cat = vec(8);\nconst abtt = vec(4);\nconst bctt = vec(4);\nconst catt = vec(4);\n\nconst _8 = vec(8);\nconst _16 = vec(16);\nconst _16b = vec(16);\nconst _16c = vec(16);\nconst _32 = vec(32);\nconst _32b = vec(32);\nconst _48 = vec(48);\nconst _64 = vec(64);\n\nlet fin = vec(1152);\nlet fin2 = vec(1152);\n\nfunction finadd(finlen, a, alen) {\n    finlen = sum(finlen, fin, a, alen, fin2);\n    const tmp = fin; fin = fin2; fin2 = tmp;\n    return finlen;\n}\n\nfunction incircleadapt(ax, ay, bx, by, cx, cy, dx, dy, permanent) {\n    let finlen;\n    let adxtail, bdxtail, cdxtail, adytail, bdytail, cdytail;\n    let axtbclen, aytbclen, bxtcalen, bytcalen, cxtablen, cytablen;\n    let abtlen, bctlen, catlen;\n    let abttlen, bcttlen, cattlen;\n    let n1, n0;\n\n    let bvirt, c, ahi, alo, bhi, blo, _i, _j, _0, s1, s0, t1, t0, u3;\n\n    const adx = ax - dx;\n    const bdx = bx - dx;\n    const cdx = cx - dx;\n    const ady = ay - dy;\n    const bdy = by - dy;\n    const cdy = cy - dy;\n\n    s1 = bdx * cdy;\n    c = splitter * bdx;\n    ahi = c - (c - bdx);\n    alo = bdx - ahi;\n    c = splitter * cdy;\n    bhi = c - (c - cdy);\n    blo = cdy - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = cdx * bdy;\n    c = splitter * cdx;\n    ahi = c - (c - cdx);\n    alo = cdx - ahi;\n    c = splitter * bdy;\n    bhi = c - (c - bdy);\n    blo = bdy - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    bc[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    bc[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    bc[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    bc[3] = u3;\n    s1 = cdx * ady;\n    c = splitter * cdx;\n    ahi = c - (c - cdx);\n    alo = cdx - ahi;\n    c = splitter * ady;\n    bhi = c - (c - ady);\n    blo = ady - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = adx * cdy;\n    c = splitter * adx;\n    ahi = c - (c - adx);\n    alo = adx - ahi;\n    c = splitter * cdy;\n    bhi = c - (c - cdy);\n    blo = cdy - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    ca[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    ca[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    ca[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    ca[3] = u3;\n    s1 = adx * bdy;\n    c = splitter * adx;\n    ahi = c - (c - adx);\n    alo = adx - ahi;\n    c = splitter * bdy;\n    bhi = c - (c - bdy);\n    blo = bdy - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = bdx * ady;\n    c = splitter * bdx;\n    ahi = c - (c - bdx);\n    alo = bdx - ahi;\n    c = splitter * ady;\n    bhi = c - (c - ady);\n    blo = ady - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    ab[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    ab[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    ab[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    ab[3] = u3;\n\n    finlen = sum(\n        sum(\n            sum(\n                scale(scale(4, bc, adx, _8), _8, adx, _16), _16,\n                scale(scale(4, bc, ady, _8), _8, ady, _16b), _16b, _32), _32,\n            sum(\n                scale(scale(4, ca, bdx, _8), _8, bdx, _16), _16,\n                scale(scale(4, ca, bdy, _8), _8, bdy, _16b), _16b, _32b), _32b, _64), _64,\n        sum(\n            scale(scale(4, ab, cdx, _8), _8, cdx, _16), _16,\n            scale(scale(4, ab, cdy, _8), _8, cdy, _16b), _16b, _32), _32, fin);\n\n    let det = estimate(finlen, fin);\n    let errbound = iccerrboundB * permanent;\n    if (det >= errbound || -det >= errbound) {\n        return det;\n    }\n\n    bvirt = ax - adx;\n    adxtail = ax - (adx + bvirt) + (bvirt - dx);\n    bvirt = ay - ady;\n    adytail = ay - (ady + bvirt) + (bvirt - dy);\n    bvirt = bx - bdx;\n    bdxtail = bx - (bdx + bvirt) + (bvirt - dx);\n    bvirt = by - bdy;\n    bdytail = by - (bdy + bvirt) + (bvirt - dy);\n    bvirt = cx - cdx;\n    cdxtail = cx - (cdx + bvirt) + (bvirt - dx);\n    bvirt = cy - cdy;\n    cdytail = cy - (cdy + bvirt) + (bvirt - dy);\n    if (adxtail === 0 && bdxtail === 0 && cdxtail === 0 && adytail === 0 && bdytail === 0 && cdytail === 0) {\n        return det;\n    }\n\n    errbound = iccerrboundC * permanent + resulterrbound * Math.abs(det);\n    det += ((adx * adx + ady * ady) * ((bdx * cdytail + cdy * bdxtail) - (bdy * cdxtail + cdx * bdytail)) +\n        2 * (adx * adxtail + ady * adytail) * (bdx * cdy - bdy * cdx)) +\n        ((bdx * bdx + bdy * bdy) * ((cdx * adytail + ady * cdxtail) - (cdy * adxtail + adx * cdytail)) +\n        2 * (bdx * bdxtail + bdy * bdytail) * (cdx * ady - cdy * adx)) +\n        ((cdx * cdx + cdy * cdy) * ((adx * bdytail + bdy * adxtail) - (ady * bdxtail + bdx * adytail)) +\n        2 * (cdx * cdxtail + cdy * cdytail) * (adx * bdy - ady * bdx));\n\n    if (det >= errbound || -det >= errbound) {\n        return det;\n    }\n\n    if (bdxtail !== 0 || bdytail !== 0 || cdxtail !== 0 || cdytail !== 0) {\n        s1 = adx * adx;\n        c = splitter * adx;\n        ahi = c - (c - adx);\n        alo = adx - ahi;\n        s0 = alo * alo - (s1 - ahi * ahi - (ahi + ahi) * alo);\n        t1 = ady * ady;\n        c = splitter * ady;\n        ahi = c - (c - ady);\n        alo = ady - ahi;\n        t0 = alo * alo - (t1 - ahi * ahi - (ahi + ahi) * alo);\n        _i = s0 + t0;\n        bvirt = _i - s0;\n        aa[0] = s0 - (_i - bvirt) + (t0 - bvirt);\n        _j = s1 + _i;\n        bvirt = _j - s1;\n        _0 = s1 - (_j - bvirt) + (_i - bvirt);\n        _i = _0 + t1;\n        bvirt = _i - _0;\n        aa[1] = _0 - (_i - bvirt) + (t1 - bvirt);\n        u3 = _j + _i;\n        bvirt = u3 - _j;\n        aa[2] = _j - (u3 - bvirt) + (_i - bvirt);\n        aa[3] = u3;\n    }\n    if (cdxtail !== 0 || cdytail !== 0 || adxtail !== 0 || adytail !== 0) {\n        s1 = bdx * bdx;\n        c = splitter * bdx;\n        ahi = c - (c - bdx);\n        alo = bdx - ahi;\n        s0 = alo * alo - (s1 - ahi * ahi - (ahi + ahi) * alo);\n        t1 = bdy * bdy;\n        c = splitter * bdy;\n        ahi = c - (c - bdy);\n        alo = bdy - ahi;\n        t0 = alo * alo - (t1 - ahi * ahi - (ahi + ahi) * alo);\n        _i = s0 + t0;\n        bvirt = _i - s0;\n        bb[0] = s0 - (_i - bvirt) + (t0 - bvirt);\n        _j = s1 + _i;\n        bvirt = _j - s1;\n        _0 = s1 - (_j - bvirt) + (_i - bvirt);\n        _i = _0 + t1;\n        bvirt = _i - _0;\n        bb[1] = _0 - (_i - bvirt) + (t1 - bvirt);\n        u3 = _j + _i;\n        bvirt = u3 - _j;\n        bb[2] = _j - (u3 - bvirt) + (_i - bvirt);\n        bb[3] = u3;\n    }\n    if (adxtail !== 0 || adytail !== 0 || bdxtail !== 0 || bdytail !== 0) {\n        s1 = cdx * cdx;\n        c = splitter * cdx;\n        ahi = c - (c - cdx);\n        alo = cdx - ahi;\n        s0 = alo * alo - (s1 - ahi * ahi - (ahi + ahi) * alo);\n        t1 = cdy * cdy;\n        c = splitter * cdy;\n        ahi = c - (c - cdy);\n        alo = cdy - ahi;\n        t0 = alo * alo - (t1 - ahi * ahi - (ahi + ahi) * alo);\n        _i = s0 + t0;\n        bvirt = _i - s0;\n        cc[0] = s0 - (_i - bvirt) + (t0 - bvirt);\n        _j = s1 + _i;\n        bvirt = _j - s1;\n        _0 = s1 - (_j - bvirt) + (_i - bvirt);\n        _i = _0 + t1;\n        bvirt = _i - _0;\n        cc[1] = _0 - (_i - bvirt) + (t1 - bvirt);\n        u3 = _j + _i;\n        bvirt = u3 - _j;\n        cc[2] = _j - (u3 - bvirt) + (_i - bvirt);\n        cc[3] = u3;\n    }\n\n    if (adxtail !== 0) {\n        axtbclen = scale(4, bc, adxtail, axtbc);\n        finlen = finadd(finlen, sum_three(\n            scale(axtbclen, axtbc, 2 * adx, _16), _16,\n            scale(scale(4, cc, adxtail, _8), _8, bdy, _16b), _16b,\n            scale(scale(4, bb, adxtail, _8), _8, -cdy, _16c), _16c, _32, _48), _48);\n    }\n    if (adytail !== 0) {\n        aytbclen = scale(4, bc, adytail, aytbc);\n        finlen = finadd(finlen, sum_three(\n            scale(aytbclen, aytbc, 2 * ady, _16), _16,\n            scale(scale(4, bb, adytail, _8), _8, cdx, _16b), _16b,\n            scale(scale(4, cc, adytail, _8), _8, -bdx, _16c), _16c, _32, _48), _48);\n    }\n    if (bdxtail !== 0) {\n        bxtcalen = scale(4, ca, bdxtail, bxtca);\n        finlen = finadd(finlen, sum_three(\n            scale(bxtcalen, bxtca, 2 * bdx, _16), _16,\n            scale(scale(4, aa, bdxtail, _8), _8, cdy, _16b), _16b,\n            scale(scale(4, cc, bdxtail, _8), _8, -ady, _16c), _16c, _32, _48), _48);\n    }\n    if (bdytail !== 0) {\n        bytcalen = scale(4, ca, bdytail, bytca);\n        finlen = finadd(finlen, sum_three(\n            scale(bytcalen, bytca, 2 * bdy, _16), _16,\n            scale(scale(4, cc, bdytail, _8), _8, adx, _16b), _16b,\n            scale(scale(4, aa, bdytail, _8), _8, -cdx, _16c), _16c, _32, _48), _48);\n    }\n    if (cdxtail !== 0) {\n        cxtablen = scale(4, ab, cdxtail, cxtab);\n        finlen = finadd(finlen, sum_three(\n            scale(cxtablen, cxtab, 2 * cdx, _16), _16,\n            scale(scale(4, bb, cdxtail, _8), _8, ady, _16b), _16b,\n            scale(scale(4, aa, cdxtail, _8), _8, -bdy, _16c), _16c, _32, _48), _48);\n    }\n    if (cdytail !== 0) {\n        cytablen = scale(4, ab, cdytail, cytab);\n        finlen = finadd(finlen, sum_three(\n            scale(cytablen, cytab, 2 * cdy, _16), _16,\n            scale(scale(4, aa, cdytail, _8), _8, bdx, _16b), _16b,\n            scale(scale(4, bb, cdytail, _8), _8, -adx, _16c), _16c, _32, _48), _48);\n    }\n\n    if (adxtail !== 0 || adytail !== 0) {\n        if (bdxtail !== 0 || bdytail !== 0 || cdxtail !== 0 || cdytail !== 0) {\n            s1 = bdxtail * cdy;\n            c = splitter * bdxtail;\n            ahi = c - (c - bdxtail);\n            alo = bdxtail - ahi;\n            c = splitter * cdy;\n            bhi = c - (c - cdy);\n            blo = cdy - bhi;\n            s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            t1 = bdx * cdytail;\n            c = splitter * bdx;\n            ahi = c - (c - bdx);\n            alo = bdx - ahi;\n            c = splitter * cdytail;\n            bhi = c - (c - cdytail);\n            blo = cdytail - bhi;\n            t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n            _i = s0 + t0;\n            bvirt = _i - s0;\n            u[0] = s0 - (_i - bvirt) + (t0 - bvirt);\n            _j = s1 + _i;\n            bvirt = _j - s1;\n            _0 = s1 - (_j - bvirt) + (_i - bvirt);\n            _i = _0 + t1;\n            bvirt = _i - _0;\n            u[1] = _0 - (_i - bvirt) + (t1 - bvirt);\n            u3 = _j + _i;\n            bvirt = u3 - _j;\n            u[2] = _j - (u3 - bvirt) + (_i - bvirt);\n            u[3] = u3;\n            s1 = cdxtail * -bdy;\n            c = splitter * cdxtail;\n            ahi = c - (c - cdxtail);\n            alo = cdxtail - ahi;\n            c = splitter * -bdy;\n            bhi = c - (c - -bdy);\n            blo = -bdy - bhi;\n            s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            t1 = cdx * -bdytail;\n            c = splitter * cdx;\n            ahi = c - (c - cdx);\n            alo = cdx - ahi;\n            c = splitter * -bdytail;\n            bhi = c - (c - -bdytail);\n            blo = -bdytail - bhi;\n            t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n            _i = s0 + t0;\n            bvirt = _i - s0;\n            v[0] = s0 - (_i - bvirt) + (t0 - bvirt);\n            _j = s1 + _i;\n            bvirt = _j - s1;\n            _0 = s1 - (_j - bvirt) + (_i - bvirt);\n            _i = _0 + t1;\n            bvirt = _i - _0;\n            v[1] = _0 - (_i - bvirt) + (t1 - bvirt);\n            u3 = _j + _i;\n            bvirt = u3 - _j;\n            v[2] = _j - (u3 - bvirt) + (_i - bvirt);\n            v[3] = u3;\n            bctlen = sum(4, u, 4, v, bct);\n            s1 = bdxtail * cdytail;\n            c = splitter * bdxtail;\n            ahi = c - (c - bdxtail);\n            alo = bdxtail - ahi;\n            c = splitter * cdytail;\n            bhi = c - (c - cdytail);\n            blo = cdytail - bhi;\n            s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            t1 = cdxtail * bdytail;\n            c = splitter * cdxtail;\n            ahi = c - (c - cdxtail);\n            alo = cdxtail - ahi;\n            c = splitter * bdytail;\n            bhi = c - (c - bdytail);\n            blo = bdytail - bhi;\n            t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n            _i = s0 - t0;\n            bvirt = s0 - _i;\n            bctt[0] = s0 - (_i + bvirt) + (bvirt - t0);\n            _j = s1 + _i;\n            bvirt = _j - s1;\n            _0 = s1 - (_j - bvirt) + (_i - bvirt);\n            _i = _0 - t1;\n            bvirt = _0 - _i;\n            bctt[1] = _0 - (_i + bvirt) + (bvirt - t1);\n            u3 = _j + _i;\n            bvirt = u3 - _j;\n            bctt[2] = _j - (u3 - bvirt) + (_i - bvirt);\n            bctt[3] = u3;\n            bcttlen = 4;\n        } else {\n            bct[0] = 0;\n            bctlen = 1;\n            bctt[0] = 0;\n            bcttlen = 1;\n        }\n        if (adxtail !== 0) {\n            const len = scale(bctlen, bct, adxtail, _16c);\n            finlen = finadd(finlen, sum(\n                scale(axtbclen, axtbc, adxtail, _16), _16,\n                scale(len, _16c, 2 * adx, _32), _32, _48), _48);\n\n            const len2 = scale(bcttlen, bctt, adxtail, _8);\n            finlen = finadd(finlen, sum_three(\n                scale(len2, _8, 2 * adx, _16), _16,\n                scale(len2, _8, adxtail, _16b), _16b,\n                scale(len, _16c, adxtail, _32), _32, _32b, _64), _64);\n\n            if (bdytail !== 0) {\n                finlen = finadd(finlen, scale(scale(4, cc, adxtail, _8), _8, bdytail, _16), _16);\n            }\n            if (cdytail !== 0) {\n                finlen = finadd(finlen, scale(scale(4, bb, -adxtail, _8), _8, cdytail, _16), _16);\n            }\n        }\n        if (adytail !== 0) {\n            const len = scale(bctlen, bct, adytail, _16c);\n            finlen = finadd(finlen, sum(\n                scale(aytbclen, aytbc, adytail, _16), _16,\n                scale(len, _16c, 2 * ady, _32), _32, _48), _48);\n\n            const len2 = scale(bcttlen, bctt, adytail, _8);\n            finlen = finadd(finlen, sum_three(\n                scale(len2, _8, 2 * ady, _16), _16,\n                scale(len2, _8, adytail, _16b), _16b,\n                scale(len, _16c, adytail, _32), _32, _32b, _64), _64);\n        }\n    }\n    if (bdxtail !== 0 || bdytail !== 0) {\n        if (cdxtail !== 0 || cdytail !== 0 || adxtail !== 0 || adytail !== 0) {\n            s1 = cdxtail * ady;\n            c = splitter * cdxtail;\n            ahi = c - (c - cdxtail);\n            alo = cdxtail - ahi;\n            c = splitter * ady;\n            bhi = c - (c - ady);\n            blo = ady - bhi;\n            s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            t1 = cdx * adytail;\n            c = splitter * cdx;\n            ahi = c - (c - cdx);\n            alo = cdx - ahi;\n            c = splitter * adytail;\n            bhi = c - (c - adytail);\n            blo = adytail - bhi;\n            t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n            _i = s0 + t0;\n            bvirt = _i - s0;\n            u[0] = s0 - (_i - bvirt) + (t0 - bvirt);\n            _j = s1 + _i;\n            bvirt = _j - s1;\n            _0 = s1 - (_j - bvirt) + (_i - bvirt);\n            _i = _0 + t1;\n            bvirt = _i - _0;\n            u[1] = _0 - (_i - bvirt) + (t1 - bvirt);\n            u3 = _j + _i;\n            bvirt = u3 - _j;\n            u[2] = _j - (u3 - bvirt) + (_i - bvirt);\n            u[3] = u3;\n            n1 = -cdy;\n            n0 = -cdytail;\n            s1 = adxtail * n1;\n            c = splitter * adxtail;\n            ahi = c - (c - adxtail);\n            alo = adxtail - ahi;\n            c = splitter * n1;\n            bhi = c - (c - n1);\n            blo = n1 - bhi;\n            s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            t1 = adx * n0;\n            c = splitter * adx;\n            ahi = c - (c - adx);\n            alo = adx - ahi;\n            c = splitter * n0;\n            bhi = c - (c - n0);\n            blo = n0 - bhi;\n            t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n            _i = s0 + t0;\n            bvirt = _i - s0;\n            v[0] = s0 - (_i - bvirt) + (t0 - bvirt);\n            _j = s1 + _i;\n            bvirt = _j - s1;\n            _0 = s1 - (_j - bvirt) + (_i - bvirt);\n            _i = _0 + t1;\n            bvirt = _i - _0;\n            v[1] = _0 - (_i - bvirt) + (t1 - bvirt);\n            u3 = _j + _i;\n            bvirt = u3 - _j;\n            v[2] = _j - (u3 - bvirt) + (_i - bvirt);\n            v[3] = u3;\n            catlen = sum(4, u, 4, v, cat);\n            s1 = cdxtail * adytail;\n            c = splitter * cdxtail;\n            ahi = c - (c - cdxtail);\n            alo = cdxtail - ahi;\n            c = splitter * adytail;\n            bhi = c - (c - adytail);\n            blo = adytail - bhi;\n            s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            t1 = adxtail * cdytail;\n            c = splitter * adxtail;\n            ahi = c - (c - adxtail);\n            alo = adxtail - ahi;\n            c = splitter * cdytail;\n            bhi = c - (c - cdytail);\n            blo = cdytail - bhi;\n            t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n            _i = s0 - t0;\n            bvirt = s0 - _i;\n            catt[0] = s0 - (_i + bvirt) + (bvirt - t0);\n            _j = s1 + _i;\n            bvirt = _j - s1;\n            _0 = s1 - (_j - bvirt) + (_i - bvirt);\n            _i = _0 - t1;\n            bvirt = _0 - _i;\n            catt[1] = _0 - (_i + bvirt) + (bvirt - t1);\n            u3 = _j + _i;\n            bvirt = u3 - _j;\n            catt[2] = _j - (u3 - bvirt) + (_i - bvirt);\n            catt[3] = u3;\n            cattlen = 4;\n        } else {\n            cat[0] = 0;\n            catlen = 1;\n            catt[0] = 0;\n            cattlen = 1;\n        }\n        if (bdxtail !== 0) {\n            const len = scale(catlen, cat, bdxtail, _16c);\n            finlen = finadd(finlen, sum(\n                scale(bxtcalen, bxtca, bdxtail, _16), _16,\n                scale(len, _16c, 2 * bdx, _32), _32, _48), _48);\n\n            const len2 = scale(cattlen, catt, bdxtail, _8);\n            finlen = finadd(finlen, sum_three(\n                scale(len2, _8, 2 * bdx, _16), _16,\n                scale(len2, _8, bdxtail, _16b), _16b,\n                scale(len, _16c, bdxtail, _32), _32, _32b, _64), _64);\n\n            if (cdytail !== 0) {\n                finlen = finadd(finlen, scale(scale(4, aa, bdxtail, _8), _8, cdytail, _16), _16);\n            }\n            if (adytail !== 0) {\n                finlen = finadd(finlen, scale(scale(4, cc, -bdxtail, _8), _8, adytail, _16), _16);\n            }\n        }\n        if (bdytail !== 0) {\n            const len = scale(catlen, cat, bdytail, _16c);\n            finlen = finadd(finlen, sum(\n                scale(bytcalen, bytca, bdytail, _16), _16,\n                scale(len, _16c, 2 * bdy, _32), _32, _48), _48);\n\n            const len2 = scale(cattlen, catt, bdytail, _8);\n            finlen = finadd(finlen, sum_three(\n                scale(len2, _8, 2 * bdy, _16), _16,\n                scale(len2, _8, bdytail, _16b), _16b,\n                scale(len, _16c, bdytail, _32), _32,  _32b, _64), _64);\n        }\n    }\n    if (cdxtail !== 0 || cdytail !== 0) {\n        if (adxtail !== 0 || adytail !== 0 || bdxtail !== 0 || bdytail !== 0) {\n            s1 = adxtail * bdy;\n            c = splitter * adxtail;\n            ahi = c - (c - adxtail);\n            alo = adxtail - ahi;\n            c = splitter * bdy;\n            bhi = c - (c - bdy);\n            blo = bdy - bhi;\n            s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            t1 = adx * bdytail;\n            c = splitter * adx;\n            ahi = c - (c - adx);\n            alo = adx - ahi;\n            c = splitter * bdytail;\n            bhi = c - (c - bdytail);\n            blo = bdytail - bhi;\n            t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n            _i = s0 + t0;\n            bvirt = _i - s0;\n            u[0] = s0 - (_i - bvirt) + (t0 - bvirt);\n            _j = s1 + _i;\n            bvirt = _j - s1;\n            _0 = s1 - (_j - bvirt) + (_i - bvirt);\n            _i = _0 + t1;\n            bvirt = _i - _0;\n            u[1] = _0 - (_i - bvirt) + (t1 - bvirt);\n            u3 = _j + _i;\n            bvirt = u3 - _j;\n            u[2] = _j - (u3 - bvirt) + (_i - bvirt);\n            u[3] = u3;\n            n1 = -ady;\n            n0 = -adytail;\n            s1 = bdxtail * n1;\n            c = splitter * bdxtail;\n            ahi = c - (c - bdxtail);\n            alo = bdxtail - ahi;\n            c = splitter * n1;\n            bhi = c - (c - n1);\n            blo = n1 - bhi;\n            s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            t1 = bdx * n0;\n            c = splitter * bdx;\n            ahi = c - (c - bdx);\n            alo = bdx - ahi;\n            c = splitter * n0;\n            bhi = c - (c - n0);\n            blo = n0 - bhi;\n            t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n            _i = s0 + t0;\n            bvirt = _i - s0;\n            v[0] = s0 - (_i - bvirt) + (t0 - bvirt);\n            _j = s1 + _i;\n            bvirt = _j - s1;\n            _0 = s1 - (_j - bvirt) + (_i - bvirt);\n            _i = _0 + t1;\n            bvirt = _i - _0;\n            v[1] = _0 - (_i - bvirt) + (t1 - bvirt);\n            u3 = _j + _i;\n            bvirt = u3 - _j;\n            v[2] = _j - (u3 - bvirt) + (_i - bvirt);\n            v[3] = u3;\n            abtlen = sum(4, u, 4, v, abt);\n            s1 = adxtail * bdytail;\n            c = splitter * adxtail;\n            ahi = c - (c - adxtail);\n            alo = adxtail - ahi;\n            c = splitter * bdytail;\n            bhi = c - (c - bdytail);\n            blo = bdytail - bhi;\n            s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n            t1 = bdxtail * adytail;\n            c = splitter * bdxtail;\n            ahi = c - (c - bdxtail);\n            alo = bdxtail - ahi;\n            c = splitter * adytail;\n            bhi = c - (c - adytail);\n            blo = adytail - bhi;\n            t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n            _i = s0 - t0;\n            bvirt = s0 - _i;\n            abtt[0] = s0 - (_i + bvirt) + (bvirt - t0);\n            _j = s1 + _i;\n            bvirt = _j - s1;\n            _0 = s1 - (_j - bvirt) + (_i - bvirt);\n            _i = _0 - t1;\n            bvirt = _0 - _i;\n            abtt[1] = _0 - (_i + bvirt) + (bvirt - t1);\n            u3 = _j + _i;\n            bvirt = u3 - _j;\n            abtt[2] = _j - (u3 - bvirt) + (_i - bvirt);\n            abtt[3] = u3;\n            abttlen = 4;\n        } else {\n            abt[0] = 0;\n            abtlen = 1;\n            abtt[0] = 0;\n            abttlen = 1;\n        }\n        if (cdxtail !== 0) {\n            const len = scale(abtlen, abt, cdxtail, _16c);\n            finlen = finadd(finlen, sum(\n                scale(cxtablen, cxtab, cdxtail, _16), _16,\n                scale(len, _16c, 2 * cdx, _32), _32, _48), _48);\n\n            const len2 = scale(abttlen, abtt, cdxtail, _8);\n            finlen = finadd(finlen, sum_three(\n                scale(len2, _8, 2 * cdx, _16), _16,\n                scale(len2, _8, cdxtail, _16b), _16b,\n                scale(len, _16c, cdxtail, _32), _32, _32b, _64), _64);\n\n            if (adytail !== 0) {\n                finlen = finadd(finlen, scale(scale(4, bb, cdxtail, _8), _8, adytail, _16), _16);\n            }\n            if (bdytail !== 0) {\n                finlen = finadd(finlen, scale(scale(4, aa, -cdxtail, _8), _8, bdytail, _16), _16);\n            }\n        }\n        if (cdytail !== 0) {\n            const len = scale(abtlen, abt, cdytail, _16c);\n            finlen = finadd(finlen, sum(\n                scale(cytablen, cytab, cdytail, _16), _16,\n                scale(len, _16c, 2 * cdy, _32), _32, _48), _48);\n\n            const len2 = scale(abttlen, abtt, cdytail, _8);\n            finlen = finadd(finlen, sum_three(\n                scale(len2, _8, 2 * cdy, _16), _16,\n                scale(len2, _8, cdytail, _16b), _16b,\n                scale(len, _16c, cdytail, _32), _32, _32b, _64), _64);\n        }\n    }\n\n    return fin[finlen - 1];\n}\n\nexport function incircle(ax, ay, bx, by, cx, cy, dx, dy) {\n    const adx = ax - dx;\n    const bdx = bx - dx;\n    const cdx = cx - dx;\n    const ady = ay - dy;\n    const bdy = by - dy;\n    const cdy = cy - dy;\n\n    const bdxcdy = bdx * cdy;\n    const cdxbdy = cdx * bdy;\n    const alift = adx * adx + ady * ady;\n\n    const cdxady = cdx * ady;\n    const adxcdy = adx * cdy;\n    const blift = bdx * bdx + bdy * bdy;\n\n    const adxbdy = adx * bdy;\n    const bdxady = bdx * ady;\n    const clift = cdx * cdx + cdy * cdy;\n\n    const det =\n        alift * (bdxcdy - cdxbdy) +\n        blift * (cdxady - adxcdy) +\n        clift * (adxbdy - bdxady);\n\n    const permanent =\n        (Math.abs(bdxcdy) + Math.abs(cdxbdy)) * alift +\n        (Math.abs(cdxady) + Math.abs(adxcdy)) * blift +\n        (Math.abs(adxbdy) + Math.abs(bdxady)) * clift;\n\n    const errbound = iccerrboundA * permanent;\n\n    if (det > errbound || -det > errbound) {\n        return det;\n    }\n    return incircleadapt(ax, ay, bx, by, cx, cy, dx, dy, permanent);\n}\n\nexport function incirclefast(ax, ay, bx, by, cx, cy, dx, dy) {\n    const adx = ax - dx;\n    const ady = ay - dy;\n    const bdx = bx - dx;\n    const bdy = by - dy;\n    const cdx = cx - dx;\n    const cdy = cy - dy;\n\n    const abdet = adx * bdy - bdx * ady;\n    const bcdet = bdx * cdy - cdx * bdy;\n    const cadet = cdx * ady - adx * cdy;\n    const alift = adx * adx + ady * ady;\n    const blift = bdx * bdx + bdy * bdy;\n    const clift = cdx * cdx + cdy * cdy;\n\n    return alift * bcdet + blift * cadet + clift * abdet;\n}\n", "import {epsilon, splitter, resulterrbound, estimate, vec, sum, sum_three, scale, negate} from './util.js';\n\nconst isperrboundA = (16 + 224 * epsilon) * epsilon;\nconst isperrboundB = (5 + 72 * epsilon) * epsilon;\nconst isperrboundC = (71 + 1408 * epsilon) * epsilon * epsilon;\n\nconst ab = vec(4);\nconst bc = vec(4);\nconst cd = vec(4);\nconst de = vec(4);\nconst ea = vec(4);\nconst ac = vec(4);\nconst bd = vec(4);\nconst ce = vec(4);\nconst da = vec(4);\nconst eb = vec(4);\n\nconst abc = vec(24);\nconst bcd = vec(24);\nconst cde = vec(24);\nconst dea = vec(24);\nconst eab = vec(24);\nconst abd = vec(24);\nconst bce = vec(24);\nconst cda = vec(24);\nconst deb = vec(24);\nconst eac = vec(24);\n\nconst adet = vec(1152);\nconst bdet = vec(1152);\nconst cdet = vec(1152);\nconst ddet = vec(1152);\nconst edet = vec(1152);\nconst abdet = vec(2304);\nconst cddet = vec(2304);\nconst cdedet = vec(3456);\nconst deter = vec(5760);\n\nconst _8 = vec(8);\nconst _8b = vec(8);\nconst _8c = vec(8);\nconst _16 = vec(16);\nconst _24 = vec(24);\nconst _48 = vec(48);\nconst _48b = vec(48);\nconst _96 = vec(96);\nconst _192 = vec(192);\nconst _384x = vec(384);\nconst _384y = vec(384);\nconst _384z = vec(384);\nconst _768 = vec(768);\n\nfunction sum_three_scale(a, b, c, az, bz, cz, out) {\n    return sum_three(\n        scale(4, a, az, _8), _8,\n        scale(4, b, bz, _8b), _8b,\n        scale(4, c, cz, _8c), _8c, _16, out);\n}\n\nfunction liftexact(alen, a, blen, b, clen, c, dlen, d, x, y, z, out) {\n    const len = sum(\n        sum(alen, a, blen, b, _48), _48,\n        negate(sum(clen, c, dlen, d, _48b), _48b), _48b, _96);\n\n    return sum_three(\n        scale(scale(len, _96, x, _192), _192, x, _384x), _384x,\n        scale(scale(len, _96, y, _192), _192, y, _384y), _384y,\n        scale(scale(len, _96, z, _192), _192, z, _384z), _384z, _768, out);\n}\n\nfunction insphereexact(ax, ay, az, bx, by, bz, cx, cy, cz, dx, dy, dz, ex, ey, ez) {\n    let bvirt, c, ahi, alo, bhi, blo, _i, _j, _0, s1, s0, t1, t0, u3;\n\n    s1 = ax * by;\n    c = splitter * ax;\n    ahi = c - (c - ax);\n    alo = ax - ahi;\n    c = splitter * by;\n    bhi = c - (c - by);\n    blo = by - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = bx * ay;\n    c = splitter * bx;\n    ahi = c - (c - bx);\n    alo = bx - ahi;\n    c = splitter * ay;\n    bhi = c - (c - ay);\n    blo = ay - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    ab[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    ab[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    ab[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    ab[3] = u3;\n    s1 = bx * cy;\n    c = splitter * bx;\n    ahi = c - (c - bx);\n    alo = bx - ahi;\n    c = splitter * cy;\n    bhi = c - (c - cy);\n    blo = cy - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = cx * by;\n    c = splitter * cx;\n    ahi = c - (c - cx);\n    alo = cx - ahi;\n    c = splitter * by;\n    bhi = c - (c - by);\n    blo = by - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    bc[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    bc[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    bc[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    bc[3] = u3;\n    s1 = cx * dy;\n    c = splitter * cx;\n    ahi = c - (c - cx);\n    alo = cx - ahi;\n    c = splitter * dy;\n    bhi = c - (c - dy);\n    blo = dy - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = dx * cy;\n    c = splitter * dx;\n    ahi = c - (c - dx);\n    alo = dx - ahi;\n    c = splitter * cy;\n    bhi = c - (c - cy);\n    blo = cy - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    cd[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    cd[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    cd[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    cd[3] = u3;\n    s1 = dx * ey;\n    c = splitter * dx;\n    ahi = c - (c - dx);\n    alo = dx - ahi;\n    c = splitter * ey;\n    bhi = c - (c - ey);\n    blo = ey - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = ex * dy;\n    c = splitter * ex;\n    ahi = c - (c - ex);\n    alo = ex - ahi;\n    c = splitter * dy;\n    bhi = c - (c - dy);\n    blo = dy - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    de[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    de[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    de[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    de[3] = u3;\n    s1 = ex * ay;\n    c = splitter * ex;\n    ahi = c - (c - ex);\n    alo = ex - ahi;\n    c = splitter * ay;\n    bhi = c - (c - ay);\n    blo = ay - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = ax * ey;\n    c = splitter * ax;\n    ahi = c - (c - ax);\n    alo = ax - ahi;\n    c = splitter * ey;\n    bhi = c - (c - ey);\n    blo = ey - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    ea[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    ea[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    ea[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    ea[3] = u3;\n    s1 = ax * cy;\n    c = splitter * ax;\n    ahi = c - (c - ax);\n    alo = ax - ahi;\n    c = splitter * cy;\n    bhi = c - (c - cy);\n    blo = cy - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = cx * ay;\n    c = splitter * cx;\n    ahi = c - (c - cx);\n    alo = cx - ahi;\n    c = splitter * ay;\n    bhi = c - (c - ay);\n    blo = ay - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    ac[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    ac[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    ac[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    ac[3] = u3;\n    s1 = bx * dy;\n    c = splitter * bx;\n    ahi = c - (c - bx);\n    alo = bx - ahi;\n    c = splitter * dy;\n    bhi = c - (c - dy);\n    blo = dy - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = dx * by;\n    c = splitter * dx;\n    ahi = c - (c - dx);\n    alo = dx - ahi;\n    c = splitter * by;\n    bhi = c - (c - by);\n    blo = by - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    bd[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    bd[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    bd[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    bd[3] = u3;\n    s1 = cx * ey;\n    c = splitter * cx;\n    ahi = c - (c - cx);\n    alo = cx - ahi;\n    c = splitter * ey;\n    bhi = c - (c - ey);\n    blo = ey - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = ex * cy;\n    c = splitter * ex;\n    ahi = c - (c - ex);\n    alo = ex - ahi;\n    c = splitter * cy;\n    bhi = c - (c - cy);\n    blo = cy - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    ce[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    ce[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    ce[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    ce[3] = u3;\n    s1 = dx * ay;\n    c = splitter * dx;\n    ahi = c - (c - dx);\n    alo = dx - ahi;\n    c = splitter * ay;\n    bhi = c - (c - ay);\n    blo = ay - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = ax * dy;\n    c = splitter * ax;\n    ahi = c - (c - ax);\n    alo = ax - ahi;\n    c = splitter * dy;\n    bhi = c - (c - dy);\n    blo = dy - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    da[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    da[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    da[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    da[3] = u3;\n    s1 = ex * by;\n    c = splitter * ex;\n    ahi = c - (c - ex);\n    alo = ex - ahi;\n    c = splitter * by;\n    bhi = c - (c - by);\n    blo = by - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = bx * ey;\n    c = splitter * bx;\n    ahi = c - (c - bx);\n    alo = bx - ahi;\n    c = splitter * ey;\n    bhi = c - (c - ey);\n    blo = ey - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    eb[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    eb[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    eb[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    eb[3] = u3;\n\n    const abclen = sum_three_scale(ab, bc, ac, cz, az, -bz, abc);\n    const bcdlen = sum_three_scale(bc, cd, bd, dz, bz, -cz, bcd);\n    const cdelen = sum_three_scale(cd, de, ce, ez, cz, -dz, cde);\n    const dealen = sum_three_scale(de, ea, da, az, dz, -ez, dea);\n    const eablen = sum_three_scale(ea, ab, eb, bz, ez, -az, eab);\n    const abdlen = sum_three_scale(ab, bd, da, dz, az, bz, abd);\n    const bcelen = sum_three_scale(bc, ce, eb, ez, bz, cz, bce);\n    const cdalen = sum_three_scale(cd, da, ac, az, cz, dz, cda);\n    const deblen = sum_three_scale(de, eb, bd, bz, dz, ez, deb);\n    const eaclen = sum_three_scale(ea, ac, ce, cz, ez, az, eac);\n\n    const deterlen = sum_three(\n        liftexact(cdelen, cde, bcelen, bce, deblen, deb, bcdlen, bcd, ax, ay, az, adet), adet,\n        liftexact(dealen, dea, cdalen, cda, eaclen, eac, cdelen, cde, bx, by, bz, bdet), bdet,\n        sum_three(\n            liftexact(eablen, eab, deblen, deb, abdlen, abd, dealen, dea, cx, cy, cz, cdet), cdet,\n            liftexact(abclen, abc, eaclen, eac, bcelen, bce, eablen, eab, dx, dy, dz, ddet), ddet,\n            liftexact(bcdlen, bcd, abdlen, abd, cdalen, cda, abclen, abc, ex, ey, ez, edet), edet, cddet, cdedet), cdedet, abdet, deter);\n\n    return deter[deterlen - 1];\n}\n\nconst xdet = vec(96);\nconst ydet = vec(96);\nconst zdet = vec(96);\nconst fin = vec(1152);\n\nfunction liftadapt(a, b, c, az, bz, cz, x, y, z, out) {\n    const len = sum_three_scale(a, b, c, az, bz, cz, _24);\n    return sum_three(\n        scale(scale(len, _24, x, _48), _48, x, xdet), xdet,\n        scale(scale(len, _24, y, _48), _48, y, ydet), ydet,\n        scale(scale(len, _24, z, _48), _48, z, zdet), zdet, _192, out);\n}\n\nfunction insphereadapt(ax, ay, az, bx, by, bz, cx, cy, cz, dx, dy, dz, ex, ey, ez, permanent) {\n    let ab3, bc3, cd3, da3, ac3, bd3;\n\n    let aextail, bextail, cextail, dextail;\n    let aeytail, beytail, ceytail, deytail;\n    let aeztail, beztail, ceztail, deztail;\n\n    let bvirt, c, ahi, alo, bhi, blo, _i, _j, _0, s1, s0, t1, t0;\n\n    const aex = ax - ex;\n    const bex = bx - ex;\n    const cex = cx - ex;\n    const dex = dx - ex;\n    const aey = ay - ey;\n    const bey = by - ey;\n    const cey = cy - ey;\n    const dey = dy - ey;\n    const aez = az - ez;\n    const bez = bz - ez;\n    const cez = cz - ez;\n    const dez = dz - ez;\n\n    s1 = aex * bey;\n    c = splitter * aex;\n    ahi = c - (c - aex);\n    alo = aex - ahi;\n    c = splitter * bey;\n    bhi = c - (c - bey);\n    blo = bey - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = bex * aey;\n    c = splitter * bex;\n    ahi = c - (c - bex);\n    alo = bex - ahi;\n    c = splitter * aey;\n    bhi = c - (c - aey);\n    blo = aey - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    ab[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    ab[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    ab3 = _j + _i;\n    bvirt = ab3 - _j;\n    ab[2] = _j - (ab3 - bvirt) + (_i - bvirt);\n    ab[3] = ab3;\n    s1 = bex * cey;\n    c = splitter * bex;\n    ahi = c - (c - bex);\n    alo = bex - ahi;\n    c = splitter * cey;\n    bhi = c - (c - cey);\n    blo = cey - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = cex * bey;\n    c = splitter * cex;\n    ahi = c - (c - cex);\n    alo = cex - ahi;\n    c = splitter * bey;\n    bhi = c - (c - bey);\n    blo = bey - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    bc[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    bc[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    bc3 = _j + _i;\n    bvirt = bc3 - _j;\n    bc[2] = _j - (bc3 - bvirt) + (_i - bvirt);\n    bc[3] = bc3;\n    s1 = cex * dey;\n    c = splitter * cex;\n    ahi = c - (c - cex);\n    alo = cex - ahi;\n    c = splitter * dey;\n    bhi = c - (c - dey);\n    blo = dey - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = dex * cey;\n    c = splitter * dex;\n    ahi = c - (c - dex);\n    alo = dex - ahi;\n    c = splitter * cey;\n    bhi = c - (c - cey);\n    blo = cey - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    cd[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    cd[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    cd3 = _j + _i;\n    bvirt = cd3 - _j;\n    cd[2] = _j - (cd3 - bvirt) + (_i - bvirt);\n    cd[3] = cd3;\n    s1 = dex * aey;\n    c = splitter * dex;\n    ahi = c - (c - dex);\n    alo = dex - ahi;\n    c = splitter * aey;\n    bhi = c - (c - aey);\n    blo = aey - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = aex * dey;\n    c = splitter * aex;\n    ahi = c - (c - aex);\n    alo = aex - ahi;\n    c = splitter * dey;\n    bhi = c - (c - dey);\n    blo = dey - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    da[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    da[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    da3 = _j + _i;\n    bvirt = da3 - _j;\n    da[2] = _j - (da3 - bvirt) + (_i - bvirt);\n    da[3] = da3;\n    s1 = aex * cey;\n    c = splitter * aex;\n    ahi = c - (c - aex);\n    alo = aex - ahi;\n    c = splitter * cey;\n    bhi = c - (c - cey);\n    blo = cey - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = cex * aey;\n    c = splitter * cex;\n    ahi = c - (c - cex);\n    alo = cex - ahi;\n    c = splitter * aey;\n    bhi = c - (c - aey);\n    blo = aey - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    ac[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    ac[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    ac3 = _j + _i;\n    bvirt = ac3 - _j;\n    ac[2] = _j - (ac3 - bvirt) + (_i - bvirt);\n    ac[3] = ac3;\n    s1 = bex * dey;\n    c = splitter * bex;\n    ahi = c - (c - bex);\n    alo = bex - ahi;\n    c = splitter * dey;\n    bhi = c - (c - dey);\n    blo = dey - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = dex * bey;\n    c = splitter * dex;\n    ahi = c - (c - dex);\n    alo = dex - ahi;\n    c = splitter * bey;\n    bhi = c - (c - bey);\n    blo = bey - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    bd[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    bd[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    bd3 = _j + _i;\n    bvirt = bd3 - _j;\n    bd[2] = _j - (bd3 - bvirt) + (_i - bvirt);\n    bd[3] = bd3;\n\n    const finlen = sum(\n        sum(\n            negate(liftadapt(bc, cd, bd, dez, bez, -cez, aex, aey, aez, adet), adet), adet,\n            liftadapt(cd, da, ac, aez, cez, dez, bex, bey, bez, bdet), bdet, abdet), abdet,\n        sum(\n            negate(liftadapt(da, ab, bd, bez, dez, aez, cex, cey, cez, cdet), cdet), cdet,\n            liftadapt(ab, bc, ac, cez, aez, -bez, dex, dey, dez, ddet), ddet, cddet), cddet, fin);\n\n    let det = estimate(finlen, fin);\n    let errbound = isperrboundB * permanent;\n    if (det >= errbound || -det >= errbound) {\n        return det;\n    }\n\n    bvirt = ax - aex;\n    aextail = ax - (aex + bvirt) + (bvirt - ex);\n    bvirt = ay - aey;\n    aeytail = ay - (aey + bvirt) + (bvirt - ey);\n    bvirt = az - aez;\n    aeztail = az - (aez + bvirt) + (bvirt - ez);\n    bvirt = bx - bex;\n    bextail = bx - (bex + bvirt) + (bvirt - ex);\n    bvirt = by - bey;\n    beytail = by - (bey + bvirt) + (bvirt - ey);\n    bvirt = bz - bez;\n    beztail = bz - (bez + bvirt) + (bvirt - ez);\n    bvirt = cx - cex;\n    cextail = cx - (cex + bvirt) + (bvirt - ex);\n    bvirt = cy - cey;\n    ceytail = cy - (cey + bvirt) + (bvirt - ey);\n    bvirt = cz - cez;\n    ceztail = cz - (cez + bvirt) + (bvirt - ez);\n    bvirt = dx - dex;\n    dextail = dx - (dex + bvirt) + (bvirt - ex);\n    bvirt = dy - dey;\n    deytail = dy - (dey + bvirt) + (bvirt - ey);\n    bvirt = dz - dez;\n    deztail = dz - (dez + bvirt) + (bvirt - ez);\n    if (aextail === 0 && aeytail === 0 && aeztail === 0 &&\n        bextail === 0 && beytail === 0 && beztail === 0 &&\n        cextail === 0 && ceytail === 0 && ceztail === 0 &&\n        dextail === 0 && deytail === 0 && deztail === 0) {\n        return det;\n    }\n\n    errbound = isperrboundC * permanent + resulterrbound * Math.abs(det);\n\n    const abeps = (aex * beytail + bey * aextail) - (aey * bextail + bex * aeytail);\n    const bceps = (bex * ceytail + cey * bextail) - (bey * cextail + cex * beytail);\n    const cdeps = (cex * deytail + dey * cextail) - (cey * dextail + dex * ceytail);\n    const daeps = (dex * aeytail + aey * dextail) - (dey * aextail + aex * deytail);\n    const aceps = (aex * ceytail + cey * aextail) - (aey * cextail + cex * aeytail);\n    const bdeps = (bex * deytail + dey * bextail) - (bey * dextail + dex * beytail);\n    det +=\n        (((bex * bex + bey * bey + bez * bez) * ((cez * daeps + dez * aceps + aez * cdeps) +\n        (ceztail * da3 + deztail * ac3 + aeztail * cd3)) + (dex * dex + dey * dey + dez * dez) *\n        ((aez * bceps - bez * aceps + cez * abeps) + (aeztail * bc3 - beztail * ac3 + ceztail * ab3))) -\n        ((aex * aex + aey * aey + aez * aez) * ((bez * cdeps - cez * bdeps + dez * bceps) +\n        (beztail * cd3 - ceztail * bd3 + deztail * bc3)) + (cex * cex + cey * cey + cez * cez) *\n        ((dez * abeps + aez * bdeps + bez * daeps) + (deztail * ab3 + aeztail * bd3 + beztail * da3)))) +\n        2 * (((bex * bextail + bey * beytail + bez * beztail) * (cez * da3 + dez * ac3 + aez * cd3) +\n        (dex * dextail + dey * deytail + dez * deztail) * (aez * bc3 - bez * ac3 + cez * ab3)) -\n        ((aex * aextail + aey * aeytail + aez * aeztail) * (bez * cd3 - cez * bd3 + dez * bc3) +\n        (cex * cextail + cey * ceytail + cez * ceztail) * (dez * ab3 + aez * bd3 + bez * da3)));\n\n    if (det >= errbound || -det >= errbound) {\n        return det;\n    }\n\n    return insphereexact(ax, ay, az, bx, by, bz, cx, cy, cz, dx, dy, dz, ex, ey, ez);\n}\n\nexport function insphere(ax, ay, az, bx, by, bz, cx, cy, cz, dx, dy, dz, ex, ey, ez) {\n    const aex = ax - ex;\n    const bex = bx - ex;\n    const cex = cx - ex;\n    const dex = dx - ex;\n    const aey = ay - ey;\n    const bey = by - ey;\n    const cey = cy - ey;\n    const dey = dy - ey;\n    const aez = az - ez;\n    const bez = bz - ez;\n    const cez = cz - ez;\n    const dez = dz - ez;\n\n    const aexbey = aex * bey;\n    const bexaey = bex * aey;\n    const ab = aexbey - bexaey;\n    const bexcey = bex * cey;\n    const cexbey = cex * bey;\n    const bc = bexcey - cexbey;\n    const cexdey = cex * dey;\n    const dexcey = dex * cey;\n    const cd = cexdey - dexcey;\n    const dexaey = dex * aey;\n    const aexdey = aex * dey;\n    const da = dexaey - aexdey;\n    const aexcey = aex * cey;\n    const cexaey = cex * aey;\n    const ac = aexcey - cexaey;\n    const bexdey = bex * dey;\n    const dexbey = dex * bey;\n    const bd = bexdey - dexbey;\n\n    const alift = aex * aex + aey * aey + aez * aez;\n    const blift = bex * bex + bey * bey + bez * bez;\n    const clift = cex * cex + cey * cey + cez * cez;\n    const dlift = dex * dex + dey * dey + dez * dez;\n\n    const det =\n        (clift * (dez * ab + aez * bd + bez * da) - dlift * (aez * bc - bez * ac + cez * ab)) +\n        (alift * (bez * cd - cez * bd + dez * bc) - blift * (cez * da + dez * ac + aez * cd));\n\n    const aezplus = Math.abs(aez);\n    const bezplus = Math.abs(bez);\n    const cezplus = Math.abs(cez);\n    const dezplus = Math.abs(dez);\n    const aexbeyplus = Math.abs(aexbey) + Math.abs(bexaey);\n    const bexceyplus = Math.abs(bexcey) + Math.abs(cexbey);\n    const cexdeyplus = Math.abs(cexdey) + Math.abs(dexcey);\n    const dexaeyplus = Math.abs(dexaey) + Math.abs(aexdey);\n    const aexceyplus = Math.abs(aexcey) + Math.abs(cexaey);\n    const bexdeyplus = Math.abs(bexdey) + Math.abs(dexbey);\n    const permanent =\n        (cexdeyplus * bezplus + bexdeyplus * cezplus + bexceyplus * dezplus) * alift +\n        (dexaeyplus * cezplus + aexceyplus * dezplus + cexdeyplus * aezplus) * blift +\n        (aexbeyplus * dezplus + bexdeyplus * aezplus + dexaeyplus * bezplus) * clift +\n        (bexceyplus * aezplus + aexceyplus * bezplus + aexbeyplus * cezplus) * dlift;\n\n    const errbound = isperrboundA * permanent;\n    if (det > errbound || -det > errbound) {\n        return det;\n    }\n    return -insphereadapt(ax, ay, az, bx, by, bz, cx, cy, cz, dx, dy, dz, ex, ey, ez, permanent);\n}\n\nexport function inspherefast(pax, pay, paz, pbx, pby, pbz, pcx, pcy, pcz, pdx, pdy, pdz, pex, pey, pez) {\n    const aex = pax - pex;\n    const bex = pbx - pex;\n    const cex = pcx - pex;\n    const dex = pdx - pex;\n    const aey = pay - pey;\n    const bey = pby - pey;\n    const cey = pcy - pey;\n    const dey = pdy - pey;\n    const aez = paz - pez;\n    const bez = pbz - pez;\n    const cez = pcz - pez;\n    const dez = pdz - pez;\n\n    const ab = aex * bey - bex * aey;\n    const bc = bex * cey - cex * bey;\n    const cd = cex * dey - dex * cey;\n    const da = dex * aey - aex * dey;\n    const ac = aex * cey - cex * aey;\n    const bd = bex * dey - dex * bey;\n\n    const abc = aez * bc - bez * ac + cez * ab;\n    const bcd = bez * cd - cez * bd + dez * bc;\n    const cda = cez * da + dez * ac + aez * cd;\n    const dab = dez * ab + aez * bd + bez * da;\n\n    const alift = aex * aex + aey * aey + aez * aez;\n    const blift = bex * bex + bey * bey + bez * bez;\n    const clift = cex * cex + cey * cey + cez * cez;\n    const dlift = dex * dex + dey * dey + dez * dez;\n\n    return (clift * dab - dlift * abc) + (alift * bcd - blift * cda);\n}\n", "import { orient2d } from 'robust-predicates';\n\nfunction pointInPolygon(p, polygon) {\n    var i;\n    var ii;\n    var k = 0;\n    var f;\n    var u1;\n    var v1;\n    var u2;\n    var v2;\n    var currentP;\n    var nextP;\n\n    var x = p[0];\n    var y = p[1];\n\n    var numContours = polygon.length;\n    for (i = 0; i < numContours; i++) {\n        ii = 0;\n        var contour = polygon[i];\n        var contourLen = contour.length - 1;\n\n        currentP = contour[0];\n        if (currentP[0] !== contour[contourLen][0] &&\n            currentP[1] !== contour[contourLen][1]) {\n            throw new Error('First and last coordinates in a ring must be the same')\n        }\n\n        u1 = currentP[0] - x;\n        v1 = currentP[1] - y;\n\n        for (ii; ii < contourLen; ii++) {\n            nextP = contour[ii + 1];\n\n            u2 = nextP[0] - x;\n            v2 = nextP[1] - y;\n\n            if (v1 === 0 && v2 === 0) {\n                if ((u2 <= 0 && u1 >= 0) || (u1 <= 0 && u2 >= 0)) { return 0 }\n            } else if ((v2 >= 0 && v1 <= 0) || (v2 <= 0 && v1 >= 0)) {\n                f = orient2d(u1, u2, v1, v2, 0, 0);\n                if (f === 0) { return 0 }\n                if ((f > 0 && v2 > 0 && v1 <= 0) || (f < 0 && v2 <= 0 && v1 > 0)) { k++; }\n            }\n            currentP = nextP;\n            v1 = v2;\n            u1 = u2;\n        }\n    }\n\n    if (k % 2 === 0) { return false }\n    return true\n}\n\nexport { pointInPolygon as default };\n", "import pip from \"point-in-polygon-hao\";\nimport {\n  BBox,\n  Feature,\n  MultiPolygon,\n  Polygon,\n  GeoJsonProperties,\n} from \"geojson\";\nimport { Coord } from \"@turf/helpers\";\nimport { getCoord, getGeom } from \"@turf/invariant\";\n\n// http://en.wikipedia.org/wiki/Even%E2%80%93odd_rule\n// modified from: https://github.com/substack/point-in-polygon/blob/master/index.js\n// which was modified from http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html\n/**\n * Takes a {@link Point} and a {@link Polygon} or {@link MultiPolygon} and determines if the point\n * resides inside the polygon. The polygon can be convex or concave. The function accounts for holes.\n *\n * @function\n * @param {Coord} point input point\n * @param {Feature<Polygon|MultiPolygon>} polygon input polygon or multipolygon\n * @param {Object} [options={}] Optional parameters\n * @param {boolean} [options.ignoreBoundary=false] True if polygon boundary should be ignored when determining if\n * the point is inside the polygon otherwise false.\n * @returns {boolean} `true` if the Point is inside the Polygon; `false` if the Point is not inside the Polygon\n * @example\n * var pt = turf.point([-77, 44]);\n * var poly = turf.polygon([[\n *   [-81, 41],\n *   [-81, 47],\n *   [-72, 47],\n *   [-72, 41],\n *   [-81, 41]\n * ]]);\n *\n * turf.booleanPointInPolygon(pt, poly);\n * //= true\n */\nfunction booleanPointInPolygon<\n  G extends Polygon | MultiPolygon,\n  P extends GeoJsonProperties = GeoJsonProperties,\n>(\n  point: Coord,\n  polygon: Feature<G, P> | G,\n  options: {\n    ignoreBoundary?: boolean;\n  } = {}\n) {\n  // validation\n  if (!point) {\n    throw new Error(\"point is required\");\n  }\n  if (!polygon) {\n    throw new Error(\"polygon is required\");\n  }\n\n  const pt = getCoord(point);\n  const geom = getGeom(polygon);\n  const type = geom.type;\n  const bbox = polygon.bbox;\n  let polys: any[] = geom.coordinates;\n\n  // Quick elimination if point is not inside bbox\n  if (bbox && inBBox(pt, bbox) === false) {\n    return false;\n  }\n\n  if (type === \"Polygon\") {\n    polys = [polys];\n  }\n  let result = false;\n  for (var i = 0; i < polys.length; ++i) {\n    const polyResult = pip(pt, polys[i]);\n    if (polyResult === 0) return options.ignoreBoundary ? false : true;\n    else if (polyResult) result = true;\n  }\n\n  return result;\n}\n\n/**\n * inBBox\n *\n * @private\n * @param {Position} pt point [x,y]\n * @param {BBox} bbox BBox [west, south, east, north]\n * @returns {boolean} true/false if point is inside BBox\n */\nfunction inBBox(pt: number[], bbox: BBox) {\n  return (\n    bbox[0] <= pt[0] && bbox[1] <= pt[1] && bbox[2] >= pt[0] && bbox[3] >= pt[1]\n  );\n}\n\nexport { booleanPointInPolygon };\nexport default booleanPointInPolygon;\n", "import { Feature, LineString } from \"geojson\";\nimport { Coord } from \"@turf/helpers\";\nimport { getCoord, getCoords } from \"@turf/invariant\";\n\n/**\n * Returns true if a point is on a line. Accepts a optional parameter to ignore the\n * start and end vertices of the linestring.\n *\n * @function\n * @param {Coord} pt GeoJSON Point\n * @param {Feature<LineString>} line GeoJSON LineString\n * @param {Object} [options={}] Optional parameters\n * @param {boolean} [options.ignoreEndVertices=false] whether to ignore the start and end vertices.\n * @param {number} [options.epsilon] Fractional number to compare with the cross product result. Useful for dealing with floating points such as lng/lat points\n * @returns {boolean} true/false\n * @example\n * var pt = turf.point([0, 0]);\n * var line = turf.lineString([[-1, -1],[1, 1],[1.5, 2.2]]);\n * var isPointOnLine = turf.booleanPointOnLine(pt, line);\n * //=true\n */\nfunction booleanPointOnLine(\n  pt: Coord,\n  line: Feature<LineString> | LineString,\n  options: {\n    ignoreEndVertices?: boolean;\n    epsilon?: number;\n  } = {}\n): boolean {\n  // Normalize inputs\n  const ptCoords = getCoord(pt);\n  const lineCoords = getCoords(line);\n\n  // Main\n  for (let i = 0; i < lineCoords.length - 1; i++) {\n    let ignoreBoundary: boolean | string = false;\n    if (options.ignoreEndVertices) {\n      if (i === 0) {\n        ignoreBoundary = \"start\";\n      }\n      if (i === lineCoords.length - 2) {\n        ignoreBoundary = \"end\";\n      }\n      if (i === 0 && i + 1 === lineCoords.length - 1) {\n        ignoreBoundary = \"both\";\n      }\n    }\n    if (\n      isPointOnLineSegment(\n        lineCoords[i],\n        lineCoords[i + 1],\n        ptCoords,\n        ignoreBoundary,\n        typeof options.epsilon === \"undefined\" ? null : options.epsilon\n      )\n    ) {\n      return true;\n    }\n  }\n  return false;\n}\n\n// See http://stackoverflow.com/a/4833823/1979085\n// See https://stackoverflow.com/a/328122/1048847\n/**\n * @private\n * @param {Position} lineSegmentStart coord pair of start of line\n * @param {Position} lineSegmentEnd coord pair of end of line\n * @param {Position} pt coord pair of point to check\n * @param {boolean|string} excludeBoundary whether the point is allowed to fall on the line ends.\n * @param {number} epsilon Fractional number to compare with the cross product result. Useful for dealing with floating points such as lng/lat points\n * If true which end to ignore.\n * @returns {boolean} true/false\n */\nfunction isPointOnLineSegment(\n  lineSegmentStart: number[],\n  lineSegmentEnd: number[],\n  pt: number[],\n  excludeBoundary: string | boolean,\n  epsilon: number | null\n): boolean {\n  const x = pt[0];\n  const y = pt[1];\n  const x1 = lineSegmentStart[0];\n  const y1 = lineSegmentStart[1];\n  const x2 = lineSegmentEnd[0];\n  const y2 = lineSegmentEnd[1];\n  const dxc = pt[0] - x1;\n  const dyc = pt[1] - y1;\n  const dxl = x2 - x1;\n  const dyl = y2 - y1;\n  const cross = dxc * dyl - dyc * dxl;\n  if (epsilon !== null) {\n    if (Math.abs(cross) > epsilon) {\n      return false;\n    }\n  } else if (cross !== 0) {\n    return false;\n  }\n\n  // Special cases for zero length lines\n  // https://github.com/Turfjs/turf/issues/2750\n  if (Math.abs(dxl) === Math.abs(dyl) && Math.abs(dxl) === 0) {\n    // Zero length line.\n    if (excludeBoundary) {\n      // To be on a zero length line pt has to be on the start (and end), BUT we\n      // are excluding start and end from possible matches.\n      return false;\n    }\n    if (pt[0] === lineSegmentStart[0] && pt[1] === lineSegmentStart[1]) {\n      // If point is same as start (and end) it's on the line segment\n      return true;\n    } else {\n      // Otherwise point is somewhere else\n      return false;\n    }\n  }\n\n  if (!excludeBoundary) {\n    if (Math.abs(dxl) >= Math.abs(dyl)) {\n      return dxl > 0 ? x1 <= x && x <= x2 : x2 <= x && x <= x1;\n    }\n    return dyl > 0 ? y1 <= y && y <= y2 : y2 <= y && y <= y1;\n  } else if (excludeBoundary === \"start\") {\n    if (Math.abs(dxl) >= Math.abs(dyl)) {\n      return dxl > 0 ? x1 < x && x <= x2 : x2 <= x && x < x1;\n    }\n    return dyl > 0 ? y1 < y && y <= y2 : y2 <= y && y < y1;\n  } else if (excludeBoundary === \"end\") {\n    if (Math.abs(dxl) >= Math.abs(dyl)) {\n      return dxl > 0 ? x1 <= x && x < x2 : x2 < x && x <= x1;\n    }\n    return dyl > 0 ? y1 <= y && y < y2 : y2 < y && y <= y1;\n  } else if (excludeBoundary === \"both\") {\n    if (Math.abs(dxl) >= Math.abs(dyl)) {\n      return dxl > 0 ? x1 < x && x < x2 : x2 < x && x < x1;\n    }\n    return dyl > 0 ? y1 < y && y < y2 : y2 < y && y < y1;\n  }\n  return false;\n}\n\nexport { booleanPointOnLine };\nexport default booleanPointOnLine;\n", "import {\n  BBox,\n  Feature,\n  Geometry,\n  LineString,\n  MultiPoint,\n  MultiPolygon,\n  Point,\n  Polygon,\n} from \"geojson\";\nimport { bbox as calcBbox } from \"@turf/bbox\";\nimport { booleanPointInPolygon } from \"@turf/boolean-point-in-polygon\";\nimport { booleanPointOnLine as isPointOnLine } from \"@turf/boolean-point-on-line\";\nimport { getGeom } from \"@turf/invariant\";\nimport { feature, featureCollection, lineString } from \"@turf/helpers\";\nimport { lineSplit } from \"@turf/line-split\";\n\n/**\n * Tests whether geometry a contains geometry b.\n * The interiors of both geometries must intersect, and the interior and boundary of geometry b must not intersect the exterior of geometry a.\n * booleanContains(a, b) is equivalent to booleanWithin(b, a)\n *\n * @function\n * @param {Geometry|Feature<any>} feature1 GeoJSON Feature or Geometry\n * @param {Geometry|Feature<any>} feature2 GeoJSON Feature or Geometry\n * @returns {boolean} true/false\n * @example\n * var line = turf.lineString([[1, 1], [1, 2], [1, 3], [1, 4]]);\n * var point = turf.point([1, 2]);\n *\n * turf.booleanContains(line, point);\n * //=true\n */\nfunction booleanContains(\n  feature1: Feature<any> | Geometry,\n  feature2: Feature<any> | Geometry\n) {\n  const geom1 = getGeom(feature1);\n  const geom2 = getGeom(feature2);\n  const type1 = geom1.type;\n  const type2 = geom2.type;\n  const coords1 = geom1.coordinates;\n  const coords2 = geom2.coordinates;\n\n  switch (type1) {\n    case \"Point\":\n      switch (type2) {\n        case \"Point\":\n          return compareCoords(coords1, coords2);\n        default:\n          throw new Error(\"feature2 \" + type2 + \" geometry not supported\");\n      }\n    case \"MultiPoint\":\n      switch (type2) {\n        case \"Point\":\n          return isPointInMultiPoint(geom1, geom2);\n        case \"MultiPoint\":\n          return isMultiPointInMultiPoint(geom1, geom2);\n        default:\n          throw new Error(\"feature2 \" + type2 + \" geometry not supported\");\n      }\n    case \"LineString\":\n      switch (type2) {\n        case \"Point\":\n          return isPointOnLine(geom2, geom1, { ignoreEndVertices: true });\n        case \"LineString\":\n          return isLineOnLine(geom1, geom2);\n        case \"MultiPoint\":\n          return isMultiPointOnLine(geom1, geom2);\n        default:\n          throw new Error(\"feature2 \" + type2 + \" geometry not supported\");\n      }\n    case \"Polygon\":\n      switch (type2) {\n        case \"Point\":\n          return booleanPointInPolygon(geom2, geom1, { ignoreBoundary: true });\n        case \"LineString\":\n          return isLineInPoly(geom1, geom2);\n        case \"Polygon\":\n          return isPolyInPoly(geom1, geom2);\n        case \"MultiPoint\":\n          return isMultiPointInPoly(geom1, geom2);\n        case \"MultiPolygon\":\n          return isMultiPolyInPoly(geom1, geom2);\n        default:\n          throw new Error(\"feature2 \" + type2 + \" geometry not supported\");\n      }\n    case \"MultiPolygon\":\n      switch (type2) {\n        case \"Polygon\":\n          return isPolygonInMultiPolygon(geom1, geom2);\n        default:\n          throw new Error(\"feature2 \" + type2 + \" geometry not supported\");\n      }\n    default:\n      throw new Error(\"feature1 \" + type1 + \" geometry not supported\");\n  }\n}\n\nfunction isPolygonInMultiPolygon(multiPolygon: MultiPolygon, polygon: Polygon) {\n  return multiPolygon.coordinates.some((coords) =>\n    isPolyInPoly({ type: \"Polygon\", coordinates: coords }, polygon)\n  );\n}\n\nfunction isMultiPolyInPoly(polygon: Polygon, multiPolygon: MultiPolygon) {\n  return multiPolygon.coordinates.every((coords) =>\n    isPolyInPoly(polygon, { type: \"Polygon\", coordinates: coords })\n  );\n}\n\nfunction isPointInMultiPoint(multiPoint: MultiPoint, pt: Point) {\n  let i;\n  let output = false;\n  for (i = 0; i < multiPoint.coordinates.length; i++) {\n    if (compareCoords(multiPoint.coordinates[i], pt.coordinates)) {\n      output = true;\n      break;\n    }\n  }\n  return output;\n}\n\nfunction isMultiPointInMultiPoint(\n  multiPoint1: MultiPoint,\n  multiPoint2: MultiPoint\n) {\n  for (const coord2 of multiPoint2.coordinates) {\n    let matchFound = false;\n    for (const coord1 of multiPoint1.coordinates) {\n      if (compareCoords(coord2, coord1)) {\n        matchFound = true;\n        break;\n      }\n    }\n    if (!matchFound) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction isMultiPointOnLine(lineString: LineString, multiPoint: MultiPoint) {\n  let haveFoundInteriorPoint = false;\n  for (const coord of multiPoint.coordinates) {\n    if (isPointOnLine(coord, lineString, { ignoreEndVertices: true })) {\n      haveFoundInteriorPoint = true;\n    }\n    if (!isPointOnLine(coord, lineString)) {\n      return false;\n    }\n  }\n  if (haveFoundInteriorPoint) {\n    return true;\n  }\n  return false;\n}\n\nfunction isMultiPointInPoly(polygon: Polygon, multiPoint: MultiPoint) {\n  for (const coord of multiPoint.coordinates) {\n    if (!booleanPointInPolygon(coord, polygon, { ignoreBoundary: true })) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction isLineOnLine(lineString1: LineString, lineString2: LineString) {\n  let haveFoundInteriorPoint = false;\n  for (const coords of lineString2.coordinates) {\n    if (\n      isPointOnLine({ type: \"Point\", coordinates: coords }, lineString1, {\n        ignoreEndVertices: true,\n      })\n    ) {\n      haveFoundInteriorPoint = true;\n    }\n    if (\n      !isPointOnLine({ type: \"Point\", coordinates: coords }, lineString1, {\n        ignoreEndVertices: false,\n      })\n    ) {\n      return false;\n    }\n  }\n  return haveFoundInteriorPoint;\n}\n\nfunction splitLineIntoSegmentsOnPolygon(\n  linestring: LineString,\n  polygon: Polygon\n) {\n  const coords = linestring.coordinates;\n\n  const outputSegments: Feature<LineString>[] = [];\n\n  for (let i = 0; i < coords.length - 1; i++) {\n    const seg = lineString([coords[i], coords[i + 1]]);\n    const split = lineSplit(seg, feature(polygon));\n\n    if (split.features.length === 0) {\n      outputSegments.push(seg);\n    } else {\n      outputSegments.push(...split.features);\n    }\n  }\n\n  return featureCollection(outputSegments);\n}\n\nfunction isLineInPoly(polygon: Polygon, linestring: LineString) {\n  const polyBbox = calcBbox(polygon);\n  const lineBbox = calcBbox(linestring);\n\n  if (!doBBoxOverlap(polyBbox, lineBbox)) {\n    return false;\n  }\n\n  for (const coord of linestring.coordinates) {\n    if (!booleanPointInPolygon(coord, polygon)) {\n      return false;\n    }\n  }\n\n  let isContainedByPolygonBoundary = false;\n  // split intersecting segments and verify their inclusion\n  const lineSegments = splitLineIntoSegmentsOnPolygon(linestring, polygon);\n\n  for (const lineSegment of lineSegments.features) {\n    const midpoint = getMidpoint(\n      lineSegment.geometry.coordinates[0],\n      lineSegment.geometry.coordinates[1]\n    );\n\n    // make sure all segments do not intersect with polygon exterior\n    if (!booleanPointInPolygon(midpoint, polygon)) {\n      return false;\n    }\n\n    // make sure at least 1 segment intersects with the polygon's interior\n    if (\n      !isContainedByPolygonBoundary &&\n      booleanPointInPolygon(midpoint, polygon, { ignoreBoundary: true })\n    ) {\n      isContainedByPolygonBoundary = true;\n    }\n  }\n\n  return isContainedByPolygonBoundary;\n}\n\n/**\n * Is Polygon2 in Polygon1\n * Only takes into account outer rings\n *\n * @private\n * @param {Geometry|Feature<Polygon>} feature1 Polygon1\n * @param {Geometry|Feature<Polygon>} feature2 Polygon2\n * @returns {boolean} true/false\n */\nfunction isPolyInPoly(\n  feature1: Feature<Polygon> | Polygon,\n  feature2: Feature<Polygon> | Polygon\n) {\n  // Handle Nulls\n  if (feature1.type === \"Feature\" && feature1.geometry === null) {\n    return false;\n  }\n  if (feature2.type === \"Feature\" && feature2.geometry === null) {\n    return false;\n  }\n\n  const poly1Bbox = calcBbox(feature1);\n  const poly2Bbox = calcBbox(feature2);\n  if (!doBBoxOverlap(poly1Bbox, poly2Bbox)) {\n    return false;\n  }\n\n  const coords = getGeom(feature2).coordinates;\n  for (const ring of coords) {\n    for (const coord of ring) {\n      if (!booleanPointInPolygon(coord, feature1)) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nfunction doBBoxOverlap(bbox1: BBox, bbox2: BBox) {\n  if (bbox1[0] > bbox2[0]) {\n    return false;\n  }\n  if (bbox1[2] < bbox2[2]) {\n    return false;\n  }\n  if (bbox1[1] > bbox2[1]) {\n    return false;\n  }\n  if (bbox1[3] < bbox2[3]) {\n    return false;\n  }\n  return true;\n}\n\n/**\n * compareCoords\n *\n * @private\n * @param {Position} pair1 point [x,y]\n * @param {Position} pair2 point [x,y]\n * @returns {boolean} true/false if coord pairs match\n */\nfunction compareCoords(pair1: number[], pair2: number[]) {\n  return pair1[0] === pair2[0] && pair1[1] === pair2[1];\n}\n\nfunction getMidpoint(pair1: number[], pair2: number[]) {\n  return [(pair1[0] + pair2[0]) / 2, (pair1[1] + pair2[1]) / 2];\n}\n\nexport {\n  booleanContains,\n  isPolygonInMultiPolygon,\n  isPointInMultiPoint,\n  isMultiPointInMultiPoint,\n  isMultiPointOnLine,\n  isMultiPointInPoly,\n  isLineOnLine,\n  isLineInPoly,\n  isPolyInPoly,\n  isMultiPolyInPoly,\n  doBBoxOverlap,\n  compareCoords,\n  getMidpoint,\n};\n\nexport default booleanContains;\n", "import lineIntersect from '@turf/line-intersect';\nimport lineSplit from '@turf/line-split';\nimport booleanContains from '@turf/boolean-contains';\nimport get from 'lodash/get';\nimport Draw from './L.PM.Draw';\nimport {\n  difference,\n  flattenPolyline,\n  groupToMultiLineString,\n  intersect,\n} from '../helpers/turfHelper';\n\nDraw.Cut = Draw.Polygon.extend({\n  initialize(map) {\n    this._map = map;\n    this._shape = 'Cut';\n    this.toolbarButtonName = 'cutPolygon';\n  },\n  _finishShape() {\n    this._editedLayers = [];\n    // if self intersection is not allowed, do not finish the shape!\n    if (!this.options.allowSelfIntersection) {\n      // Check if polygon intersects when is completed and the line between the last and the first point is drawn\n      this._handleSelfIntersection(true, this._layer.getLatLngs()[0]);\n\n      if (this._doesSelfIntersect) {\n        return;\n      }\n    }\n\n    // If snap finish is required but the last marker wasn't snapped, do not finish the shape!\n    if (\n      this.options.requireSnapToFinish &&\n      !this._hintMarker._snapped &&\n      !this._isFirstLayer()\n    ) {\n      return;\n    }\n\n    // get coordinates\n    const coords = this._layer.getLatLngs();\n\n    // only finish the shape if there are 3 or more vertices\n    if (coords.length <= 2) {\n      return;\n    }\n\n    const polygonLayer = L.polygon(coords, this.options.pathOptions);\n    // readout information about the latlngs like snapping points\n    polygonLayer._latlngInfos = this._layer._latlngInfo;\n    this.cut(polygonLayer);\n\n    // clean up snapping states\n    this._cleanupSnapping();\n\n    // remove the first vertex from \"other snapping layers\"\n    this._otherSnapLayers.splice(this._tempSnapLayerIndex, 1);\n    delete this._tempSnapLayerIndex;\n\n    this._editedLayers.forEach(({ layer, originalLayer }) => {\n      // fire pm:cut on the cutted layer\n      this._fireCut(originalLayer, layer, originalLayer);\n\n      // fire pm:cut on the map\n      this._fireCut(this._map, layer, originalLayer);\n\n      // fire edit event after cut\n      originalLayer.pm._fireEdit();\n    });\n    this._editedLayers = [];\n\n    const hintMarkerLatLng = this._hintMarker.getLatLng();\n\n    // disable drawing\n    this.disable();\n    if (this.options.continueDrawing) {\n      this.enable();\n      this._hintMarker.setLatLng(hintMarkerLatLng);\n    }\n  },\n  cut(layer) {\n    const all = this._map._layers;\n    // contains information about snapping points\n    const _latlngInfos = layer._latlngInfos || [];\n\n    // find all layers that intersect with `layer`, the just drawn cutting layer\n    const layers = Object.keys(all)\n      // convert object to array\n      .map((l) => all[l])\n      // only layers handled by leaflet-geoman\n      .filter((l) => l.pm)\n      .filter((l) => !l._pmTempLayer)\n      // filter out everything that ignore leaflet-geoman\n      .filter(\n        (l) =>\n          (!L.PM.optIn && !l.options.pmIgnore) || // if optIn is not set / true and pmIgnore is not set / true (default)\n          (L.PM.optIn && l.options.pmIgnore === false) // if optIn is true and pmIgnore is false);\n      )\n      // only polyline instances\n      .filter((l) => l instanceof L.Polyline)\n      // exclude the drawn one\n      .filter((l) => l !== layer)\n      // layer is allowed to cut\n      .filter((l) => l.pm.options.allowCutting)\n      // filter out everything that ignore leaflet-geoman\n      .filter((l) => {\n        // TODO: after cutting nothing else can be cutted anymore until a new list is passed, because the layers don't exists anymore. Should we remove the cutted layers from the list?\n        if (\n          this.options.layersToCut &&\n          L.Util.isArray(this.options.layersToCut) &&\n          this.options.layersToCut.length > 0\n        ) {\n          return this.options.layersToCut.indexOf(l) > -1;\n        }\n        return true;\n      })\n      // filter out everything that ignore leaflet-geoman\n      .filter((l) => !this._layerGroup.hasLayer(l))\n      // only layers with intersections\n      .filter((l) => {\n        try {\n          const lineInter =\n            !!lineIntersect(layer.toGeoJSON(15), l.toGeoJSON(15)).features\n              .length > 0;\n\n          if (\n            lineInter ||\n            (l instanceof L.Polyline && !(l instanceof L.Polygon))\n          ) {\n            return lineInter;\n          }\n          return !!intersect(layer.toGeoJSON(15), l.toGeoJSON(15));\n        } catch (e) {\n          if (l instanceof L.Polygon) {\n            console.error(\"You can't cut polygons with self-intersections\");\n          }\n          return false;\n        }\n      });\n\n    // loop through all layers that intersect with the drawn (cutting) layer\n    layers.forEach((l) => {\n      let newLayer;\n      if (l instanceof L.Polygon) {\n        // Also for L.Rectangle\n        // easiest way to clone the complete latlngs without reference\n        newLayer = L.polygon(l.getLatLngs());\n        const coords = newLayer.getLatLngs();\n\n        // snapping points added to the layer, so borders are cutted correct\n        _latlngInfos.forEach((info) => {\n          if (info && info.snapInfo) {\n            const { latlng } = info;\n            // get closest layer ( == input layer) with the closest segment to the intersection point\n            const closest = this._calcClosestLayer(latlng, [newLayer]);\n            if (\n              closest &&\n              closest.segment &&\n              closest.distance < this.options.snapDistance\n            ) {\n              const { segment } = closest;\n              if (segment && segment.length === 2) {\n                const { indexPath, parentPath, newIndex } =\n                  L.PM.Utils._getIndexFromSegment(coords, segment);\n                // define the coordsRing that is edited\n                const coordsRing =\n                  indexPath.length > 1 ? get(coords, parentPath) : coords;\n                coordsRing.splice(newIndex, 0, latlng);\n              }\n            }\n          }\n        });\n      } else {\n        // L.Polyline\n        newLayer = l;\n      }\n\n      // find layer difference\n      const diff = this._cutLayer(layer, newLayer);\n\n      // the resulting layer after the cut\n      let resultLayer = L.geoJSON(diff, l.options);\n      if (resultLayer.getLayers().length === 1) {\n        [resultLayer] = resultLayer.getLayers(); // prevent that a unnecessary layergroup is created\n      }\n      this._setPane(resultLayer, 'layerPane');\n      const resultingLayer = resultLayer.addTo(\n        this._map.pm._getContainingLayer()\n      );\n      // give the new layer the original options\n      resultingLayer.pm.enable(l.pm.options);\n      resultingLayer.pm.disable();\n\n      // add templayer prop so pm:remove isn't fired\n      l._pmTempLayer = true;\n      layer._pmTempLayer = true;\n\n      // remove old layer and cutting layer\n      l.remove();\n      l.removeFrom(this._map.pm._getContainingLayer());\n      layer.remove();\n      layer.removeFrom(this._map.pm._getContainingLayer());\n\n      // Remove it only if it is a layergroup. It can be only not a layergroup if a layer exists\n      if (resultingLayer.getLayers && resultingLayer.getLayers().length === 0) {\n        this._map.pm.removeLayer({ target: resultingLayer });\n      }\n\n      if (resultingLayer instanceof L.LayerGroup) {\n        resultingLayer.eachLayer((_layer) => {\n          this._addDrawnLayerProp(_layer);\n        });\n        this._addDrawnLayerProp(resultingLayer);\n      } else {\n        this._addDrawnLayerProp(resultingLayer);\n      }\n\n      if (\n        this.options.layersToCut &&\n        L.Util.isArray(this.options.layersToCut) &&\n        this.options.layersToCut.length > 0\n      ) {\n        const idx = this.options.layersToCut.indexOf(l);\n        if (idx > -1) {\n          this.options.layersToCut.splice(idx, 1);\n        }\n      }\n\n      this._editedLayers.push({\n        layer: resultingLayer,\n        originalLayer: l,\n      });\n    });\n  },\n  _cutLayer(layer, l) {\n    const fg = L.geoJSON();\n    let diff;\n    // cut\n    if (l instanceof L.Polygon) {\n      // find layer difference\n      diff = difference(l.toGeoJSON(15), layer.toGeoJSON(15));\n    } else {\n      const features = flattenPolyline(l);\n\n      features.forEach((feature) => {\n        // get splitted line to look which line part is coverd by the cut polygon\n        const lineDiff = lineSplit(feature, layer.toGeoJSON(15));\n\n        let group;\n        if (lineDiff && lineDiff.features.length > 0) {\n          group = L.geoJSON(lineDiff);\n        } else {\n          group = L.geoJSON(feature);\n        }\n\n        group.getLayers().forEach((lay) => {\n          // add only parts to the map, they are not covered by the cut polygon\n          if (!booleanContains(layer.toGeoJSON(15), lay.toGeoJSON(15))) {\n            lay.addTo(fg);\n          }\n        });\n      });\n\n      if (features.length > 1) {\n        diff = groupToMultiLineString(fg);\n      } else {\n        diff = fg.toGeoJSON(15);\n      }\n    }\n    return diff;\n  },\n  _change: L.Util.falseFn,\n});\n", "/*\r\n *      bignumber.js v9.3.1\r\n *      A JavaScript library for arbitrary-precision arithmetic.\r\n *      https://github.com/MikeMcl/bignumber.js\r\n *      Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>\r\n *      MIT Licensed.\r\n *\r\n *      BigNumber.prototype methods     |  BigNumber methods\r\n *                                      |\r\n *      absoluteValue            abs    |  clone\r\n *      comparedTo                      |  config               set\r\n *      decimalPlaces            dp     |      DECIMAL_PLACES\r\n *      dividedBy                div    |      ROUNDING_MODE\r\n *      dividedToIntegerBy       idiv   |      EXPONENTIAL_AT\r\n *      exponentiatedBy          pow    |      RANGE\r\n *      integerValue                    |      CRYPTO\r\n *      isEqualTo                eq     |      MODULO_MODE\r\n *      isFinite                        |      POW_PRECISION\r\n *      isGreaterThan            gt     |      FORMAT\r\n *      isGreaterThanOrEqualTo   gte    |      ALPHABET\r\n *      isInteger                       |  isBigNumber\r\n *      isLessThan               lt     |  maximum              max\r\n *      isLessThanOrEqualTo      lte    |  minimum              min\r\n *      isNaN                           |  random\r\n *      isNegative                      |  sum\r\n *      isPositive                      |\r\n *      isZero                          |\r\n *      minus                           |\r\n *      modulo                   mod    |\r\n *      multipliedBy             times  |\r\n *      negated                         |\r\n *      plus                            |\r\n *      precision                sd     |\r\n *      shiftedBy                       |\r\n *      squareRoot               sqrt   |\r\n *      toExponential                   |\r\n *      toFixed                         |\r\n *      toFormat                        |\r\n *      toFraction                      |\r\n *      toJSON                          |\r\n *      toNumber                        |\r\n *      toPrecision                     |\r\n *      toString                        |\r\n *      valueOf                         |\r\n *\r\n */\r\n\r\n\r\nvar\r\n  isNumeric = /^-?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:e[+-]?\\d+)?$/i,\r\n  mathceil = Math.ceil,\r\n  mathfloor = Math.floor,\r\n\r\n  bignumberError = '[BigNumber Error] ',\r\n  tooManyDigits = bignumberError + 'Number primitive has more than 15 significant digits: ',\r\n\r\n  BASE = 1e14,\r\n  LOG_BASE = 14,\r\n  MAX_SAFE_INTEGER = 0x1fffffffffffff,         // 2^53 - 1\r\n  // MAX_INT32 = 0x7fffffff,                   // 2^31 - 1\r\n  POWS_TEN = [1, 10, 100, 1e3, 1e4, 1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11, 1e12, 1e13],\r\n  SQRT_BASE = 1e7,\r\n\r\n  // EDITABLE\r\n  // The limit on the value of DECIMAL_PLACES, TO_EXP_NEG, TO_EXP_POS, MIN_EXP, MAX_EXP, and\r\n  // the arguments to toExponential, toFixed, toFormat, and toPrecision.\r\n  MAX = 1E9;                                   // 0 to MAX_INT32\r\n\r\n\r\n/*\r\n * Create and return a BigNumber constructor.\r\n */\r\nfunction clone(configObject) {\r\n  var div, convertBase, parseNumeric,\r\n    P = BigNumber.prototype = { constructor: BigNumber, toString: null, valueOf: null },\r\n    ONE = new BigNumber(1),\r\n\r\n\r\n    //----------------------------- EDITABLE CONFIG DEFAULTS -------------------------------\r\n\r\n\r\n    // The default values below must be integers within the inclusive ranges stated.\r\n    // The values can also be changed at run-time using BigNumber.set.\r\n\r\n    // The maximum number of decimal places for operations involving division.\r\n    DECIMAL_PLACES = 20,                     // 0 to MAX\r\n\r\n    // The rounding mode used when rounding to the above decimal places, and when using\r\n    // toExponential, toFixed, toFormat and toPrecision, and round (default value).\r\n    // UP         0 Away from zero.\r\n    // DOWN       1 Towards zero.\r\n    // CEIL       2 Towards +Infinity.\r\n    // FLOOR      3 Towards -Infinity.\r\n    // HALF_UP    4 Towards nearest neighbour. If equidistant, up.\r\n    // HALF_DOWN  5 Towards nearest neighbour. If equidistant, down.\r\n    // HALF_EVEN  6 Towards nearest neighbour. If equidistant, towards even neighbour.\r\n    // HALF_CEIL  7 Towards nearest neighbour. If equidistant, towards +Infinity.\r\n    // HALF_FLOOR 8 Towards nearest neighbour. If equidistant, towards -Infinity.\r\n    ROUNDING_MODE = 4,                       // 0 to 8\r\n\r\n    // EXPONENTIAL_AT : [TO_EXP_NEG , TO_EXP_POS]\r\n\r\n    // The exponent value at and beneath which toString returns exponential notation.\r\n    // Number type: -7\r\n    TO_EXP_NEG = -7,                         // 0 to -MAX\r\n\r\n    // The exponent value at and above which toString returns exponential notation.\r\n    // Number type: 21\r\n    TO_EXP_POS = 21,                         // 0 to MAX\r\n\r\n    // RANGE : [MIN_EXP, MAX_EXP]\r\n\r\n    // The minimum exponent value, beneath which underflow to zero occurs.\r\n    // Number type: -324  (5e-324)\r\n    MIN_EXP = -1e7,                          // -1 to -MAX\r\n\r\n    // The maximum exponent value, above which overflow to Infinity occurs.\r\n    // Number type:  308  (1.7976931348623157e+308)\r\n    // For MAX_EXP > 1e7, e.g. new BigNumber('1e100000000').plus(1) may be slow.\r\n    MAX_EXP = 1e7,                           // 1 to MAX\r\n\r\n    // Whether to use cryptographically-secure random number generation, if available.\r\n    CRYPTO = false,                          // true or false\r\n\r\n    // The modulo mode used when calculating the modulus: a mod n.\r\n    // The quotient (q = a / n) is calculated according to the corresponding rounding mode.\r\n    // The remainder (r) is calculated as: r = a - n * q.\r\n    //\r\n    // UP        0 The remainder is positive if the dividend is negative, else is negative.\r\n    // DOWN      1 The remainder has the same sign as the dividend.\r\n    //             This modulo mode is commonly known as 'truncated division' and is\r\n    //             equivalent to (a % n) in JavaScript.\r\n    // FLOOR     3 The remainder has the same sign as the divisor (Python %).\r\n    // HALF_EVEN 6 This modulo mode implements the IEEE 754 remainder function.\r\n    // EUCLID    9 Euclidian division. q = sign(n) * floor(a / abs(n)).\r\n    //             The remainder is always positive.\r\n    //\r\n    // The truncated division, floored division, Euclidian division and IEEE 754 remainder\r\n    // modes are commonly used for the modulus operation.\r\n    // Although the other rounding modes can also be used, they may not give useful results.\r\n    MODULO_MODE = 1,                         // 0 to 9\r\n\r\n    // The maximum number of significant digits of the result of the exponentiatedBy operation.\r\n    // If POW_PRECISION is 0, there will be unlimited significant digits.\r\n    POW_PRECISION = 0,                       // 0 to MAX\r\n\r\n    // The format specification used by the BigNumber.prototype.toFormat method.\r\n    FORMAT = {\r\n      prefix: '',\r\n      groupSize: 3,\r\n      secondaryGroupSize: 0,\r\n      groupSeparator: ',',\r\n      decimalSeparator: '.',\r\n      fractionGroupSize: 0,\r\n      fractionGroupSeparator: '\\xA0',        // non-breaking space\r\n      suffix: ''\r\n    },\r\n\r\n    // The alphabet used for base conversion. It must be at least 2 characters long, with no '+',\r\n    // '-', '.', whitespace, or repeated character.\r\n    // '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_'\r\n    ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyz',\r\n    alphabetHasNormalDecimalDigits = true;\r\n\r\n\r\n  //------------------------------------------------------------------------------------------\r\n\r\n\r\n  // CONSTRUCTOR\r\n\r\n\r\n  /*\r\n   * The BigNumber constructor and exported function.\r\n   * Create and return a new instance of a BigNumber object.\r\n   *\r\n   * v {number|string|BigNumber} A numeric value.\r\n   * [b] {number} The base of v. Integer, 2 to ALPHABET.length inclusive.\r\n   */\r\n  function BigNumber(v, b) {\r\n    var alphabet, c, caseChanged, e, i, isNum, len, str,\r\n      x = this;\r\n\r\n    // Enable constructor call without `new`.\r\n    if (!(x instanceof BigNumber)) return new BigNumber(v, b);\r\n\r\n    if (b == null) {\r\n\r\n      if (v && v._isBigNumber === true) {\r\n        x.s = v.s;\r\n\r\n        if (!v.c || v.e > MAX_EXP) {\r\n          x.c = x.e = null;\r\n        } else if (v.e < MIN_EXP) {\r\n          x.c = [x.e = 0];\r\n        } else {\r\n          x.e = v.e;\r\n          x.c = v.c.slice();\r\n        }\r\n\r\n        return;\r\n      }\r\n\r\n      if ((isNum = typeof v == 'number') && v * 0 == 0) {\r\n\r\n        // Use `1 / n` to handle minus zero also.\r\n        x.s = 1 / v < 0 ? (v = -v, -1) : 1;\r\n\r\n        // Fast path for integers, where n < 2147483648 (2**31).\r\n        if (v === ~~v) {\r\n          for (e = 0, i = v; i >= 10; i /= 10, e++);\r\n\r\n          if (e > MAX_EXP) {\r\n            x.c = x.e = null;\r\n          } else {\r\n            x.e = e;\r\n            x.c = [v];\r\n          }\r\n\r\n          return;\r\n        }\r\n\r\n        str = String(v);\r\n      } else {\r\n\r\n        if (!isNumeric.test(str = String(v))) return parseNumeric(x, str, isNum);\r\n\r\n        x.s = str.charCodeAt(0) == 45 ? (str = str.slice(1), -1) : 1;\r\n      }\r\n\r\n      // Decimal point?\r\n      if ((e = str.indexOf('.')) > -1) str = str.replace('.', '');\r\n\r\n      // Exponential form?\r\n      if ((i = str.search(/e/i)) > 0) {\r\n\r\n        // Determine exponent.\r\n        if (e < 0) e = i;\r\n        e += +str.slice(i + 1);\r\n        str = str.substring(0, i);\r\n      } else if (e < 0) {\r\n\r\n        // Integer.\r\n        e = str.length;\r\n      }\r\n\r\n    } else {\r\n\r\n      // '[BigNumber Error] Base {not a primitive number|not an integer|out of range}: {b}'\r\n      intCheck(b, 2, ALPHABET.length, 'Base');\r\n\r\n      // Allow exponential notation to be used with base 10 argument, while\r\n      // also rounding to DECIMAL_PLACES as with other bases.\r\n      if (b == 10 && alphabetHasNormalDecimalDigits) {\r\n        x = new BigNumber(v);\r\n        return round(x, DECIMAL_PLACES + x.e + 1, ROUNDING_MODE);\r\n      }\r\n\r\n      str = String(v);\r\n\r\n      if (isNum = typeof v == 'number') {\r\n\r\n        // Avoid potential interpretation of Infinity and NaN as base 44+ values.\r\n        if (v * 0 != 0) return parseNumeric(x, str, isNum, b);\r\n\r\n        x.s = 1 / v < 0 ? (str = str.slice(1), -1) : 1;\r\n\r\n        // '[BigNumber Error] Number primitive has more than 15 significant digits: {n}'\r\n        if (BigNumber.DEBUG && str.replace(/^0\\.0*|\\./, '').length > 15) {\r\n          throw Error\r\n           (tooManyDigits + v);\r\n        }\r\n      } else {\r\n        x.s = str.charCodeAt(0) === 45 ? (str = str.slice(1), -1) : 1;\r\n      }\r\n\r\n      alphabet = ALPHABET.slice(0, b);\r\n      e = i = 0;\r\n\r\n      // Check that str is a valid base b number.\r\n      // Don't use RegExp, so alphabet can contain special characters.\r\n      for (len = str.length; i < len; i++) {\r\n        if (alphabet.indexOf(c = str.charAt(i)) < 0) {\r\n          if (c == '.') {\r\n\r\n            // If '.' is not the first character and it has not be found before.\r\n            if (i > e) {\r\n              e = len;\r\n              continue;\r\n            }\r\n          } else if (!caseChanged) {\r\n\r\n            // Allow e.g. hexadecimal 'FF' as well as 'ff'.\r\n            if (str == str.toUpperCase() && (str = str.toLowerCase()) ||\r\n                str == str.toLowerCase() && (str = str.toUpperCase())) {\r\n              caseChanged = true;\r\n              i = -1;\r\n              e = 0;\r\n              continue;\r\n            }\r\n          }\r\n\r\n          return parseNumeric(x, String(v), isNum, b);\r\n        }\r\n      }\r\n\r\n      // Prevent later check for length on converted number.\r\n      isNum = false;\r\n      str = convertBase(str, b, 10, x.s);\r\n\r\n      // Decimal point?\r\n      if ((e = str.indexOf('.')) > -1) str = str.replace('.', '');\r\n      else e = str.length;\r\n    }\r\n\r\n    // Determine leading zeros.\r\n    for (i = 0; str.charCodeAt(i) === 48; i++);\r\n\r\n    // Determine trailing zeros.\r\n    for (len = str.length; str.charCodeAt(--len) === 48;);\r\n\r\n    if (str = str.slice(i, ++len)) {\r\n      len -= i;\r\n\r\n      // '[BigNumber Error] Number primitive has more than 15 significant digits: {n}'\r\n      if (isNum && BigNumber.DEBUG &&\r\n        len > 15 && (v > MAX_SAFE_INTEGER || v !== mathfloor(v))) {\r\n          throw Error\r\n           (tooManyDigits + (x.s * v));\r\n      }\r\n\r\n       // Overflow?\r\n      if ((e = e - i - 1) > MAX_EXP) {\r\n\r\n        // Infinity.\r\n        x.c = x.e = null;\r\n\r\n      // Underflow?\r\n      } else if (e < MIN_EXP) {\r\n\r\n        // Zero.\r\n        x.c = [x.e = 0];\r\n      } else {\r\n        x.e = e;\r\n        x.c = [];\r\n\r\n        // Transform base\r\n\r\n        // e is the base 10 exponent.\r\n        // i is where to slice str to get the first element of the coefficient array.\r\n        i = (e + 1) % LOG_BASE;\r\n        if (e < 0) i += LOG_BASE;  // i < 1\r\n\r\n        if (i < len) {\r\n          if (i) x.c.push(+str.slice(0, i));\r\n\r\n          for (len -= LOG_BASE; i < len;) {\r\n            x.c.push(+str.slice(i, i += LOG_BASE));\r\n          }\r\n\r\n          i = LOG_BASE - (str = str.slice(i)).length;\r\n        } else {\r\n          i -= len;\r\n        }\r\n\r\n        for (; i--; str += '0');\r\n        x.c.push(+str);\r\n      }\r\n    } else {\r\n\r\n      // Zero.\r\n      x.c = [x.e = 0];\r\n    }\r\n  }\r\n\r\n\r\n  // CONSTRUCTOR PROPERTIES\r\n\r\n\r\n  BigNumber.clone = clone;\r\n\r\n  BigNumber.ROUND_UP = 0;\r\n  BigNumber.ROUND_DOWN = 1;\r\n  BigNumber.ROUND_CEIL = 2;\r\n  BigNumber.ROUND_FLOOR = 3;\r\n  BigNumber.ROUND_HALF_UP = 4;\r\n  BigNumber.ROUND_HALF_DOWN = 5;\r\n  BigNumber.ROUND_HALF_EVEN = 6;\r\n  BigNumber.ROUND_HALF_CEIL = 7;\r\n  BigNumber.ROUND_HALF_FLOOR = 8;\r\n  BigNumber.EUCLID = 9;\r\n\r\n\r\n  /*\r\n   * Configure infrequently-changing library-wide settings.\r\n   *\r\n   * Accept an object with the following optional properties (if the value of a property is\r\n   * a number, it must be an integer within the inclusive range stated):\r\n   *\r\n   *   DECIMAL_PLACES   {number}           0 to MAX\r\n   *   ROUNDING_MODE    {number}           0 to 8\r\n   *   EXPONENTIAL_AT   {number|number[]}  -MAX to MAX  or  [-MAX to 0, 0 to MAX]\r\n   *   RANGE            {number|number[]}  -MAX to MAX (not zero)  or  [-MAX to -1, 1 to MAX]\r\n   *   CRYPTO           {boolean}          true or false\r\n   *   MODULO_MODE      {number}           0 to 9\r\n   *   POW_PRECISION       {number}           0 to MAX\r\n   *   ALPHABET         {string}           A string of two or more unique characters which does\r\n   *                                       not contain '.'.\r\n   *   FORMAT           {object}           An object with some of the following properties:\r\n   *     prefix                 {string}\r\n   *     groupSize              {number}\r\n   *     secondaryGroupSize     {number}\r\n   *     groupSeparator         {string}\r\n   *     decimalSeparator       {string}\r\n   *     fractionGroupSize      {number}\r\n   *     fractionGroupSeparator {string}\r\n   *     suffix                 {string}\r\n   *\r\n   * (The values assigned to the above FORMAT object properties are not checked for validity.)\r\n   *\r\n   * E.g.\r\n   * BigNumber.config({ DECIMAL_PLACES : 20, ROUNDING_MODE : 4 })\r\n   *\r\n   * Ignore properties/parameters set to null or undefined, except for ALPHABET.\r\n   *\r\n   * Return an object with the properties current values.\r\n   */\r\n  BigNumber.config = BigNumber.set = function (obj) {\r\n    var p, v;\r\n\r\n    if (obj != null) {\r\n\r\n      if (typeof obj == 'object') {\r\n\r\n        // DECIMAL_PLACES {number} Integer, 0 to MAX inclusive.\r\n        // '[BigNumber Error] DECIMAL_PLACES {not a primitive number|not an integer|out of range}: {v}'\r\n        if (obj.hasOwnProperty(p = 'DECIMAL_PLACES')) {\r\n          v = obj[p];\r\n          intCheck(v, 0, MAX, p);\r\n          DECIMAL_PLACES = v;\r\n        }\r\n\r\n        // ROUNDING_MODE {number} Integer, 0 to 8 inclusive.\r\n        // '[BigNumber Error] ROUNDING_MODE {not a primitive number|not an integer|out of range}: {v}'\r\n        if (obj.hasOwnProperty(p = 'ROUNDING_MODE')) {\r\n          v = obj[p];\r\n          intCheck(v, 0, 8, p);\r\n          ROUNDING_MODE = v;\r\n        }\r\n\r\n        // EXPONENTIAL_AT {number|number[]}\r\n        // Integer, -MAX to MAX inclusive or\r\n        // [integer -MAX to 0 inclusive, 0 to MAX inclusive].\r\n        // '[BigNumber Error] EXPONENTIAL_AT {not a primitive number|not an integer|out of range}: {v}'\r\n        if (obj.hasOwnProperty(p = 'EXPONENTIAL_AT')) {\r\n          v = obj[p];\r\n          if (v && v.pop) {\r\n            intCheck(v[0], -MAX, 0, p);\r\n            intCheck(v[1], 0, MAX, p);\r\n            TO_EXP_NEG = v[0];\r\n            TO_EXP_POS = v[1];\r\n          } else {\r\n            intCheck(v, -MAX, MAX, p);\r\n            TO_EXP_NEG = -(TO_EXP_POS = v < 0 ? -v : v);\r\n          }\r\n        }\r\n\r\n        // RANGE {number|number[]} Non-zero integer, -MAX to MAX inclusive or\r\n        // [integer -MAX to -1 inclusive, integer 1 to MAX inclusive].\r\n        // '[BigNumber Error] RANGE {not a primitive number|not an integer|out of range|cannot be zero}: {v}'\r\n        if (obj.hasOwnProperty(p = 'RANGE')) {\r\n          v = obj[p];\r\n          if (v && v.pop) {\r\n            intCheck(v[0], -MAX, -1, p);\r\n            intCheck(v[1], 1, MAX, p);\r\n            MIN_EXP = v[0];\r\n            MAX_EXP = v[1];\r\n          } else {\r\n            intCheck(v, -MAX, MAX, p);\r\n            if (v) {\r\n              MIN_EXP = -(MAX_EXP = v < 0 ? -v : v);\r\n            } else {\r\n              throw Error\r\n               (bignumberError + p + ' cannot be zero: ' + v);\r\n            }\r\n          }\r\n        }\r\n\r\n        // CRYPTO {boolean} true or false.\r\n        // '[BigNumber Error] CRYPTO not true or false: {v}'\r\n        // '[BigNumber Error] crypto unavailable'\r\n        if (obj.hasOwnProperty(p = 'CRYPTO')) {\r\n          v = obj[p];\r\n          if (v === !!v) {\r\n            if (v) {\r\n              if (typeof crypto != 'undefined' && crypto &&\r\n               (crypto.getRandomValues || crypto.randomBytes)) {\r\n                CRYPTO = v;\r\n              } else {\r\n                CRYPTO = !v;\r\n                throw Error\r\n                 (bignumberError + 'crypto unavailable');\r\n              }\r\n            } else {\r\n              CRYPTO = v;\r\n            }\r\n          } else {\r\n            throw Error\r\n             (bignumberError + p + ' not true or false: ' + v);\r\n          }\r\n        }\r\n\r\n        // MODULO_MODE {number} Integer, 0 to 9 inclusive.\r\n        // '[BigNumber Error] MODULO_MODE {not a primitive number|not an integer|out of range}: {v}'\r\n        if (obj.hasOwnProperty(p = 'MODULO_MODE')) {\r\n          v = obj[p];\r\n          intCheck(v, 0, 9, p);\r\n          MODULO_MODE = v;\r\n        }\r\n\r\n        // POW_PRECISION {number} Integer, 0 to MAX inclusive.\r\n        // '[BigNumber Error] POW_PRECISION {not a primitive number|not an integer|out of range}: {v}'\r\n        if (obj.hasOwnProperty(p = 'POW_PRECISION')) {\r\n          v = obj[p];\r\n          intCheck(v, 0, MAX, p);\r\n          POW_PRECISION = v;\r\n        }\r\n\r\n        // FORMAT {object}\r\n        // '[BigNumber Error] FORMAT not an object: {v}'\r\n        if (obj.hasOwnProperty(p = 'FORMAT')) {\r\n          v = obj[p];\r\n          if (typeof v == 'object') FORMAT = v;\r\n          else throw Error\r\n           (bignumberError + p + ' not an object: ' + v);\r\n        }\r\n\r\n        // ALPHABET {string}\r\n        // '[BigNumber Error] ALPHABET invalid: {v}'\r\n        if (obj.hasOwnProperty(p = 'ALPHABET')) {\r\n          v = obj[p];\r\n\r\n          // Disallow if less than two characters,\r\n          // or if it contains '+', '-', '.', whitespace, or a repeated character.\r\n          if (typeof v == 'string' && !/^.?$|[+\\-.\\s]|(.).*\\1/.test(v)) {\r\n            alphabetHasNormalDecimalDigits = v.slice(0, 10) == '0123456789';\r\n            ALPHABET = v;\r\n          } else {\r\n            throw Error\r\n             (bignumberError + p + ' invalid: ' + v);\r\n          }\r\n        }\r\n\r\n      } else {\r\n\r\n        // '[BigNumber Error] Object expected: {v}'\r\n        throw Error\r\n         (bignumberError + 'Object expected: ' + obj);\r\n      }\r\n    }\r\n\r\n    return {\r\n      DECIMAL_PLACES: DECIMAL_PLACES,\r\n      ROUNDING_MODE: ROUNDING_MODE,\r\n      EXPONENTIAL_AT: [TO_EXP_NEG, TO_EXP_POS],\r\n      RANGE: [MIN_EXP, MAX_EXP],\r\n      CRYPTO: CRYPTO,\r\n      MODULO_MODE: MODULO_MODE,\r\n      POW_PRECISION: POW_PRECISION,\r\n      FORMAT: FORMAT,\r\n      ALPHABET: ALPHABET\r\n    };\r\n  };\r\n\r\n\r\n  /*\r\n   * Return true if v is a BigNumber instance, otherwise return false.\r\n   *\r\n   * If BigNumber.DEBUG is true, throw if a BigNumber instance is not well-formed.\r\n   *\r\n   * v {any}\r\n   *\r\n   * '[BigNumber Error] Invalid BigNumber: {v}'\r\n   */\r\n  BigNumber.isBigNumber = function (v) {\r\n    if (!v || v._isBigNumber !== true) return false;\r\n    if (!BigNumber.DEBUG) return true;\r\n\r\n    var i, n,\r\n      c = v.c,\r\n      e = v.e,\r\n      s = v.s;\r\n\r\n    out: if ({}.toString.call(c) == '[object Array]') {\r\n\r\n      if ((s === 1 || s === -1) && e >= -MAX && e <= MAX && e === mathfloor(e)) {\r\n\r\n        // If the first element is zero, the BigNumber value must be zero.\r\n        if (c[0] === 0) {\r\n          if (e === 0 && c.length === 1) return true;\r\n          break out;\r\n        }\r\n\r\n        // Calculate number of digits that c[0] should have, based on the exponent.\r\n        i = (e + 1) % LOG_BASE;\r\n        if (i < 1) i += LOG_BASE;\r\n\r\n        // Calculate number of digits of c[0].\r\n        //if (Math.ceil(Math.log(c[0] + 1) / Math.LN10) == i) {\r\n        if (String(c[0]).length == i) {\r\n\r\n          for (i = 0; i < c.length; i++) {\r\n            n = c[i];\r\n            if (n < 0 || n >= BASE || n !== mathfloor(n)) break out;\r\n          }\r\n\r\n          // Last element cannot be zero, unless it is the only element.\r\n          if (n !== 0) return true;\r\n        }\r\n      }\r\n\r\n    // Infinity/NaN\r\n    } else if (c === null && e === null && (s === null || s === 1 || s === -1)) {\r\n      return true;\r\n    }\r\n\r\n    throw Error\r\n      (bignumberError + 'Invalid BigNumber: ' + v);\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a new BigNumber whose value is the maximum of the arguments.\r\n   *\r\n   * arguments {number|string|BigNumber}\r\n   */\r\n  BigNumber.maximum = BigNumber.max = function () {\r\n    return maxOrMin(arguments, -1);\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a new BigNumber whose value is the minimum of the arguments.\r\n   *\r\n   * arguments {number|string|BigNumber}\r\n   */\r\n  BigNumber.minimum = BigNumber.min = function () {\r\n    return maxOrMin(arguments, 1);\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a new BigNumber with a random value equal to or greater than 0 and less than 1,\r\n   * and with dp, or DECIMAL_PLACES if dp is omitted, decimal places (or less if trailing\r\n   * zeros are produced).\r\n   *\r\n   * [dp] {number} Decimal places. Integer, 0 to MAX inclusive.\r\n   *\r\n   * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {dp}'\r\n   * '[BigNumber Error] crypto unavailable'\r\n   */\r\n  BigNumber.random = (function () {\r\n    var pow2_53 = 0x20000000000000;\r\n\r\n    // Return a 53 bit integer n, where 0 <= n < 9007199254740992.\r\n    // Check if Math.random() produces more than 32 bits of randomness.\r\n    // If it does, assume at least 53 bits are produced, otherwise assume at least 30 bits.\r\n    // 0x40000000 is 2^30, 0x800000 is 2^23, 0x1fffff is 2^21 - 1.\r\n    var random53bitInt = (Math.random() * pow2_53) & 0x1fffff\r\n     ? function () { return mathfloor(Math.random() * pow2_53); }\r\n     : function () { return ((Math.random() * 0x40000000 | 0) * 0x800000) +\r\n       (Math.random() * 0x800000 | 0); };\r\n\r\n    return function (dp) {\r\n      var a, b, e, k, v,\r\n        i = 0,\r\n        c = [],\r\n        rand = new BigNumber(ONE);\r\n\r\n      if (dp == null) dp = DECIMAL_PLACES;\r\n      else intCheck(dp, 0, MAX);\r\n\r\n      k = mathceil(dp / LOG_BASE);\r\n\r\n      if (CRYPTO) {\r\n\r\n        // Browsers supporting crypto.getRandomValues.\r\n        if (crypto.getRandomValues) {\r\n\r\n          a = crypto.getRandomValues(new Uint32Array(k *= 2));\r\n\r\n          for (; i < k;) {\r\n\r\n            // 53 bits:\r\n            // ((Math.pow(2, 32) - 1) * Math.pow(2, 21)).toString(2)\r\n            // 11111 11111111 11111111 11111111 11100000 00000000 00000000\r\n            // ((Math.pow(2, 32) - 1) >>> 11).toString(2)\r\n            //                                     11111 11111111 11111111\r\n            // 0x20000 is 2^21.\r\n            v = a[i] * 0x20000 + (a[i + 1] >>> 11);\r\n\r\n            // Rejection sampling:\r\n            // 0 <= v < 9007199254740992\r\n            // Probability that v >= 9e15, is\r\n            // 7199254740992 / 9007199254740992 ~= 0.0008, i.e. 1 in 1251\r\n            if (v >= 9e15) {\r\n              b = crypto.getRandomValues(new Uint32Array(2));\r\n              a[i] = b[0];\r\n              a[i + 1] = b[1];\r\n            } else {\r\n\r\n              // 0 <= v <= 8999999999999999\r\n              // 0 <= (v % 1e14) <= 99999999999999\r\n              c.push(v % 1e14);\r\n              i += 2;\r\n            }\r\n          }\r\n          i = k / 2;\r\n\r\n        // Node.js supporting crypto.randomBytes.\r\n        } else if (crypto.randomBytes) {\r\n\r\n          // buffer\r\n          a = crypto.randomBytes(k *= 7);\r\n\r\n          for (; i < k;) {\r\n\r\n            // 0x1000000000000 is 2^48, 0x10000000000 is 2^40\r\n            // 0x100000000 is 2^32, 0x1000000 is 2^24\r\n            // 11111 11111111 11111111 11111111 11111111 11111111 11111111\r\n            // 0 <= v < 9007199254740992\r\n            v = ((a[i] & 31) * 0x1000000000000) + (a[i + 1] * 0x10000000000) +\r\n               (a[i + 2] * 0x100000000) + (a[i + 3] * 0x1000000) +\r\n               (a[i + 4] << 16) + (a[i + 5] << 8) + a[i + 6];\r\n\r\n            if (v >= 9e15) {\r\n              crypto.randomBytes(7).copy(a, i);\r\n            } else {\r\n\r\n              // 0 <= (v % 1e14) <= 99999999999999\r\n              c.push(v % 1e14);\r\n              i += 7;\r\n            }\r\n          }\r\n          i = k / 7;\r\n        } else {\r\n          CRYPTO = false;\r\n          throw Error\r\n           (bignumberError + 'crypto unavailable');\r\n        }\r\n      }\r\n\r\n      // Use Math.random.\r\n      if (!CRYPTO) {\r\n\r\n        for (; i < k;) {\r\n          v = random53bitInt();\r\n          if (v < 9e15) c[i++] = v % 1e14;\r\n        }\r\n      }\r\n\r\n      k = c[--i];\r\n      dp %= LOG_BASE;\r\n\r\n      // Convert trailing digits to zeros according to dp.\r\n      if (k && dp) {\r\n        v = POWS_TEN[LOG_BASE - dp];\r\n        c[i] = mathfloor(k / v) * v;\r\n      }\r\n\r\n      // Remove trailing elements which are zero.\r\n      for (; c[i] === 0; c.pop(), i--);\r\n\r\n      // Zero?\r\n      if (i < 0) {\r\n        c = [e = 0];\r\n      } else {\r\n\r\n        // Remove leading elements which are zero and adjust exponent accordingly.\r\n        for (e = -1 ; c[0] === 0; c.splice(0, 1), e -= LOG_BASE);\r\n\r\n        // Count the digits of the first element of c to determine leading zeros, and...\r\n        for (i = 1, v = c[0]; v >= 10; v /= 10, i++);\r\n\r\n        // adjust the exponent accordingly.\r\n        if (i < LOG_BASE) e -= LOG_BASE - i;\r\n      }\r\n\r\n      rand.e = e;\r\n      rand.c = c;\r\n      return rand;\r\n    };\r\n  })();\r\n\r\n\r\n   /*\r\n   * Return a BigNumber whose value is the sum of the arguments.\r\n   *\r\n   * arguments {number|string|BigNumber}\r\n   */\r\n  BigNumber.sum = function () {\r\n    var i = 1,\r\n      args = arguments,\r\n      sum = new BigNumber(args[0]);\r\n    for (; i < args.length;) sum = sum.plus(args[i++]);\r\n    return sum;\r\n  };\r\n\r\n\r\n  // PRIVATE FUNCTIONS\r\n\r\n\r\n  // Called by BigNumber and BigNumber.prototype.toString.\r\n  convertBase = (function () {\r\n    var decimal = '0123456789';\r\n\r\n    /*\r\n     * Convert string of baseIn to an array of numbers of baseOut.\r\n     * Eg. toBaseOut('255', 10, 16) returns [15, 15].\r\n     * Eg. toBaseOut('ff', 16, 10) returns [2, 5, 5].\r\n     */\r\n    function toBaseOut(str, baseIn, baseOut, alphabet) {\r\n      var j,\r\n        arr = [0],\r\n        arrL,\r\n        i = 0,\r\n        len = str.length;\r\n\r\n      for (; i < len;) {\r\n        for (arrL = arr.length; arrL--; arr[arrL] *= baseIn);\r\n\r\n        arr[0] += alphabet.indexOf(str.charAt(i++));\r\n\r\n        for (j = 0; j < arr.length; j++) {\r\n\r\n          if (arr[j] > baseOut - 1) {\r\n            if (arr[j + 1] == null) arr[j + 1] = 0;\r\n            arr[j + 1] += arr[j] / baseOut | 0;\r\n            arr[j] %= baseOut;\r\n          }\r\n        }\r\n      }\r\n\r\n      return arr.reverse();\r\n    }\r\n\r\n    // Convert a numeric string of baseIn to a numeric string of baseOut.\r\n    // If the caller is toString, we are converting from base 10 to baseOut.\r\n    // If the caller is BigNumber, we are converting from baseIn to base 10.\r\n    return function (str, baseIn, baseOut, sign, callerIsToString) {\r\n      var alphabet, d, e, k, r, x, xc, y,\r\n        i = str.indexOf('.'),\r\n        dp = DECIMAL_PLACES,\r\n        rm = ROUNDING_MODE;\r\n\r\n      // Non-integer.\r\n      if (i >= 0) {\r\n        k = POW_PRECISION;\r\n\r\n        // Unlimited precision.\r\n        POW_PRECISION = 0;\r\n        str = str.replace('.', '');\r\n        y = new BigNumber(baseIn);\r\n        x = y.pow(str.length - i);\r\n        POW_PRECISION = k;\r\n\r\n        // Convert str as if an integer, then restore the fraction part by dividing the\r\n        // result by its base raised to a power.\r\n\r\n        y.c = toBaseOut(toFixedPoint(coeffToString(x.c), x.e, '0'),\r\n         10, baseOut, decimal);\r\n        y.e = y.c.length;\r\n      }\r\n\r\n      // Convert the number as integer.\r\n\r\n      xc = toBaseOut(str, baseIn, baseOut, callerIsToString\r\n       ? (alphabet = ALPHABET, decimal)\r\n       : (alphabet = decimal, ALPHABET));\r\n\r\n      // xc now represents str as an integer and converted to baseOut. e is the exponent.\r\n      e = k = xc.length;\r\n\r\n      // Remove trailing zeros.\r\n      for (; xc[--k] == 0; xc.pop());\r\n\r\n      // Zero?\r\n      if (!xc[0]) return alphabet.charAt(0);\r\n\r\n      // Does str represent an integer? If so, no need for the division.\r\n      if (i < 0) {\r\n        --e;\r\n      } else {\r\n        x.c = xc;\r\n        x.e = e;\r\n\r\n        // The sign is needed for correct rounding.\r\n        x.s = sign;\r\n        x = div(x, y, dp, rm, baseOut);\r\n        xc = x.c;\r\n        r = x.r;\r\n        e = x.e;\r\n      }\r\n\r\n      // xc now represents str converted to baseOut.\r\n\r\n      // The index of the rounding digit.\r\n      d = e + dp + 1;\r\n\r\n      // The rounding digit: the digit to the right of the digit that may be rounded up.\r\n      i = xc[d];\r\n\r\n      // Look at the rounding digits and mode to determine whether to round up.\r\n\r\n      k = baseOut / 2;\r\n      r = r || d < 0 || xc[d + 1] != null;\r\n\r\n      r = rm < 4 ? (i != null || r) && (rm == 0 || rm == (x.s < 0 ? 3 : 2))\r\n            : i > k || i == k &&(rm == 4 || r || rm == 6 && xc[d - 1] & 1 ||\r\n             rm == (x.s < 0 ? 8 : 7));\r\n\r\n      // If the index of the rounding digit is not greater than zero, or xc represents\r\n      // zero, then the result of the base conversion is zero or, if rounding up, a value\r\n      // such as 0.00001.\r\n      if (d < 1 || !xc[0]) {\r\n\r\n        // 1^-dp or 0\r\n        str = r ? toFixedPoint(alphabet.charAt(1), -dp, alphabet.charAt(0)) : alphabet.charAt(0);\r\n      } else {\r\n\r\n        // Truncate xc to the required number of decimal places.\r\n        xc.length = d;\r\n\r\n        // Round up?\r\n        if (r) {\r\n\r\n          // Rounding up may mean the previous digit has to be rounded up and so on.\r\n          for (--baseOut; ++xc[--d] > baseOut;) {\r\n            xc[d] = 0;\r\n\r\n            if (!d) {\r\n              ++e;\r\n              xc = [1].concat(xc);\r\n            }\r\n          }\r\n        }\r\n\r\n        // Determine trailing zeros.\r\n        for (k = xc.length; !xc[--k];);\r\n\r\n        // E.g. [4, 11, 15] becomes 4bf.\r\n        for (i = 0, str = ''; i <= k; str += alphabet.charAt(xc[i++]));\r\n\r\n        // Add leading zeros, decimal point and trailing zeros as required.\r\n        str = toFixedPoint(str, e, alphabet.charAt(0));\r\n      }\r\n\r\n      // The caller will add the sign.\r\n      return str;\r\n    };\r\n  })();\r\n\r\n\r\n  // Perform division in the specified base. Called by div and convertBase.\r\n  div = (function () {\r\n\r\n    // Assume non-zero x and k.\r\n    function multiply(x, k, base) {\r\n      var m, temp, xlo, xhi,\r\n        carry = 0,\r\n        i = x.length,\r\n        klo = k % SQRT_BASE,\r\n        khi = k / SQRT_BASE | 0;\r\n\r\n      for (x = x.slice(); i--;) {\r\n        xlo = x[i] % SQRT_BASE;\r\n        xhi = x[i] / SQRT_BASE | 0;\r\n        m = khi * xlo + xhi * klo;\r\n        temp = klo * xlo + ((m % SQRT_BASE) * SQRT_BASE) + carry;\r\n        carry = (temp / base | 0) + (m / SQRT_BASE | 0) + khi * xhi;\r\n        x[i] = temp % base;\r\n      }\r\n\r\n      if (carry) x = [carry].concat(x);\r\n\r\n      return x;\r\n    }\r\n\r\n    function compare(a, b, aL, bL) {\r\n      var i, cmp;\r\n\r\n      if (aL != bL) {\r\n        cmp = aL > bL ? 1 : -1;\r\n      } else {\r\n\r\n        for (i = cmp = 0; i < aL; i++) {\r\n\r\n          if (a[i] != b[i]) {\r\n            cmp = a[i] > b[i] ? 1 : -1;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      return cmp;\r\n    }\r\n\r\n    function subtract(a, b, aL, base) {\r\n      var i = 0;\r\n\r\n      // Subtract b from a.\r\n      for (; aL--;) {\r\n        a[aL] -= i;\r\n        i = a[aL] < b[aL] ? 1 : 0;\r\n        a[aL] = i * base + a[aL] - b[aL];\r\n      }\r\n\r\n      // Remove leading zeros.\r\n      for (; !a[0] && a.length > 1; a.splice(0, 1));\r\n    }\r\n\r\n    // x: dividend, y: divisor.\r\n    return function (x, y, dp, rm, base) {\r\n      var cmp, e, i, more, n, prod, prodL, q, qc, rem, remL, rem0, xi, xL, yc0,\r\n        yL, yz,\r\n        s = x.s == y.s ? 1 : -1,\r\n        xc = x.c,\r\n        yc = y.c;\r\n\r\n      // Either NaN, Infinity or 0?\r\n      if (!xc || !xc[0] || !yc || !yc[0]) {\r\n\r\n        return new BigNumber(\r\n\r\n         // Return NaN if either NaN, or both Infinity or 0.\r\n         !x.s || !y.s || (xc ? yc && xc[0] == yc[0] : !yc) ? NaN :\r\n\r\n          // Return \u00B10 if x is \u00B10 or y is \u00B1Infinity, or return \u00B1Infinity as y is \u00B10.\r\n          xc && xc[0] == 0 || !yc ? s * 0 : s / 0\r\n       );\r\n      }\r\n\r\n      q = new BigNumber(s);\r\n      qc = q.c = [];\r\n      e = x.e - y.e;\r\n      s = dp + e + 1;\r\n\r\n      if (!base) {\r\n        base = BASE;\r\n        e = bitFloor(x.e / LOG_BASE) - bitFloor(y.e / LOG_BASE);\r\n        s = s / LOG_BASE | 0;\r\n      }\r\n\r\n      // Result exponent may be one less then the current value of e.\r\n      // The coefficients of the BigNumbers from convertBase may have trailing zeros.\r\n      for (i = 0; yc[i] == (xc[i] || 0); i++);\r\n\r\n      if (yc[i] > (xc[i] || 0)) e--;\r\n\r\n      if (s < 0) {\r\n        qc.push(1);\r\n        more = true;\r\n      } else {\r\n        xL = xc.length;\r\n        yL = yc.length;\r\n        i = 0;\r\n        s += 2;\r\n\r\n        // Normalise xc and yc so highest order digit of yc is >= base / 2.\r\n\r\n        n = mathfloor(base / (yc[0] + 1));\r\n\r\n        // Not necessary, but to handle odd bases where yc[0] == (base / 2) - 1.\r\n        // if (n > 1 || n++ == 1 && yc[0] < base / 2) {\r\n        if (n > 1) {\r\n          yc = multiply(yc, n, base);\r\n          xc = multiply(xc, n, base);\r\n          yL = yc.length;\r\n          xL = xc.length;\r\n        }\r\n\r\n        xi = yL;\r\n        rem = xc.slice(0, yL);\r\n        remL = rem.length;\r\n\r\n        // Add zeros to make remainder as long as divisor.\r\n        for (; remL < yL; rem[remL++] = 0);\r\n        yz = yc.slice();\r\n        yz = [0].concat(yz);\r\n        yc0 = yc[0];\r\n        if (yc[1] >= base / 2) yc0++;\r\n        // Not necessary, but to prevent trial digit n > base, when using base 3.\r\n        // else if (base == 3 && yc0 == 1) yc0 = 1 + 1e-15;\r\n\r\n        do {\r\n          n = 0;\r\n\r\n          // Compare divisor and remainder.\r\n          cmp = compare(yc, rem, yL, remL);\r\n\r\n          // If divisor < remainder.\r\n          if (cmp < 0) {\r\n\r\n            // Calculate trial digit, n.\r\n\r\n            rem0 = rem[0];\r\n            if (yL != remL) rem0 = rem0 * base + (rem[1] || 0);\r\n\r\n            // n is how many times the divisor goes into the current remainder.\r\n            n = mathfloor(rem0 / yc0);\r\n\r\n            //  Algorithm:\r\n            //  product = divisor multiplied by trial digit (n).\r\n            //  Compare product and remainder.\r\n            //  If product is greater than remainder:\r\n            //    Subtract divisor from product, decrement trial digit.\r\n            //  Subtract product from remainder.\r\n            //  If product was less than remainder at the last compare:\r\n            //    Compare new remainder and divisor.\r\n            //    If remainder is greater than divisor:\r\n            //      Subtract divisor from remainder, increment trial digit.\r\n\r\n            if (n > 1) {\r\n\r\n              // n may be > base only when base is 3.\r\n              if (n >= base) n = base - 1;\r\n\r\n              // product = divisor * trial digit.\r\n              prod = multiply(yc, n, base);\r\n              prodL = prod.length;\r\n              remL = rem.length;\r\n\r\n              // Compare product and remainder.\r\n              // If product > remainder then trial digit n too high.\r\n              // n is 1 too high about 5% of the time, and is not known to have\r\n              // ever been more than 1 too high.\r\n              while (compare(prod, rem, prodL, remL) == 1) {\r\n                n--;\r\n\r\n                // Subtract divisor from product.\r\n                subtract(prod, yL < prodL ? yz : yc, prodL, base);\r\n                prodL = prod.length;\r\n                cmp = 1;\r\n              }\r\n            } else {\r\n\r\n              // n is 0 or 1, cmp is -1.\r\n              // If n is 0, there is no need to compare yc and rem again below,\r\n              // so change cmp to 1 to avoid it.\r\n              // If n is 1, leave cmp as -1, so yc and rem are compared again.\r\n              if (n == 0) {\r\n\r\n                // divisor < remainder, so n must be at least 1.\r\n                cmp = n = 1;\r\n              }\r\n\r\n              // product = divisor\r\n              prod = yc.slice();\r\n              prodL = prod.length;\r\n            }\r\n\r\n            if (prodL < remL) prod = [0].concat(prod);\r\n\r\n            // Subtract product from remainder.\r\n            subtract(rem, prod, remL, base);\r\n            remL = rem.length;\r\n\r\n             // If product was < remainder.\r\n            if (cmp == -1) {\r\n\r\n              // Compare divisor and new remainder.\r\n              // If divisor < new remainder, subtract divisor from remainder.\r\n              // Trial digit n too low.\r\n              // n is 1 too low about 5% of the time, and very rarely 2 too low.\r\n              while (compare(yc, rem, yL, remL) < 1) {\r\n                n++;\r\n\r\n                // Subtract divisor from remainder.\r\n                subtract(rem, yL < remL ? yz : yc, remL, base);\r\n                remL = rem.length;\r\n              }\r\n            }\r\n          } else if (cmp === 0) {\r\n            n++;\r\n            rem = [0];\r\n          } // else cmp === 1 and n will be 0\r\n\r\n          // Add the next digit, n, to the result array.\r\n          qc[i++] = n;\r\n\r\n          // Update the remainder.\r\n          if (rem[0]) {\r\n            rem[remL++] = xc[xi] || 0;\r\n          } else {\r\n            rem = [xc[xi]];\r\n            remL = 1;\r\n          }\r\n        } while ((xi++ < xL || rem[0] != null) && s--);\r\n\r\n        more = rem[0] != null;\r\n\r\n        // Leading zero?\r\n        if (!qc[0]) qc.splice(0, 1);\r\n      }\r\n\r\n      if (base == BASE) {\r\n\r\n        // To calculate q.e, first get the number of digits of qc[0].\r\n        for (i = 1, s = qc[0]; s >= 10; s /= 10, i++);\r\n\r\n        round(q, dp + (q.e = i + e * LOG_BASE - 1) + 1, rm, more);\r\n\r\n      // Caller is convertBase.\r\n      } else {\r\n        q.e = e;\r\n        q.r = +more;\r\n      }\r\n\r\n      return q;\r\n    };\r\n  })();\r\n\r\n\r\n  /*\r\n   * Return a string representing the value of BigNumber n in fixed-point or exponential\r\n   * notation rounded to the specified decimal places or significant digits.\r\n   *\r\n   * n: a BigNumber.\r\n   * i: the index of the last digit required (i.e. the digit that may be rounded up).\r\n   * rm: the rounding mode.\r\n   * id: 1 (toExponential) or 2 (toPrecision).\r\n   */\r\n  function format(n, i, rm, id) {\r\n    var c0, e, ne, len, str;\r\n\r\n    if (rm == null) rm = ROUNDING_MODE;\r\n    else intCheck(rm, 0, 8);\r\n\r\n    if (!n.c) return n.toString();\r\n\r\n    c0 = n.c[0];\r\n    ne = n.e;\r\n\r\n    if (i == null) {\r\n      str = coeffToString(n.c);\r\n      str = id == 1 || id == 2 && (ne <= TO_EXP_NEG || ne >= TO_EXP_POS)\r\n       ? toExponential(str, ne)\r\n       : toFixedPoint(str, ne, '0');\r\n    } else {\r\n      n = round(new BigNumber(n), i, rm);\r\n\r\n      // n.e may have changed if the value was rounded up.\r\n      e = n.e;\r\n\r\n      str = coeffToString(n.c);\r\n      len = str.length;\r\n\r\n      // toPrecision returns exponential notation if the number of significant digits\r\n      // specified is less than the number of digits necessary to represent the integer\r\n      // part of the value in fixed-point notation.\r\n\r\n      // Exponential notation.\r\n      if (id == 1 || id == 2 && (i <= e || e <= TO_EXP_NEG)) {\r\n\r\n        // Append zeros?\r\n        for (; len < i; str += '0', len++);\r\n        str = toExponential(str, e);\r\n\r\n      // Fixed-point notation.\r\n      } else {\r\n        i -= ne + (id === 2 && e > ne);\r\n        str = toFixedPoint(str, e, '0');\r\n\r\n        // Append zeros?\r\n        if (e + 1 > len) {\r\n          if (--i > 0) for (str += '.'; i--; str += '0');\r\n        } else {\r\n          i += e - len;\r\n          if (i > 0) {\r\n            if (e + 1 == len) str += '.';\r\n            for (; i--; str += '0');\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return n.s < 0 && c0 ? '-' + str : str;\r\n  }\r\n\r\n\r\n  // Handle BigNumber.max and BigNumber.min.\r\n  // If any number is NaN, return NaN.\r\n  function maxOrMin(args, n) {\r\n    var k, y,\r\n      i = 1,\r\n      x = new BigNumber(args[0]);\r\n\r\n    for (; i < args.length; i++) {\r\n      y = new BigNumber(args[i]);\r\n      if (!y.s || (k = compare(x, y)) === n || k === 0 && x.s === n) {\r\n        x = y;\r\n      }\r\n    }\r\n\r\n    return x;\r\n  }\r\n\r\n\r\n  /*\r\n   * Strip trailing zeros, calculate base 10 exponent and check against MIN_EXP and MAX_EXP.\r\n   * Called by minus, plus and times.\r\n   */\r\n  function normalise(n, c, e) {\r\n    var i = 1,\r\n      j = c.length;\r\n\r\n     // Remove trailing zeros.\r\n    for (; !c[--j]; c.pop());\r\n\r\n    // Calculate the base 10 exponent. First get the number of digits of c[0].\r\n    for (j = c[0]; j >= 10; j /= 10, i++);\r\n\r\n    // Overflow?\r\n    if ((e = i + e * LOG_BASE - 1) > MAX_EXP) {\r\n\r\n      // Infinity.\r\n      n.c = n.e = null;\r\n\r\n    // Underflow?\r\n    } else if (e < MIN_EXP) {\r\n\r\n      // Zero.\r\n      n.c = [n.e = 0];\r\n    } else {\r\n      n.e = e;\r\n      n.c = c;\r\n    }\r\n\r\n    return n;\r\n  }\r\n\r\n\r\n  // Handle values that fail the validity test in BigNumber.\r\n  parseNumeric = (function () {\r\n    var basePrefix = /^(-?)0([xbo])(?=\\w[\\w.]*$)/i,\r\n      dotAfter = /^([^.]+)\\.$/,\r\n      dotBefore = /^\\.([^.]+)$/,\r\n      isInfinityOrNaN = /^-?(Infinity|NaN)$/,\r\n      whitespaceOrPlus = /^\\s*\\+(?=[\\w.])|^\\s+|\\s+$/g;\r\n\r\n    return function (x, str, isNum, b) {\r\n      var base,\r\n        s = isNum ? str : str.replace(whitespaceOrPlus, '');\r\n\r\n      // No exception on \u00B1Infinity or NaN.\r\n      if (isInfinityOrNaN.test(s)) {\r\n        x.s = isNaN(s) ? null : s < 0 ? -1 : 1;\r\n      } else {\r\n        if (!isNum) {\r\n\r\n          // basePrefix = /^(-?)0([xbo])(?=\\w[\\w.]*$)/i\r\n          s = s.replace(basePrefix, function (m, p1, p2) {\r\n            base = (p2 = p2.toLowerCase()) == 'x' ? 16 : p2 == 'b' ? 2 : 8;\r\n            return !b || b == base ? p1 : m;\r\n          });\r\n\r\n          if (b) {\r\n            base = b;\r\n\r\n            // E.g. '1.' to '1', '.1' to '0.1'\r\n            s = s.replace(dotAfter, '$1').replace(dotBefore, '0.$1');\r\n          }\r\n\r\n          if (str != s) return new BigNumber(s, base);\r\n        }\r\n\r\n        // '[BigNumber Error] Not a number: {n}'\r\n        // '[BigNumber Error] Not a base {b} number: {n}'\r\n        if (BigNumber.DEBUG) {\r\n          throw Error\r\n            (bignumberError + 'Not a' + (b ? ' base ' + b : '') + ' number: ' + str);\r\n        }\r\n\r\n        // NaN\r\n        x.s = null;\r\n      }\r\n\r\n      x.c = x.e = null;\r\n    }\r\n  })();\r\n\r\n\r\n  /*\r\n   * Round x to sd significant digits using rounding mode rm. Check for over/under-flow.\r\n   * If r is truthy, it is known that there are more digits after the rounding digit.\r\n   */\r\n  function round(x, sd, rm, r) {\r\n    var d, i, j, k, n, ni, rd,\r\n      xc = x.c,\r\n      pows10 = POWS_TEN;\r\n\r\n    // if x is not Infinity or NaN...\r\n    if (xc) {\r\n\r\n      // rd is the rounding digit, i.e. the digit after the digit that may be rounded up.\r\n      // n is a base 1e14 number, the value of the element of array x.c containing rd.\r\n      // ni is the index of n within x.c.\r\n      // d is the number of digits of n.\r\n      // i is the index of rd within n including leading zeros.\r\n      // j is the actual index of rd within n (if < 0, rd is a leading zero).\r\n      out: {\r\n\r\n        // Get the number of digits of the first element of xc.\r\n        for (d = 1, k = xc[0]; k >= 10; k /= 10, d++);\r\n        i = sd - d;\r\n\r\n        // If the rounding digit is in the first element of xc...\r\n        if (i < 0) {\r\n          i += LOG_BASE;\r\n          j = sd;\r\n          n = xc[ni = 0];\r\n\r\n          // Get the rounding digit at index j of n.\r\n          rd = mathfloor(n / pows10[d - j - 1] % 10);\r\n        } else {\r\n          ni = mathceil((i + 1) / LOG_BASE);\r\n\r\n          if (ni >= xc.length) {\r\n\r\n            if (r) {\r\n\r\n              // Needed by sqrt.\r\n              for (; xc.length <= ni; xc.push(0));\r\n              n = rd = 0;\r\n              d = 1;\r\n              i %= LOG_BASE;\r\n              j = i - LOG_BASE + 1;\r\n            } else {\r\n              break out;\r\n            }\r\n          } else {\r\n            n = k = xc[ni];\r\n\r\n            // Get the number of digits of n.\r\n            for (d = 1; k >= 10; k /= 10, d++);\r\n\r\n            // Get the index of rd within n.\r\n            i %= LOG_BASE;\r\n\r\n            // Get the index of rd within n, adjusted for leading zeros.\r\n            // The number of leading zeros of n is given by LOG_BASE - d.\r\n            j = i - LOG_BASE + d;\r\n\r\n            // Get the rounding digit at index j of n.\r\n            rd = j < 0 ? 0 : mathfloor(n / pows10[d - j - 1] % 10);\r\n          }\r\n        }\r\n\r\n        r = r || sd < 0 ||\r\n\r\n        // Are there any non-zero digits after the rounding digit?\r\n        // The expression  n % pows10[d - j - 1]  returns all digits of n to the right\r\n        // of the digit at j, e.g. if n is 908714 and j is 2, the expression gives 714.\r\n         xc[ni + 1] != null || (j < 0 ? n : n % pows10[d - j - 1]);\r\n\r\n        r = rm < 4\r\n         ? (rd || r) && (rm == 0 || rm == (x.s < 0 ? 3 : 2))\r\n         : rd > 5 || rd == 5 && (rm == 4 || r || rm == 6 &&\r\n\r\n          // Check whether the digit to the left of the rounding digit is odd.\r\n          ((i > 0 ? j > 0 ? n / pows10[d - j] : 0 : xc[ni - 1]) % 10) & 1 ||\r\n           rm == (x.s < 0 ? 8 : 7));\r\n\r\n        if (sd < 1 || !xc[0]) {\r\n          xc.length = 0;\r\n\r\n          if (r) {\r\n\r\n            // Convert sd to decimal places.\r\n            sd -= x.e + 1;\r\n\r\n            // 1, 0.1, 0.01, 0.001, 0.0001 etc.\r\n            xc[0] = pows10[(LOG_BASE - sd % LOG_BASE) % LOG_BASE];\r\n            x.e = -sd || 0;\r\n          } else {\r\n\r\n            // Zero.\r\n            xc[0] = x.e = 0;\r\n          }\r\n\r\n          return x;\r\n        }\r\n\r\n        // Remove excess digits.\r\n        if (i == 0) {\r\n          xc.length = ni;\r\n          k = 1;\r\n          ni--;\r\n        } else {\r\n          xc.length = ni + 1;\r\n          k = pows10[LOG_BASE - i];\r\n\r\n          // E.g. 56700 becomes 56000 if 7 is the rounding digit.\r\n          // j > 0 means i > number of leading zeros of n.\r\n          xc[ni] = j > 0 ? mathfloor(n / pows10[d - j] % pows10[j]) * k : 0;\r\n        }\r\n\r\n        // Round up?\r\n        if (r) {\r\n\r\n          for (; ;) {\r\n\r\n            // If the digit to be rounded up is in the first element of xc...\r\n            if (ni == 0) {\r\n\r\n              // i will be the length of xc[0] before k is added.\r\n              for (i = 1, j = xc[0]; j >= 10; j /= 10, i++);\r\n              j = xc[0] += k;\r\n              for (k = 1; j >= 10; j /= 10, k++);\r\n\r\n              // if i != k the length has increased.\r\n              if (i != k) {\r\n                x.e++;\r\n                if (xc[0] == BASE) xc[0] = 1;\r\n              }\r\n\r\n              break;\r\n            } else {\r\n              xc[ni] += k;\r\n              if (xc[ni] != BASE) break;\r\n              xc[ni--] = 0;\r\n              k = 1;\r\n            }\r\n          }\r\n        }\r\n\r\n        // Remove trailing zeros.\r\n        for (i = xc.length; xc[--i] === 0; xc.pop());\r\n      }\r\n\r\n      // Overflow? Infinity.\r\n      if (x.e > MAX_EXP) {\r\n        x.c = x.e = null;\r\n\r\n      // Underflow? Zero.\r\n      } else if (x.e < MIN_EXP) {\r\n        x.c = [x.e = 0];\r\n      }\r\n    }\r\n\r\n    return x;\r\n  }\r\n\r\n\r\n  function valueOf(n) {\r\n    var str,\r\n      e = n.e;\r\n\r\n    if (e === null) return n.toString();\r\n\r\n    str = coeffToString(n.c);\r\n\r\n    str = e <= TO_EXP_NEG || e >= TO_EXP_POS\r\n      ? toExponential(str, e)\r\n      : toFixedPoint(str, e, '0');\r\n\r\n    return n.s < 0 ? '-' + str : str;\r\n  }\r\n\r\n\r\n  // PROTOTYPE/INSTANCE METHODS\r\n\r\n\r\n  /*\r\n   * Return a new BigNumber whose value is the absolute value of this BigNumber.\r\n   */\r\n  P.absoluteValue = P.abs = function () {\r\n    var x = new BigNumber(this);\r\n    if (x.s < 0) x.s = 1;\r\n    return x;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return\r\n   *   1 if the value of this BigNumber is greater than the value of BigNumber(y, b),\r\n   *   -1 if the value of this BigNumber is less than the value of BigNumber(y, b),\r\n   *   0 if they have the same value,\r\n   *   or null if the value of either is NaN.\r\n   */\r\n  P.comparedTo = function (y, b) {\r\n    return compare(this, new BigNumber(y, b));\r\n  };\r\n\r\n\r\n  /*\r\n   * If dp is undefined or null or true or false, return the number of decimal places of the\r\n   * value of this BigNumber, or null if the value of this BigNumber is \u00B1Infinity or NaN.\r\n   *\r\n   * Otherwise, if dp is a number, return a new BigNumber whose value is the value of this\r\n   * BigNumber rounded to a maximum of dp decimal places using rounding mode rm, or\r\n   * ROUNDING_MODE if rm is omitted.\r\n   *\r\n   * [dp] {number} Decimal places: integer, 0 to MAX inclusive.\r\n   * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.\r\n   *\r\n   * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {dp|rm}'\r\n   */\r\n  P.decimalPlaces = P.dp = function (dp, rm) {\r\n    var c, n, v,\r\n      x = this;\r\n\r\n    if (dp != null) {\r\n      intCheck(dp, 0, MAX);\r\n      if (rm == null) rm = ROUNDING_MODE;\r\n      else intCheck(rm, 0, 8);\r\n\r\n      return round(new BigNumber(x), dp + x.e + 1, rm);\r\n    }\r\n\r\n    if (!(c = x.c)) return null;\r\n    n = ((v = c.length - 1) - bitFloor(this.e / LOG_BASE)) * LOG_BASE;\r\n\r\n    // Subtract the number of trailing zeros of the last number.\r\n    if (v = c[v]) for (; v % 10 == 0; v /= 10, n--);\r\n    if (n < 0) n = 0;\r\n\r\n    return n;\r\n  };\r\n\r\n\r\n  /*\r\n   *  n / 0 = I\r\n   *  n / N = N\r\n   *  n / I = 0\r\n   *  0 / n = 0\r\n   *  0 / 0 = N\r\n   *  0 / N = N\r\n   *  0 / I = 0\r\n   *  N / n = N\r\n   *  N / 0 = N\r\n   *  N / N = N\r\n   *  N / I = N\r\n   *  I / n = I\r\n   *  I / 0 = I\r\n   *  I / N = N\r\n   *  I / I = N\r\n   *\r\n   * Return a new BigNumber whose value is the value of this BigNumber divided by the value of\r\n   * BigNumber(y, b), rounded according to DECIMAL_PLACES and ROUNDING_MODE.\r\n   */\r\n  P.dividedBy = P.div = function (y, b) {\r\n    return div(this, new BigNumber(y, b), DECIMAL_PLACES, ROUNDING_MODE);\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a new BigNumber whose value is the integer part of dividing the value of this\r\n   * BigNumber by the value of BigNumber(y, b).\r\n   */\r\n  P.dividedToIntegerBy = P.idiv = function (y, b) {\r\n    return div(this, new BigNumber(y, b), 0, 1);\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a BigNumber whose value is the value of this BigNumber exponentiated by n.\r\n   *\r\n   * If m is present, return the result modulo m.\r\n   * If n is negative round according to DECIMAL_PLACES and ROUNDING_MODE.\r\n   * If POW_PRECISION is non-zero and m is not present, round to POW_PRECISION using ROUNDING_MODE.\r\n   *\r\n   * The modular power operation works efficiently when x, n, and m are integers, otherwise it\r\n   * is equivalent to calculating x.exponentiatedBy(n).modulo(m) with a POW_PRECISION of 0.\r\n   *\r\n   * n {number|string|BigNumber} The exponent. An integer.\r\n   * [m] {number|string|BigNumber} The modulus.\r\n   *\r\n   * '[BigNumber Error] Exponent not an integer: {n}'\r\n   */\r\n  P.exponentiatedBy = P.pow = function (n, m) {\r\n    var half, isModExp, i, k, more, nIsBig, nIsNeg, nIsOdd, y,\r\n      x = this;\r\n\r\n    n = new BigNumber(n);\r\n\r\n    // Allow NaN and \u00B1Infinity, but not other non-integers.\r\n    if (n.c && !n.isInteger()) {\r\n      throw Error\r\n        (bignumberError + 'Exponent not an integer: ' + valueOf(n));\r\n    }\r\n\r\n    if (m != null) m = new BigNumber(m);\r\n\r\n    // Exponent of MAX_SAFE_INTEGER is 15.\r\n    nIsBig = n.e > 14;\r\n\r\n    // If x is NaN, \u00B1Infinity, \u00B10 or \u00B11, or n is \u00B1Infinity, NaN or \u00B10.\r\n    if (!x.c || !x.c[0] || x.c[0] == 1 && !x.e && x.c.length == 1 || !n.c || !n.c[0]) {\r\n\r\n      // The sign of the result of pow when x is negative depends on the evenness of n.\r\n      // If +n overflows to \u00B1Infinity, the evenness of n would be not be known.\r\n      y = new BigNumber(Math.pow(+valueOf(x), nIsBig ? n.s * (2 - isOdd(n)) : +valueOf(n)));\r\n      return m ? y.mod(m) : y;\r\n    }\r\n\r\n    nIsNeg = n.s < 0;\r\n\r\n    if (m) {\r\n\r\n      // x % m returns NaN if abs(m) is zero, or m is NaN.\r\n      if (m.c ? !m.c[0] : !m.s) return new BigNumber(NaN);\r\n\r\n      isModExp = !nIsNeg && x.isInteger() && m.isInteger();\r\n\r\n      if (isModExp) x = x.mod(m);\r\n\r\n    // Overflow to \u00B1Infinity: >=2**1e10 or >=1.0000024**1e15.\r\n    // Underflow to \u00B10: <=0.79**1e10 or <=0.9999975**1e15.\r\n    } else if (n.e > 9 && (x.e > 0 || x.e < -1 || (x.e == 0\r\n      // [1, 240000000]\r\n      ? x.c[0] > 1 || nIsBig && x.c[1] >= 24e7\r\n      // [80000000000000]  [99999750000000]\r\n      : x.c[0] < 8e13 || nIsBig && x.c[0] <= 9999975e7))) {\r\n\r\n      // If x is negative and n is odd, k = -0, else k = 0.\r\n      k = x.s < 0 && isOdd(n) ? -0 : 0;\r\n\r\n      // If x >= 1, k = \u00B1Infinity.\r\n      if (x.e > -1) k = 1 / k;\r\n\r\n      // If n is negative return \u00B10, else return \u00B1Infinity.\r\n      return new BigNumber(nIsNeg ? 1 / k : k);\r\n\r\n    } else if (POW_PRECISION) {\r\n\r\n      // Truncating each coefficient array to a length of k after each multiplication\r\n      // equates to truncating significant digits to POW_PRECISION + [28, 41],\r\n      // i.e. there will be a minimum of 28 guard digits retained.\r\n      k = mathceil(POW_PRECISION / LOG_BASE + 2);\r\n    }\r\n\r\n    if (nIsBig) {\r\n      half = new BigNumber(0.5);\r\n      if (nIsNeg) n.s = 1;\r\n      nIsOdd = isOdd(n);\r\n    } else {\r\n      i = Math.abs(+valueOf(n));\r\n      nIsOdd = i % 2;\r\n    }\r\n\r\n    y = new BigNumber(ONE);\r\n\r\n    // Performs 54 loop iterations for n of 9007199254740991.\r\n    for (; ;) {\r\n\r\n      if (nIsOdd) {\r\n        y = y.times(x);\r\n        if (!y.c) break;\r\n\r\n        if (k) {\r\n          if (y.c.length > k) y.c.length = k;\r\n        } else if (isModExp) {\r\n          y = y.mod(m);    //y = y.minus(div(y, m, 0, MODULO_MODE).times(m));\r\n        }\r\n      }\r\n\r\n      if (i) {\r\n        i = mathfloor(i / 2);\r\n        if (i === 0) break;\r\n        nIsOdd = i % 2;\r\n      } else {\r\n        n = n.times(half);\r\n        round(n, n.e + 1, 1);\r\n\r\n        if (n.e > 14) {\r\n          nIsOdd = isOdd(n);\r\n        } else {\r\n          i = +valueOf(n);\r\n          if (i === 0) break;\r\n          nIsOdd = i % 2;\r\n        }\r\n      }\r\n\r\n      x = x.times(x);\r\n\r\n      if (k) {\r\n        if (x.c && x.c.length > k) x.c.length = k;\r\n      } else if (isModExp) {\r\n        x = x.mod(m);    //x = x.minus(div(x, m, 0, MODULO_MODE).times(m));\r\n      }\r\n    }\r\n\r\n    if (isModExp) return y;\r\n    if (nIsNeg) y = ONE.div(y);\r\n\r\n    return m ? y.mod(m) : k ? round(y, POW_PRECISION, ROUNDING_MODE, more) : y;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a new BigNumber whose value is the value of this BigNumber rounded to an integer\r\n   * using rounding mode rm, or ROUNDING_MODE if rm is omitted.\r\n   *\r\n   * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.\r\n   *\r\n   * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {rm}'\r\n   */\r\n  P.integerValue = function (rm) {\r\n    var n = new BigNumber(this);\r\n    if (rm == null) rm = ROUNDING_MODE;\r\n    else intCheck(rm, 0, 8);\r\n    return round(n, n.e + 1, rm);\r\n  };\r\n\r\n\r\n  /*\r\n   * Return true if the value of this BigNumber is equal to the value of BigNumber(y, b),\r\n   * otherwise return false.\r\n   */\r\n  P.isEqualTo = P.eq = function (y, b) {\r\n    return compare(this, new BigNumber(y, b)) === 0;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return true if the value of this BigNumber is a finite number, otherwise return false.\r\n   */\r\n  P.isFinite = function () {\r\n    return !!this.c;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return true if the value of this BigNumber is greater than the value of BigNumber(y, b),\r\n   * otherwise return false.\r\n   */\r\n  P.isGreaterThan = P.gt = function (y, b) {\r\n    return compare(this, new BigNumber(y, b)) > 0;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return true if the value of this BigNumber is greater than or equal to the value of\r\n   * BigNumber(y, b), otherwise return false.\r\n   */\r\n  P.isGreaterThanOrEqualTo = P.gte = function (y, b) {\r\n    return (b = compare(this, new BigNumber(y, b))) === 1 || b === 0;\r\n\r\n  };\r\n\r\n\r\n  /*\r\n   * Return true if the value of this BigNumber is an integer, otherwise return false.\r\n   */\r\n  P.isInteger = function () {\r\n    return !!this.c && bitFloor(this.e / LOG_BASE) > this.c.length - 2;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return true if the value of this BigNumber is less than the value of BigNumber(y, b),\r\n   * otherwise return false.\r\n   */\r\n  P.isLessThan = P.lt = function (y, b) {\r\n    return compare(this, new BigNumber(y, b)) < 0;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return true if the value of this BigNumber is less than or equal to the value of\r\n   * BigNumber(y, b), otherwise return false.\r\n   */\r\n  P.isLessThanOrEqualTo = P.lte = function (y, b) {\r\n    return (b = compare(this, new BigNumber(y, b))) === -1 || b === 0;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return true if the value of this BigNumber is NaN, otherwise return false.\r\n   */\r\n  P.isNaN = function () {\r\n    return !this.s;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return true if the value of this BigNumber is negative, otherwise return false.\r\n   */\r\n  P.isNegative = function () {\r\n    return this.s < 0;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return true if the value of this BigNumber is positive, otherwise return false.\r\n   */\r\n  P.isPositive = function () {\r\n    return this.s > 0;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return true if the value of this BigNumber is 0 or -0, otherwise return false.\r\n   */\r\n  P.isZero = function () {\r\n    return !!this.c && this.c[0] == 0;\r\n  };\r\n\r\n\r\n  /*\r\n   *  n - 0 = n\r\n   *  n - N = N\r\n   *  n - I = -I\r\n   *  0 - n = -n\r\n   *  0 - 0 = 0\r\n   *  0 - N = N\r\n   *  0 - I = -I\r\n   *  N - n = N\r\n   *  N - 0 = N\r\n   *  N - N = N\r\n   *  N - I = N\r\n   *  I - n = I\r\n   *  I - 0 = I\r\n   *  I - N = N\r\n   *  I - I = N\r\n   *\r\n   * Return a new BigNumber whose value is the value of this BigNumber minus the value of\r\n   * BigNumber(y, b).\r\n   */\r\n  P.minus = function (y, b) {\r\n    var i, j, t, xLTy,\r\n      x = this,\r\n      a = x.s;\r\n\r\n    y = new BigNumber(y, b);\r\n    b = y.s;\r\n\r\n    // Either NaN?\r\n    if (!a || !b) return new BigNumber(NaN);\r\n\r\n    // Signs differ?\r\n    if (a != b) {\r\n      y.s = -b;\r\n      return x.plus(y);\r\n    }\r\n\r\n    var xe = x.e / LOG_BASE,\r\n      ye = y.e / LOG_BASE,\r\n      xc = x.c,\r\n      yc = y.c;\r\n\r\n    if (!xe || !ye) {\r\n\r\n      // Either Infinity?\r\n      if (!xc || !yc) return xc ? (y.s = -b, y) : new BigNumber(yc ? x : NaN);\r\n\r\n      // Either zero?\r\n      if (!xc[0] || !yc[0]) {\r\n\r\n        // Return y if y is non-zero, x if x is non-zero, or zero if both are zero.\r\n        return yc[0] ? (y.s = -b, y) : new BigNumber(xc[0] ? x :\r\n\r\n         // IEEE 754 (2008) 6.3: n - n = -0 when rounding to -Infinity\r\n         ROUNDING_MODE == 3 ? -0 : 0);\r\n      }\r\n    }\r\n\r\n    xe = bitFloor(xe);\r\n    ye = bitFloor(ye);\r\n    xc = xc.slice();\r\n\r\n    // Determine which is the bigger number.\r\n    if (a = xe - ye) {\r\n\r\n      if (xLTy = a < 0) {\r\n        a = -a;\r\n        t = xc;\r\n      } else {\r\n        ye = xe;\r\n        t = yc;\r\n      }\r\n\r\n      t.reverse();\r\n\r\n      // Prepend zeros to equalise exponents.\r\n      for (b = a; b--; t.push(0));\r\n      t.reverse();\r\n    } else {\r\n\r\n      // Exponents equal. Check digit by digit.\r\n      j = (xLTy = (a = xc.length) < (b = yc.length)) ? a : b;\r\n\r\n      for (a = b = 0; b < j; b++) {\r\n\r\n        if (xc[b] != yc[b]) {\r\n          xLTy = xc[b] < yc[b];\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // x < y? Point xc to the array of the bigger number.\r\n    if (xLTy) {\r\n      t = xc;\r\n      xc = yc;\r\n      yc = t;\r\n      y.s = -y.s;\r\n    }\r\n\r\n    b = (j = yc.length) - (i = xc.length);\r\n\r\n    // Append zeros to xc if shorter.\r\n    // No need to add zeros to yc if shorter as subtract only needs to start at yc.length.\r\n    if (b > 0) for (; b--; xc[i++] = 0);\r\n    b = BASE - 1;\r\n\r\n    // Subtract yc from xc.\r\n    for (; j > a;) {\r\n\r\n      if (xc[--j] < yc[j]) {\r\n        for (i = j; i && !xc[--i]; xc[i] = b);\r\n        --xc[i];\r\n        xc[j] += BASE;\r\n      }\r\n\r\n      xc[j] -= yc[j];\r\n    }\r\n\r\n    // Remove leading zeros and adjust exponent accordingly.\r\n    for (; xc[0] == 0; xc.splice(0, 1), --ye);\r\n\r\n    // Zero?\r\n    if (!xc[0]) {\r\n\r\n      // Following IEEE 754 (2008) 6.3,\r\n      // n - n = +0  but  n - n = -0  when rounding towards -Infinity.\r\n      y.s = ROUNDING_MODE == 3 ? -1 : 1;\r\n      y.c = [y.e = 0];\r\n      return y;\r\n    }\r\n\r\n    // No need to check for Infinity as +x - +y != Infinity && -x - -y != Infinity\r\n    // for finite x and y.\r\n    return normalise(y, xc, ye);\r\n  };\r\n\r\n\r\n  /*\r\n   *   n % 0 =  N\r\n   *   n % N =  N\r\n   *   n % I =  n\r\n   *   0 % n =  0\r\n   *  -0 % n = -0\r\n   *   0 % 0 =  N\r\n   *   0 % N =  N\r\n   *   0 % I =  0\r\n   *   N % n =  N\r\n   *   N % 0 =  N\r\n   *   N % N =  N\r\n   *   N % I =  N\r\n   *   I % n =  N\r\n   *   I % 0 =  N\r\n   *   I % N =  N\r\n   *   I % I =  N\r\n   *\r\n   * Return a new BigNumber whose value is the value of this BigNumber modulo the value of\r\n   * BigNumber(y, b). The result depends on the value of MODULO_MODE.\r\n   */\r\n  P.modulo = P.mod = function (y, b) {\r\n    var q, s,\r\n      x = this;\r\n\r\n    y = new BigNumber(y, b);\r\n\r\n    // Return NaN if x is Infinity or NaN, or y is NaN or zero.\r\n    if (!x.c || !y.s || y.c && !y.c[0]) {\r\n      return new BigNumber(NaN);\r\n\r\n    // Return x if y is Infinity or x is zero.\r\n    } else if (!y.c || x.c && !x.c[0]) {\r\n      return new BigNumber(x);\r\n    }\r\n\r\n    if (MODULO_MODE == 9) {\r\n\r\n      // Euclidian division: q = sign(y) * floor(x / abs(y))\r\n      // r = x - qy    where  0 <= r < abs(y)\r\n      s = y.s;\r\n      y.s = 1;\r\n      q = div(x, y, 0, 3);\r\n      y.s = s;\r\n      q.s *= s;\r\n    } else {\r\n      q = div(x, y, 0, MODULO_MODE);\r\n    }\r\n\r\n    y = x.minus(q.times(y));\r\n\r\n    // To match JavaScript %, ensure sign of zero is sign of dividend.\r\n    if (!y.c[0] && MODULO_MODE == 1) y.s = x.s;\r\n\r\n    return y;\r\n  };\r\n\r\n\r\n  /*\r\n   *  n * 0 = 0\r\n   *  n * N = N\r\n   *  n * I = I\r\n   *  0 * n = 0\r\n   *  0 * 0 = 0\r\n   *  0 * N = N\r\n   *  0 * I = N\r\n   *  N * n = N\r\n   *  N * 0 = N\r\n   *  N * N = N\r\n   *  N * I = N\r\n   *  I * n = I\r\n   *  I * 0 = N\r\n   *  I * N = N\r\n   *  I * I = I\r\n   *\r\n   * Return a new BigNumber whose value is the value of this BigNumber multiplied by the value\r\n   * of BigNumber(y, b).\r\n   */\r\n  P.multipliedBy = P.times = function (y, b) {\r\n    var c, e, i, j, k, m, xcL, xlo, xhi, ycL, ylo, yhi, zc,\r\n      base, sqrtBase,\r\n      x = this,\r\n      xc = x.c,\r\n      yc = (y = new BigNumber(y, b)).c;\r\n\r\n    // Either NaN, \u00B1Infinity or \u00B10?\r\n    if (!xc || !yc || !xc[0] || !yc[0]) {\r\n\r\n      // Return NaN if either is NaN, or one is 0 and the other is Infinity.\r\n      if (!x.s || !y.s || xc && !xc[0] && !yc || yc && !yc[0] && !xc) {\r\n        y.c = y.e = y.s = null;\r\n      } else {\r\n        y.s *= x.s;\r\n\r\n        // Return \u00B1Infinity if either is \u00B1Infinity.\r\n        if (!xc || !yc) {\r\n          y.c = y.e = null;\r\n\r\n        // Return \u00B10 if either is \u00B10.\r\n        } else {\r\n          y.c = [0];\r\n          y.e = 0;\r\n        }\r\n      }\r\n\r\n      return y;\r\n    }\r\n\r\n    e = bitFloor(x.e / LOG_BASE) + bitFloor(y.e / LOG_BASE);\r\n    y.s *= x.s;\r\n    xcL = xc.length;\r\n    ycL = yc.length;\r\n\r\n    // Ensure xc points to longer array and xcL to its length.\r\n    if (xcL < ycL) {\r\n      zc = xc;\r\n      xc = yc;\r\n      yc = zc;\r\n      i = xcL;\r\n      xcL = ycL;\r\n      ycL = i;\r\n    }\r\n\r\n    // Initialise the result array with zeros.\r\n    for (i = xcL + ycL, zc = []; i--; zc.push(0));\r\n\r\n    base = BASE;\r\n    sqrtBase = SQRT_BASE;\r\n\r\n    for (i = ycL; --i >= 0;) {\r\n      c = 0;\r\n      ylo = yc[i] % sqrtBase;\r\n      yhi = yc[i] / sqrtBase | 0;\r\n\r\n      for (k = xcL, j = i + k; j > i;) {\r\n        xlo = xc[--k] % sqrtBase;\r\n        xhi = xc[k] / sqrtBase | 0;\r\n        m = yhi * xlo + xhi * ylo;\r\n        xlo = ylo * xlo + ((m % sqrtBase) * sqrtBase) + zc[j] + c;\r\n        c = (xlo / base | 0) + (m / sqrtBase | 0) + yhi * xhi;\r\n        zc[j--] = xlo % base;\r\n      }\r\n\r\n      zc[j] = c;\r\n    }\r\n\r\n    if (c) {\r\n      ++e;\r\n    } else {\r\n      zc.splice(0, 1);\r\n    }\r\n\r\n    return normalise(y, zc, e);\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a new BigNumber whose value is the value of this BigNumber negated,\r\n   * i.e. multiplied by -1.\r\n   */\r\n  P.negated = function () {\r\n    var x = new BigNumber(this);\r\n    x.s = -x.s || null;\r\n    return x;\r\n  };\r\n\r\n\r\n  /*\r\n   *  n + 0 = n\r\n   *  n + N = N\r\n   *  n + I = I\r\n   *  0 + n = n\r\n   *  0 + 0 = 0\r\n   *  0 + N = N\r\n   *  0 + I = I\r\n   *  N + n = N\r\n   *  N + 0 = N\r\n   *  N + N = N\r\n   *  N + I = N\r\n   *  I + n = I\r\n   *  I + 0 = I\r\n   *  I + N = N\r\n   *  I + I = I\r\n   *\r\n   * Return a new BigNumber whose value is the value of this BigNumber plus the value of\r\n   * BigNumber(y, b).\r\n   */\r\n  P.plus = function (y, b) {\r\n    var t,\r\n      x = this,\r\n      a = x.s;\r\n\r\n    y = new BigNumber(y, b);\r\n    b = y.s;\r\n\r\n    // Either NaN?\r\n    if (!a || !b) return new BigNumber(NaN);\r\n\r\n    // Signs differ?\r\n     if (a != b) {\r\n      y.s = -b;\r\n      return x.minus(y);\r\n    }\r\n\r\n    var xe = x.e / LOG_BASE,\r\n      ye = y.e / LOG_BASE,\r\n      xc = x.c,\r\n      yc = y.c;\r\n\r\n    if (!xe || !ye) {\r\n\r\n      // Return \u00B1Infinity if either \u00B1Infinity.\r\n      if (!xc || !yc) return new BigNumber(a / 0);\r\n\r\n      // Either zero?\r\n      // Return y if y is non-zero, x if x is non-zero, or zero if both are zero.\r\n      if (!xc[0] || !yc[0]) return yc[0] ? y : new BigNumber(xc[0] ? x : a * 0);\r\n    }\r\n\r\n    xe = bitFloor(xe);\r\n    ye = bitFloor(ye);\r\n    xc = xc.slice();\r\n\r\n    // Prepend zeros to equalise exponents. Faster to use reverse then do unshifts.\r\n    if (a = xe - ye) {\r\n      if (a > 0) {\r\n        ye = xe;\r\n        t = yc;\r\n      } else {\r\n        a = -a;\r\n        t = xc;\r\n      }\r\n\r\n      t.reverse();\r\n      for (; a--; t.push(0));\r\n      t.reverse();\r\n    }\r\n\r\n    a = xc.length;\r\n    b = yc.length;\r\n\r\n    // Point xc to the longer array, and b to the shorter length.\r\n    if (a - b < 0) {\r\n      t = yc;\r\n      yc = xc;\r\n      xc = t;\r\n      b = a;\r\n    }\r\n\r\n    // Only start adding at yc.length - 1 as the further digits of xc can be ignored.\r\n    for (a = 0; b;) {\r\n      a = (xc[--b] = xc[b] + yc[b] + a) / BASE | 0;\r\n      xc[b] = BASE === xc[b] ? 0 : xc[b] % BASE;\r\n    }\r\n\r\n    if (a) {\r\n      xc = [a].concat(xc);\r\n      ++ye;\r\n    }\r\n\r\n    // No need to check for zero, as +x + +y != 0 && -x + -y != 0\r\n    // ye = MAX_EXP + 1 possible\r\n    return normalise(y, xc, ye);\r\n  };\r\n\r\n\r\n  /*\r\n   * If sd is undefined or null or true or false, return the number of significant digits of\r\n   * the value of this BigNumber, or null if the value of this BigNumber is \u00B1Infinity or NaN.\r\n   * If sd is true include integer-part trailing zeros in the count.\r\n   *\r\n   * Otherwise, if sd is a number, return a new BigNumber whose value is the value of this\r\n   * BigNumber rounded to a maximum of sd significant digits using rounding mode rm, or\r\n   * ROUNDING_MODE if rm is omitted.\r\n   *\r\n   * sd {number|boolean} number: significant digits: integer, 1 to MAX inclusive.\r\n   *                     boolean: whether to count integer-part trailing zeros: true or false.\r\n   * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.\r\n   *\r\n   * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {sd|rm}'\r\n   */\r\n  P.precision = P.sd = function (sd, rm) {\r\n    var c, n, v,\r\n      x = this;\r\n\r\n    if (sd != null && sd !== !!sd) {\r\n      intCheck(sd, 1, MAX);\r\n      if (rm == null) rm = ROUNDING_MODE;\r\n      else intCheck(rm, 0, 8);\r\n\r\n      return round(new BigNumber(x), sd, rm);\r\n    }\r\n\r\n    if (!(c = x.c)) return null;\r\n    v = c.length - 1;\r\n    n = v * LOG_BASE + 1;\r\n\r\n    if (v = c[v]) {\r\n\r\n      // Subtract the number of trailing zeros of the last element.\r\n      for (; v % 10 == 0; v /= 10, n--);\r\n\r\n      // Add the number of digits of the first element.\r\n      for (v = c[0]; v >= 10; v /= 10, n++);\r\n    }\r\n\r\n    if (sd && x.e + 1 > n) n = x.e + 1;\r\n\r\n    return n;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a new BigNumber whose value is the value of this BigNumber shifted by k places\r\n   * (powers of 10). Shift to the right if n > 0, and to the left if n < 0.\r\n   *\r\n   * k {number} Integer, -MAX_SAFE_INTEGER to MAX_SAFE_INTEGER inclusive.\r\n   *\r\n   * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {k}'\r\n   */\r\n  P.shiftedBy = function (k) {\r\n    intCheck(k, -MAX_SAFE_INTEGER, MAX_SAFE_INTEGER);\r\n    return this.times('1e' + k);\r\n  };\r\n\r\n\r\n  /*\r\n   *  sqrt(-n) =  N\r\n   *  sqrt(N) =  N\r\n   *  sqrt(-I) =  N\r\n   *  sqrt(I) =  I\r\n   *  sqrt(0) =  0\r\n   *  sqrt(-0) = -0\r\n   *\r\n   * Return a new BigNumber whose value is the square root of the value of this BigNumber,\r\n   * rounded according to DECIMAL_PLACES and ROUNDING_MODE.\r\n   */\r\n  P.squareRoot = P.sqrt = function () {\r\n    var m, n, r, rep, t,\r\n      x = this,\r\n      c = x.c,\r\n      s = x.s,\r\n      e = x.e,\r\n      dp = DECIMAL_PLACES + 4,\r\n      half = new BigNumber('0.5');\r\n\r\n    // Negative/NaN/Infinity/zero?\r\n    if (s !== 1 || !c || !c[0]) {\r\n      return new BigNumber(!s || s < 0 && (!c || c[0]) ? NaN : c ? x : 1 / 0);\r\n    }\r\n\r\n    // Initial estimate.\r\n    s = Math.sqrt(+valueOf(x));\r\n\r\n    // Math.sqrt underflow/overflow?\r\n    // Pass x to Math.sqrt as integer, then adjust the exponent of the result.\r\n    if (s == 0 || s == 1 / 0) {\r\n      n = coeffToString(c);\r\n      if ((n.length + e) % 2 == 0) n += '0';\r\n      s = Math.sqrt(+n);\r\n      e = bitFloor((e + 1) / 2) - (e < 0 || e % 2);\r\n\r\n      if (s == 1 / 0) {\r\n        n = '5e' + e;\r\n      } else {\r\n        n = s.toExponential();\r\n        n = n.slice(0, n.indexOf('e') + 1) + e;\r\n      }\r\n\r\n      r = new BigNumber(n);\r\n    } else {\r\n      r = new BigNumber(s + '');\r\n    }\r\n\r\n    // Check for zero.\r\n    // r could be zero if MIN_EXP is changed after the this value was created.\r\n    // This would cause a division by zero (x/t) and hence Infinity below, which would cause\r\n    // coeffToString to throw.\r\n    if (r.c[0]) {\r\n      e = r.e;\r\n      s = e + dp;\r\n      if (s < 3) s = 0;\r\n\r\n      // Newton-Raphson iteration.\r\n      for (; ;) {\r\n        t = r;\r\n        r = half.times(t.plus(div(x, t, dp, 1)));\r\n\r\n        if (coeffToString(t.c).slice(0, s) === (n = coeffToString(r.c)).slice(0, s)) {\r\n\r\n          // The exponent of r may here be one less than the final result exponent,\r\n          // e.g 0.0009999 (e-4) --> 0.001 (e-3), so adjust s so the rounding digits\r\n          // are indexed correctly.\r\n          if (r.e < e) --s;\r\n          n = n.slice(s - 3, s + 1);\r\n\r\n          // The 4th rounding digit may be in error by -1 so if the 4 rounding digits\r\n          // are 9999 or 4999 (i.e. approaching a rounding boundary) continue the\r\n          // iteration.\r\n          if (n == '9999' || !rep && n == '4999') {\r\n\r\n            // On the first iteration only, check to see if rounding up gives the\r\n            // exact result as the nines may infinitely repeat.\r\n            if (!rep) {\r\n              round(t, t.e + DECIMAL_PLACES + 2, 0);\r\n\r\n              if (t.times(t).eq(x)) {\r\n                r = t;\r\n                break;\r\n              }\r\n            }\r\n\r\n            dp += 4;\r\n            s += 4;\r\n            rep = 1;\r\n          } else {\r\n\r\n            // If rounding digits are null, 0{0,4} or 50{0,3}, check for exact\r\n            // result. If not, then there are further digits and m will be truthy.\r\n            if (!+n || !+n.slice(1) && n.charAt(0) == '5') {\r\n\r\n              // Truncate to the first rounding digit.\r\n              round(r, r.e + DECIMAL_PLACES + 2, 1);\r\n              m = !r.times(r).eq(x);\r\n            }\r\n\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return round(r, r.e + DECIMAL_PLACES + 1, ROUNDING_MODE, m);\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a string representing the value of this BigNumber in exponential notation and\r\n   * rounded using ROUNDING_MODE to dp fixed decimal places.\r\n   *\r\n   * [dp] {number} Decimal places. Integer, 0 to MAX inclusive.\r\n   * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.\r\n   *\r\n   * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {dp|rm}'\r\n   */\r\n  P.toExponential = function (dp, rm) {\r\n    if (dp != null) {\r\n      intCheck(dp, 0, MAX);\r\n      dp++;\r\n    }\r\n    return format(this, dp, rm, 1);\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a string representing the value of this BigNumber in fixed-point notation rounding\r\n   * to dp fixed decimal places using rounding mode rm, or ROUNDING_MODE if rm is omitted.\r\n   *\r\n   * Note: as with JavaScript's number type, (-0).toFixed(0) is '0',\r\n   * but e.g. (-0.00001).toFixed(0) is '-0'.\r\n   *\r\n   * [dp] {number} Decimal places. Integer, 0 to MAX inclusive.\r\n   * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.\r\n   *\r\n   * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {dp|rm}'\r\n   */\r\n  P.toFixed = function (dp, rm) {\r\n    if (dp != null) {\r\n      intCheck(dp, 0, MAX);\r\n      dp = dp + this.e + 1;\r\n    }\r\n    return format(this, dp, rm);\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a string representing the value of this BigNumber in fixed-point notation rounded\r\n   * using rm or ROUNDING_MODE to dp decimal places, and formatted according to the properties\r\n   * of the format or FORMAT object (see BigNumber.set).\r\n   *\r\n   * The formatting object may contain some or all of the properties shown below.\r\n   *\r\n   * FORMAT = {\r\n   *   prefix: '',\r\n   *   groupSize: 3,\r\n   *   secondaryGroupSize: 0,\r\n   *   groupSeparator: ',',\r\n   *   decimalSeparator: '.',\r\n   *   fractionGroupSize: 0,\r\n   *   fractionGroupSeparator: '\\xA0',      // non-breaking space\r\n   *   suffix: ''\r\n   * };\r\n   *\r\n   * [dp] {number} Decimal places. Integer, 0 to MAX inclusive.\r\n   * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.\r\n   * [format] {object} Formatting options. See FORMAT pbject above.\r\n   *\r\n   * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {dp|rm}'\r\n   * '[BigNumber Error] Argument not an object: {format}'\r\n   */\r\n  P.toFormat = function (dp, rm, format) {\r\n    var str,\r\n      x = this;\r\n\r\n    if (format == null) {\r\n      if (dp != null && rm && typeof rm == 'object') {\r\n        format = rm;\r\n        rm = null;\r\n      } else if (dp && typeof dp == 'object') {\r\n        format = dp;\r\n        dp = rm = null;\r\n      } else {\r\n        format = FORMAT;\r\n      }\r\n    } else if (typeof format != 'object') {\r\n      throw Error\r\n        (bignumberError + 'Argument not an object: ' + format);\r\n    }\r\n\r\n    str = x.toFixed(dp, rm);\r\n\r\n    if (x.c) {\r\n      var i,\r\n        arr = str.split('.'),\r\n        g1 = +format.groupSize,\r\n        g2 = +format.secondaryGroupSize,\r\n        groupSeparator = format.groupSeparator || '',\r\n        intPart = arr[0],\r\n        fractionPart = arr[1],\r\n        isNeg = x.s < 0,\r\n        intDigits = isNeg ? intPart.slice(1) : intPart,\r\n        len = intDigits.length;\r\n\r\n      if (g2) {\r\n        i = g1;\r\n        g1 = g2;\r\n        g2 = i;\r\n        len -= i;\r\n      }\r\n\r\n      if (g1 > 0 && len > 0) {\r\n        i = len % g1 || g1;\r\n        intPart = intDigits.substr(0, i);\r\n        for (; i < len; i += g1) intPart += groupSeparator + intDigits.substr(i, g1);\r\n        if (g2 > 0) intPart += groupSeparator + intDigits.slice(i);\r\n        if (isNeg) intPart = '-' + intPart;\r\n      }\r\n\r\n      str = fractionPart\r\n       ? intPart + (format.decimalSeparator || '') + ((g2 = +format.fractionGroupSize)\r\n        ? fractionPart.replace(new RegExp('\\\\d{' + g2 + '}\\\\B', 'g'),\r\n         '$&' + (format.fractionGroupSeparator || ''))\r\n        : fractionPart)\r\n       : intPart;\r\n    }\r\n\r\n    return (format.prefix || '') + str + (format.suffix || '');\r\n  };\r\n\r\n\r\n  /*\r\n   * Return an array of two BigNumbers representing the value of this BigNumber as a simple\r\n   * fraction with an integer numerator and an integer denominator.\r\n   * The denominator will be a positive non-zero value less than or equal to the specified\r\n   * maximum denominator. If a maximum denominator is not specified, the denominator will be\r\n   * the lowest value necessary to represent the number exactly.\r\n   *\r\n   * [md] {number|string|BigNumber} Integer >= 1, or Infinity. The maximum denominator.\r\n   *\r\n   * '[BigNumber Error] Argument {not an integer|out of range} : {md}'\r\n   */\r\n  P.toFraction = function (md) {\r\n    var d, d0, d1, d2, e, exp, n, n0, n1, q, r, s,\r\n      x = this,\r\n      xc = x.c;\r\n\r\n    if (md != null) {\r\n      n = new BigNumber(md);\r\n\r\n      // Throw if md is less than one or is not an integer, unless it is Infinity.\r\n      if (!n.isInteger() && (n.c || n.s !== 1) || n.lt(ONE)) {\r\n        throw Error\r\n          (bignumberError + 'Argument ' +\r\n            (n.isInteger() ? 'out of range: ' : 'not an integer: ') + valueOf(n));\r\n      }\r\n    }\r\n\r\n    if (!xc) return new BigNumber(x);\r\n\r\n    d = new BigNumber(ONE);\r\n    n1 = d0 = new BigNumber(ONE);\r\n    d1 = n0 = new BigNumber(ONE);\r\n    s = coeffToString(xc);\r\n\r\n    // Determine initial denominator.\r\n    // d is a power of 10 and the minimum max denominator that specifies the value exactly.\r\n    e = d.e = s.length - x.e - 1;\r\n    d.c[0] = POWS_TEN[(exp = e % LOG_BASE) < 0 ? LOG_BASE + exp : exp];\r\n    md = !md || n.comparedTo(d) > 0 ? (e > 0 ? d : n1) : n;\r\n\r\n    exp = MAX_EXP;\r\n    MAX_EXP = 1 / 0;\r\n    n = new BigNumber(s);\r\n\r\n    // n0 = d1 = 0\r\n    n0.c[0] = 0;\r\n\r\n    for (; ;)  {\r\n      q = div(n, d, 0, 1);\r\n      d2 = d0.plus(q.times(d1));\r\n      if (d2.comparedTo(md) == 1) break;\r\n      d0 = d1;\r\n      d1 = d2;\r\n      n1 = n0.plus(q.times(d2 = n1));\r\n      n0 = d2;\r\n      d = n.minus(q.times(d2 = d));\r\n      n = d2;\r\n    }\r\n\r\n    d2 = div(md.minus(d0), d1, 0, 1);\r\n    n0 = n0.plus(d2.times(n1));\r\n    d0 = d0.plus(d2.times(d1));\r\n    n0.s = n1.s = x.s;\r\n    e = e * 2;\r\n\r\n    // Determine which fraction is closer to x, n0/d0 or n1/d1\r\n    r = div(n1, d1, e, ROUNDING_MODE).minus(x).abs().comparedTo(\r\n        div(n0, d0, e, ROUNDING_MODE).minus(x).abs()) < 1 ? [n1, d1] : [n0, d0];\r\n\r\n    MAX_EXP = exp;\r\n\r\n    return r;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return the value of this BigNumber converted to a number primitive.\r\n   */\r\n  P.toNumber = function () {\r\n    return +valueOf(this);\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a string representing the value of this BigNumber rounded to sd significant digits\r\n   * using rounding mode rm or ROUNDING_MODE. If sd is less than the number of digits\r\n   * necessary to represent the integer part of the value in fixed-point notation, then use\r\n   * exponential notation.\r\n   *\r\n   * [sd] {number} Significant digits. Integer, 1 to MAX inclusive.\r\n   * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.\r\n   *\r\n   * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {sd|rm}'\r\n   */\r\n  P.toPrecision = function (sd, rm) {\r\n    if (sd != null) intCheck(sd, 1, MAX);\r\n    return format(this, sd, rm, 2);\r\n  };\r\n\r\n\r\n  /*\r\n   * Return a string representing the value of this BigNumber in base b, or base 10 if b is\r\n   * omitted. If a base is specified, including base 10, round according to DECIMAL_PLACES and\r\n   * ROUNDING_MODE. If a base is not specified, and this BigNumber has a positive exponent\r\n   * that is equal to or greater than TO_EXP_POS, or a negative exponent equal to or less than\r\n   * TO_EXP_NEG, return exponential notation.\r\n   *\r\n   * [b] {number} Integer, 2 to ALPHABET.length inclusive.\r\n   *\r\n   * '[BigNumber Error] Base {not a primitive number|not an integer|out of range}: {b}'\r\n   */\r\n  P.toString = function (b) {\r\n    var str,\r\n      n = this,\r\n      s = n.s,\r\n      e = n.e;\r\n\r\n    // Infinity or NaN?\r\n    if (e === null) {\r\n      if (s) {\r\n        str = 'Infinity';\r\n        if (s < 0) str = '-' + str;\r\n      } else {\r\n        str = 'NaN';\r\n      }\r\n    } else {\r\n      if (b == null) {\r\n        str = e <= TO_EXP_NEG || e >= TO_EXP_POS\r\n         ? toExponential(coeffToString(n.c), e)\r\n         : toFixedPoint(coeffToString(n.c), e, '0');\r\n      } else if (b === 10 && alphabetHasNormalDecimalDigits) {\r\n        n = round(new BigNumber(n), DECIMAL_PLACES + e + 1, ROUNDING_MODE);\r\n        str = toFixedPoint(coeffToString(n.c), n.e, '0');\r\n      } else {\r\n        intCheck(b, 2, ALPHABET.length, 'Base');\r\n        str = convertBase(toFixedPoint(coeffToString(n.c), e, '0'), 10, b, s, true);\r\n      }\r\n\r\n      if (s < 0 && n.c[0]) str = '-' + str;\r\n    }\r\n\r\n    return str;\r\n  };\r\n\r\n\r\n  /*\r\n   * Return as toString, but do not accept a base argument, and include the minus sign for\r\n   * negative zero.\r\n   */\r\n  P.valueOf = P.toJSON = function () {\r\n    return valueOf(this);\r\n  };\r\n\r\n\r\n  P._isBigNumber = true;\r\n\r\n  P[Symbol.toStringTag] = 'BigNumber';\r\n\r\n  // Node.js v10.12.0+\r\n  P[Symbol.for('nodejs.util.inspect.custom')] = P.valueOf;\r\n\r\n  if (configObject != null) BigNumber.set(configObject);\r\n\r\n  return BigNumber;\r\n}\r\n\r\n\r\n// PRIVATE HELPER FUNCTIONS\r\n\r\n// These functions don't need access to variables,\r\n// e.g. DECIMAL_PLACES, in the scope of the `clone` function above.\r\n\r\n\r\nfunction bitFloor(n) {\r\n  var i = n | 0;\r\n  return n > 0 || n === i ? i : i - 1;\r\n}\r\n\r\n\r\n// Return a coefficient array as a string of base 10 digits.\r\nfunction coeffToString(a) {\r\n  var s, z,\r\n    i = 1,\r\n    j = a.length,\r\n    r = a[0] + '';\r\n\r\n  for (; i < j;) {\r\n    s = a[i++] + '';\r\n    z = LOG_BASE - s.length;\r\n    for (; z--; s = '0' + s);\r\n    r += s;\r\n  }\r\n\r\n  // Determine trailing zeros.\r\n  for (j = r.length; r.charCodeAt(--j) === 48;);\r\n\r\n  return r.slice(0, j + 1 || 1);\r\n}\r\n\r\n\r\n// Compare the value of BigNumbers x and y.\r\nfunction compare(x, y) {\r\n  var a, b,\r\n    xc = x.c,\r\n    yc = y.c,\r\n    i = x.s,\r\n    j = y.s,\r\n    k = x.e,\r\n    l = y.e;\r\n\r\n  // Either NaN?\r\n  if (!i || !j) return null;\r\n\r\n  a = xc && !xc[0];\r\n  b = yc && !yc[0];\r\n\r\n  // Either zero?\r\n  if (a || b) return a ? b ? 0 : -j : i;\r\n\r\n  // Signs differ?\r\n  if (i != j) return i;\r\n\r\n  a = i < 0;\r\n  b = k == l;\r\n\r\n  // Either Infinity?\r\n  if (!xc || !yc) return b ? 0 : !xc ^ a ? 1 : -1;\r\n\r\n  // Compare exponents.\r\n  if (!b) return k > l ^ a ? 1 : -1;\r\n\r\n  j = (k = xc.length) < (l = yc.length) ? k : l;\r\n\r\n  // Compare digit by digit.\r\n  for (i = 0; i < j; i++) if (xc[i] != yc[i]) return xc[i] > yc[i] ^ a ? 1 : -1;\r\n\r\n  // Compare lengths.\r\n  return k == l ? 0 : k > l ^ a ? 1 : -1;\r\n}\r\n\r\n\r\n/*\r\n * Check that n is a primitive number, an integer, and in range, otherwise throw.\r\n */\r\nfunction intCheck(n, min, max, name) {\r\n  if (n < min || n > max || n !== mathfloor(n)) {\r\n    throw Error\r\n     (bignumberError + (name || 'Argument') + (typeof n == 'number'\r\n       ? n < min || n > max ? ' out of range: ' : ' not an integer: '\r\n       : ' not a primitive number: ') + String(n));\r\n  }\r\n}\r\n\r\n\r\n// Assumes finite n.\r\nfunction isOdd(n) {\r\n  var k = n.c.length - 1;\r\n  return bitFloor(n.e / LOG_BASE) == k && n.c[k] % 2 != 0;\r\n}\r\n\r\n\r\nfunction toExponential(str, e) {\r\n  return (str.length > 1 ? str.charAt(0) + '.' + str.slice(1) : str) +\r\n   (e < 0 ? 'e' : 'e+') + e;\r\n}\r\n\r\n\r\nfunction toFixedPoint(str, e, z) {\r\n  var len, zs;\r\n\r\n  // Negative exponent?\r\n  if (e < 0) {\r\n\r\n    // Prepend zeros.\r\n    for (zs = z + '.'; ++e; zs += z);\r\n    str = zs + str;\r\n\r\n  // Positive exponent\r\n  } else {\r\n    len = str.length;\r\n\r\n    // Append zeros.\r\n    if (++e > len) {\r\n      for (zs = z, e -= len; --e; zs += z);\r\n      str += zs;\r\n    } else if (e < len) {\r\n      str = str.slice(0, e) + '.' + str.slice(e);\r\n    }\r\n  }\r\n\r\n  return str;\r\n}\r\n\r\n\r\n// EXPORT\r\n\r\n\r\nexport var BigNumber = clone();\r\n\r\nexport default BigNumber;\r\n", "type Comparator<T> = (a: T, b: T) => number;\ntype Predicate<T> = (value: T) => boolean;\n\nclass SplayTreeNode<K, Node extends SplayTreeNode<K, Node>> {\n    readonly key: K;\n\n    left: Node | null = null;\n    right: Node | null = null;\n\n    constructor(key: K) {\n        this.key = key;\n    }\n}\n\nclass SplayTreeSetNode<K> extends SplayTreeNode<K, SplayTreeSetNode<K>> {\n    constructor(key: K) {\n        super(key);\n    }\n}\n\nclass SplayTreeMapNode<K, V> extends SplayTreeNode<K, SplayTreeMapNode<K, V>> {\n    readonly value: V;\n\n    constructor(key: K, value: V) {\n        super(key);\n        this.value = value;\n    }\n\n    replaceValue(value: V) {\n        const node = new SplayTreeMapNode(this.key, value);\n        node.left = this.left;\n        node.right = this.right;\n        return node;\n    }\n}\n\nabstract class SplayTree<K, Node extends SplayTreeNode<K, Node>> {\n    protected abstract root: Node | null;\n\n    public size = 0;\n\n    protected modificationCount = 0;\n\n    protected splayCount = 0;\n\n    protected abstract compare: Comparator<K>;\n\n    protected abstract validKey: Predicate<unknown>;\n\n    protected splay(key: K) {\n        const root = this.root;\n        if (root == null) {\n            this.compare(key, key);\n            return -1;\n        }\n\n        let right: Node | null = null;\n        let newTreeRight: Node | null = null;\n        let left: Node | null = null;\n        let newTreeLeft: Node | null = null;\n        let current = root;\n        const compare = this.compare;\n        let comp: number;\n        while (true) {\n            comp = compare(current.key, key);\n            if (comp > 0) {\n                let currentLeft = current.left;\n                if (currentLeft == null) break;\n                comp = compare(currentLeft.key, key);\n                if (comp > 0) {\n                    current.left = currentLeft.right;\n                    currentLeft.right = current;\n                    current = currentLeft;\n                    currentLeft = current.left;\n                    if (currentLeft == null) break;\n                }\n                if (right == null) {\n                    newTreeRight = current;\n                } else {\n                    right.left = current;\n                }\n                right = current;\n                current = currentLeft;\n            } else if (comp < 0) {\n                let currentRight = current.right;\n                if (currentRight == null) break;\n                comp = compare(currentRight.key, key);\n                if (comp < 0) {\n                    current.right = currentRight.left;\n                    currentRight.left = current;\n                    current = currentRight;\n                    currentRight = current.right;\n                    if (currentRight == null) break;\n                }\n                if (left == null) {\n                    newTreeLeft = current;\n                } else {\n                    left.right = current;\n                }\n                left = current;\n                current = currentRight;\n            } else {\n                break;\n            }\n        }\n        if (left != null) {\n            left.right = current.left;\n            current.left = newTreeLeft;\n        }\n        if (right != null) {\n            right.left = current.right;\n            current.right = newTreeRight;\n        }\n        if (this.root !== current) {\n            this.root = current;\n            this.splayCount++;\n        }\n        return comp;\n    }\n\n    protected splayMin(node: Node) {\n        let current = node;\n        let nextLeft = current.left;\n        while (nextLeft != null) {\n            const left = nextLeft;\n            current.left = left.right;\n            left.right = current;\n            current = left;\n            nextLeft = current.left;\n        }\n        return current;\n    }\n\n    protected splayMax(node: Node) {\n        let current = node;\n        let nextRight = current.right;\n        while (nextRight != null) {\n            const right = nextRight;\n            current.right = right.left;\n            right.left = current;\n            current = right;\n            nextRight = current.right;\n        }\n        return current;\n    }\n\n    protected _delete(key: K) {\n        if (this.root == null) return null;\n        const comp = this.splay(key);\n        if (comp != 0) return null;\n        let root = this.root;\n        const result = root;\n        const left = root.left;\n        this.size--;\n        if (left == null) {\n            this.root = root.right;\n        } else {\n            const right = root.right;\n            root = this.splayMax(left);\n\n            root.right = right;\n            this.root = root;\n        }\n        this.modificationCount++;\n        return result;\n    }\n\n    protected addNewRoot(node: Node, comp: number) {\n        this.size++;\n        this.modificationCount++;\n        const root = this.root;\n        if (root == null) {\n            this.root = node;\n            return;\n        }\n        if (comp < 0) {\n            node.left = root;\n            node.right = root.right;\n            root.right = null;\n        } else {\n            node.right = root;\n            node.left = root.left;\n            root.left = null;\n        }\n        this.root = node;\n    }\n\n    protected _first() {\n        const root = this.root;\n        if (root == null) return null;\n        this.root = this.splayMin(root);\n        return this.root;\n    }\n\n    protected _last() {\n        const root = this.root;\n        if (root == null) return null;\n        this.root = this.splayMax(root);\n        return this.root;\n    }\n\n    public clear() {\n        this.root = null;\n        this.size = 0;\n        this.modificationCount++;\n    }\n\n    public has(key: unknown) {\n        return this.validKey(key) && this.splay(key as K) == 0;\n    }\n\n    protected defaultCompare(): Comparator<K> {\n        return (a: K, b: K) => a < b ? -1 : a > b ? 1 : 0;\n    }\n\n    protected wrap(): SplayTreeWrapper<K, Node> {\n        return {\n            getRoot: () => { return this.root },\n            setRoot: (root) => { this.root = root },\n            getSize: () => { return this.size },\n            getModificationCount: () => { return this.modificationCount },\n            getSplayCount: () => { return this.splayCount },\n            setSplayCount: (count) => { this.splayCount = count },\n            splay: (key) => { return this.splay(key) },\n            has: (key) => { return this.has(key) },\n        };\n    }\n}\n\nexport class SplayTreeMap<K, V> extends SplayTree<K, SplayTreeMapNode<K, V>> implements Iterable<[K, V]>, Map<K, V> {\n    protected root: SplayTreeMapNode<K, V> | null = null;\n\n    protected compare: Comparator<K>;\n    protected validKey: Predicate<unknown>;\n\n    constructor(compare?: Comparator<K>, isValidKey?: Predicate<unknown>) {\n        super();\n        this.compare = compare ?? this.defaultCompare();\n        this.validKey = isValidKey ?? ((a: unknown) => a != null && a != undefined);\n    }\n\n    delete(key: unknown) {\n        if (!this.validKey(key)) return false;\n        return this._delete(key as K) != null;\n    }\n\n    forEach(f: (value: V, key: K, map: Map<K, V>) => void) {\n        const nodes: Iterator<[K, V]> = new SplayTreeMapEntryIterableIterator<K, V>(this.wrap());\n        let result: IteratorResult<[K, V]>;\n        while (result = nodes.next(), !result.done) {\n            f(result.value[1], result.value[0], this);\n        }\n    }\n\n    get(key: unknown): V | undefined {\n        if (!this.validKey(key)) return undefined;\n        if (this.root != null) {\n            const comp = this.splay(key as K);\n            if (comp == 0) {\n                return this.root!.value;\n            }\n        }\n        return undefined;\n    }\n\n    hasValue(value: unknown) {\n        const initialSplayCount = this.splayCount;\n        const visit = (node: SplayTreeMapNode<K, V> | null) => {\n            while (node != null) {\n                if (node.value == value) return true;\n                if (initialSplayCount != this.splayCount) {\n                    throw \"Concurrent modification during iteration.\";\n                }\n                if (node.right != null && visit(node.right)) {\n                    return true;\n                }\n                node = node.left;\n            }\n            return false;\n        }\n\n        return visit(this.root);\n    }\n\n    set(key: K, value: V) {\n        const comp = this.splay(key);\n        if (comp == 0) {\n            this.root = this.root!.replaceValue(value);\n            this.splayCount += 1;\n            return this;\n        }\n        this.addNewRoot(new SplayTreeMapNode(key, value), comp);\n        return this;\n    }\n\n    setAll(other: Map<K, V>) {\n        other.forEach((value: V, key: K) => {\n            this.set(key, value);\n        });\n    }\n\n    setIfAbsent(key: K, ifAbsent: () => V) {\n        let comp = this.splay(key);\n        if (comp == 0) {\n            return this.root!.value;\n        }\n        const modificationCount = this.modificationCount;\n        const splayCount = this.splayCount;\n        const value = ifAbsent();\n        if (modificationCount != this.modificationCount) {\n            throw \"Concurrent modification during iteration.\";\n        }\n        if (splayCount != this.splayCount) {\n            comp = this.splay(key);\n        }\n        this.addNewRoot(new SplayTreeMapNode(key, value), comp);\n        return value;\n    }\n\n    isEmpty() {\n        return this.root == null;\n    }\n\n    isNotEmpty() {\n        return !this.isEmpty();\n    }\n\n    firstKey() {\n        if (this.root == null) return null;\n        return this._first()!.key;\n    }\n\n    lastKey() {\n        if (this.root == null) return null;\n        return this._last()!.key;\n    }\n\n    lastKeyBefore(key: K) {\n        if (key == null) throw \"Invalid arguments(s)\";\n        if (this.root == null) return null;\n        const comp = this.splay(key);\n        if (comp < 0) return this.root!.key;\n        let node: SplayTreeMapNode<K, V> | null = this.root!.left;\n        if (node == null) return null;\n        let nodeRight = node.right;\n        while (nodeRight != null) {\n            node = nodeRight;\n            nodeRight = node.right;\n        }\n        return node!.key;\n    }\n\n    firstKeyAfter(key: K) {\n        if (key == null) throw \"Invalid arguments(s)\";\n        if (this.root == null) return null;\n        const comp = this.splay(key);\n        if (comp > 0) return this.root!.key;\n        let node: SplayTreeMapNode<K, V> | null = this.root!.right;\n        if (node == null) return null;\n        let nodeLeft = node.left;\n        while (nodeLeft != null) {\n            node = nodeLeft;\n            nodeLeft = node.left;\n        }\n        return node!.key;\n    }\n\n    update(key: K, update: (value: V) => V, ifAbsent?: () => V) {\n        let comp = this.splay(key);\n        if (comp == 0) {\n            const modificationCount = this.modificationCount;\n            const splayCount = this.splayCount;\n            const newValue = update(this.root!.value);\n            if (modificationCount != this.modificationCount) {\n                throw \"Concurrent modification during iteration.\";\n            }\n            if (splayCount != this.splayCount) {\n                this.splay(key);\n            }\n            this.root = this.root!.replaceValue(newValue);\n            this.splayCount += 1;\n            return newValue;\n        }\n        if (ifAbsent != null) {\n            const modificationCount = this.modificationCount;\n            const splayCount = this.splayCount;\n            const newValue = ifAbsent();\n            if (modificationCount != this.modificationCount) {\n                throw \"Concurrent modification during iteration.\";\n            }\n            if (splayCount != this.splayCount) {\n                comp = this.splay(key);\n            }\n            this.addNewRoot(new SplayTreeMapNode(key, newValue), comp);\n            return newValue;\n        }\n        throw \"Invalid argument (key): Key not in map.\"\n    }\n\n    updateAll(update: (key: K, value: V) => V) {\n        const root = this.root;\n        if (root == null) return;\n        const iterator = new SplayTreeMapEntryIterableIterator(this.wrap());\n        let node: IteratorResult<[K, V]>;\n        while (node = iterator.next(), !node.done) {\n            const newValue = update(...node.value);\n            iterator.replaceValue(newValue);\n        }\n    }\n\n    keys(): IterableIterator<K> {\n        return new SplayTreeKeyIterableIterator<K, SplayTreeMapNode<K, V>>(this.wrap());\n    }\n\n    values(): IterableIterator<V> {\n        return new SplayTreeValueIterableIterator<K, V>(this.wrap());\n    }\n\n    entries(): IterableIterator<[K, V]> {\n        return this[Symbol.iterator]();\n    }\n\n    [Symbol.iterator](): IterableIterator<[K, V]> {\n        return new SplayTreeMapEntryIterableIterator<K, V>(this.wrap());\n    }\n\n    [Symbol.toStringTag] = '[object Map]'\n}\n\nexport class SplayTreeSet<E> extends SplayTree<E, SplayTreeSetNode<E>> implements Iterable<E>, Set<E> {\n    protected root: SplayTreeSetNode<E> | null = null;\n\n    protected compare: Comparator<E>;\n    protected validKey: Predicate<unknown>;\n\n    constructor(compare?: Comparator<E>, isValidKey?: Predicate<unknown>) {\n        super();\n        this.compare = compare ?? this.defaultCompare();\n        this.validKey = isValidKey ?? ((v: unknown) => v != null && v != undefined );\n    }\n\n    delete(element: unknown) {\n        if (!this.validKey(element)) return false;\n        return this._delete(element as E) != null;\n    }\n\n    deleteAll(elements: Iterable<unknown>) {\n        for (const element of elements) {\n            this.delete(element);\n        }\n    }\n\n    forEach(f: (element: E, element2: E, set: Set<E>) => void) {\n        const nodes: Iterator<E> = this[Symbol.iterator]();\n        let result: IteratorResult<E>;\n        while (result = nodes.next(), !result.done) {\n            f(result.value, result.value, this);\n        }\n    }\n\n    add(element: E) {\n        const compare = this.splay(element);\n        if (compare != 0) this.addNewRoot(new SplayTreeSetNode(element), compare);\n        return this;\n    }\n\n    addAndReturn(element: E) {\n        const compare = this.splay(element);\n        if (compare != 0) this.addNewRoot(new SplayTreeSetNode(element), compare);\n        return this.root!.key;\n    }\n\n    addAll(elements: Iterable<E>) {\n        for (const element of elements) {\n            this.add(element);\n        }\n    }\n\n    isEmpty() {\n        return this.root == null;\n    }\n\n    isNotEmpty() {\n        return this.root != null;\n    }\n\n    single() {\n        if (this.size == 0) throw \"Bad state: No element\";\n        if (this.size > 1) throw \"Bad state: Too many element\";\n        return this.root!.key;\n    }\n\n    first() {\n        if (this.size == 0) throw \"Bad state: No element\";\n        return this._first()!.key;\n    }\n\n    last() {\n        if (this.size == 0) throw \"Bad state: No element\";\n        return this._last()!.key;\n    }\n\n    lastBefore(element: E) {\n        if (element == null) throw \"Invalid arguments(s)\";\n        if (this.root == null) return null;\n        const comp = this.splay(element);\n        if (comp < 0) return this.root!.key;\n        let node: SplayTreeSetNode<E> | null = this.root!.left;\n        if (node == null) return null;\n        let nodeRight = node.right;\n        while (nodeRight != null) {\n            node = nodeRight;\n            nodeRight = node.right;\n        }\n        return node!.key;\n    }\n\n    firstAfter(element: E) {\n        if (element == null) throw \"Invalid arguments(s)\";\n        if (this.root == null) return null;\n        const comp = this.splay(element);\n        if (comp > 0) return this.root!.key;\n        let node: SplayTreeSetNode<E> | null = this.root!.right;\n        if (node == null) return null;\n        let nodeLeft = node.left;\n        while (nodeLeft != null) {\n            node = nodeLeft;\n            nodeLeft = node.left;\n        }\n        return node!.key;\n    }\n\n    retainAll(elements: Iterable<unknown>) {\n        const retainSet = new SplayTreeSet<E>(this.compare, this.validKey);\n        const modificationCount = this.modificationCount;\n        for (const object of elements) {\n            if (modificationCount != this.modificationCount) {\n                throw \"Concurrent modification during iteration.\";\n            }\n            if (this.validKey(object) && this.splay(object as E) == 0) {\n                retainSet.add(this.root!.key);\n            }\n        }\n        if (retainSet.size != this.size) {\n            this.root = retainSet.root;\n            this.size = retainSet.size;\n            this.modificationCount++;\n        }\n    }\n\n    lookup(object: unknown): E | null {\n        if (!this.validKey(object)) return null;\n        const comp = this.splay(object as E);\n        if (comp != 0) return null;\n        return this.root!.key;\n    }\n\n    intersection(other: Set<unknown>): Set<E> {\n        const result = new SplayTreeSet<E>(this.compare, this.validKey);\n        for (const element of this) {\n            if (other.has(element)) result.add(element);\n        }\n        return result;\n    }\n\n    difference(other: Set<unknown>): Set<E> {\n        const result = new SplayTreeSet<E>(this.compare, this.validKey);\n        for (const element of this) {\n            if (!other.has(element)) result.add(element);\n        }\n        return result;\n    }\n\n    union(other: Set<E>): Set<E> {\n        const u = this.clone();\n        u.addAll(other);\n        return u;\n    }\n\n    protected clone() {\n        const set = new SplayTreeSet<E>(this.compare, this.validKey);\n        set.size = this.size;\n        set.root = this.copyNode<SplayTreeSetNode<E>>(this.root);\n        return set;\n    }\n\n    protected copyNode<Node extends SplayTreeNode<E, Node>>(node: Node | null) {\n        if (node == null) return null;\n        function copyChildren(node: Node, dest: SplayTreeSetNode<E>) {\n            let left: Node | null;\n            let right: Node | null;\n            do {\n                left = node.left;\n                right = node.right;\n                if (left != null) {\n                    const newLeft = new SplayTreeSetNode<E>(left.key);\n                    dest.left = newLeft;\n                    copyChildren(left, newLeft);\n                }\n                if (right != null) {\n                    const newRight = new SplayTreeSetNode<E>(right.key);\n                    dest.right = newRight;\n                    node = right;\n                    dest = newRight;\n                }\n            } while (right != null);\n        }\n\n        const result = new SplayTreeSetNode<E>(node.key);\n        copyChildren(node, result);\n        return result;\n    }\n\n    toSet(): Set<E> {\n        return this.clone();\n    }\n\n    entries(): IterableIterator<[E, E]> {\n        return new SplayTreeSetEntryIterableIterator<E, SplayTreeSetNode<E>>(this.wrap());\n    }\n\n    keys(): IterableIterator<E> {\n        return this[Symbol.iterator]();\n    }\n    \n    values(): IterableIterator<E> {\n        return this[Symbol.iterator]();\n    }\n\n    [Symbol.iterator](): IterableIterator<E> {\n        return new SplayTreeKeyIterableIterator<E, SplayTreeSetNode<E>>(this.wrap());\n    }\n\n    [Symbol.toStringTag] = '[object Set]'\n}\n\ninterface SplayTreeWrapper<K, Node extends SplayTreeNode<K, Node>> {\n    getRoot: () => Node | null;\n    setRoot: (root: Node | null) => void;\n    getSize: () => number;\n    getModificationCount: () => number;\n    getSplayCount: () => number;\n    setSplayCount: (count: number) => void;\n    splay: (key: K) => number;\n    has: (key: unknown) => boolean;\n}\n\ntype SplayTreeMapWrapper<K, V> = SplayTreeWrapper<K, SplayTreeMapNode<K, V>>;\n\nabstract class SplayTreeIterableIterator<K, Node extends SplayTreeNode<K, Node>, T> implements IterableIterator<T> {\n    protected readonly tree: SplayTreeWrapper<K, Node>;\n\n    protected readonly path = new Array<Node>();\n\n    protected modificationCount: number | null = null;\n\n    protected splayCount: number;\n\n    constructor(tree: SplayTreeWrapper<K, Node>) {\n        this.tree = tree;\n        this.splayCount = tree.getSplayCount();\n    }\n\n    [Symbol.iterator](): IterableIterator<T> {\n        return this;\n    }\n\n    next(): IteratorResult<T, null> {\n        if (this.moveNext()) return { done: false, value: this.current()! }\n        return { done: true, value: null }\n    }\n\n    protected current() {\n        if (!this.path.length) return null;\n        const node = this.path[this.path.length - 1];\n        return this.getValue(node);\n    }\n\n    protected rebuildPath(key: K) {\n        this.path.splice(0, this.path.length)\n        this.tree.splay(key);\n        this.path.push(this.tree.getRoot()!);\n        this.splayCount = this.tree.getSplayCount();\n    }\n\n    protected findLeftMostDescendent(node: Node | null) {\n        while (node != null) {\n            this.path.push(node);\n            node = node.left;\n        }\n    }\n\n    protected moveNext() {\n        if (this.modificationCount != this.tree.getModificationCount()) {\n            if (this.modificationCount == null) {\n                this.modificationCount = this.tree.getModificationCount();\n                let node = this.tree.getRoot();\n                while (node != null) {\n                    this.path.push(node);\n                    node = node.left;\n                }\n                return this.path.length > 0;\n            }\n            throw \"Concurrent modification during iteration.\";\n        }\n        if (!this.path.length) return false;\n        if (this.splayCount != this.tree.getSplayCount()) {\n            this.rebuildPath(this.path[this.path.length - 1].key);\n        }\n        let node = this.path[this.path.length - 1];\n        let next = node.right;\n        if (next != null) {\n            while (next != null) {\n                this.path.push(next);\n                next = next.left;\n            }\n            return true;\n        }\n        this.path.pop();\n        while (this.path.length && this.path[this.path.length - 1].right === node) {\n            node = this.path.pop()!;\n        }\n        return this.path.length > 0;\n    }\n\n    protected abstract getValue(node: Node): T\n}\n\nclass SplayTreeKeyIterableIterator<K, Node extends SplayTreeNode<K, Node>> extends SplayTreeIterableIterator<K, Node, K> {\n\n    protected getValue(node: Node) {\n        return node.key;\n    }\n}\n\nclass SplayTreeSetEntryIterableIterator<K, Node extends SplayTreeNode<K, Node>> extends SplayTreeIterableIterator<K, Node, [K, K]> {\n\n    protected getValue(node: Node): [K, K] {\n        return [node.key, node.key];\n    }\n}\n\nclass SplayTreeValueIterableIterator<K, V> extends SplayTreeIterableIterator<K, SplayTreeMapNode<K, V>, V> {\n\n    constructor(map: SplayTreeMapWrapper<K, V>) {\n        super(map);\n    }\n\n    protected getValue(node: SplayTreeMapNode<K, V>) {\n        return node.value;\n    }\n}\n\nclass SplayTreeMapEntryIterableIterator<K, V> extends SplayTreeIterableIterator<K, SplayTreeMapNode<K, V>, [K, V]> {\n\n    constructor(map: SplayTreeMapWrapper<K, V>) {\n        super(map);\n    }\n\n    protected getValue(node: SplayTreeMapNode<K, V>): [K, V] {\n        return [node.key, node.value];\n    }\n\n    replaceValue(value: V) {\n        if (this.modificationCount != this.tree.getModificationCount()) {\n            throw \"Concurrent modification during iteration.\";\n        }\n        if (this.splayCount != this.tree.getSplayCount()) {\n            this.rebuildPath(this.path[this.path.length - 1].key);\n        }\n        const last = this.path.pop()!;\n        const newLast = last.replaceValue(value);\n        if (!this.path.length) {\n            this.tree.setRoot(newLast);\n        } else {\n            const parent = this.path[this.path.length - 1];\n            if (last === parent.left) {\n                parent.left = newLast;\n            } else {\n                parent.right = newLast;\n            }\n        }\n        this.path.push(newLast);\n        const count = this.tree.getSplayCount() + 1;\n        this.tree.setSplayCount(count);\n        this.splayCount = count;\n    }\n}", "import BigNumber from \"bignumber.js\";\nimport { Bbox } from \"./bbox.js\";\nimport { precision } from \"./precision.js\";\nimport Segment from \"./segment.js\";\nimport { Point } from \"./sweep-event.js\";\n\nexport type Ring = [number, number][]\nexport type Poly = Ring[]\nexport type MultiPoly = Poly[]\nexport type Geom = Poly | MultiPoly\n\nexport class RingIn {\n  poly: PolyIn\n  isExterior: boolean\n  segments: Segment[]\n  bbox: Bbox\n\n  constructor(geomRing: Ring, poly: PolyIn, isExterior: boolean) {\n    if (!Array.isArray(geomRing) || geomRing.length === 0) {\n      throw new Error(\"Input geometry is not a valid Polygon or MultiPolygon\")\n    }\n\n    this.poly = poly\n    this.isExterior = isExterior\n    this.segments = []\n\n    if (\n      typeof geomRing[0][0] !== \"number\" ||\n      typeof geomRing[0][1] !== \"number\"\n    ) {\n      throw new Error(\"Input geometry is not a valid Polygon or MultiPolygon\")\n    }\n\n    const firstPoint = precision.snap({ x: new BigNumber(geomRing[0][0]), y: new BigNumber(geomRing[0][1]) }) as Point\n    this.bbox = {\n      ll: { x: firstPoint.x, y: firstPoint.y },\n      ur: { x: firstPoint.x, y: firstPoint.y },\n    }\n\n    let prevPoint = firstPoint\n    for (let i = 1, iMax = geomRing.length; i < iMax; i++) {\n      if (\n        typeof geomRing[i][0] !== \"number\" ||\n        typeof geomRing[i][1] !== \"number\"\n      ) {\n        throw new Error(\"Input geometry is not a valid Polygon or MultiPolygon\")\n      }\n      const point = precision.snap({ x: new BigNumber(geomRing[i][0]), y: new BigNumber(geomRing[i][1]) }) as Point\n      // skip repeated points\n      if (point.x.eq(prevPoint.x) && point.y.eq(prevPoint.y)) continue\n      this.segments.push(Segment.fromRing(prevPoint, point, this))\n      if (point.x.isLessThan(this.bbox.ll.x)) this.bbox.ll.x = point.x\n      if (point.y.isLessThan(this.bbox.ll.y)) this.bbox.ll.y = point.y\n      if (point.x.isGreaterThan(this.bbox.ur.x)) this.bbox.ur.x = point.x\n      if (point.y.isGreaterThan(this.bbox.ur.y)) this.bbox.ur.y = point.y\n      prevPoint = point\n    }\n    // add segment from last to first if last is not the same as first\n    if (!firstPoint.x.eq(prevPoint.x) || !firstPoint.y.eq(prevPoint.y)) {\n      this.segments.push(Segment.fromRing(prevPoint, firstPoint, this))\n    }\n  }\n\n  getSweepEvents() {\n    const sweepEvents = []\n    for (let i = 0, iMax = this.segments.length; i < iMax; i++) {\n      const segment = this.segments[i]\n      sweepEvents.push(segment.leftSE)\n      sweepEvents.push(segment.rightSE)\n    }\n    return sweepEvents\n  }\n}\n\nexport class PolyIn {\n  multiPoly: MultiPolyIn\n  exteriorRing: RingIn\n  interiorRings: RingIn[]\n  bbox: Bbox\n\n  constructor(geomPoly: Poly, multiPoly: MultiPolyIn) {\n    if (!Array.isArray(geomPoly)) {\n      throw new Error(\"Input geometry is not a valid Polygon or MultiPolygon\")\n    }\n    this.exteriorRing = new RingIn(geomPoly[0], this, true)\n    // copy by value\n    this.bbox = {\n      ll: { x: this.exteriorRing.bbox.ll.x, y: this.exteriorRing.bbox.ll.y },\n      ur: { x: this.exteriorRing.bbox.ur.x, y: this.exteriorRing.bbox.ur.y },\n    }\n    this.interiorRings = []\n    for (let i = 1, iMax = geomPoly.length; i < iMax; i++) {\n      const ring = new RingIn(geomPoly[i], this, false)\n      if (ring.bbox.ll.x.isLessThan(this.bbox.ll.x)) this.bbox.ll.x = ring.bbox.ll.x\n      if (ring.bbox.ll.y.isLessThan(this.bbox.ll.y)) this.bbox.ll.y = ring.bbox.ll.y\n      if (ring.bbox.ur.x.isGreaterThan(this.bbox.ur.x)) this.bbox.ur.x = ring.bbox.ur.x\n      if (ring.bbox.ur.y.isGreaterThan(this.bbox.ur.y)) this.bbox.ur.y = ring.bbox.ur.y\n      this.interiorRings.push(ring)\n    }\n    this.multiPoly = multiPoly\n  }\n\n  getSweepEvents() {\n    const sweepEvents = this.exteriorRing.getSweepEvents()\n    for (let i = 0, iMax = this.interiorRings.length; i < iMax; i++) {\n      const ringSweepEvents = this.interiorRings[i].getSweepEvents()\n      for (let j = 0, jMax = ringSweepEvents.length; j < jMax; j++) {\n        sweepEvents.push(ringSweepEvents[j])\n      }\n    }\n    return sweepEvents\n  }\n}\n\nexport class MultiPolyIn {\n  isSubject: boolean\n  polys: PolyIn[]\n  bbox: Bbox\n\n  constructor(geom: Geom, isSubject: boolean) {\n    if (!Array.isArray(geom)) {\n      throw new Error(\"Input geometry is not a valid Polygon or MultiPolygon\")\n    }\n\n    try {\n      // if the input looks like a polygon, convert it to a multipolygon\n      if (typeof geom[0][0][0] === \"number\") geom = [geom as Poly]\n    } catch (ex) {\n      // The input is either malformed or has empty arrays.\n      // In either case, it will be handled later on.\n    }\n\n    this.polys = []\n    this.bbox = {\n      ll: { x: new BigNumber(Number.POSITIVE_INFINITY), y: new BigNumber(Number.POSITIVE_INFINITY) },\n      ur: { x: new BigNumber(Number.NEGATIVE_INFINITY), y: new BigNumber(Number.NEGATIVE_INFINITY) },\n    }\n    for (let i = 0, iMax = geom.length; i < iMax; i++) {\n      const poly = new PolyIn(geom[i] as Poly, this)\n      if (poly.bbox.ll.x.isLessThan(this.bbox.ll.x)) this.bbox.ll.x = poly.bbox.ll.x\n      if (poly.bbox.ll.y.isLessThan(this.bbox.ll.y)) this.bbox.ll.y = poly.bbox.ll.y\n      if (poly.bbox.ur.x.isGreaterThan(this.bbox.ur.x)) this.bbox.ur.x = poly.bbox.ur.x\n      if (poly.bbox.ur.y.isGreaterThan(this.bbox.ur.y)) this.bbox.ur.y = poly.bbox.ur.y\n      this.polys.push(poly)\n    }\n    this.isSubject = isSubject\n  }\n\n  getSweepEvents() {\n    const sweepEvents = []\n    for (let i = 0, iMax = this.polys.length; i < iMax; i++) {\n      const polySweepEvents = this.polys[i].getSweepEvents()\n      for (let j = 0, jMax = polySweepEvents.length; j < jMax; j++) {\n        sweepEvents.push(polySweepEvents[j])\n      }\n    }\n    return sweepEvents\n  }\n}\n", "export default <T>(x: T) => {\n    return () => {\n        return x\n    }\n}", "import BigNumber from \"bignumber.js\"\nimport constant from \"./constant.js\"\n\nexport default (eps?: number) => {\n    const almostEqual = eps ? (a: BigNumber, b: BigNumber) =>\n        b.minus(a).abs().isLessThanOrEqualTo(eps)\n        : constant(false)\n\n    return (a: BigNumber, b: BigNumber) => {\n        if (almostEqual(a, b)) return 0\n\n        return a.comparedTo(b)\n    }\n}", "import BigNumber from \"bignumber.js\";\nimport constant from \"./constant.js\";\nimport { Vector } from \"./vector.js\";\n\nexport default function (eps?: number) {\n    const almostCollinear = eps ? (area2: BigNumber, ax: BigNumber, ay: BigNumber, cx: BigNumber, cy: BigNumber) =>\n        area2.exponentiatedBy(2).isLessThanOrEqualTo(\n            cx.minus(ax).exponentiatedBy(2).plus(cy.minus(ay).exponentiatedBy(2))\n                .times(eps))\n        : constant(false)\n\n    return (a: Vector, b: Vector, c: Vector) => {\n        const ax = a.x, ay = a.y, cx = c.x, cy = c.y\n\n        const area2 = ay.minus(cy).times(b.x.minus(cx)).minus(ax.minus(cx).times(b.y.minus(cy)))\n\n        if (almostCollinear(area2, ax, ay, cx, cy)) return 0\n\n        return area2.comparedTo(0)\n    }\n}", "import BigNumber from \"bignumber.js\";\nimport { SplayTreeSet } from \"splaytree-ts\"\nimport compare from \"./compare.js\";\nimport identity from \"./identity.js\";\nimport { Vector } from \"./vector.js\";\n\nexport default (eps?: number) => {\n  if (eps) {\n\n    const xTree = new SplayTreeSet(compare(eps))\n    const yTree = new SplayTreeSet(compare(eps))\n\n    const snapCoord = (coord: BigNumber, tree: SplayTreeSet<BigNumber>) => {\n      return tree.addAndReturn(coord)\n    }\n\n    const snap = (v: Vector) => {\n      return {\n        x: snapCoord(v.x, xTree),\n        y: snapCoord(v.y, yTree),\n      } as Vector\n    }\n\n    snap({ x: new BigNumber(0), y: new BigNumber(0)})\n\n    return snap\n  }\n\n  return identity<Vector>\n}", "export default <T>(x: T) => {\n    return x;\n}", "import compare from \"./compare.js\";\nimport orient from \"./orient.js\";\nimport snap from \"./snap.js\";\n\nconst set = (eps?: number) => {\n    return {\n        set: (eps?: number) => { precision = set(eps) },\n        reset: () => set(eps),\n        compare: compare(eps),\n        snap: snap(eps),\n        orient: orient(eps)\n    }\n}\n\nexport let precision: ReturnType<typeof set> = set()", "import { Vector } from \"./vector.js\";\n\nexport interface Bbox {\n  ll: Vector;\n  ur: Vector;\n}\n\n/**\n * A bounding box has the format:\n *\n *  { ll: { x: xmin, y: ymin }, ur: { x: xmax, y: ymax } }\n *\n */\n\nexport const isInBbox = (bbox: Bbox, point: Vector) => {\n  return (\n    bbox.ll.x.isLessThanOrEqualTo(point.x) &&\n    point.x.isLessThanOrEqualTo(bbox.ur.x) &&\n    bbox.ll.y.isLessThanOrEqualTo(point.y) &&\n    point.y.isLessThanOrEqualTo(bbox.ur.y) \n  )\n}\n\n/* Returns either null, or a bbox (aka an ordered pair of points)\n * If there is only one point of overlap, a bbox with identical points\n * will be returned */\nexport const getBboxOverlap = (b1: Bbox, b2: Bbox) => {\n  // check if the bboxes overlap at all\n  if (\n    b2.ur.x.isLessThan(b1.ll.x) ||\n    b1.ur.x.isLessThan(b2.ll.x) ||\n    b2.ur.y.isLessThan(b1.ll.y) ||\n    b1.ur.y.isLessThan(b2.ll.y) \n  )\n    return null\n\n  // find the middle two X values\n  const lowerX = b1.ll.x.isLessThan(b2.ll.x) ? b2.ll.x : b1.ll.x\n  const upperX = b1.ur.x.isLessThan(b2.ur.x) ? b1.ur.x : b2.ur.x\n\n  // find the middle two Y values\n  const lowerY = b1.ll.y.isLessThan(b2.ll.y) ? b2.ll.y : b1.ll.y\n  const upperY = b1.ur.y.isLessThan(b2.ur.y) ? b1.ur.y : b2.ur.y\n\n  // put those middle values together to get the overlap\n  return { ll: { x: lowerX, y: lowerY }, ur: { x: upperX, y: upperY } } as Bbox\n}\n", "import { SplayTreeSet } from \"splaytree-ts\"\nimport { getBboxOverlap } from \"./bbox.js\"\nimport * as geomIn from \"./geom-in.js\"\nimport { Geom } from \"./geom-in.js\"\nimport * as geomOut from \"./geom-out.js\"\nimport { precision } from \"./precision.js\"\nimport SweepEvent from \"./sweep-event.js\"\nimport SweepLine from \"./sweep-line.js\"\n\nexport class Operation {\n  type!: string\n  numMultiPolys!: number\n\n  run(type: string, geom: Geom, moreGeoms: Geom[]) {\n    operation.type = type\n\n    /* Convert inputs to MultiPoly objects */\n    const multipolys = [new geomIn.MultiPolyIn(geom, true)]\n    for (let i = 0, iMax = moreGeoms.length; i < iMax; i++) {\n      multipolys.push(new geomIn.MultiPolyIn(moreGeoms[i], false))\n    }\n    operation.numMultiPolys = multipolys.length\n\n    /* BBox optimization for difference operation\n     * If the bbox of a multipolygon that's part of the clipping doesn't\n     * intersect the bbox of the subject at all, we can just drop that\n     * multiploygon. */\n    if (operation.type === \"difference\") {\n      // in place removal\n      const subject = multipolys[0]\n      let i = 1\n      while (i < multipolys.length) {\n        if (getBboxOverlap(multipolys[i].bbox, subject.bbox) !== null) i++\n        else multipolys.splice(i, 1)\n      }\n    }\n\n    /* BBox optimization for intersection operation\n     * If we can find any pair of multipolygons whose bbox does not overlap,\n     * then the result will be empty. */\n    if (operation.type === \"intersection\") {\n      // TODO: this is O(n^2) in number of polygons. By sorting the bboxes,\n      //       it could be optimized to O(n * ln(n))\n      for (let i = 0, iMax = multipolys.length; i < iMax; i++) {\n        const mpA = multipolys[i]\n        for (let j = i + 1, jMax = multipolys.length; j < jMax; j++) {\n          if (getBboxOverlap(mpA.bbox, multipolys[j].bbox) === null) return []\n        }\n      }\n    }\n\n    /* Put segment endpoints in a priority queue */\n    const queue = new SplayTreeSet(SweepEvent.compare)\n    for (let i = 0, iMax = multipolys.length; i < iMax; i++) {\n      const sweepEvents = multipolys[i].getSweepEvents()\n      for (let j = 0, jMax = sweepEvents.length; j < jMax; j++) {\n        queue.add(sweepEvents[j])\n      }\n    }\n\n    /* Pass the sweep line over those endpoints */\n    const sweepLine = new SweepLine(queue)\n    let evt = null\n    if (queue.size != 0) {\n      evt = queue.first()\n      queue.delete(evt)\n    }\n    while (evt) {\n      const newEvents = sweepLine.process(evt)\n      for (let i = 0, iMax = newEvents.length; i < iMax; i++) {\n        const evt = newEvents[i]\n        if (evt.consumedBy === undefined) queue.add(evt)\n      }\n      if (queue.size != 0) {\n        evt = queue.first()\n        queue.delete(evt)\n      } else {\n        evt = null;\n      }\n    }\n\n    // free some memory we don't need anymore\n    precision.reset()\n\n    /* Collect and compile segments we're keeping into a multipolygon */\n    const ringsOut = geomOut.RingOut.factory(sweepLine.segments)\n    const result = new geomOut.MultiPolyOut(ringsOut)\n    return result.getGeom()\n  }\n}\n\n// singleton available by import\nconst operation = new Operation()\n\nexport default operation\n", "import * as bn from \"bignumber.js\";\n\nexport interface Vector {\n  x: bn.BigNumber;\n  y: bn.BigNumber;\n}\n\n/* Cross Product of two vectors with first point at origin */\nexport const crossProduct = (a: Vector, b: Vector) => a.x.times(b.y).minus(a.y.times(b.x))\n\n/* Dot Product of two vectors with first point at origin */\nexport const dotProduct = (a: Vector, b: Vector) => a.x.times(b.x).plus(a.y.times(b.y))\n\nexport const length = (v: Vector) => dotProduct(v, v).sqrt()\n\n/* Get the sine of the angle from pShared -> pAngle to pShaed -> pBase */\nexport const sineOfAngle = (pShared: Vector, pBase: Vector, pAngle: Vector) => {\n  const vBase = { x: pBase.x.minus(pShared.x), y: pBase.y.minus(pShared.y) }\n  const vAngle = { x: pAngle.x.minus(pShared.x), y: pAngle.y.minus(pShared.y) }\n  return crossProduct(vAngle, vBase).div(length(vAngle)).div(length(vBase))\n}\n\n/* Get the cosine of the angle from pShared -> pAngle to pShaed -> pBase */\nexport const cosineOfAngle = (pShared: Vector, pBase: Vector, pAngle: Vector) => {\n  const vBase = { x: pBase.x.minus(pShared.x), y: pBase.y.minus(pShared.y) }\n  const vAngle = { x: pAngle.x.minus(pShared.x), y: pAngle.y.minus(pShared.y) }\n  return dotProduct(vAngle, vBase).div(length(vAngle)).div(length(vBase))\n}\n\n/* Get the x coordinate where the given line (defined by a point and vector)\n * crosses the horizontal line with the given y coordiante.\n * In the case of parrallel lines (including overlapping ones) returns null. */\nexport const horizontalIntersection = (pt: Vector, v: Vector, y: bn.BigNumber) => {\n  if (v.y.isZero()) return null\n  return { x: pt.x.plus((v.x.div(v.y)).times(y.minus(pt.y))), y: y }\n}\n\n/* Get the y coordinate where the given line (defined by a point and vector)\n * crosses the vertical line with the given x coordiante.\n * In the case of parrallel lines (including overlapping ones) returns null. */\nexport const verticalIntersection = (pt: Vector, v: Vector, x: bn.BigNumber) => {\n  if (v.x.isZero()) return null\n  return { x: x, y: pt.y.plus((v.y.div(v.x)).times(x.minus(pt.x))) }\n}\n\n/* Get the intersection of two lines, each defined by a base point and a vector.\n * In the case of parrallel lines (including overlapping ones) returns null. */\nexport const intersection = (pt1: Vector, v1: Vector, pt2: Vector, v2: Vector) => {\n  // take some shortcuts for vertical and horizontal lines\n  // this also ensures we don't calculate an intersection and then discover\n  // it's actually outside the bounding box of the line\n  if (v1.x.isZero()) return verticalIntersection(pt2, v2, pt1.x)\n  if (v2.x.isZero()) return verticalIntersection(pt1, v1, pt2.x)\n  if (v1.y.isZero()) return horizontalIntersection(pt2, v2, pt1.y)\n  if (v2.y.isZero()) return horizontalIntersection(pt1, v1, pt2.y)\n\n  // General case for non-overlapping segments.\n  // This algorithm is based on Schneider and Eberly.\n  // http://www.cimec.org.ar/~ncalvo/Schneider_Eberly.pdf - pg 244\n\n  const kross = crossProduct(v1, v2)\n  if (kross.isZero()) return null\n\n  const ve = { x: pt2.x.minus(pt1.x), y: pt2.y.minus(pt1.y) }\n  const d1 = crossProduct(ve, v1).div(kross)\n  const d2 = crossProduct(ve, v2).div(kross)\n\n  // take the average of the two calculations to minimize rounding error\n  const x1 = pt1.x.plus(d2.times(v1.x)),\n    x2 = pt2.x.plus(d1.times(v2.x))\n  const y1 = pt1.y.plus(d2.times(v1.y)),\n    y2 = pt2.y.plus(d1.times(v2.y))\n  const x = x1.plus(x2).div(2)\n  const y = y1.plus(y2).div(2)\n  return { x: x, y: y } as Vector\n}\n\n/* Given a vector, return one that is perpendicular */\nexport const perpendicular = (v: Vector) => {\n  return { x: v.y.negated(), y: v.x }\n}", "import BigNumber from \"bignumber.js\";\nimport Segment from \"./segment.js\"\nimport { cosineOfAngle, sineOfAngle, Vector } from \"./vector.js\"\n\nexport interface Point extends Vector {\n  events: SweepEvent[];\n}\n\nexport default class SweepEvent {\n  point: Point;\n  isLeft: boolean;\n  segment!: Segment;\n  otherSE!: SweepEvent;\n  consumedBy: SweepEvent | undefined;\n\n  // for ordering sweep events in the sweep event queue\n  static compare(a: SweepEvent, b: SweepEvent) {\n    // favor event with a point that the sweep line hits first\n    const ptCmp = SweepEvent.comparePoints(a.point, b.point)\n    if (ptCmp !== 0) return ptCmp\n\n    // the points are the same, so link them if needed\n    if (a.point !== b.point) a.link(b)\n\n    // favor right events over left\n    if (a.isLeft !== b.isLeft) return a.isLeft ? 1 : -1\n\n    // we have two matching left or right endpoints\n    // ordering of this case is the same as for their segments\n    return Segment.compare(a.segment, b.segment)\n  }\n\n  // for ordering points in sweep line order\n  static comparePoints(aPt: Point, bPt: Point) {\n    if (aPt.x.isLessThan(bPt.x)) return -1\n    if (aPt.x.isGreaterThan(bPt.x)) return 1\n\n    if (aPt.y.isLessThan(bPt.y)) return -1\n    if (aPt.y.isGreaterThan(bPt.y)) return 1\n\n    return 0\n  }\n\n  // Warning: 'point' input will be modified and re-used (for performance)\n  constructor(point: Point, isLeft: boolean) {\n    if (point.events === undefined) point.events = [this]\n    else point.events.push(this)\n    this.point = point\n    this.isLeft = isLeft\n    // this.segment, this.otherSE set by factory\n  }\n\n  link(other: SweepEvent) {\n    if (other.point === this.point) {\n      throw new Error(\"Tried to link already linked events\")\n    }\n    const otherEvents = other.point.events\n    for (let i = 0, iMax = otherEvents.length; i < iMax; i++) {\n      const evt = otherEvents[i]\n      this.point.events.push(evt)\n      evt.point = this.point\n    }\n    this.checkForConsuming()\n  }\n\n  /* Do a pass over our linked events and check to see if any pair\n   * of segments match, and should be consumed. */\n  checkForConsuming() {\n    // FIXME: The loops in this method run O(n^2) => no good.\n    //        Maintain little ordered sweep event trees?\n    //        Can we maintaining an ordering that avoids the need\n    //        for the re-sorting with getLeftmostComparator in geom-out?\n\n    // Compare each pair of events to see if other events also match\n    const numEvents = this.point.events.length\n    for (let i = 0; i < numEvents; i++) {\n      const evt1 = this.point.events[i]\n      if (evt1.segment.consumedBy !== undefined) continue\n      for (let j = i + 1; j < numEvents; j++) {\n        const evt2 = this.point.events[j]\n        if (evt2.consumedBy !== undefined) continue\n        if (evt1.otherSE.point.events !== evt2.otherSE.point.events) continue\n        evt1.segment.consume(evt2.segment)\n      }\n    }\n  }\n\n  getAvailableLinkedEvents() {\n    // point.events is always of length 2 or greater\n    const events = []\n    for (let i = 0, iMax = this.point.events.length; i < iMax; i++) {\n      const evt = this.point.events[i]\n      if (evt !== this && !evt.segment.ringOut && evt.segment.isInResult()) {\n        events.push(evt)\n      }\n    }\n    return events\n  }\n\n  /**\n   * Returns a comparator function for sorting linked events that will\n   * favor the event that will give us the smallest left-side angle.\n   * All ring construction starts as low as possible heading to the right,\n   * so by always turning left as sharp as possible we'll get polygons\n   * without uncessary loops & holes.\n   *\n   * The comparator function has a compute cache such that it avoids\n   * re-computing already-computed values.\n   */\n  getLeftmostComparator(baseEvent: SweepEvent) {\n    const cache = new Map<SweepEvent, { sine: BigNumber, cosine: BigNumber }>()\n\n    const fillCache = (linkedEvent: SweepEvent) => {\n      const nextEvent = linkedEvent.otherSE\n      cache.set(linkedEvent, {\n        sine: sineOfAngle(this.point, baseEvent.point, nextEvent.point),\n        cosine: cosineOfAngle(this.point, baseEvent.point, nextEvent.point),\n      })\n    }\n\n    return (a: SweepEvent, b: SweepEvent) => {\n      if (!cache.has(a)) fillCache(a)\n      if (!cache.has(b)) fillCache(b)\n\n      const { sine: asine, cosine: acosine } = cache.get(a)!\n      const { sine: bsine, cosine: bcosine } = cache.get(b)!\n\n      // both on or above x-axis\n      if (asine.isGreaterThanOrEqualTo(0) && bsine.isGreaterThanOrEqualTo(0)) {\n        if (acosine.isLessThan(bcosine)) return 1\n        if (acosine.isGreaterThan(bcosine)) return -1\n        return 0\n      }\n\n      // both below x-axis\n      if (asine.isLessThan(0) && bsine.isLessThan(0)) {\n        if (acosine.isLessThan(bcosine)) return -1\n        if (acosine.isGreaterThan(bcosine)) return 1\n        return 0\n      }\n\n      // one above x-axis, one below\n      if (bsine.isLessThan(asine)) return -1\n      if (bsine.isGreaterThan(asine)) return 1\n      return 0\n    }\n  }\n}\n", "import { MultiPoly, Poly, Ring } from \"./geom-in.js\"\nimport { precision } from \"./precision.js\"\nimport Segment from \"./segment.js\"\nimport SweepEvent from \"./sweep-event.js\"\n\nexport class RingOut {\n  events: SweepEvent[]\n  poly: PolyOut | null\n  _isExteriorRing: boolean | undefined\n  _enclosingRing: RingOut | null | undefined\n  \n  /* Given the segments from the sweep line pass, compute & return a series\n   * of closed rings from all the segments marked to be part of the result */\n  static factory(allSegments: Segment[]) {\n    const ringsOut = []\n\n    for (let i = 0, iMax = allSegments.length; i < iMax; i++) {\n      const segment = allSegments[i]\n      if (!segment.isInResult() || segment.ringOut) continue\n\n      let prevEvent = null\n      let event = segment.leftSE\n      let nextEvent = segment.rightSE\n      const events = [event]\n\n      const startingPoint = event.point\n      const intersectionLEs = []\n\n      /* Walk the chain of linked events to form a closed ring */\n      while (true) {\n        prevEvent = event\n        event = nextEvent\n        events.push(event)\n\n        /* Is the ring complete? */\n        if (event.point === startingPoint) break\n\n        while (true) {\n          const availableLEs = event.getAvailableLinkedEvents()\n\n          /* Did we hit a dead end? This shouldn't happen. Indicates some earlier\n           * part of the algorithm malfunctioned... please file a bug report. */\n          if (availableLEs.length === 0) {\n            const firstPt = events[0].point\n            const lastPt = events[events.length - 1].point\n            throw new Error(\n              `Unable to complete output ring starting at [${firstPt.x},` +\n                ` ${firstPt.y}]. Last matching segment found ends at` +\n                ` [${lastPt.x}, ${lastPt.y}].`,\n            )\n          }\n\n          /* Only one way to go, so cotinue on the path */\n          if (availableLEs.length === 1) {\n            nextEvent = availableLEs[0].otherSE\n            break\n          }\n\n          /* We must have an intersection. Check for a completed loop */\n          let indexLE = null\n          for (let j = 0, jMax = intersectionLEs.length; j < jMax; j++) {\n            if (intersectionLEs[j].point === event.point) {\n              indexLE = j\n              break\n            }\n          }\n          /* Found a completed loop. Cut that off and make a ring */\n          if (indexLE !== null) {\n            const intersectionLE = intersectionLEs.splice(indexLE)[0]\n            const ringEvents = events.splice(intersectionLE.index)\n            ringEvents.unshift(ringEvents[0].otherSE)\n            ringsOut.push(new RingOut(ringEvents.reverse()))\n            continue\n          }\n          /* register the intersection */\n          intersectionLEs.push({\n            index: events.length,\n            point: event.point,\n          })\n          /* Choose the left-most option to continue the walk */\n          const comparator = event.getLeftmostComparator(prevEvent)\n          nextEvent = availableLEs.sort(comparator)[0].otherSE\n          break\n        }\n      }\n\n      ringsOut.push(new RingOut(events))\n    }\n    return ringsOut\n  }\n\n  constructor(events: SweepEvent[]) {\n    this.events = events\n    for (let i = 0, iMax = events.length; i < iMax; i++) {\n      events[i].segment.ringOut = this\n    }\n    this.poly = null\n  }\n\n  getGeom() {\n    // Remove superfluous points (ie extra points along a straight line),\n    let prevPt = this.events[0].point\n    const points = [prevPt]\n    for (let i = 1, iMax = this.events.length - 1; i < iMax; i++) {\n      const pt = this.events[i].point\n      const nextPt = this.events[i + 1].point\n      if (precision.orient(pt, prevPt, nextPt) === 0) continue\n      points.push(pt)\n      prevPt = pt\n    }\n\n    // ring was all (within rounding error of angle calc) colinear points\n    if (points.length === 1) return null\n\n    // check if the starting point is necessary\n    const pt = points[0]\n    const nextPt = points[1]\n    if (precision.orient(pt, prevPt, nextPt) === 0) points.shift()\n\n    points.push(points[0])\n    const step = this.isExteriorRing() ? 1 : -1\n    const iStart = this.isExteriorRing() ? 0 : points.length - 1\n    const iEnd = this.isExteriorRing() ? points.length : -1\n    const orderedPoints: Ring = []\n    for (let i = iStart; i != iEnd; i += step)\n      orderedPoints.push([points[i].x.toNumber(), points[i].y.toNumber()])\n    return orderedPoints\n  }\n\n  isExteriorRing(): boolean {\n    if (this._isExteriorRing === undefined) {\n      const enclosing = this.enclosingRing()\n      this._isExteriorRing = enclosing ? !enclosing.isExteriorRing() : true\n    }\n    return this._isExteriorRing\n  }\n\n  enclosingRing() {\n    if (this._enclosingRing === undefined) {\n      this._enclosingRing = this._calcEnclosingRing()\n    }\n    return this._enclosingRing\n  }\n\n  /* Returns the ring that encloses this one, if any */\n  _calcEnclosingRing(): RingOut | null | undefined {\n    // start with the ealier sweep line event so that the prevSeg\n    // chain doesn't lead us inside of a loop of ours\n    let leftMostEvt = this.events[0]\n    for (let i = 1, iMax = this.events.length; i < iMax; i++) {\n      const evt = this.events[i]\n      if (SweepEvent.compare(leftMostEvt, evt) > 0) leftMostEvt = evt\n    }\n\n    let prevSeg: Segment | null | undefined = leftMostEvt.segment.prevInResult()\n    let prevPrevSeg: Segment | null | undefined = prevSeg ? prevSeg.prevInResult() : null\n\n    while (true) {\n      // no segment found, thus no ring can enclose us\n      if (!prevSeg) return null\n\n      // no segments below prev segment found, thus the ring of the prev\n      // segment must loop back around and enclose us\n      if (!prevPrevSeg) return prevSeg.ringOut\n\n      // if the two segments are of different rings, the ring of the prev\n      // segment must either loop around us or the ring of the prev prev\n      // seg, which would make us and the ring of the prev peers\n      if (prevPrevSeg.ringOut !== prevSeg.ringOut) {\n        if (prevPrevSeg.ringOut?.enclosingRing() !== prevSeg.ringOut) {\n          return prevSeg.ringOut\n        } else return prevSeg.ringOut?.enclosingRing()\n      }\n\n      // two segments are from the same ring, so this was a penisula\n      // of that ring. iterate downward, keep searching\n      prevSeg = prevPrevSeg.prevInResult()\n      prevPrevSeg = prevSeg ? prevSeg.prevInResult() : null\n    }\n  }\n}\n\nexport class PolyOut {\n  exteriorRing: RingOut;\n  interiorRings: RingOut[];\n\n  constructor(exteriorRing: RingOut) {\n    this.exteriorRing = exteriorRing\n    exteriorRing.poly = this\n    this.interiorRings = []\n  }\n\n  addInterior(ring: RingOut) {\n    this.interiorRings.push(ring)\n    ring.poly = this\n  }\n\n  getGeom() {\n    const geom0 = this.exteriorRing.getGeom()\n    // exterior ring was all (within rounding error of angle calc) colinear points\n    if (geom0 === null) return null\n    const geom: Poly = [geom0];\n    for (let i = 0, iMax = this.interiorRings.length; i < iMax; i++) {\n      const ringGeom = this.interiorRings[i].getGeom()\n      // interior ring was all (within rounding error of angle calc) colinear points\n      if (ringGeom === null) continue\n      geom.push(ringGeom)\n    }\n    return geom\n  }\n}\n\nexport class MultiPolyOut {\n  rings: RingOut[];\n  polys: PolyOut[];\n\n  constructor(rings: RingOut[]) {\n    this.rings = rings\n    this.polys = this._composePolys(rings)\n  }\n\n  getGeom() {\n    const geom: MultiPoly = []\n    for (let i = 0, iMax = this.polys.length; i < iMax; i++) {\n      const polyGeom = this.polys[i].getGeom()\n      // exterior ring was all (within rounding error of angle calc) colinear points\n      if (polyGeom === null) continue\n      geom.push(polyGeom)\n    }\n    return geom\n  }\n\n  _composePolys(rings: RingOut[]) {\n    const polys = []\n    for (let i = 0, iMax = rings.length; i < iMax; i++) {\n      const ring = rings[i]\n      if (ring.poly) continue\n      if (ring.isExteriorRing()) polys.push(new PolyOut(ring))\n      else {\n        const enclosingRing = ring.enclosingRing()\n        if (!enclosingRing?.poly) polys.push(new PolyOut(enclosingRing!))\n        enclosingRing?.poly?.addInterior(ring)\n      }\n    }\n    return polys\n  }\n}\n", "import { SplayTreeSet } from \"splaytree-ts\"\nimport Segment from \"./segment.js\"\nimport SweepEvent, { Point } from \"./sweep-event.js\"\n\n/**\n * NOTE:  We must be careful not to change any segments while\n *        they are in the SplayTree. AFAIK, there's no way to tell\n *        the tree to rebalance itself - thus before splitting\n *        a segment that's in the tree, we remove it from the tree,\n *        do the split, then re-insert it. (Even though splitting a\n *        segment *shouldn't* change its correct position in the\n *        sweep line tree, the reality is because of rounding errors,\n *        it sometimes does.)\n */\n\nexport default class SweepLine {\n  private queue: SplayTreeSet<SweepEvent>\n  private tree: SplayTreeSet<Segment>\n  segments: Segment[]\n\n  constructor(queue: SplayTreeSet<SweepEvent>, comparator = Segment.compare) {\n    this.queue = queue\n    this.tree = new SplayTreeSet(comparator)\n    this.segments = []\n  }\n\n  process(event: SweepEvent) {\n    const segment = event.segment\n    const newEvents: SweepEvent[] = []\n\n    // if we've already been consumed by another segment,\n    // clean up our body parts and get out\n    if (event.consumedBy) {\n      if (event.isLeft) this.queue.delete(event.otherSE)\n      else this.tree.delete(segment)\n      return newEvents\n    }\n\n    if (event.isLeft) this.tree.add(segment);\n\n    let prevSeg: Segment | null = segment\n    let nextSeg: Segment | null = segment\n\n    // skip consumed segments still in tree\n    do {\n      prevSeg = this.tree.lastBefore(prevSeg)\n    } while (prevSeg != null && prevSeg.consumedBy != undefined)\n\n    // skip consumed segments still in tree\n    do {\n      nextSeg = this.tree.firstAfter(nextSeg)\n    } while (nextSeg != null && nextSeg.consumedBy != undefined)\n\n    if (event.isLeft) {\n      // Check for intersections against the previous segment in the sweep line\n      let prevMySplitter = null\n      if (prevSeg) {\n        const prevInter = prevSeg.getIntersection(segment)\n        if (prevInter !== null) {\n          if (!segment.isAnEndpoint(prevInter)) prevMySplitter = prevInter\n          if (!prevSeg.isAnEndpoint(prevInter)) {\n            const newEventsFromSplit = this._splitSafely(prevSeg, prevInter)\n            for (let i = 0, iMax = newEventsFromSplit.length; i < iMax; i++) {\n              newEvents.push(newEventsFromSplit[i])\n            }\n          }\n        }\n      }\n\n      // Check for intersections against the next segment in the sweep line\n      let nextMySplitter = null\n      if (nextSeg) {\n        const nextInter = nextSeg.getIntersection(segment)\n        if (nextInter !== null) {\n          if (!segment.isAnEndpoint(nextInter)) nextMySplitter = nextInter\n          if (!nextSeg.isAnEndpoint(nextInter)) {\n            const newEventsFromSplit = this._splitSafely(nextSeg, nextInter)\n            for (let i = 0, iMax = newEventsFromSplit.length; i < iMax; i++) {\n              newEvents.push(newEventsFromSplit[i])\n            }\n          }\n        }\n      }\n\n      // For simplicity, even if we find more than one intersection we only\n      // spilt on the 'earliest' (sweep-line style) of the intersections.\n      // The other intersection will be handled in a future process().\n      if (prevMySplitter !== null || nextMySplitter !== null) {\n        let mySplitter = null\n        if (prevMySplitter === null) mySplitter = nextMySplitter\n        else if (nextMySplitter === null) mySplitter = prevMySplitter\n        else {\n          const cmpSplitters = SweepEvent.comparePoints(\n            prevMySplitter,\n            nextMySplitter,\n          )\n          mySplitter = cmpSplitters <= 0 ? prevMySplitter : nextMySplitter\n        }\n\n        // Rounding errors can cause changes in ordering,\n        // so remove afected segments and right sweep events before splitting\n        this.queue.delete(segment.rightSE)\n        newEvents.push(segment.rightSE)\n\n        const newEventsFromSplit = segment.split(mySplitter!)\n        for (let i = 0, iMax = newEventsFromSplit.length; i < iMax; i++) {\n          newEvents.push(newEventsFromSplit[i])\n        }\n      }\n\n      if (newEvents.length > 0) {\n        // We found some intersections, so re-do the current event to\n        // make sure sweep line ordering is totally consistent for later\n        // use with the segment 'prev' pointers\n        this.tree.delete(segment)\n        newEvents.push(event)\n      } else {\n        // done with left event\n        this.segments.push(segment)\n        segment.prev = prevSeg\n      }\n    } else {\n      // event.isRight\n\n      // since we're about to be removed from the sweep line, check for\n      // intersections between our previous and next segments\n      if (prevSeg && nextSeg) {\n        const inter = prevSeg.getIntersection(nextSeg)\n        if (inter !== null) {\n          if (!prevSeg.isAnEndpoint(inter)) {\n            const newEventsFromSplit = this._splitSafely(prevSeg, inter)\n            for (let i = 0, iMax = newEventsFromSplit.length; i < iMax; i++) {\n              newEvents.push(newEventsFromSplit[i])\n            }\n          }\n          if (!nextSeg.isAnEndpoint(inter)) {\n            const newEventsFromSplit = this._splitSafely(nextSeg, inter)\n            for (let i = 0, iMax = newEventsFromSplit.length; i < iMax; i++) {\n              newEvents.push(newEventsFromSplit[i])\n            }\n          }\n        }\n      }\n\n      this.tree.delete(segment)\n    }\n\n    return newEvents\n  }\n\n  /* Safely split a segment that is currently in the datastructures\n   * IE - a segment other than the one that is currently being processed. */\n  _splitSafely(seg: Segment, pt: Point) {\n    // Rounding errors can cause changes in ordering,\n    // so remove afected segments and right sweep events before splitting\n    // removeNode() doesn't work, so have re-find the seg\n    // https://github.com/w8r/splay-tree/pull/5\n    this.tree.delete(seg)\n    const rightSE = seg.rightSE\n    this.queue.delete(rightSE)\n    const newEvents = seg.split(pt)\n    newEvents.push(rightSE)\n    // splitting can trigger consumption\n    if (seg.consumedBy === undefined) this.tree.add(seg)\n    return newEvents\n  }\n}\n", "import { getBboxOverlap, isInBbox } from \"./bbox.js\"\nimport { MultiPolyIn, RingIn } from \"./geom-in.js\"\nimport { RingOut } from \"./geom-out.js\"\nimport operation from \"./operation.js\"\nimport { precision } from \"./precision.js\"\nimport SweepEvent, { Point } from \"./sweep-event.js\"\nimport { intersection } from \"./vector.js\"\n\ninterface State {\n  rings: RingIn[],\n  windings: number[],\n  multiPolys: MultiPolyIn[]\n}\n\n// Give segments unique ID's to get consistent sorting of\n// segments and sweep events when all else is identical\nlet segmentId = 0\n\nexport default class Segment {\n  id: number\n  leftSE: SweepEvent\n  rightSE: SweepEvent\n  rings: RingIn[] | null\n  windings: number[] | null\n  ringOut: RingOut | undefined\n  consumedBy: Segment | undefined\n  prev: Segment | null | undefined\n  _prevInResult: Segment | null | undefined\n  _beforeState: State | undefined\n  _afterState: State | undefined\n  _isInResult: boolean | undefined\n\n  /* This compare() function is for ordering segments in the sweep\n   * line tree, and does so according to the following criteria:\n   *\n   * Consider the vertical line that lies an infinestimal step to the\n   * right of the right-more of the two left endpoints of the input\n   * segments. Imagine slowly moving a point up from negative infinity\n   * in the increasing y direction. Which of the two segments will that\n   * point intersect first? That segment comes 'before' the other one.\n   *\n   * If neither segment would be intersected by such a line, (if one\n   * or more of the segments are vertical) then the line to be considered\n   * is directly on the right-more of the two left inputs.\n   */\n  static compare(a: Segment, b: Segment) {\n    const alx = a.leftSE.point.x\n    const blx = b.leftSE.point.x\n    const arx = a.rightSE.point.x\n    const brx = b.rightSE.point.x\n\n    // check if they're even in the same vertical plane\n    if (brx.isLessThan(alx)) return 1\n    if (arx.isLessThan(blx)) return -1\n\n    const aly = a.leftSE.point.y\n    const bly = b.leftSE.point.y\n    const ary = a.rightSE.point.y\n    const bry = b.rightSE.point.y\n\n    // is left endpoint of segment B the right-more?\n    if (alx.isLessThan(blx)) {\n      // are the two segments in the same horizontal plane?\n      if (bly.isLessThan(aly) && bly.isLessThan(ary)) return 1\n      if (bly.isGreaterThan(aly) && bly.isGreaterThan(ary)) return -1\n\n      // is the B left endpoint colinear to segment A?\n      const aCmpBLeft = a.comparePoint(b.leftSE.point)\n      if (aCmpBLeft < 0) return 1\n      if (aCmpBLeft > 0) return -1\n\n      // is the A right endpoint colinear to segment B ?\n      const bCmpARight = b.comparePoint(a.rightSE.point)\n      if (bCmpARight !== 0) return bCmpARight\n\n      // colinear segments, consider the one with left-more\n      // left endpoint to be first (arbitrary?)\n      return -1\n    }\n\n    // is left endpoint of segment A the right-more?\n    if (alx.isGreaterThan(blx)) {\n      if (aly.isLessThan(bly) && aly.isLessThan(bry)) return -1\n      if (aly.isGreaterThan(bly) && aly.isGreaterThan(bry)) return 1\n\n      // is the A left endpoint colinear to segment B?\n      const bCmpALeft = b.comparePoint(a.leftSE.point)\n      if (bCmpALeft !== 0) return bCmpALeft\n\n      // is the B right endpoint colinear to segment A?\n      const aCmpBRight = a.comparePoint(b.rightSE.point)\n      if (aCmpBRight < 0) return 1\n      if (aCmpBRight > 0) return -1\n\n      // colinear segments, consider the one with left-more\n      // left endpoint to be first (arbitrary?)\n      return 1\n    }\n\n    // if we get here, the two left endpoints are in the same\n    // vertical plane, ie alx === blx\n\n    // consider the lower left-endpoint to come first\n    if (aly.isLessThan(bly)) return -1\n    if (aly.isGreaterThan(bly)) return 1\n\n    // left endpoints are identical\n    // check for colinearity by using the left-more right endpoint\n\n    // is the A right endpoint more left-more?\n    if (arx.isLessThan(brx)) {\n      const bCmpARight = b.comparePoint(a.rightSE.point)\n      if (bCmpARight !== 0) return bCmpARight\n    }\n\n    // is the B right endpoint more left-more?\n    if (arx.isGreaterThan(brx)) {\n      const aCmpBRight = a.comparePoint(b.rightSE.point)\n      if (aCmpBRight < 0) return 1\n      if (aCmpBRight > 0) return -1\n    }\n\n    if (!arx.eq(brx)) {\n      // are these two [almost] vertical segments with opposite orientation?\n      // if so, the one with the lower right endpoint comes first\n      const ay = ary.minus(aly)\n      const ax = arx.minus(alx)\n      const by = bry.minus(bly)\n      const bx = brx.minus(blx)\n      if (ay.isGreaterThan(ax) && by.isLessThan(bx)) return 1\n      if (ay.isLessThan(ax) && by.isGreaterThan(bx)) return -1\n    }\n\n    // we have colinear segments with matching orientation\n    // consider the one with more left-more right endpoint to be first\n    if (arx.isGreaterThan(brx)) return 1\n    if (arx.isLessThan(brx)) return -1\n\n    // if we get here, two two right endpoints are in the same\n    // vertical plane, ie arx === brx\n\n    // consider the lower right-endpoint to come first\n    if (ary.isLessThan(bry)) return -1\n    if (ary.isGreaterThan(bry)) return 1\n\n    // right endpoints identical as well, so the segments are idential\n    // fall back on creation order as consistent tie-breaker\n    if (a.id < b.id) return -1\n    if (a.id > b.id) return 1\n\n    // identical segment, ie a === b\n    return 0\n  }\n\n  /* Warning: a reference to ringWindings input will be stored,\n   *  and possibly will be later modified */\n  constructor(leftSE: SweepEvent, rightSE: SweepEvent, rings: RingIn[], windings: number[]) {\n    this.id = ++segmentId\n    this.leftSE = leftSE\n    leftSE.segment = this\n    leftSE.otherSE = rightSE\n    this.rightSE = rightSE\n    rightSE.segment = this\n    rightSE.otherSE = leftSE\n    this.rings = rings\n    this.windings = windings\n    // left unset for performance, set later in algorithm\n    // this.ringOut, this.consumedBy, this.prev\n  }\n\n  static fromRing(pt1: Point, pt2: Point, ring: RingIn) {\n    let leftPt: Point, rightPt: Point, winding: number\n\n    // ordering the two points according to sweep line ordering\n    const cmpPts = SweepEvent.comparePoints(pt1, pt2)\n    if (cmpPts < 0) {\n      leftPt = pt1\n      rightPt = pt2\n      winding = 1\n    } else if (cmpPts > 0) {\n      leftPt = pt2\n      rightPt = pt1\n      winding = -1\n    } else\n      throw new Error(\n        `Tried to create degenerate segment at [${pt1.x}, ${pt1.y}]`,\n      )\n\n    const leftSE = new SweepEvent(leftPt, true)\n    const rightSE = new SweepEvent(rightPt, false)\n    return new Segment(leftSE, rightSE, [ring], [winding])\n  }\n\n  /* When a segment is split, the rightSE is replaced with a new sweep event */\n  replaceRightSE(newRightSE: SweepEvent) {\n    this.rightSE = newRightSE\n    this.rightSE.segment = this\n    this.rightSE.otherSE = this.leftSE\n    this.leftSE.otherSE = this.rightSE\n  }\n\n  bbox() {\n    const y1 = this.leftSE.point.y\n    const y2 = this.rightSE.point.y\n    return {\n      ll: { x: this.leftSE.point.x, y: y1.isLessThan(y2) ? y1 : y2 },\n      ur: { x: this.rightSE.point.x, y: y1.isGreaterThan(y2) ? y1 : y2 },\n    }\n  }\n\n  /* A vector from the left point to the right */\n  vector() {\n    return {\n      x: this.rightSE.point.x.minus(this.leftSE.point.x),\n      y: this.rightSE.point.y.minus(this.leftSE.point.y),\n    }\n  }\n\n  isAnEndpoint(pt: Point) {\n    return (\n      (pt.x.eq(this.leftSE.point.x) && pt.y.eq(this.leftSE.point.y)) ||\n      (pt.x.eq(this.rightSE.point.x) && pt.y.eq(this.rightSE.point.y))\n    )\n  }\n\n  /* Compare this segment with a point.\n   *\n   * A point P is considered to be colinear to a segment if there\n   * exists a distance D such that if we travel along the segment\n   * from one * endpoint towards the other a distance D, we find\n   * ourselves at point P.\n   *\n   * Return value indicates:\n   *\n   *   1: point lies above the segment (to the left of vertical)\n   *   0: point is colinear to segment\n   *  -1: point lies below the segment (to the right of vertical)\n   */\n  comparePoint(point: Point) {\n    return precision.orient(this.leftSE.point, point, this.rightSE.point)\n  }\n\n  /**\n   * Given another segment, returns the first non-trivial intersection\n   * between the two segments (in terms of sweep line ordering), if it exists.\n   *\n   * A 'non-trivial' intersection is one that will cause one or both of the\n   * segments to be split(). As such, 'trivial' vs. 'non-trivial' intersection:\n   *\n   *   * endpoint of segA with endpoint of segB --> trivial\n   *   * endpoint of segA with point along segB --> non-trivial\n   *   * endpoint of segB with point along segA --> non-trivial\n   *   * point along segA with point along segB --> non-trivial\n   *\n   * If no non-trivial intersection exists, return null\n   * Else, return null.\n   */\n  getIntersection(other: Segment) {\n    // If bboxes don't overlap, there can't be any intersections\n    const tBbox = this.bbox()\n    const oBbox = other.bbox()\n    const bboxOverlap = getBboxOverlap(tBbox, oBbox)\n    if (bboxOverlap === null) return null\n\n    // We first check to see if the endpoints can be considered intersections.\n    // This will 'snap' intersections to endpoints if possible, and will\n    // handle cases of colinearity.\n\n    const tlp = this.leftSE.point\n    const trp = this.rightSE.point\n    const olp = other.leftSE.point\n    const orp = other.rightSE.point\n\n    // does each endpoint touch the other segment?\n    // note that we restrict the 'touching' definition to only allow segments\n    // to touch endpoints that lie forward from where we are in the sweep line pass\n    const touchesOtherLSE = isInBbox(tBbox, olp) && this.comparePoint(olp) === 0\n    const touchesThisLSE = isInBbox(oBbox, tlp) && other.comparePoint(tlp) === 0\n    const touchesOtherRSE = isInBbox(tBbox, orp) && this.comparePoint(orp) === 0\n    const touchesThisRSE = isInBbox(oBbox, trp) && other.comparePoint(trp) === 0\n\n    // do left endpoints match?\n    if (touchesThisLSE && touchesOtherLSE) {\n      // these two cases are for colinear segments with matching left\n      // endpoints, and one segment being longer than the other\n      if (touchesThisRSE && !touchesOtherRSE) return trp\n      if (!touchesThisRSE && touchesOtherRSE) return orp\n      // either the two segments match exactly (two trival intersections)\n      // or just on their left endpoint (one trivial intersection\n      return null\n    }\n\n    // does this left endpoint matches (other doesn't)\n    if (touchesThisLSE) {\n      // check for segments that just intersect on opposing endpoints\n      if (touchesOtherRSE) {\n        if (tlp.x.eq(orp.x) && tlp.y.eq(orp.y)) return null\n      }\n      // t-intersection on left endpoint\n      return tlp\n    }\n\n    // does other left endpoint matches (this doesn't)\n    if (touchesOtherLSE) {\n      // check for segments that just intersect on opposing endpoints\n      if (touchesThisRSE) {\n        if (trp.x.eq(olp.x) && trp.y.eq(olp.y)) return null\n      }\n      // t-intersection on left endpoint\n      return olp\n    }\n\n    // trivial intersection on right endpoints\n    if (touchesThisRSE && touchesOtherRSE) return null\n\n    // t-intersections on just one right endpoint\n    if (touchesThisRSE) return trp\n    if (touchesOtherRSE) return orp\n\n    // None of our endpoints intersect. Look for a general intersection between\n    // infinite lines laid over the segments\n    const pt = intersection(tlp, this.vector(), olp, other.vector())\n\n    // are the segments parrallel? Note that if they were colinear with overlap,\n    // they would have an endpoint intersection and that case was already handled above\n    if (pt === null) return null\n\n    // is the intersection found between the lines not on the segments?\n    if (!isInBbox(bboxOverlap, pt)) return null\n\n    // round the the computed point if needed\n    return precision.snap(pt) as Point\n  }\n\n  /**\n   * Split the given segment into multiple segments on the given points.\n   *  * Each existing segment will retain its leftSE and a new rightSE will be\n   *    generated for it.\n   *  * A new segment will be generated which will adopt the original segment's\n   *    rightSE, and a new leftSE will be generated for it.\n   *  * If there are more than two points given to split on, new segments\n   *    in the middle will be generated with new leftSE and rightSE's.\n   *  * An array of the newly generated SweepEvents will be returned.\n   *\n   * Warning: input array of points is modified\n   */\n  split(point: Point) {\n    const newEvents = []\n    const alreadyLinked = point.events !== undefined\n\n    const newLeftSE = new SweepEvent(point, true)\n    const newRightSE = new SweepEvent(point, false)\n    const oldRightSE = this.rightSE\n    this.replaceRightSE(newRightSE)\n    newEvents.push(newRightSE)\n    newEvents.push(newLeftSE)\n    const newSeg = new Segment(\n      newLeftSE,\n      oldRightSE,\n      this.rings!.slice(),\n      this.windings!.slice(),\n    )\n\n    // when splitting a nearly vertical downward-facing segment,\n    // sometimes one of the resulting new segments is vertical, in which\n    // case its left and right events may need to be swapped\n    if (\n      SweepEvent.comparePoints(newSeg.leftSE.point, newSeg.rightSE.point) > 0\n    ) {\n      newSeg.swapEvents()\n    }\n    if (SweepEvent.comparePoints(this.leftSE.point, this.rightSE.point) > 0) {\n      this.swapEvents()\n    }\n\n    // in the point we just used to create new sweep events with was already\n    // linked to other events, we need to check if either of the affected\n    // segments should be consumed\n    if (alreadyLinked) {\n      newLeftSE.checkForConsuming()\n      newRightSE.checkForConsuming()\n    }\n\n    return newEvents\n  }\n\n  /* Swap which event is left and right */\n  swapEvents() {\n    const tmpEvt = this.rightSE\n    this.rightSE = this.leftSE\n    this.leftSE = tmpEvt\n    this.leftSE.isLeft = true\n    this.rightSE.isLeft = false\n    for (let i = 0, iMax = this.windings!.length; i < iMax; i++) {\n      this.windings![i] *= -1\n    }\n  }\n\n  /* Consume another segment. We take their rings under our wing\n   * and mark them as consumed. Use for perfectly overlapping segments */\n  consume(other: Segment) {\n    let consumer = this as Segment\n    let consumee = other\n    while (consumer.consumedBy) consumer = consumer.consumedBy\n    while (consumee.consumedBy) consumee = consumee.consumedBy\n\n    const cmp = Segment.compare(consumer, consumee)\n    if (cmp === 0) return // already consumed\n    // the winner of the consumption is the earlier segment\n    // according to sweep line ordering\n    if (cmp > 0) {\n      const tmp = consumer\n      consumer = consumee\n      consumee = tmp\n    }\n\n    // make sure a segment doesn't consume it's prev\n    if (consumer.prev === consumee) {\n      const tmp = consumer\n      consumer = consumee\n      consumee = tmp\n    }\n\n    for (let i = 0, iMax = consumee.rings!.length; i < iMax; i++) {\n      const ring = consumee.rings![i]\n      const winding = consumee.windings![i]\n      const index = consumer.rings!.indexOf(ring)\n      if (index === -1) {\n        consumer.rings!.push(ring)\n        consumer.windings!.push(winding)\n      } else consumer.windings![index] += winding\n    }\n    consumee.rings = null\n    consumee.windings = null\n    consumee.consumedBy = consumer\n\n    // mark sweep events consumed as to maintain ordering in sweep event queue\n    consumee.leftSE.consumedBy = consumer.leftSE\n    consumee.rightSE.consumedBy = consumer.rightSE\n  }\n\n  /* The first segment previous segment chain that is in the result */\n  prevInResult(): Segment | null | undefined {\n    if (this._prevInResult !== undefined) return this._prevInResult\n    if (!this.prev) this._prevInResult = null\n    else if (this.prev.isInResult()) this._prevInResult = this.prev\n    else this._prevInResult = this.prev.prevInResult()\n    return this._prevInResult\n  }\n\n  beforeState(): State {\n    if (this._beforeState !== undefined) return this._beforeState\n    if (!this.prev)\n      this._beforeState = {\n        rings: [],\n        windings: [],\n        multiPolys: [],\n      }\n    else {\n      const seg = this.prev.consumedBy || this.prev\n      this._beforeState = seg.afterState()\n    }\n    return this._beforeState\n  }\n\n  afterState() {\n    if (this._afterState !== undefined) return this._afterState\n\n    const beforeState = this.beforeState()\n    this._afterState = {\n      rings: beforeState.rings.slice(0),\n      windings: beforeState.windings.slice(0),\n      multiPolys: [],\n    }\n    const ringsAfter = this._afterState.rings\n    const windingsAfter = this._afterState.windings\n    const mpsAfter = this._afterState.multiPolys\n\n    // calculate ringsAfter, windingsAfter\n    for (let i = 0, iMax = this.rings!.length; i < iMax; i++) {\n      const ring = this.rings![i]\n      const winding = this.windings![i]\n      const index = ringsAfter.indexOf(ring)\n      if (index === -1) {\n        ringsAfter.push(ring)\n        windingsAfter.push(winding)\n      } else windingsAfter[index] += winding\n    }\n\n    // calcualte polysAfter\n    const polysAfter = []\n    const polysExclude = []\n    for (let i = 0, iMax = ringsAfter.length; i < iMax; i++) {\n      if (windingsAfter[i] === 0) continue // non-zero rule\n      const ring = ringsAfter[i]\n      const poly = ring.poly\n      if (polysExclude.indexOf(poly) !== -1) continue\n      if (ring.isExterior) polysAfter.push(poly)\n      else {\n        if (polysExclude.indexOf(poly) === -1) polysExclude.push(poly)\n        const index = polysAfter.indexOf(ring.poly)\n        if (index !== -1) polysAfter.splice(index, 1)\n      }\n    }\n\n    // calculate multiPolysAfter\n    for (let i = 0, iMax = polysAfter.length; i < iMax; i++) {\n      const mp = polysAfter[i].multiPoly\n      if (mpsAfter.indexOf(mp) === -1) mpsAfter.push(mp)\n    }\n\n    return this._afterState\n  }\n\n  /* Is this segment part of the final result? */\n  isInResult() {\n    // if we've been consumed, we're not in the result\n    if (this.consumedBy) return false\n\n    if (this._isInResult !== undefined) return this._isInResult\n\n    const mpsBefore = this.beforeState().multiPolys\n    const mpsAfter = this.afterState().multiPolys\n\n    switch (operation.type) {\n      case \"union\": {\n        // UNION - included iff:\n        //  * On one side of us there is 0 poly interiors AND\n        //  * On the other side there is 1 or more.\n        const noBefores = mpsBefore.length === 0\n        const noAfters = mpsAfter.length === 0\n        this._isInResult = noBefores !== noAfters\n        break\n      }\n\n      case \"intersection\": {\n        // INTERSECTION - included iff:\n        //  * on one side of us all multipolys are rep. with poly interiors AND\n        //  * on the other side of us, not all multipolys are repsented\n        //    with poly interiors\n        let least\n        let most\n        if (mpsBefore.length < mpsAfter.length) {\n          least = mpsBefore.length\n          most = mpsAfter.length\n        } else {\n          least = mpsAfter.length\n          most = mpsBefore.length\n        }\n        this._isInResult = most === operation.numMultiPolys && least < most\n        break\n      }\n\n      case \"xor\": {\n        // XOR - included iff:\n        //  * the difference between the number of multipolys represented\n        //    with poly interiors on our two sides is an odd number\n        const diff = Math.abs(mpsBefore.length - mpsAfter.length)\n        this._isInResult = diff % 2 === 1\n        break\n      }\n\n      case \"difference\": {\n        // DIFFERENCE included iff:\n        //  * on exactly one side, we have just the subject\n        const isJustSubject = (mps: MultiPolyIn[]) => mps.length === 1 && mps[0].isSubject\n        this._isInResult = isJustSubject(mpsBefore) !== isJustSubject(mpsAfter)\n        break\n      }\n    }\n\n    return this._isInResult\n  }\n}\n", "import { Geom } from \"./geom-in.js\"\nimport { precision } from \"./precision.js\"\nimport operation from \"./operation.js\"\n\nexport { Geom }\n\nexport const union = (geom: Geom, ...moreGeoms: Geom[]) =>\n  operation.run(\"union\", geom, moreGeoms)\n\nexport const intersection = (geom: Geom, ...moreGeoms: Geom[]) =>\n  operation.run(\"intersection\", geom, moreGeoms)\n\nexport const xor = (geom: Geom, ...moreGeoms: Geom[]) =>\n  operation.run(\"xor\", geom, moreGeoms)\n\nexport const difference = (geom: Geom, ...moreGeoms: Geom[]) =>\n  operation.run(\"difference\", geom, moreGeoms)\n\nexport const setPrecision = precision.set", "import * as polygonClipping from 'polyclip-ts';\n\nexport function feature(geom) {\n  const feat = { type: 'Feature' };\n  feat.geometry = geom;\n  return feat;\n}\n\nexport function getGeometry(geojson) {\n  if (geojson.type === 'Feature') return geojson.geometry;\n  return geojson;\n}\n\nexport function getCoords(geojson) {\n  if (geojson && geojson.geometry && geojson.geometry.coordinates)\n    return geojson.geometry.coordinates;\n  return geojson;\n}\n\nexport function turfPoint(coords, precision = -1) {\n  if (precision > -1) {\n    coords[0] = L.Util.formatNum(coords[0], precision);\n    coords[1] = L.Util.formatNum(coords[1], precision);\n  }\n\n  return feature({ type: 'Point', coordinates: coords });\n}\n\nexport function turfLineString(coords) {\n  return feature({ type: 'LineString', coordinates: coords });\n}\n\nexport function turfMultiLineString(coords) {\n  return feature({ type: 'MultiLineString', coordinates: coords });\n}\n\nexport function turfPolygon(coords) {\n  return feature({ type: 'Polygon', coordinates: coords });\n}\n\nexport function turfMultiPolygon(coords) {\n  return feature({ type: 'MultiPolygon', coordinates: coords });\n}\n\nexport function turfFeatureCollection(features) {\n  return { type: 'FeatureCollection', features };\n}\n\nexport function intersect(poly1, poly2) {\n  const geom1 = getGeometry(poly1);\n  const geom2 = getGeometry(poly2);\n\n  const intersection = polygonClipping.intersection(\n    geom1.coordinates,\n    geom2.coordinates\n  );\n  if (intersection.length === 0) return null;\n  if (intersection.length === 1) return turfPolygon(intersection[0]);\n  return turfMultiPolygon(intersection);\n}\n\nexport function difference(polygon1, polygon2) {\n  const geom1 = getGeometry(polygon1);\n  const geom2 = getGeometry(polygon2);\n\n  const differenced = polygonClipping.difference(\n    geom1.coordinates,\n    geom2.coordinates\n  );\n  if (differenced.length === 0) return null;\n  if (differenced.length === 1) return turfPolygon(differenced[0]);\n  return turfMultiPolygon(differenced);\n}\n\n// LineString coords returns 1\n// MultiLineString coords returns 2\nexport function getDepthOfCoords(coords) {\n  if (Array.isArray(coords)) {\n    return 1 + getDepthOfCoords(coords[0]);\n  }\n  return -1; // return -1 because this is already the lng of the lnglat (geojson) array\n}\n\nexport function flattenPolyline(polyline) {\n  if (polyline instanceof L.Polyline) {\n    polyline = polyline.toGeoJSON(15);\n  }\n\n  const coords = getCoords(polyline);\n  const depth = getDepthOfCoords(coords);\n  const features = [];\n  if (depth > 1) {\n    coords.forEach((coord) => {\n      features.push(turfLineString(coord));\n    });\n  } else {\n    features.push(polyline);\n  }\n\n  return features;\n}\n\nexport function groupToMultiLineString(group) {\n  const coords = [];\n  group.eachLayer((layer) => {\n    coords.push(getCoords(layer.toGeoJSON(15)));\n  });\n  return turfMultiLineString(coords);\n}\n\nexport function convertToLatLng(coords) {\n  const lnglat = getCoords(coords);\n  return L.latLng(lnglat[1], lnglat[0]);\n}\n\nexport function convertArrayToLatLngs(arr) {\n  const latlngs = [];\n  if (arr.features) {\n    arr.features.forEach((geojson) => {\n      latlngs.push(convertToLatLng(geojson));\n    });\n  }\n  return latlngs;\n}\n", "import Draw from './L.PM.Draw';\nimport { getTranslation } from '../helpers';\n\nDraw.Text = Draw.extend({\n  initialize(map) {\n    this._map = map;\n    this._shape = 'Text';\n    this.toolbarButtonName = 'drawText';\n  },\n  enable(options) {\n    // TODO: Think about if these options could be passed globally for all\n    // instances of L.PM.Draw. So a dev could set drawing style one time as some kind of config\n    L.Util.setOptions(this, options);\n\n    // change enabled state\n    this._enabled = true;\n\n    // create a marker on click on the map\n    this._map.on('click', this._createMarker, this);\n\n    // toggle the draw button of the Toolbar in case drawing mode got enabled without the button\n    this._map.pm.Toolbar.toggleButton(this.toolbarButtonName, true);\n\n    // this is the hintmarker on the mouse cursor\n    this._hintMarker = L.marker(this._map.getCenter(), {\n      interactive: false,\n      zIndexOffset: 100,\n      icon: L.divIcon({ className: 'marker-icon cursor-marker' }),\n    });\n    this._setPane(this._hintMarker, 'vertexPane');\n    this._hintMarker._pmTempLayer = true;\n    this._hintMarker.addTo(this._map);\n\n    // show the hintmarker if the option is set\n    if (this.options.cursorMarker) {\n      L.DomUtil.addClass(this._hintMarker._icon, 'visible');\n    }\n\n    // add tooltip to hintmarker\n    if (this.options.tooltips) {\n      this._hintMarker\n        .bindTooltip(getTranslation('tooltips.placeText'), {\n          permanent: true,\n          offset: L.point(0, 10),\n          direction: 'bottom',\n\n          opacity: 0.8,\n        })\n        .openTooltip();\n    }\n\n    // this is just to keep the snappable mixin happy\n    this._layer = this._hintMarker;\n\n    // sync hint marker with mouse cursor\n    this._map.on('mousemove', this._syncHintMarker, this);\n\n    this._map.getContainer().classList.add('geoman-draw-cursor');\n\n    // fire drawstart event\n    this._fireDrawStart();\n    this._setGlobalDrawMode();\n  },\n  disable() {\n    // cancel, if drawing mode isn't even enabled\n    if (!this._enabled) {\n      return;\n    }\n\n    // change enabled state\n    this._enabled = false;\n\n    // undbind click event, don't create a marker on click anymore\n    this._map.off('click', this._createMarker, this);\n\n    // remove hint marker\n    this._hintMarker?.remove();\n\n    this._map.getContainer().classList.remove('geoman-draw-cursor');\n\n    // remove event listener to sync hint marker\n    this._map.off('mousemove', this._syncHintMarker, this);\n\n    this._map.off('mousemove', this._showHintMarkerAfterMoving, this);\n\n    // toggle the draw button of the Toolbar in case drawing mode got disabled without the button\n    this._map.pm.Toolbar.toggleButton(this.toolbarButtonName, false);\n\n    // cleanup snapping\n    if (this.options.snappable) {\n      this._cleanupSnapping();\n    }\n\n    // fire drawend event\n    this._fireDrawEnd();\n    this._setGlobalDrawMode();\n  },\n  enabled() {\n    return this._enabled;\n  },\n  toggle(options) {\n    if (this.enabled()) {\n      this.disable();\n    } else {\n      this.enable(options);\n    }\n  },\n  _syncHintMarker(e) {\n    // move the cursor marker\n    this._hintMarker.setLatLng(e.latlng);\n\n    // if snapping is enabled, do it\n    if (this.options.snappable) {\n      const fakeDragEvent = e;\n      fakeDragEvent.target = this._hintMarker;\n      this._handleSnapping(fakeDragEvent);\n    }\n  },\n  _createMarker(e) {\n    if (!e.latlng) {\n      return;\n    }\n\n    // If snap finish is required but the last marker wasn't snapped, do not finish the shape!\n    if (\n      this.options.requireSnapToFinish &&\n      !this._hintMarker._snapped &&\n      !this._isFirstLayer()\n    ) {\n      return;\n    }\n\n    // assign the coordinate of the click to the hintMarker, that's necessary for\n    // mobile where the marker can't follow a cursor\n    if (!this._hintMarker._snapped) {\n      this._hintMarker.setLatLng(e.latlng);\n    }\n\n    // get coordinate for new vertex by hintMarker (cursor marker)\n    const latlng = this._hintMarker.getLatLng();\n\n    this.textArea = this._createTextArea();\n\n    if (this.options.textOptions?.className) {\n      const cssClasses = this.options.textOptions.className.split(' ');\n      this.textArea.classList.add(...cssClasses);\n    }\n\n    const textAreaIcon = this._createTextIcon(this.textArea);\n\n    const marker = new L.Marker(latlng, {\n      textMarker: true,\n      _textMarkerOverPM: true, // we need to put this into the options, else we can't catch this in the init method\n      icon: textAreaIcon,\n    });\n    this._setPane(marker, 'markerPane');\n    this._finishLayer(marker);\n\n    if (!marker.pm) {\n      // if pm is not create we don't apply dragging to the marker (draggable is applied to the marker, when it is added to the map )\n      marker.options.draggable = false;\n    }\n    // add marker to the map\n    marker.addTo(this._map.pm._getContainingLayer());\n    if (marker.pm) {\n      marker.pm.textArea = this.textArea;\n      L.setOptions(marker.pm, {\n        removeIfEmpty: this.options.textOptions?.removeIfEmpty ?? true,\n      });\n\n      const focusAfterDraw = this.options.textOptions?.focusAfterDraw ?? true;\n      marker.pm._createTextMarker(focusAfterDraw);\n      if (this.options.textOptions?.text) {\n        marker.pm.setText(this.options.textOptions.text);\n      }\n    }\n\n    // fire the pm:create event and pass shape and marker\n    this._fireCreate(marker);\n\n    this._cleanupSnapping();\n\n    // disable drawing\n    this.disable();\n    if (this.options.continueDrawing) {\n      // the user is still typing some text, so we re-enable the layer after moving the mouse\n      this._map.once('mousemove', this._showHintMarkerAfterMoving, this);\n    }\n  },\n\n  _showHintMarkerAfterMoving(e) {\n    this.enable();\n    this._hintMarker.setLatLng(e.latlng);\n  },\n\n  _createTextArea() {\n    const textArea = document.createElement('textarea');\n    textArea.readOnly = true;\n    textArea.classList.add('pm-textarea', 'pm-disabled');\n    return textArea;\n  },\n\n  _createTextIcon(textArea) {\n    return L.divIcon({\n      className: 'pm-text-marker',\n      html: textArea,\n    });\n  },\n});\n", "import { getRenderer } from '../helpers';\n\nconst DragMixin = {\n  enableLayerDrag() {\n    // layer is not allowed to dragged or is not on the map\n    if (!this.options.draggable || !this._layer._map) {\n      return;\n    }\n\n    // before enabling layer drag, disable layer editing\n    this.disable();\n\n    this._layerDragEnabled = true;\n\n    // if layer never enabled and _map is not set (for snapping)\n    if (!this._map) {\n      this._map = this._layer._map;\n    }\n\n    if (\n      this._layer instanceof L.Marker ||\n      this._layer instanceof L.ImageOverlay\n    ) {\n      // prevents dragging the DOM image instead of the marker\n      L.DomEvent.on(this._getDOMElem(), 'dragstart', this._stopDOMImageDrag);\n    }\n\n    // Disable Leaflet Dragging of Markers\n    if (this._layer.dragging) {\n      this._layer.dragging.disable();\n    }\n\n    // temporary coord variable for delta calculation\n    this._tempDragCoord = null;\n\n    // add CSS class\n    if (getRenderer(this._layer) instanceof L.Canvas) {\n      this._layer.on('mouseout', this.removeDraggingClass, this);\n      this._layer.on('mouseover', this.addDraggingClass, this);\n    } else {\n      this.addDraggingClass();\n    }\n\n    this._originalMapDragState = this._layer._map.dragging._enabled;\n\n    // can we reliably save the map's draggable state?\n    // (if the mouse up event happens outside the container, then the map can become undraggable)\n    this._safeToCacheDragState = true;\n\n    const container = this._getDOMElem();\n\n    // check if DOM element exists\n    if (container) {\n      // add mousedown event to trigger drag\n      if (getRenderer(this._layer) instanceof L.Canvas) {\n        this._layer.on(\n          'touchstart mousedown',\n          this._dragMixinOnMouseDown,\n          this\n        );\n        this._map.pm._addTouchEvents(container);\n      } else {\n        // We can't just use layer.on('mousedown') because on touch devices the event is not fired if user presses on the layer and then drag it.\n        // With checking on touchstart and mousedown on the DOM element we can listen on the needed events\n        L.DomEvent.on(\n          container,\n          'touchstart mousedown',\n          this._simulateMouseDownEvent,\n          this\n        );\n      }\n    }\n\n    this._fireDragEnable();\n  },\n  disableLayerDrag() {\n    this._layerDragEnabled = false;\n\n    // remove CSS class\n    if (getRenderer(this._layer) instanceof L.Canvas) {\n      this._layer.off('mouseout', this.removeDraggingClass, this);\n      this._layer.off('mouseover', this.addDraggingClass, this);\n    } else {\n      this.removeDraggingClass();\n    }\n\n    // if the layer is dragged but now disabled\n    if (this._originalMapDragState && this._dragging) {\n      this._map.dragging.enable();\n    }\n\n    // no longer save the drag state\n    this._safeToCacheDragState = false;\n\n    // Disable Leaflet Dragging of Markers\n    if (this._layer.dragging) {\n      this._layer.dragging.disable();\n    }\n\n    const container = this._getDOMElem();\n    // check if DOM element exists\n    if (container) {\n      if (getRenderer(this._layer) instanceof L.Canvas) {\n        this._layer.off(\n          'touchstart mousedown',\n          this._dragMixinOnMouseDown,\n          this\n        );\n        this._map.pm._removeTouchEvents(container);\n      } else {\n        // disable mousedown event\n        L.DomEvent.off(\n          container,\n          'touchstart mousedown',\n          this._simulateMouseDownEvent,\n          this\n        );\n      }\n    }\n\n    if (this._layerDragged) {\n      this._fireUpdate();\n    }\n    this._layerDragged = false;\n\n    this._fireDragDisable();\n  },\n  // TODO: make this private in the next major release\n  dragging() {\n    return this._dragging;\n  },\n  layerDragEnabled() {\n    return !!this._layerDragEnabled;\n  },\n  // We need to simulate a mousedown event on the layer object. We can't just use layer.on('mousedown') because on touch devices the event is not fired if user presses on the layer and then drag it.\n  // With checking on touchstart and mousedown on the DOM element we can listen on the needed events\n  _simulateMouseDownEvent(e) {\n    const first = e.touches ? e.touches[0] : e;\n    const evt = {\n      originalEvent: first,\n      target: this._layer,\n    };\n    // we expect in the function to get the clicked latlng / point\n    evt.containerPoint = this._map.mouseEventToContainerPoint(first);\n    evt.latlng = this._map.containerPointToLatLng(evt.containerPoint);\n\n    this._dragMixinOnMouseDown(evt);\n    return false;\n  },\n  _simulateMouseMoveEvent(e) {\n    const first = e.touches ? e.touches[0] : e;\n    const evt = {\n      originalEvent: first,\n      target: this._layer,\n    };\n    // we expect in the function to get the clicked latlng / point\n    evt.containerPoint = this._map.mouseEventToContainerPoint(first);\n    evt.latlng = this._map.containerPointToLatLng(evt.containerPoint);\n\n    this._dragMixinOnMouseMove(evt);\n    return false;\n  },\n  _simulateMouseUpEvent(e) {\n    const first = e.touches ? e.touches[0] : e;\n    const evt = {\n      originalEvent: first,\n      target: this._layer,\n    };\n    if (e.type.indexOf('touch') === -1) {\n      // we expect in the function to get the clicked latlng / point\n      evt.containerPoint = this._map.mouseEventToContainerPoint(e);\n      evt.latlng = this._map.containerPointToLatLng(evt.containerPoint);\n    }\n    this._dragMixinOnMouseUp(evt);\n    return false;\n  },\n  _dragMixinOnMouseDown(e) {\n    // cancel if mouse button is NOT the left button\n    if (e.originalEvent.button > 0) {\n      return;\n    }\n    this._overwriteEventIfItComesFromMarker(e);\n\n    const fromLayerSync = e._fromLayerSync;\n\n    // if other layers found, snapping will be disabled\n    const layersToSyncFound = this._syncLayers('_dragMixinOnMouseDown', e);\n\n    if (this._layer instanceof L.Marker) {\n      if (this.options.snappable && !fromLayerSync && !layersToSyncFound) {\n        this._initSnappableMarkers();\n      } else {\n        this._disableSnapping();\n      }\n    }\n\n    // we need to disable snapping for CircleMarker because they are snapping because of the check in onLayerDrag -> if(_snapped)\n    if (this._layer instanceof L.CircleMarker) {\n      let _editableOption = 'resizeableCircleMarker';\n      if (this._layer instanceof L.Circle) {\n        _editableOption = 'resizeableCircle';\n      }\n\n      if (this.options.snappable && !fromLayerSync && !layersToSyncFound) {\n        if (!this._layer.pm.options[_editableOption]) {\n          this._initSnappableMarkersDrag();\n        }\n      } else if (this._layer.pm.options[_editableOption]) {\n        this._layer.pm._disableSnapping();\n      } else {\n        this._layer.pm._disableSnappingDrag();\n      }\n    }\n\n    // save current map dragging state\n    if (this._safeToCacheDragState) {\n      this._originalMapDragState = this._layer._map.dragging._enabled;\n\n      // don't cache the state again until another mouse up is registered\n      this._safeToCacheDragState = false;\n    }\n\n    // save for delta calculation\n    this._tempDragCoord = e.latlng;\n\n    L.DomEvent.on(\n      this._map.getContainer(),\n      'touchend mouseup',\n      this._simulateMouseUpEvent,\n      this\n    );\n\n    // listen to mousemove on map (instead of polygon),\n    // otherwise fast mouse movements stop the drag\n    L.DomEvent.on(\n      this._map.getContainer(),\n      'touchmove mousemove',\n      this._simulateMouseMoveEvent,\n      this\n    );\n  },\n  _dragMixinOnMouseMove(e) {\n    this._overwriteEventIfItComesFromMarker(e);\n    const el = this._getDOMElem();\n\n    this._syncLayers('_dragMixinOnMouseMove', e);\n\n    if (!this._dragging) {\n      // set state\n      this._dragging = true;\n      L.DomUtil.addClass(el, 'leaflet-pm-dragging');\n\n      if (!(this._layer instanceof L.Marker)) {\n        // bring it to front to prevent drag interception\n        this._layer.bringToFront();\n      }\n\n      // disbale map drag\n      if (this._originalMapDragState) {\n        this._map.dragging.disable();\n      }\n\n      // fire pm:dragstart event\n      this._fireDragStart();\n    }\n\n    // if _tempDragCoord is null add the current latlng to prevent throwing a error. This can happen when for example the layer is removed and added to the map while dragging (MarkerCluster)\n    if (!this._tempDragCoord) {\n      this._tempDragCoord = e.latlng;\n    }\n\n    this._onLayerDrag(e);\n\n    // update the hidden circle border after dragging\n    if (this._layer instanceof L.CircleMarker) {\n      this._layer.pm._updateHiddenPolyCircle();\n    }\n  },\n  _dragMixinOnMouseUp(e) {\n    const el = this._getDOMElem();\n\n    this._syncLayers('_dragMixinOnMouseUp', e);\n\n    // re-enable map drag\n    if (this._originalMapDragState) {\n      this._map.dragging.enable();\n    }\n\n    // if mouseup event fired, it's safe to cache the map draggable state on the next mouse down\n    this._safeToCacheDragState = true;\n    // clear up mousemove event\n    L.DomEvent.off(\n      this._map.getContainer(),\n      'touchmove mousemove',\n      this._simulateMouseMoveEvent,\n      this\n    );\n\n    // clear up mouseup event\n    L.DomEvent.off(\n      this._map.getContainer(),\n      'touchend mouseup',\n      this._simulateMouseUpEvent,\n      this\n    );\n\n    // if no drag happened, don't do anything\n    if (!this._dragging) {\n      return false;\n    }\n\n    // update the hidden circle border after dragging\n    if (this._layer instanceof L.CircleMarker) {\n      this._layer.pm._updateHiddenPolyCircle();\n    }\n\n    this._layerDragged = true;\n\n    // timeout to prevent click event after drag :-/\n    // TODO: do it better as soon as leaflet has a way to do it better :-)\n    window.setTimeout(() => {\n      // set state\n      this._dragging = false;\n      // if the layer is not on the map, we have no DOM element\n      if (el) {\n        L.DomUtil.removeClass(el, 'leaflet-pm-dragging');\n      }\n\n      // fire pm:dragend event\n      this._fireDragEnd();\n\n      // fire edit\n      this._fireEdit();\n      this._layerEdited = true;\n    }, 10);\n\n    return true;\n  },\n  _onLayerDrag(e) {\n    // latLng of mouse event\n    const { latlng } = e;\n\n    // delta coords (how far was dragged)\n    const deltaLatLng = {\n      lat: latlng.lat - this._tempDragCoord.lat,\n      lng: latlng.lng - this._tempDragCoord.lng,\n    };\n\n    // move the coordinates by the delta\n    const moveCoords = (coords) =>\n      // alter the coordinates\n      coords.map((currentLatLng) => {\n        if (Array.isArray(currentLatLng)) {\n          // do this recursively as coords might be nested\n          return moveCoords(currentLatLng);\n        }\n\n        // move the coord and return it\n        const newLatlng = {\n          lat: currentLatLng.lat + deltaLatLng.lat,\n          lng: currentLatLng.lng + deltaLatLng.lng,\n        };\n\n        if (currentLatLng.alt || currentLatLng.alt === 0) {\n          newLatlng.alt = currentLatLng.alt;\n        }\n        return newLatlng;\n      });\n\n    if (\n      (this._layer instanceof L.Circle &&\n        this._layer.options.resizeableCircle) ||\n      (this._layer instanceof L.CircleMarker &&\n        this._layer.options.resizeableCircleMarker)\n    ) {\n      // create the new coordinates array\n      const newCoords = moveCoords([this._layer.getLatLng()]);\n      // set new coordinates and redraw\n      this._layer.setLatLng(newCoords[0]);\n      this._fireChange(this._layer.getLatLng(), 'Edit');\n    } else if (\n      this._layer instanceof L.CircleMarker ||\n      this._layer instanceof L.Marker\n    ) {\n      let coordsRefernce = this._layer.getLatLng();\n      if (this._layer._snapped) {\n        // if layer is snapped we use the original latlng for re-calculation, else the layer will not be \"unsnappable\" anymore\n        coordsRefernce = this._layer._orgLatLng;\n      }\n      // create the new coordinates array\n      const newCoords = moveCoords([coordsRefernce]);\n      // set new coordinates and redraw\n      this._layer.setLatLng(newCoords[0]);\n      this._fireChange(this._layer.getLatLng(), 'Edit');\n    } else if (this._layer instanceof L.ImageOverlay) {\n      // create the new coordinates array\n      const newCoords = moveCoords([\n        this._layer.getBounds().getNorthWest(),\n        this._layer.getBounds().getSouthEast(),\n      ]);\n      // set new coordinates and redraw\n      this._layer.setBounds(newCoords);\n      this._fireChange(this._layer.getBounds(), 'Edit');\n    } else {\n      // create the new coordinates array\n      const newCoords = moveCoords(this._layer.getLatLngs());\n\n      // set new coordinates and redraw\n      this._layer.setLatLngs(newCoords);\n      this._fireChange(this._layer.getLatLngs(), 'Edit');\n    }\n\n    // save current latlng for next delta calculation\n    this._tempDragCoord = latlng;\n\n    e.layer = this._layer;\n    // fire pm:dragstart event\n    this._fireDrag(e);\n  },\n  addDraggingClass() {\n    const el = this._getDOMElem();\n    if (el) {\n      L.DomUtil.addClass(el, 'leaflet-pm-draggable');\n    }\n  },\n  removeDraggingClass() {\n    const el = this._getDOMElem();\n    if (el) {\n      L.DomUtil.removeClass(el, 'leaflet-pm-draggable');\n    }\n  },\n  _getDOMElem() {\n    let el = null;\n    if (this._layer._path) {\n      el = this._layer._path;\n    } else if (this._layer._renderer && this._layer._renderer._container) {\n      el = this._layer._renderer._container;\n    } else if (this._layer._image) {\n      el = this._layer._image;\n    } else if (this._layer._icon) {\n      el = this._layer._icon;\n    }\n    return el;\n  },\n  _overwriteEventIfItComesFromMarker(e) {\n    // e.latlng is not the clicked latlng if the layer is a Marker (or the radius below 10) -> Leaflet definition\n    // https://github.com/Leaflet/Leaflet/blob/0f904a515879fcd08f69b7f51799ee7f18f23fd8/src/map/Map.js#L1416\n    const isMarker =\n      e.target.getLatLng && (!e.target._radius || e.target._radius <= 10);\n    if (isMarker) {\n      // we want the clicked latlng / point, so we overwrite the property e.latlng\n      e.containerPoint = this._map.mouseEventToContainerPoint(e.originalEvent);\n      e.latlng = this._map.containerPointToLatLng(e.containerPoint);\n    }\n  },\n  _syncLayers(fnc, e) {\n    // if layer is in Edit-Mode it should not be possible to drag other layers too. (Marker & CircleMarker & ImageOverlay)\n    if (this.enabled()) {\n      return false;\n    }\n\n    if (\n      !e._fromLayerSync &&\n      this._layer === e.target &&\n      this.options.syncLayersOnDrag\n    ) {\n      e._fromLayerSync = true;\n      let layersToSync = [];\n      if (L.Util.isArray(this.options.syncLayersOnDrag)) {\n        // layers\n        layersToSync = this.options.syncLayersOnDrag;\n\n        this.options.syncLayersOnDrag.forEach((layer) => {\n          if (layer instanceof L.LayerGroup) {\n            layersToSync = layersToSync.concat(layer.pm.getLayers(true));\n          }\n        });\n      } else if (this.options.syncLayersOnDrag === true) {\n        // LayerGroup\n        if (this._parentLayerGroup) {\n          for (const key in this._parentLayerGroup) {\n            const lg = this._parentLayerGroup[key];\n            if (lg.pm) {\n              layersToSync = lg.pm.getLayers(true);\n            }\n          }\n        }\n      }\n\n      if (L.Util.isArray(layersToSync) && layersToSync.length > 0) {\n        // filter out layers that don't have leaflet-geoman and not allowed to drag\n        layersToSync = layersToSync\n          .filter((layer) => !!layer.pm)\n          .filter((layer) => !!layer.pm.options.draggable);\n        layersToSync.forEach((layer) => {\n          if (layer !== this._layer && layer.pm[fnc]) {\n            layer._snapped = false;\n            layer.pm[fnc](e);\n          }\n        });\n      }\n      return layersToSync.length > 0;\n    }\n    return false;\n  },\n  _stopDOMImageDrag(e) {\n    e.preventDefault();\n    return false;\n  },\n};\n\nexport default DragMixin;\n", "import get from 'lodash/get';\nimport { _convertLatLngs, _toPoint } from '../helpers/ModeHelper';\nimport { calcAngle, copyLatLngs } from '../helpers';\n\n/**\n * We create a temporary polygon with the same latlngs as the layer that we want to rotate.\n * Why polygon? Because then we have the correct center also for polylines with `layer.getCenter()`.\n * We reference the origin layer as `_rotationLayer`. The rotate listeners (`_onRotate...()`) are only applied to the temp polygon and from there we need to rotate the `_rotationLayer` too.\n *\n */\n\nconst RotateMixin = {\n  _onRotateStart(e) {\n    // prevent that the limit Markers are calculated new\n    this._preventRenderingMarkers(true);\n    this._rotationOriginLatLng = this._getRotationCenter().clone();\n    this._rotationOriginPoint = _toPoint(this._map, this._rotationOriginLatLng);\n    this._rotationStartPoint = _toPoint(this._map, e.target.getLatLng());\n    // we need to store the initial latlngs so we can always re-calc from the origin latlngs\n    this._initialRotateLatLng = copyLatLngs(this._layer);\n    this._startAngle = this.getAngle();\n\n    const originLatLngs = copyLatLngs(\n      this._rotationLayer,\n      this._rotationLayer.pm._rotateOrgLatLng\n    );\n\n    this._fireRotationStart(this._rotationLayer, originLatLngs);\n    this._fireRotationStart(this._map, originLatLngs);\n  },\n  _onRotate(e) {\n    const position = _toPoint(this._map, e.target.getLatLng());\n    const previous = this._rotationStartPoint;\n    const origin = this._rotationOriginPoint;\n\n    // rotation diff angle (radiant)\n    const angleDiffRadiant =\n      Math.atan2(position.y - origin.y, position.x - origin.x) -\n      Math.atan2(previous.y - origin.y, previous.x - origin.x);\n\n    // rotate the temp polygon\n    this._layer.setLatLngs(\n      this._rotateLayer(\n        angleDiffRadiant,\n        this._initialRotateLatLng,\n        this._rotationOriginLatLng,\n        L.PM.Matrix.init(),\n        this._map\n      )\n    );\n    // move the helper markers\n    const that = this;\n    function forEachLatLng(latlng, path = [], _i = -1) {\n      if (_i > -1) {\n        path.push(_i);\n      }\n      if (L.Util.isArray(latlng[0])) {\n        latlng.forEach((x, i) => forEachLatLng(x, path.slice(), i));\n      } else {\n        const markers =\n          path.length > 0 ? get(that._markers, path) : that._markers[0];\n        latlng.forEach((_latlng, j) => {\n          const marker = markers[j];\n          marker.setLatLng(_latlng);\n        });\n      }\n    }\n    forEachLatLng(this._layer.getLatLngs());\n\n    const oldLatLngs = copyLatLngs(this._rotationLayer);\n    // rotate the origin layer\n    this._rotationLayer.setLatLngs(\n      this._rotateLayer(\n        angleDiffRadiant,\n        this._rotationLayer.pm._rotateOrgLatLng,\n        this._rotationOriginLatLng,\n        L.PM.Matrix.init(),\n        this._map\n      )\n    );\n\n    // convert the difference radiant to degrees and add it to the angle before rotation starts\n    let angleDiff = (angleDiffRadiant * 180) / Math.PI;\n    angleDiff = angleDiff < 0 ? angleDiff + 360 : angleDiff;\n    const angle = angleDiff + this._startAngle;\n    this._setAngle(angle);\n    this._rotationLayer.pm._setAngle(angle);\n\n    this._fireRotation(this._rotationLayer, angleDiff, oldLatLngs);\n    this._fireRotation(this._map, angleDiff, oldLatLngs);\n    this._rotationLayer.pm._fireChange(\n      this._rotationLayer.getLatLngs(),\n      'Rotation'\n    );\n  },\n  _onRotateEnd() {\n    const startAngle = this._startAngle;\n    delete this._rotationOriginLatLng;\n    delete this._rotationOriginPoint;\n    delete this._rotationStartPoint;\n    delete this._initialRotateLatLng;\n    delete this._startAngle;\n\n    const originLatLngs = copyLatLngs(\n      this._rotationLayer,\n      this._rotationLayer.pm._rotateOrgLatLng\n    );\n    // store the new latlngs\n    this._rotationLayer.pm._rotateOrgLatLng = copyLatLngs(this._rotationLayer);\n\n    this._fireRotationEnd(this._rotationLayer, startAngle, originLatLngs);\n    this._fireRotationEnd(this._map, startAngle, originLatLngs);\n    this._rotationLayer.pm._fireEdit(this._rotationLayer, 'Rotation');\n\n    this._preventRenderingMarkers(false);\n\n    this._layerRotated = true;\n  },\n  _rotateLayer(radiant, latlngs, origin, _matrix, map) {\n    const originPoint = _toPoint(map, origin);\n    this._matrix = _matrix.clone().rotate(radiant, originPoint).flip();\n    return _convertLatLngs(latlngs, this._matrix, map);\n  },\n  _setAngle(angle) {\n    angle = angle < 0 ? angle + 360 : angle;\n    this._angle = angle % 360;\n  },\n  _getRotationCenter() {\n    if (this._rotationCenter) {\n      return this._rotationCenter;\n    }\n\n    const polygon = L.polygon(this._layer.getLatLngs(), {\n      stroke: false,\n      fill: false,\n      pmIgnore: true,\n    }).addTo(this._layer._map);\n    const center = polygon.getCenter();\n    polygon.removeFrom(this._layer._map);\n    return center;\n  },\n\n  /*\n   *\n   * Public functions f.ex. to disable and enable rotation on the layer directly\n   *\n   */\n  enableRotate() {\n    if (!this.options.allowRotation) {\n      this.disableRotate();\n      return;\n    }\n\n    if (this.rotateEnabled()) {\n      this.disableRotate();\n    }\n\n    if (this._layer instanceof L.Rectangle && this._angle === undefined) {\n      this.setInitAngle(\n        calcAngle(\n          this._layer._map,\n          this._layer.getLatLngs()[0][0],\n          this._layer.getLatLngs()[0][1]\n        ) || 0\n      );\n    }\n\n    // We create an hidden polygon. We set pmIgnore to false, so that the `pm` property will be always create, also if OptIn == true\n    const options = {\n      fill: false,\n      stroke: false,\n      pmIgnore: false,\n      snapIgnore: true,\n    };\n\n    // we create a temp polygon for rotation\n    this._rotatePoly = L.polygon(this._layer.getLatLngs(), options);\n    this._rotatePoly._pmTempLayer = true;\n    this._rotatePoly.addTo(this._layer._map);\n    this._rotatePoly.pm._setAngle(this.getAngle());\n    this._rotatePoly.pm.setRotationCenter(this.getRotationCenter());\n    this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions());\n    this._rotatePoly.pm.setOptions({\n      rotate: true,\n      snappable: false,\n      hideMiddleMarkers: true,\n    });\n    // we connect the temp polygon (that will be enabled for rotation) with the current layer, so that we can rotate the current layer too\n    this._rotatePoly.pm._rotationLayer = this._layer;\n    this._rotatePoly.pm.enable();\n\n    // store the original latlngs\n    this._rotateOrgLatLng = copyLatLngs(this._layer);\n\n    this._rotateEnabled = true;\n\n    this._layer.on('remove', this.disableRotate, this);\n\n    this._fireRotationEnable(this._layer);\n    // we need to use this._layer._map because this._map can be undefined if layer was never enabled for editing before\n    this._fireRotationEnable(this._layer._map);\n  },\n  disableRotate() {\n    if (this.rotateEnabled()) {\n      if (this._rotatePoly.pm._layerRotated) {\n        this._fireUpdate();\n      }\n      this._rotatePoly.pm._layerRotated = false;\n      // delete the temp polygon\n      this._rotatePoly.pm.disable();\n      this._rotatePoly.remove();\n      this._rotatePoly.pm.setOptions({ rotate: false });\n      this._rotatePoly = undefined;\n      this._rotateOrgLatLng = undefined;\n\n      this._layer.off('remove', this.disableRotate, this);\n\n      this._rotateEnabled = false;\n\n      this._fireRotationDisable(this._layer);\n      // we need to use this._layer._map because this._map can be undefined if layer was never enabled for editing before\n      this._fireRotationDisable(this._layer._map);\n    }\n  },\n  rotateEnabled() {\n    return !!this._rotateEnabled;\n  },\n  // angle is clockwise (0-360)\n  rotateLayer(degrees) {\n    const oldAngle = this.getAngle();\n    const oldLatLngs = this._layer.getLatLngs();\n    const rads = degrees * (Math.PI / 180);\n    this._layer.setLatLngs(\n      this._rotateLayer(\n        rads,\n        this._layer.getLatLngs(),\n        this._getRotationCenter(),\n        L.PM.Matrix.init(),\n        this._layer._map\n      )\n    );\n    // store the new latlngs\n    this._rotateOrgLatLng = L.polygon(this._layer.getLatLngs()).getLatLngs();\n    this._setAngle(this.getAngle() + degrees);\n    if (\n      this.rotateEnabled() &&\n      this._rotatePoly &&\n      this._rotatePoly.pm.enabled()\n    ) {\n      this._rotatePoly.setLatLngs(\n        this._rotateLayer(\n          rads,\n          this._rotatePoly.getLatLngs(),\n          this._getRotationCenter(),\n          L.PM.Matrix.init(),\n          this._rotatePoly._map\n        )\n      );\n      this._rotatePoly.pm._initMarkers();\n    }\n\n    // TODO: for negative angle change the difference is always (360 - angle), do we want this?\n    let angleDiff = this.getAngle() - oldAngle;\n    angleDiff = angleDiff < 0 ? angleDiff + 360 : angleDiff;\n\n    this._startAngle = oldAngle;\n    this._fireRotation(this._layer, angleDiff, oldLatLngs, this._layer);\n    this._fireRotation(\n      this._map || this._layer._map,\n      angleDiff,\n      oldLatLngs,\n      this._layer\n    );\n    delete this._startAngle;\n    this._fireChange(this._layer.getLatLngs(), 'Rotation');\n  },\n  rotateLayerToAngle(degrees) {\n    const newAnlge = degrees - this.getAngle();\n    this.rotateLayer(newAnlge);\n  },\n  // angle is clockwise (0-360)\n  getAngle() {\n    return this._angle || 0;\n  },\n  // angle is clockwise (0-360)\n  setInitAngle(degrees) {\n    this._setAngle(degrees);\n  },\n  getRotationCenter() {\n    return this._getRotationCenter();\n  },\n  setRotationCenter(center) {\n    this._rotationCenter = center;\n\n    if (this._rotatePoly) {\n      this._rotatePoly.pm.setRotationCenter(center);\n    }\n  },\n};\n\nexport default RotateMixin;\n", "export function _convertLatLng(latlng, matrix, map, zoom) {\n  return map.unproject(matrix.transform(map.project(latlng, zoom)), zoom);\n}\n\nexport function _convertLatLngs(latlng, matrix, map) {\n  let zoom = map.getMaxZoom();\n  if (zoom === Infinity) {\n    zoom = map.getZoom();\n  }\n  if (L.Util.isArray(latlng)) {\n    const latlngs = [];\n    latlng.forEach((x) => {\n      latlngs.push(_convertLatLngs(x, matrix, map));\n    });\n    return latlngs;\n  }\n  if (latlng instanceof L.LatLng) {\n    return _convertLatLng(latlng, matrix, map, zoom);\n  }\n  return null;\n}\n\nexport function _toPoint(map, latlng) {\n  if (latlng instanceof L.Layer) {\n    latlng = latlng.getLatLng();\n  }\n  let zoom = map.getMaxZoom();\n  if (zoom === Infinity) {\n    zoom = map.getZoom();\n  }\n  return map.project(latlng, zoom);\n}\n\nexport function _toLatLng(map, point) {\n  let zoom = map.getMaxZoom();\n  if (zoom === Infinity) {\n    zoom = map.getZoom();\n  }\n  return map.unproject(point, zoom);\n}\n", "import SnapMixin from '../Mixins/Snapping';\nimport DragMixin from '../Mixins/Dragging';\nimport RotateMixin from '../Mixins/Rotating';\nimport EventMixin from '../Mixins/Events';\n\nconst Edit = L.Class.extend({\n  includes: [DragMixin, SnapMixin, RotateMixin, EventMixin],\n  options: {\n    snappable: true, // TODO: next major Release, rename it to allowSnapping\n    snapDistance: 20,\n    allowSelfIntersection: true,\n    allowSelfIntersectionEdit: false,\n    preventMarkerRemoval: false,\n    removeLayerBelowMinVertexCount: true,\n    limitMarkersToCount: -1,\n    hideMiddleMarkers: false,\n    snapSegment: true,\n    syncLayersOnDrag: false,\n    draggable: true, // TODO: next major Release, rename it to allowDragging\n    allowEditing: true, // disable all interactions on a layer which are activated with `enable()`. For example a Circle can't be dragged in Edit-Mode\n    allowRemoval: true,\n    allowCutting: true,\n    allowRotation: true,\n    addVertexOn: 'click',\n    removeVertexOn: 'contextmenu',\n    removeVertexValidation: undefined,\n    addVertexValidation: undefined,\n    moveVertexValidation: undefined,\n    resizeableCircleMarker: false,\n    resizeableCircle: true,\n    snapMiddle: false,\n    snapVertex: true,\n  },\n  setOptions(options) {\n    L.Util.setOptions(this, options);\n  },\n  getOptions() {\n    return this.options;\n  },\n  applyOptions() {},\n  isPolygon() {\n    // if it's a polygon, it means the coordinates array is multi dimensional\n    return this._layer instanceof L.Polygon;\n  },\n  getShape() {\n    return this._shape;\n  },\n  _setPane(layer, type) {\n    if (type === 'layerPane') {\n      layer.options.pane =\n        (this._map.pm.globalOptions.panes &&\n          this._map.pm.globalOptions.panes.layerPane) ||\n        'overlayPane';\n    } else if (type === 'vertexPane') {\n      layer.options.pane =\n        (this._map.pm.globalOptions.panes &&\n          this._map.pm.globalOptions.panes.vertexPane) ||\n        'markerPane';\n    } else if (type === 'markerPane') {\n      layer.options.pane =\n        (this._map.pm.globalOptions.panes &&\n          this._map.pm.globalOptions.panes.markerPane) ||\n        'markerPane';\n    }\n  },\n  remove() {\n    const map = this._map || this._layer._map;\n    map.pm.removeLayer({ target: this._layer });\n  },\n  _vertexValidation(type, e) {\n    const marker = e.target;\n    const args = { layer: this._layer, marker, event: e };\n\n    let validationFnc = '';\n    if (type === 'move') {\n      validationFnc = 'moveVertexValidation';\n    } else if (type === 'add') {\n      validationFnc = 'addVertexValidation';\n    } else if (type === 'remove') {\n      validationFnc = 'removeVertexValidation';\n    }\n\n    // if validation goes wrong, we return false\n    if (\n      this.options[validationFnc] &&\n      typeof this.options[validationFnc] === 'function' &&\n      !this.options[validationFnc](args)\n    ) {\n      if (type === 'move') {\n        marker._cancelDragEventChain = marker.getLatLng();\n      }\n      return false;\n    }\n\n    marker._cancelDragEventChain = null;\n    return true;\n  },\n  _vertexValidationDrag(marker) {\n    // we reset the marker to the place before it was dragged. We need this, because we can't stop the drag process in a `dragstart` | `movestart` listener\n    if (marker._cancelDragEventChain) {\n      marker._latlng = marker._cancelDragEventChain;\n      marker.update();\n      return false;\n    }\n    return true;\n  },\n  _vertexValidationDragEnd(marker) {\n    if (marker._cancelDragEventChain) {\n      marker._cancelDragEventChain = null;\n      return false;\n    }\n    return true;\n  },\n});\n\nexport default Edit;\n", "import Edit from './L.PM.Edit';\n\n// LayerGroup doesn't inherit from L.PM.Edit because it's just calling L.PM.Edit.Polygon\n// (which inherits from L.PM.Edit) for each layer,\n// so it's not really a parent class\nEdit.LayerGroup = L.Class.extend({\n  initialize(layerGroup) {\n    this._layerGroup = layerGroup;\n    this._layers = this.getLayers();\n    this._getMap();\n\n    // init all layers of the group\n    this._layers.forEach((layer) => this._initLayer(layer));\n\n    // if a new layer is added to the group, reinitialize\n    // This only works for FeatureGroups, not LayerGroups\n    // https://github.com/Leaflet/Leaflet/issues/4861\n\n    const addThrottle = (e) => {\n      if (e.layer._pmTempLayer) {\n        return;\n      }\n      this._layers = this.getLayers();\n      const _initLayers = this._layers.filter(\n        (layer) =>\n          !layer.pm._parentLayerGroup ||\n          !(this._layerGroup._leaflet_id in layer.pm._parentLayerGroup)\n      );\n      // init the newly added layers (can be multiple because of the throttle)\n      _initLayers.forEach((layer) => {\n        this._initLayer(layer);\n      });\n      // if editing was already enabled for this group, enable it again\n      // so the new layers are enabled\n      if (\n        _initLayers.length > 0 &&\n        this._getMap() &&\n        this._getMap().pm.globalEditModeEnabled()\n      ) {\n        if (this.enabled()) {\n          this.enable(this.getOptions());\n        }\n      }\n    };\n    this._layerGroup.on(\n      'layeradd',\n      L.Util.throttle(addThrottle, 100, this),\n      this\n    );\n\n    // Remove the layergroup from the layer\n    this._layerGroup.on(\n      'layerremove',\n      (e) => {\n        this._removeLayerFromGroup(e.target);\n      },\n      this\n    );\n\n    const removeThrottle = (e) => {\n      if (e.target._pmTempLayer) {\n        return;\n      }\n      this._layers = this.getLayers();\n    };\n    // if a layer is removed from the group, calc the layers list again.\n    // we run this as throttle because the findLayers() is a larger function\n    this._layerGroup.on(\n      'layerremove',\n      L.Util.throttle(removeThrottle, 100, this),\n      this\n    );\n  },\n  enable(options, _layerIds = []) {\n    if (_layerIds.length === 0) {\n      this._layers = this.getLayers();\n    }\n    this._options = options;\n    this._layers.forEach((layer) => {\n      if (layer instanceof L.LayerGroup) {\n        if (_layerIds.indexOf(layer._leaflet_id) === -1) {\n          _layerIds.push(layer._leaflet_id);\n          layer.pm.enable(options, _layerIds);\n        }\n      } else {\n        layer.pm.enable(options);\n      }\n    });\n  },\n  disable(_layerIds = []) {\n    if (_layerIds.length === 0) {\n      this._layers = this.getLayers();\n    }\n    this._layers.forEach((layer) => {\n      if (layer instanceof L.LayerGroup) {\n        if (_layerIds.indexOf(layer._leaflet_id) === -1) {\n          _layerIds.push(layer._leaflet_id);\n          layer.pm.disable(_layerIds);\n        }\n      } else {\n        layer.pm.disable();\n      }\n    });\n  },\n  enabled(_layerIds = []) {\n    if (_layerIds.length === 0) {\n      this._layers = this.getLayers();\n    }\n    const enabled = this._layers.find((layer) => {\n      if (layer instanceof L.LayerGroup) {\n        if (_layerIds.indexOf(layer._leaflet_id) === -1) {\n          _layerIds.push(layer._leaflet_id);\n          return layer.pm.enabled(_layerIds);\n        }\n        return false; // enabled is already returned because this is not the first time, so we can return always false\n      }\n      return layer.pm.enabled();\n    });\n    return !!enabled;\n  },\n  toggleEdit(options, _layerIds = []) {\n    if (_layerIds.length === 0) {\n      this._layers = this.getLayers();\n    }\n    this._options = options;\n    this._layers.forEach((layer) => {\n      if (layer instanceof L.LayerGroup) {\n        if (_layerIds.indexOf(layer._leaflet_id) === -1) {\n          _layerIds.push(layer._leaflet_id);\n          layer.pm.toggleEdit(options, _layerIds);\n        }\n      } else {\n        layer.pm.toggleEdit(options);\n      }\n    });\n  },\n  _initLayer(layer) {\n    // add reference for the group to each layer inside said group by id, a layer can have multiple groups\n    const id = L.Util.stamp(this._layerGroup);\n    if (!layer.pm._parentLayerGroup) {\n      layer.pm._parentLayerGroup = {};\n    }\n    layer.pm._parentLayerGroup[id] = this._layerGroup;\n  },\n  _removeLayerFromGroup(layer) {\n    if (layer.pm && layer.pm._layerGroup) {\n      const id = L.Util.stamp(this._layerGroup);\n      delete layer.pm._layerGroup[id];\n    }\n  },\n  dragging() {\n    this._layers = this.getLayers();\n    if (this._layers) {\n      const dragging = this._layers.find((layer) => layer.pm.dragging());\n      return !!dragging;\n    }\n    return false;\n  },\n  getOptions() {\n    return this.options;\n  },\n  _getMap() {\n    return this._map || this._layers.find((l) => !!l._map)?._map || null;\n  },\n  getLayers(\n    deep = false,\n    filterGeoman = true,\n    filterGroupsOut = true,\n    _layerIds = []\n  ) {\n    let layers = [];\n    if (deep) {\n      // get the layers of LayerGroup children\n      this._layerGroup.getLayers().forEach((layer) => {\n        layers.push(layer);\n        if (layer instanceof L.LayerGroup) {\n          if (_layerIds.indexOf(layer._leaflet_id) === -1) {\n            _layerIds.push(layer._leaflet_id);\n            layers = layers.concat(\n              layer.pm.getLayers(true, true, true, _layerIds)\n            );\n          }\n        }\n      });\n    } else {\n      // get all layers of the layer group\n      layers = this._layerGroup.getLayers();\n    }\n\n    if (filterGroupsOut) {\n      layers = layers.filter((layer) => !(layer instanceof L.LayerGroup));\n    }\n    if (filterGeoman) {\n      // filter out layers that don't have leaflet-geoman\n      layers = layers.filter((layer) => !!layer.pm);\n      // filter out everything that's leaflet-geoman specific temporary stuff\n      layers = layers.filter((layer) => !layer._pmTempLayer);\n      // filter out everything that ignore leaflet-geoman\n      layers = layers.filter(\n        (layer) =>\n          (!L.PM.optIn && !layer.options.pmIgnore) || // if optIn is not set / true and pmIgnore is not set / true (default)\n          (L.PM.optIn && layer.options.pmIgnore === false) // if optIn is true and pmIgnore is false);\n      );\n    }\n    return layers;\n  },\n  setOptions(options, _layerIds = []) {\n    if (_layerIds.length === 0) {\n      this._layers = this.getLayers();\n    }\n    this.options = options;\n    this._layers.forEach((layer) => {\n      if (layer.pm) {\n        if (layer instanceof L.LayerGroup) {\n          if (_layerIds.indexOf(layer._leaflet_id) === -1) {\n            _layerIds.push(layer._leaflet_id);\n            layer.pm.setOptions(options, _layerIds);\n          }\n        } else {\n          layer.pm.setOptions(options);\n        }\n      }\n    });\n  },\n});\n", "import Edit from './L.PM.Edit';\n\nEdit.Marker = Edit.extend({\n  _shape: 'Marker',\n  initialize(layer) {\n    // layer is a marker in this case :-)\n    this._layer = layer;\n    this._enabled = false;\n\n    // register dragend event e.g. to fire pm:edit\n    this._layer.on('dragend', this._onDragEnd, this);\n  },\n  // TODO: remove default option in next major Release\n  enable(options = { draggable: true }) {\n    L.Util.setOptions(this, options);\n\n    // layer is not allowed to edit\n    if (!this.options.allowEditing || !this._layer._map) {\n      this.disable();\n      return;\n    }\n\n    this._map = this._layer._map;\n\n    if (this.enabled()) {\n      this.disable();\n    }\n    this.applyOptions();\n\n    // if shape gets removed from map, disable edit mode\n    this._layer.on('remove', this.disable, this);\n\n    this._enabled = true;\n\n    this._layer.on('pm:dragstart', this._onDragStart, this);\n    this._layer.on('pm:dragend', this._onMarkerDragEnd, this);\n\n    this._fireEnable();\n  },\n  disable() {\n    // if it's not enabled, it doesn't need to be disabled\n    if (!this.enabled()) {\n      return;\n    }\n\n    // disable dragging, as this could have been active even without being enabled\n    this.disableLayerDrag();\n\n    // remove listener\n    this._layer.off('remove', this.disable, this);\n    this._layer.off('contextmenu', this._removeMarker, this);\n\n    if (this._layerEdited) {\n      this._fireUpdate();\n    }\n    this._layerEdited = false;\n    this._fireDisable();\n\n    this._enabled = false;\n  },\n  enabled() {\n    return this._enabled;\n  },\n  toggleEdit(options) {\n    if (!this.enabled()) {\n      this.enable(options);\n    } else {\n      this.disable();\n    }\n  },\n  applyOptions() {\n    if (this.options.snappable) {\n      this._initSnappableMarkers();\n    } else {\n      this._disableSnapping();\n    }\n\n    if (this.options.draggable) {\n      this.enableLayerDrag();\n    } else {\n      this.disableLayerDrag();\n    }\n    // enable removal for the marker\n    if (!this.options.preventMarkerRemoval) {\n      this._layer.on('contextmenu', this._removeMarker, this);\n    }\n  },\n  _removeMarker(e) {\n    const marker = e.target;\n    marker.remove();\n    // TODO: find out why this is fired manually, shouldn't it be catched by L.PM.Map 'layerremove'?\n    this._fireRemove(marker);\n    this._fireRemove(this._map, marker);\n  },\n  _onDragStart() {\n    this._map.pm.Draw.Marker._layerIsDragging = true;\n  },\n  _onMarkerDragEnd() {\n    this._map.pm.Draw.Marker._layerIsDragging = false;\n  },\n  _onDragEnd() {\n    this._fireEdit();\n    this._layerEdited = true;\n  },\n  // overwrite initSnappableMarkers from Snapping.js Mixin\n  _initSnappableMarkers() {\n    const marker = this._layer;\n\n    this.options.snapDistance = this.options.snapDistance || 30;\n    this.options.snapSegment =\n      this.options.snapSegment === undefined ? true : this.options.snapSegment;\n\n    marker.off('pm:drag', this._handleSnapping, this);\n    marker.on('pm:drag', this._handleSnapping, this);\n\n    marker.off('pm:dragend', this._cleanupSnapping, this);\n    marker.on('pm:dragend', this._cleanupSnapping, this);\n\n    marker.off('pm:dragstart', this._unsnap, this);\n    marker.on('pm:dragstart', this._unsnap, this);\n  },\n  _disableSnapping() {\n    const marker = this._layer;\n    marker.off('pm:drag', this._handleSnapping, this);\n    marker.off('pm:dragend', this._cleanupSnapping, this);\n    marker.off('pm:dragstart', this._unsnap, this);\n  },\n});\n", "import kinks from '@turf/kinks';\nimport lineIntersect from '@turf/line-intersect';\nimport get from 'lodash/get';\nimport Edit from './L.PM.Edit';\nimport { copyLatLngs, hasValues, removeEmptyCoordRings } from '../helpers';\n\nimport MarkerLimits from '../Mixins/MarkerLimits';\n\n// Shit's getting complicated in here with Multipolygon Support. So here's a quick note about it:\n// Multipolygons with holes means lots of nested, multidimensional arrays.\n// In order to find a value inside such an array you need a path to adress it directly.\n// Example: var arr = [[['a', 'b'], ['c']]];\n// The indexPath to 'b' is [0, 0, 1]. The indexPath to 'c' is [0, 1, 0].\n// So I can get 'b' with: arr[0][0][1].\n// Got it? Now you know what is meant when you read \"indexPath\" around here. Have fun \uD83D\uDC4D\n\nEdit.Line = Edit.extend({\n  includes: [MarkerLimits],\n  _shape: 'Line',\n  initialize(layer) {\n    this._layer = layer;\n    this._enabled = false;\n  },\n  enable(options) {\n    L.Util.setOptions(this, options);\n\n    this._map = this._layer._map;\n\n    // cancel when map isn't available, this happens when the polygon is removed before this fires\n    if (!this._map) {\n      return;\n    }\n\n    // layer is not allowed to edit\n    if (!this.options.allowEditing) {\n      this.disable();\n      return;\n    }\n\n    if (this.enabled()) {\n      // if it was already enabled, disable first\n      // we don't block enabling again because new options might be passed\n      this.disable();\n    }\n\n    // change state\n    this._enabled = true;\n\n    // init markers\n    this._initMarkers();\n\n    this.applyOptions();\n\n    // if shape gets removed from map, disable edit mode\n    this._layer.on('remove', this.disable, this);\n\n    if (!this.options.allowSelfIntersection) {\n      this._layer.on(\n        'pm:vertexremoved',\n        this._handleSelfIntersectionOnVertexRemoval,\n        this\n      );\n    }\n\n    if (!this.options.allowSelfIntersection) {\n      if (this._layer.options.color !== '#f00000ff') {\n        this.cachedColor = this._layer.options.color;\n        this.isRed = false;\n      } else {\n        this.isRed = true;\n      }\n      this._handleLayerStyle();\n    } else {\n      this.cachedColor = undefined;\n    }\n    this._fireEnable();\n  },\n  disable() {\n    // if it's not enabled, it doesn't need to be disabled\n    if (!this.enabled()) {\n      return;\n    }\n\n    // prevent disabling if polygon is being dragged\n    if (this._dragging) {\n      return;\n    }\n    this._enabled = false;\n    this._markerGroup.clearLayers();\n    this._markerGroup.removeFrom(this._map);\n\n    // remove listener\n    this._layer.off('remove', this.disable, this);\n\n    if (!this.options.allowSelfIntersection) {\n      this._layer.off(\n        'pm:vertexremoved',\n        this._handleSelfIntersectionOnVertexRemoval,\n        this\n      );\n    }\n\n    // remove draggable class\n    const el = this._layer._path\n      ? this._layer._path\n      : this._layer._renderer._container;\n    L.DomUtil.removeClass(el, 'leaflet-pm-draggable');\n\n    if (this._layerEdited) {\n      this._fireUpdate();\n    }\n    this._layerEdited = false;\n    this._fireDisable();\n  },\n  enabled() {\n    return this._enabled;\n  },\n  toggleEdit(options) {\n    if (!this.enabled()) {\n      this.enable(options);\n    } else {\n      this.disable();\n    }\n    return this.enabled();\n  },\n  applyOptions() {\n    if (this.options.snappable) {\n      this._initSnappableMarkers();\n    } else {\n      this._disableSnapping();\n    }\n  },\n  _initMarkers() {\n    const map = this._map;\n    const coords = this._layer.getLatLngs();\n\n    // cleanup old ones first\n    if (this._markerGroup) {\n      this._markerGroup.removeFrom(map);\n      this._markerGroup.clearLayers();\n    }\n\n    // add markerGroup to map, markerGroup includes regular and middle markers\n    this._markerGroup = new L.FeatureGroup();\n    this._markerGroup._pmTempLayer = true;\n\n    // handle coord-rings (outer, inner, etc)\n    const handleRing = (coordsArr) => {\n      // if there is another coords ring, go a level deep and do this again\n      if (Array.isArray(coordsArr[0])) {\n        return coordsArr.map(handleRing, this);\n      }\n\n      // the marker array, it includes only the markers of vertexes (no middle markers)\n      const ringArr = coordsArr.map(this._createMarker, this);\n\n      if (this.options.hideMiddleMarkers !== true) {\n        // create small markers in the middle of the regular markers\n        coordsArr.map((v, k) => {\n          // find the next index fist\n          const nextIndex = this.isPolygon()\n            ? (k + 1) % coordsArr.length\n            : k + 1;\n          // create the marker\n          return this._createMiddleMarker(ringArr[k], ringArr[nextIndex]);\n        });\n      }\n\n      return ringArr;\n    };\n\n    // create markers\n    this._markers = handleRing(coords);\n\n    // handle possible limitation: maximum number of markers\n    this.filterMarkerGroup();\n\n    // add markerGroup to map\n    map.addLayer(this._markerGroup);\n  },\n\n  // creates initial markers for coordinates\n  _createMarker(latlng) {\n    const marker = new L.Marker(latlng, {\n      draggable: true,\n      icon: L.divIcon({ className: 'marker-icon' }),\n    });\n    this._setPane(marker, 'vertexPane');\n\n    marker._pmTempLayer = true;\n\n    if (this.options.rotate) {\n      marker.on('dragstart', this._onRotateStart, this);\n      marker.on('drag', this._onRotate, this);\n      marker.on('dragend', this._onRotateEnd, this);\n    } else {\n      marker.on('click', this._onVertexClick, this);\n      marker.on('dragstart', this._onMarkerDragStart, this);\n      marker.on('move', this._onMarkerDrag, this);\n      marker.on('dragend', this._onMarkerDragEnd, this);\n\n      if (!this.options.preventMarkerRemoval) {\n        marker.on(this.options.removeVertexOn, this._removeMarker, this);\n      }\n    }\n\n    this._markerGroup.addLayer(marker);\n\n    return marker;\n  },\n\n  // creates the middle markes between coordinates\n  _createMiddleMarker(leftM, rightM) {\n    // cancel if there are no two markers\n    if (!leftM || !rightM) {\n      return false;\n    }\n\n    const latlng = L.PM.Utils.calcMiddleLatLng(\n      this._map,\n      leftM.getLatLng(),\n      rightM.getLatLng()\n    );\n\n    const middleMarker = this._createMarker(latlng);\n    const middleIcon = L.divIcon({\n      className: 'marker-icon marker-icon-middle',\n    });\n    middleMarker.setIcon(middleIcon);\n    middleMarker.leftM = leftM;\n    middleMarker.rightM = rightM;\n\n    // save reference to this middle markers on the neighboor regular markers\n    leftM._middleMarkerNext = middleMarker;\n    rightM._middleMarkerPrev = middleMarker;\n\n    middleMarker.on(this.options.addVertexOn, this._onMiddleMarkerClick, this);\n    middleMarker.on('movestart', this._onMiddleMarkerMoveStart, this);\n\n    return middleMarker;\n  },\n  _onMiddleMarkerClick(e) {\n    const middleMarker = e.target;\n\n    if (!this._vertexValidation('add', e)) {\n      return;\n    }\n    // TODO: move the next two lines inside _addMarker() as soon as\n    // https://github.com/Leaflet/Leaflet/issues/4484\n    // is fixed\n    const icon = L.divIcon({ className: 'marker-icon' });\n    middleMarker.setIcon(icon);\n    this._addMarker(middleMarker, middleMarker.leftM, middleMarker.rightM);\n  },\n  _onMiddleMarkerMoveStart(e) {\n    const middleMarker = e.target;\n    middleMarker.on('moveend', this._onMiddleMarkerMoveEnd, this);\n    if (!this._vertexValidation('add', e)) {\n      middleMarker.on('move', this._onMiddleMarkerMovePrevent, this);\n      return;\n    }\n\n    middleMarker._dragging = true;\n    // TODO: This is a workaround. Remove the moveend listener and\n    // callback as soon as this is fixed:\n    // https://github.com/Leaflet/Leaflet/issues/4484\n    this._addMarker(middleMarker, middleMarker.leftM, middleMarker.rightM);\n  },\n  _onMiddleMarkerMovePrevent(e) {\n    const middleMarker = e.target;\n    this._vertexValidationDrag(middleMarker);\n  },\n  _onMiddleMarkerMoveEnd(e) {\n    const middleMarker = e.target;\n    middleMarker.off('move', this._onMiddleMarkerMovePrevent, this);\n    middleMarker.off('moveend', this._onMiddleMarkerMoveEnd, this);\n    if (!this._vertexValidationDragEnd(middleMarker)) {\n      return;\n    }\n    const icon = L.divIcon({ className: 'marker-icon' });\n    middleMarker.setIcon(icon);\n    // timeout is needed else this._onVertexClick fires the event because it is called after deleting the flag\n    setTimeout(() => {\n      delete middleMarker._dragging;\n    }, 100);\n  },\n  // adds a new marker from a middlemarker\n  _addMarker(newM, leftM, rightM) {\n    // first, make this middlemarker a regular marker\n    newM.off('movestart', this._onMiddleMarkerMoveStart, this);\n    newM.off(this.options.addVertexOn, this._onMiddleMarkerClick, this);\n    // now, create the polygon coordinate point for that marker\n    // and push into marker array\n    // and associate polygon coordinate with marker coordinate\n    const latlng = newM.getLatLng();\n    const coords = this._layer._latlngs;\n\n    // remove linked markers\n    delete newM.leftM;\n    delete newM.rightM;\n\n    // the index path to the marker inside the multidimensional marker array\n    const { indexPath, index, parentPath } = L.PM.Utils.findDeepMarkerIndex(\n      this._markers,\n      leftM\n    );\n\n    // define the coordsRing that is edited\n    const coordsRing = indexPath.length > 1 ? get(coords, parentPath) : coords;\n\n    // define the markers array that is edited\n    const markerArr =\n      indexPath.length > 1 ? get(this._markers, parentPath) : this._markers;\n\n    // add coordinate to coordinate array\n    coordsRing.splice(index + 1, 0, latlng);\n\n    // add marker to marker array\n    markerArr.splice(index + 1, 0, newM);\n\n    // set new latlngs to update polygon\n    this._layer.setLatLngs(coords);\n\n    // create the new middlemarkers\n    if (this.options.hideMiddleMarkers !== true) {\n      this._createMiddleMarker(leftM, newM);\n      this._createMiddleMarker(newM, rightM);\n    }\n\n    // fire edit event\n    this._fireEdit();\n    this._layerEdited = true;\n    this._fireChange(this._layer.getLatLngs(), 'Edit');\n\n    this._fireVertexAdded(\n      newM,\n      L.PM.Utils.findDeepMarkerIndex(this._markers, newM).indexPath,\n      latlng\n    );\n\n    if (this.options.snappable) {\n      this._initSnappableMarkers();\n    }\n  },\n\n  hasSelfIntersection() {\n    // check for self intersection of the layer and return true/false\n    const selfIntersection = kinks(this._layer.toGeoJSON(15));\n    return selfIntersection.features.length > 0;\n  },\n\n  _handleSelfIntersectionOnVertexRemoval() {\n    // check for selfintersection again (mainly to reset the style)\n    const selfIntersection = this._handleLayerStyle(true);\n\n    if (selfIntersection) {\n      // reset coordinates\n      this._layer.setLatLngs(this._coordsBeforeEdit);\n      this._coordsBeforeEdit = null;\n\n      // re-enable markers for the new coords\n      this._initMarkers();\n    }\n  },\n\n  _handleLayerStyle(flash) {\n    const layer = this._layer;\n\n    let selfIntersection;\n    let intersection;\n    if (this.options.allowSelfIntersection) {\n      selfIntersection = false;\n    } else {\n      intersection = kinks(this._layer.toGeoJSON(15));\n      selfIntersection = intersection.features.length > 0;\n    }\n\n    if (selfIntersection) {\n      if (\n        !this.options.allowSelfIntersection &&\n        this.options.allowSelfIntersectionEdit\n      ) {\n        this._updateDisabledMarkerStyle(this._markers, true);\n      }\n\n      if (this.isRed) {\n        return selfIntersection;\n      }\n\n      // if it does self-intersect, mark or flash it red\n      if (flash) {\n        this._flashLayer();\n      } else {\n        layer.setStyle({ color: '#f00000ff' });\n        this.isRed = true;\n      }\n\n      // fire intersect event\n      this._fireIntersect(intersection);\n    } else {\n      // if not, reset the style to the default color\n      layer.setStyle({ color: this.cachedColor });\n      this.isRed = false;\n      if (\n        !this.options.allowSelfIntersection &&\n        this.options.allowSelfIntersectionEdit\n      ) {\n        this._updateDisabledMarkerStyle(this._markers, false);\n      }\n    }\n    return selfIntersection;\n  },\n  _flashLayer() {\n    if (!this.cachedColor) {\n      this.cachedColor = this._layer.options.color;\n    }\n\n    this._layer.setStyle({ color: '#f00000ff' });\n    this.isRed = true;\n\n    window.setTimeout(() => {\n      this._layer.setStyle({ color: this.cachedColor });\n      this.isRed = false;\n    }, 200);\n  },\n  _updateDisabledMarkerStyle(markers, disabled) {\n    markers.forEach((marker) => {\n      if (Array.isArray(marker)) {\n        this._updateDisabledMarkerStyle(marker, disabled);\n      } else if (marker._icon) {\n        if (disabled && !this._checkMarkerAllowedToDrag(marker)) {\n          L.DomUtil.addClass(marker._icon, 'vertexmarker-disabled');\n        } else {\n          L.DomUtil.removeClass(marker._icon, 'vertexmarker-disabled');\n        }\n      }\n    });\n  },\n  _removeMarker(e) {\n    // the marker that should be removed\n    const marker = e.target;\n\n    if (!this._vertexValidation('remove', e)) {\n      return;\n    }\n\n    // if self intersection isn't allowed, save the coords upon dragstart\n    // in case we need to reset the layer\n    if (!this.options.allowSelfIntersection) {\n      this._coordsBeforeEdit = copyLatLngs(\n        this._layer,\n        this._layer.getLatLngs()\n      );\n    }\n\n    // coords of the layer\n    let coords = this._layer.getLatLngs();\n\n    // the index path to the marker inside the multidimensional marker array\n    const { indexPath, index, parentPath } = L.PM.Utils.findDeepMarkerIndex(\n      this._markers,\n      marker\n    );\n\n    // only continue if this is NOT a middle marker (those can't be deleted)\n    if (!indexPath) {\n      return;\n    }\n\n    // define the coordsRing that is edited\n    const coordsRing = indexPath.length > 1 ? get(coords, parentPath) : coords;\n\n    // define the markers array that is edited\n    let markerArr =\n      indexPath.length > 1 ? get(this._markers, parentPath) : this._markers;\n\n    // define whether marker is part of hole\n    const isHole =\n      parentPath[parentPath.length - 1] > 0 && this._layer instanceof L.Polygon;\n\n    // prevent removal of the layer if the vertex count is below minimum when not a hole\n    if (!this.options.removeLayerBelowMinVertexCount && !isHole) {\n      // if on a line only 2 vertices left or on a polygon 3 vertices left, don't allow to delete\n      if (\n        coordsRing.length <= 2 ||\n        (this.isPolygon() && coordsRing.length <= 3)\n      ) {\n        this._flashLayer();\n        return;\n      }\n    }\n\n    // remove coordinate\n    coordsRing.splice(index, 1);\n\n    // set new latlngs to the polygon\n    this._layer.setLatLngs(coords);\n\n    // if a polygon has less than 3 vertices, remove all of them. We will remove only one here, the if-clause after that will handle the rest\n    if (this.isPolygon() && coordsRing.length <= 2) {\n      coordsRing.splice(0, coordsRing.length);\n    }\n\n    let layerRemoved = false;\n    // if the ring of the line has no coordinates left, remove the last coord too\n    if (coordsRing.length <= 1) {\n      coordsRing.splice(0, coordsRing.length);\n\n      // Clean up MultiPolygon\n      if (parentPath.length > 1 && indexPath.length > 1) {\n        coords = removeEmptyCoordRings(coords);\n      }\n\n      // set new coords\n      this._layer.setLatLngs(coords);\n\n      // re-enable editing so unnecessary markers are removed\n      this._initMarkers();\n      layerRemoved = true;\n    }\n\n    // if no coords are left, remove the layer\n    if (!hasValues(coords)) {\n      this._layer.remove();\n    }\n\n    // remove all empty coord-rings\n    coords = removeEmptyCoordRings(coords);\n    this._layer.setLatLngs(coords);\n    // remove empty marker arrays\n    this._markers = removeEmptyCoordRings(this._markers);\n\n    // No need to calculate the middle marker when the layer was removed\n    if (!layerRemoved) {\n      // get new markerArr because we cleaned up coords and markers array\n      markerArr =\n        indexPath.length > 1 ? get(this._markers, parentPath) : this._markers;\n\n      // now handle the middle markers\n      // remove the marker and the middlemarkers next to it from the map\n      if (marker._middleMarkerPrev) {\n        this._markerGroup.removeLayer(marker._middleMarkerPrev);\n        this._removeFromCache(marker._middleMarkerPrev);\n      }\n      if (marker._middleMarkerNext) {\n        this._markerGroup.removeLayer(marker._middleMarkerNext);\n        this._removeFromCache(marker._middleMarkerNext);\n      }\n\n      // remove the marker from the map\n      this._markerGroup.removeLayer(marker);\n      this._removeFromCache(marker);\n\n      if (markerArr) {\n        let rightMarkerIndex;\n        let leftMarkerIndex;\n\n        if (this.isPolygon()) {\n          // find neighbor marker-indexes\n          rightMarkerIndex = (index + 1) % markerArr.length;\n          leftMarkerIndex = (index + (markerArr.length - 1)) % markerArr.length;\n        } else {\n          // find neighbor marker-indexes\n          leftMarkerIndex = index - 1 < 0 ? undefined : index - 1;\n          rightMarkerIndex =\n            index + 1 >= markerArr.length ? undefined : index + 1;\n        }\n\n        // don't create middlemarkers if there is only one marker left\n        if (rightMarkerIndex !== leftMarkerIndex) {\n          const leftM = markerArr[leftMarkerIndex];\n          const rightM = markerArr[rightMarkerIndex];\n          if (this.options.hideMiddleMarkers !== true) {\n            this._createMiddleMarker(leftM, rightM);\n          }\n        }\n\n        // remove the marker from the markers array\n        markerArr.splice(index, 1);\n      }\n    }\n\n    // fire edit event\n    this._fireEdit();\n    this._layerEdited = true;\n\n    // fire vertex removal event\n    // TODO: maybe fire latlng as well?\n    this._fireVertexRemoved(marker, indexPath);\n    this._fireChange(this._layer.getLatLngs(), 'Edit');\n  },\n  updatePolygonCoordsFromMarkerDrag(marker) {\n    // update polygon coords\n    const coords = this._layer.getLatLngs();\n\n    // get marker latlng\n    const latlng = marker.getLatLng();\n\n    // get indexPath of Marker\n    const { indexPath, index, parentPath } = L.PM.Utils.findDeepMarkerIndex(\n      this._markers,\n      marker\n    );\n\n    // update coord\n    const parent = indexPath.length > 1 ? get(coords, parentPath) : coords;\n    // Can be removed after https://github.com/Leaflet/Leaflet/issues/9689 is fixed\n    latlng.alt = parent[index].alt;\n    parent.splice(index, 1, latlng);\n\n    // set new coords on layer\n    this._layer.setLatLngs(coords);\n  },\n\n  _getNeighborMarkers(marker) {\n    const { indexPath, index, parentPath } = L.PM.Utils.findDeepMarkerIndex(\n      this._markers,\n      marker\n    );\n\n    // the markers neighbors\n    const markerArr =\n      indexPath.length > 1 ? get(this._markers, parentPath) : this._markers;\n\n    // find the indizes of next and previous markers\n    const nextMarkerIndex = (index + 1) % markerArr.length;\n    const prevMarkerIndex = (index + (markerArr.length - 1)) % markerArr.length;\n\n    // get prev and next marker\n    const prevMarker = markerArr[prevMarkerIndex];\n    const nextMarker = markerArr[nextMarkerIndex];\n\n    return { prevMarker, nextMarker };\n  },\n  _checkMarkerAllowedToDrag(marker) {\n    const { prevMarker, nextMarker } = this._getNeighborMarkers(marker);\n\n    const prevLine = L.polyline([prevMarker.getLatLng(), marker.getLatLng()]);\n    const nextLine = L.polyline([marker.getLatLng(), nextMarker.getLatLng()]);\n\n    const prevLineIntersection = lineIntersect(\n      this._layer.toGeoJSON(15),\n      prevLine.toGeoJSON(15)\n    );\n\n    // Filter out intersections that are the markers themselves\n    const prevLineIntersectionLen = prevLineIntersection.features.filter(\n      (f) => {\n        const coords = f.geometry.coordinates;\n        const latlng = L.latLng(coords[1], coords[0]);\n        return (\n          !latlng.equals(prevMarker.getLatLng()) &&\n          !latlng.equals(marker.getLatLng())\n        );\n      }\n    ).length;\n\n    const nextLineIntersection = lineIntersect(\n      this._layer.toGeoJSON(15),\n      nextLine.toGeoJSON(15)\n    );\n\n    // Filter out intersections that are the markers themselves\n    const nextLineIntersectionLen = nextLineIntersection.features.filter(\n      (f) => {\n        const coords = f.geometry.coordinates;\n        const latlng = L.latLng(coords[1], coords[0]);\n        return (\n          !latlng.equals(nextMarker.getLatLng()) &&\n          !latlng.equals(marker.getLatLng())\n        );\n      }\n    ).length;\n\n    if (prevLineIntersectionLen < 1 && nextLineIntersectionLen < 1) {\n      return false;\n    }\n    return true;\n  },\n  _onMarkerDragStart(e) {\n    const marker = e.target;\n    this._preventRenderingMarkers(true);\n\n    // When intersection is true while calling enable(), the cachedColor is already set\n    if (!this.cachedColor) {\n      this.cachedColor = this._layer.options.color;\n    }\n\n    if (!this._vertexValidation('move', e)) {\n      return;\n    }\n\n    const { indexPath } = L.PM.Utils.findDeepMarkerIndex(this._markers, marker);\n\n    this._fireMarkerDragStart(e, indexPath);\n\n    // if self intersection isn't allowed, save the coords upon dragstart\n    // in case we need to reset the layer\n    if (!this.options.allowSelfIntersection) {\n      this._coordsBeforeEdit = copyLatLngs(\n        this._layer,\n        this._layer.getLatLngs()\n      );\n    }\n\n    if (\n      !this.options.allowSelfIntersection &&\n      this.options.allowSelfIntersectionEdit &&\n      this.hasSelfIntersection()\n    ) {\n      this._markerAllowedToDrag = this._checkMarkerAllowedToDrag(marker);\n    } else {\n      this._markerAllowedToDrag = null;\n    }\n  },\n  _onMarkerDrag(e) {\n    // dragged marker\n    const marker = e.target;\n\n    if (!this._vertexValidationDrag(marker)) {\n      return;\n    }\n\n    const { indexPath, index, parentPath } = L.PM.Utils.findDeepMarkerIndex(\n      this._markers,\n      marker\n    );\n\n    // only continue if this is NOT a middle marker\n    if (!indexPath) {\n      return;\n    }\n\n    if (\n      !this.options.allowSelfIntersection &&\n      this.options.allowSelfIntersectionEdit &&\n      this.hasSelfIntersection() &&\n      this._markerAllowedToDrag === false\n    ) {\n      this._layer.setLatLngs(this._coordsBeforeEdit);\n      // re-enable markers for the new coords\n      this._initMarkers();\n      // check for selfintersection again (mainly to reset the style)\n      this._handleLayerStyle();\n      return;\n    }\n\n    this.updatePolygonCoordsFromMarkerDrag(marker);\n\n    // the dragged markers neighbors\n    const markerArr =\n      indexPath.length > 1 ? get(this._markers, parentPath) : this._markers;\n\n    // find the indizes of next and previous markers\n    const nextMarkerIndex = (index + 1) % markerArr.length;\n    const prevMarkerIndex = (index + (markerArr.length - 1)) % markerArr.length;\n\n    // update middle markers on the left and right\n    // be aware that \"next\" and \"prev\" might be interchanged, depending on the geojson array\n    const markerLatLng = marker.getLatLng();\n\n    // get latlng of prev and next marker\n    const prevMarkerLatLng = markerArr[prevMarkerIndex].getLatLng();\n    const nextMarkerLatLng = markerArr[nextMarkerIndex].getLatLng();\n\n    if (marker._middleMarkerNext) {\n      const middleMarkerNextLatLng = L.PM.Utils.calcMiddleLatLng(\n        this._map,\n        markerLatLng,\n        nextMarkerLatLng\n      );\n      marker._middleMarkerNext.setLatLng(middleMarkerNextLatLng);\n    }\n\n    if (marker._middleMarkerPrev) {\n      const middleMarkerPrevLatLng = L.PM.Utils.calcMiddleLatLng(\n        this._map,\n        markerLatLng,\n        prevMarkerLatLng\n      );\n      marker._middleMarkerPrev.setLatLng(middleMarkerPrevLatLng);\n    }\n\n    // if self intersection is not allowed, handle it\n    if (!this.options.allowSelfIntersection) {\n      this._handleLayerStyle();\n    }\n    this._fireMarkerDrag(e, indexPath);\n    this._fireChange(this._layer.getLatLngs(), 'Edit');\n  },\n  _onMarkerDragEnd(e) {\n    const marker = e.target;\n    this._preventRenderingMarkers(false);\n\n    if (!this._vertexValidationDragEnd(marker)) {\n      return;\n    }\n\n    const { indexPath } = L.PM.Utils.findDeepMarkerIndex(this._markers, marker);\n\n    // if self intersection is not allowed but this edit caused a self intersection,\n    // reset and cancel; do not fire events\n    let intersection =\n      !this.options.allowSelfIntersection && this.hasSelfIntersection();\n    if (\n      intersection &&\n      this.options.allowSelfIntersectionEdit &&\n      this._markerAllowedToDrag\n    ) {\n      intersection = false;\n    }\n\n    const intersectionReset =\n      !this.options.allowSelfIntersection && intersection;\n\n    this._fireMarkerDragEnd(e, indexPath, intersectionReset);\n\n    if (intersectionReset) {\n      // reset coordinates\n      this._layer.setLatLngs(this._coordsBeforeEdit);\n      this._coordsBeforeEdit = null;\n\n      // re-enable markers for the new coords\n      this._initMarkers();\n\n      if (this.options.snappable) {\n        this._initSnappableMarkers();\n      }\n\n      // check for selfintersection again (mainly to reset the style)\n      this._handleLayerStyle();\n\n      this._fireLayerReset(e, indexPath);\n      return;\n    }\n    if (\n      !this.options.allowSelfIntersection &&\n      this.options.allowSelfIntersectionEdit\n    ) {\n      this._handleLayerStyle();\n    }\n    // fire edit event\n    this._fireEdit();\n    this._layerEdited = true;\n    this._fireChange(this._layer.getLatLngs(), 'Edit');\n  },\n  _onVertexClick(e) {\n    const vertex = e.target;\n    if (vertex._dragging) {\n      return;\n    }\n\n    const { indexPath } = L.PM.Utils.findDeepMarkerIndex(this._markers, vertex);\n\n    this._fireVertexClick(e, indexPath);\n  },\n});\n", "const MarkerLimits = {\n  filterMarkerGroup() {\n    // define cache of markers\n    this.markerCache = [];\n    this.createCache();\n\n    // refresh cache when layer was edited (e.g. when a vertex was added or removed)\n    this._layer.on('pm:edit', this.createCache, this);\n\n    // apply filter for the first time\n    this.applyLimitFilters({});\n\n    if (!this.throttledApplyLimitFilters) {\n      this.throttledApplyLimitFilters = L.Util.throttle(\n        this.applyLimitFilters,\n        100,\n        this\n      );\n    }\n\n    // remove events when edit mode is disabled\n    this._layer.on('pm:disable', this._removeMarkerLimitEvents, this);\n    this._layer.on('remove', this._removeMarkerLimitEvents, this);\n\n    // add markers closest to the mouse\n    if (this.options.limitMarkersToCount > -1) {\n      // re-init markers when a vertex is removed.\n      // The reason is that syncing this cache with a removed marker was impossible to do\n      this._layer.on('pm:vertexremoved', this._initMarkers, this);\n\n      this._map.on('mousemove', this.throttledApplyLimitFilters, this);\n    }\n  },\n  _removeMarkerLimitEvents() {\n    this._map.off('mousemove', this.throttledApplyLimitFilters, this);\n    this._layer.off('pm:edit', this.createCache, this);\n    this._layer.off('pm:disable', this._removeMarkerLimitEvents, this);\n    this._layer.off('pm:vertexremoved', this._initMarkers, this);\n  },\n  createCache() {\n    const allMarkers = [...this._markerGroup.getLayers(), ...this.markerCache];\n    this.markerCache = allMarkers.filter((v, i, s) => s.indexOf(v) === i);\n  },\n  _removeFromCache(marker) {\n    const markerCacheIndex = this.markerCache.indexOf(marker);\n    if (markerCacheIndex > -1) {\n      this.markerCache.splice(markerCacheIndex, 1);\n    }\n  },\n  renderLimits(markers) {\n    this.markerCache.forEach((l) => {\n      if (markers.includes(l)) {\n        this._markerGroup.addLayer(l);\n      } else {\n        this._markerGroup.removeLayer(l);\n      }\n    });\n  },\n  applyLimitFilters({ latlng = { lat: 0, lng: 0 } }) {\n    if (this._preventRenderMarkers) {\n      return;\n    }\n    // find markers near the cursor\n    const makersNearCursor = this._filterClosestMarkers(latlng);\n\n    // all markers that we want to show\n    const markersToAdd = [...makersNearCursor];\n\n    this.renderLimits(markersToAdd);\n  },\n  _filterClosestMarkers(latlng) {\n    const markers = [...this.markerCache];\n    const limit = this.options.limitMarkersToCount;\n\n    if (limit === -1) {\n      return markers;\n    }\n\n    // sort markers by distance to cursor\n    markers.sort((l, t) => {\n      const distanceA = l._latlng.distanceTo(latlng);\n      const distanceB = t._latlng.distanceTo(latlng);\n\n      return distanceA - distanceB;\n    });\n\n    // reduce markers to number of limit\n    const closest = markers.filter((l, i) => (limit > -1 ? i < limit : true));\n\n    return closest;\n  },\n  _preventRenderMarkers: false,\n  _preventRenderingMarkers(value) {\n    this._preventRenderMarkers = !!value;\n  },\n};\n\nexport default MarkerLimits;\n", "import lineIntersect from '@turf/line-intersect';\nimport Edit from './L.PM.Edit';\n\nEdit.Polygon = Edit.Line.extend({\n  _shape: 'Polygon',\n  _checkMarkerAllowedToDrag(marker) {\n    const { prevMarker, nextMarker } = this._getNeighborMarkers(marker);\n\n    const prevLine = L.polyline([prevMarker.getLatLng(), marker.getLatLng()]);\n    const nextLine = L.polyline([marker.getLatLng(), nextMarker.getLatLng()]);\n\n    const prevLineIntersection = lineIntersect(\n      this._layer.toGeoJSON(15),\n      prevLine.toGeoJSON(15)\n    );\n\n    // Filter out intersections that are the markers themselves\n    const prevLineIntersectionLen = prevLineIntersection.features.filter(\n      (f) => {\n        const coords = f.geometry.coordinates;\n        const latlng = L.latLng(coords[1], coords[0]);\n        return (\n          !latlng.equals(prevMarker.getLatLng()) &&\n          !latlng.equals(marker.getLatLng())\n        );\n      }\n    ).length;\n\n    const nextLineIntersection = lineIntersect(\n      this._layer.toGeoJSON(15),\n      nextLine.toGeoJSON(15)\n    );\n\n    // Filter out intersections that are the markers themselves\n    const nextLineIntersectionLen = nextLineIntersection.features.filter(\n      (f) => {\n        const coords = f.geometry.coordinates;\n        const latlng = L.latLng(coords[1], coords[0]);\n        return (\n          !latlng.equals(nextMarker.getLatLng()) &&\n          !latlng.equals(marker.getLatLng())\n        );\n      }\n    ).length;\n\n    if (prevLineIntersectionLen < 1 && nextLineIntersectionLen < 1) {\n      return false;\n    }\n    return true;\n  },\n});\n", "// Corner detection based on Leaflet Draw's Edit.Rectangle.js Class:\n// https://github.com/Leaflet/Leaflet.draw/blob/master/src/edit/handler/Edit.Rectangle.js\nimport Edit from './L.PM.Edit';\nimport { calcAngle } from '../helpers';\n\nEdit.Rectangle = Edit.Polygon.extend({\n  _shape: 'Rectangle',\n  // initializes Rectangle Markers\n  _initMarkers() {\n    const map = this._map;\n    const corners = this._findCorners();\n\n    // cleanup old ones first\n    if (this._markerGroup) {\n      this._markerGroup.clearLayers();\n    }\n\n    // add markerGroup to map, markerGroup includes regular and middle markers\n    this._markerGroup = new L.FeatureGroup();\n    this._markerGroup._pmTempLayer = true;\n    map.addLayer(this._markerGroup);\n\n    // create markers for four corners of rectangle\n    this._markers = [];\n\n    // nest set of corner markers in a 2D array so that we can Cut this Rectangle, if needed\n    this._markers[0] = corners.map(this._createMarker, this);\n\n    // convenience alias, for better readability\n    [this._cornerMarkers] = this._markers;\n\n    // Update the marker latlngs if the rectangle is rotated\n    this._layer.getLatLngs()[0].forEach((latlng, index) => {\n      const marker = this._cornerMarkers.find((m) => m._index === index);\n      if (marker) {\n        marker.setLatLng(latlng);\n      }\n    });\n  },\n  applyOptions() {\n    if (this.options.snappable) {\n      this._initSnappableMarkers();\n    } else {\n      this._disableSnapping();\n    }\n    this._addMarkerEvents();\n  },\n\n  // creates initial markers for coordinates\n  _createMarker(latlng, index) {\n    const marker = new L.Marker(latlng, {\n      draggable: true,\n      icon: L.divIcon({ className: 'marker-icon' }),\n    });\n    this._setPane(marker, 'vertexPane');\n\n    marker._origLatLng = latlng;\n    marker._index = index;\n    marker._pmTempLayer = true;\n\n    marker.on('click', this._onVertexClick, this);\n\n    this._markerGroup.addLayer(marker);\n\n    return marker;\n  },\n  // Add marker events after adding the snapping events to the markers, beacause of the execution order\n  _addMarkerEvents() {\n    this._markers[0].forEach((marker) => {\n      marker.on('dragstart', this._onMarkerDragStart, this);\n      marker.on('drag', this._onMarkerDrag, this);\n      marker.on('dragend', this._onMarkerDragEnd, this);\n\n      // TODO: Can we remove this? The _removeMarker Event is a empty function\n      if (!this.options.preventMarkerRemoval) {\n        marker.on('contextmenu', this._removeMarker, this);\n      }\n    });\n  },\n  // Empty callback for 'contextmenu' binding set in L.PM.Edit.Line.js's _createMarker method (AKA, right-click on marker event)\n  // (A Rectangle is designed to always remain a \"true\" rectangle -- if you want it editable, use Polygon Tool instead!!!)\n  _removeMarker() {\n    // The method, it does nothing!!!\n    return null;\n  },\n\n  _onMarkerDragStart(e) {\n    if (!this._vertexValidation('move', e)) {\n      return;\n    }\n\n    // dragged marker\n    const draggedMarker = e.target;\n    // Store/update a reference to marker in opposite corner\n    const corners = this._cornerMarkers;\n    draggedMarker._oppositeCornerLatLng = corners\n      .find((m) => m._index === (draggedMarker._index + 2) % 4)\n      .getLatLng();\n\n    // Automatically unsnap all markers on drag start (they'll snap back if close enough to another snappable object)\n    // (Without this, it's occasionally possible for a marker to get stuck as 'snapped,' which prevents Rectangle resizing)\n    draggedMarker._snapped = false;\n\n    const { indexPath } = L.PM.Utils.findDeepMarkerIndex(\n      this._markers,\n      draggedMarker\n    );\n\n    this._fireMarkerDragStart(e, indexPath);\n  },\n\n  _onMarkerDrag(e) {\n    // dragged marker\n    const draggedMarker = e.target;\n\n    if (!this._vertexValidationDrag(draggedMarker)) {\n      return;\n    }\n\n    // only continue if this is NOT a middle marker (should NEVER be one, but this is just a safety check)\n    if (draggedMarker._index === undefined) {\n      return;\n    }\n\n    this._adjustRectangleForMarkerMove(draggedMarker);\n\n    const { indexPath } = L.PM.Utils.findDeepMarkerIndex(\n      this._markers,\n      draggedMarker\n    );\n    this._fireMarkerDrag(e, indexPath);\n    this._fireChange(this._layer.getLatLngs(), 'Edit');\n  },\n\n  _onMarkerDragEnd(e) {\n    // dragged marker\n    const draggedMarker = e.target;\n    if (!this._vertexValidationDragEnd(draggedMarker)) {\n      return;\n    }\n\n    // Clean-up data attributes\n    this._cornerMarkers.forEach((m) => {\n      delete m._oppositeCornerLatLng;\n    });\n\n    const { indexPath } = L.PM.Utils.findDeepMarkerIndex(\n      this._markers,\n      draggedMarker\n    );\n    this._fireMarkerDragEnd(e, indexPath);\n\n    // fire edit event\n    this._fireEdit();\n    this._layerEdited = true;\n    this._fireChange(this._layer.getLatLngs(), 'Edit');\n  },\n\n  // adjusts the rectangle's size and bounds whenever a marker is moved\n  // params: movedMarker -- the Marker object\n  _adjustRectangleForMarkerMove(movedMarker) {\n    // update moved marker coordinates\n    L.extend(movedMarker._origLatLng, movedMarker._latlng);\n\n    // update rectangle boundaries, based on moved marker's new LatLng and cached opposite corner's LatLng\n    const corners = L.PM.Utils._getRotatedRectangle(\n      movedMarker.getLatLng(),\n      movedMarker._oppositeCornerLatLng,\n      this.getAngle(),\n      this._map\n    );\n    this._layer.setLatLngs(corners);\n\n    // Reposition the markers at each corner\n    this._adjustAllMarkers(movedMarker);\n\n    // Redraw the shape (to update altered rectangle)\n    this._layer.redraw();\n  },\n\n  // adjusts the position of all Markers\n  // params: markerLatLngs -- an array of exactly LatLng objects\n  _adjustAllMarkers(movedMarker) {\n    const markerLatLngs = this._layer.getLatLngs()[0];\n\n    if (\n      markerLatLngs &&\n      markerLatLngs.length !== 4 &&\n      markerLatLngs.length > 0\n    ) {\n      // The layers is currently to small and has not enough latlngs.\n      // Leaflet destroys the valid Rectangle by removing the last latlng if the last and first latlng are equal. See: Leaflet#7464 V1.7.1\n\n      // update all possible markers\n      markerLatLngs.forEach((latlng, index) => {\n        this._cornerMarkers[index].setLatLng(latlng);\n      });\n\n      // apply to all markers with no latlng on the layer, the first latlng\n      const restMarkers = this._cornerMarkers.slice(markerLatLngs.length);\n      restMarkers.forEach((marker) => {\n        marker.setLatLng(markerLatLngs[0]);\n      });\n    } else if (!markerLatLngs || !markerLatLngs.length) {\n      console.error('The layer has no LatLngs');\n    } else {\n      const correctIndex = markerLatLngs.findIndex((latlng) =>\n        movedMarker.getLatLng().equals(latlng)\n      );\n\n      if (correctIndex > -1) {\n        // keep the correct index order of the markers. LatLngs index order can be changed\n        // after using setLatLngs but the markers are still on the same place\n        this._cornerMarkers[(movedMarker._index + 1) % 4].setLatLng(\n          markerLatLngs[(correctIndex + 1) % 4]\n        );\n        this._cornerMarkers[(movedMarker._index + 2) % 4].setLatLng(\n          markerLatLngs[(correctIndex + 2) % 4]\n        );\n        this._cornerMarkers[(movedMarker._index + 3) % 4].setLatLng(\n          markerLatLngs[(correctIndex + 3) % 4]\n        );\n      } else {\n        this._cornerMarkers.forEach((marker) => {\n          marker.setLatLng(markerLatLngs[marker._index]);\n        });\n      }\n    }\n  },\n  // finds the 4 corners of the current bounding box\n  // returns array of 4 LatLng objects in this order: Northwest corner, Northeast corner, Southeast corner, Southwest corner\n  _findCorners() {\n    if (this._angle === undefined) {\n      this.setInitAngle(\n        calcAngle(\n          this._map,\n          this._layer.getLatLngs()[0][0],\n          this._layer.getLatLngs()[0][1]\n        ) || 0\n      );\n    }\n\n    const latlngs = this._layer.getLatLngs()[0];\n    return L.PM.Utils._getRotatedRectangle(\n      latlngs[0],\n      latlngs[2],\n      this.getAngle(),\n      this._map || this\n    );\n  },\n});\n", "import Edit from './L.PM.Edit';\nimport { destinationOnLine } from '../helpers';\n\nEdit.CircleMarker = Edit.extend({\n  _shape: 'CircleMarker',\n  initialize(layer) {\n    this._layer = layer;\n    this._enabled = false;\n\n    this._minRadiusOption = 'minRadiusCircleMarker';\n    this._maxRadiusOption = 'maxRadiusCircleMarker';\n    this._editableOption = 'resizeableCircleMarker';\n\n    // create polygon around the circle border\n    this._updateHiddenPolyCircle();\n  },\n  // TODO: remove default option in next major Release\n  enable(options = { draggable: true, snappable: true }) {\n    L.Util.setOptions(this, options);\n    // TODO: remove with next major release\n    if (this.options.editable) {\n      this.options.resizeableCircleMarker = this.options.editable;\n      delete this.options.editable;\n    }\n\n    // layer is not allowed to edit\n    // cancel when map isn't available, this happens when it is removed before this fires\n    if (!this.options.allowEditing || !this._layer._map) {\n      this.disable();\n      return;\n    }\n\n    this._map = this._layer._map;\n\n    if (this.enabled()) {\n      // if it was already enabled, disable first\n      // we don't block enabling again because new options might be passed\n      this.disable();\n    }\n    this.applyOptions();\n\n    // if shape gets removed from map, disable edit mode\n    this._layer.on('remove', this.disable, this);\n\n    // change state\n    this._enabled = true;\n\n    this._extendingEnable();\n\n    // create polygon around the circle border\n    this._updateHiddenPolyCircle();\n\n    this._fireEnable();\n  },\n  _extendingEnable() {\n    // if CircleMarker is dragged while draw mode\n    this._layer.on('pm:dragstart', this._onDragStart, this);\n    this._layer.on('pm:drag', this._onMarkerDrag, this);\n    this._layer.on('pm:dragend', this._onMarkerDragEnd, this);\n  },\n  disable() {\n    // prevent disabling if layer is being dragged\n    if (this.dragging()) {\n      return;\n    }\n\n    // Add map if it is not already set. This happens when disable() is called before enable()\n    if (!this._map) {\n      this._map = this._layer._map;\n    }\n\n    if (!this._map) {\n      return;\n    }\n\n    // if it's not enabled, it doesn't need to be disabled\n    if (!this.enabled()) {\n      return;\n    }\n\n    // disable dragging of non-editable circle\n    if (this.layerDragEnabled()) {\n      this.disableLayerDrag();\n    }\n    if (this._helperLayers) {\n      this._helperLayers.clearLayers();\n      this._helperLayers.removeFrom(this._map);\n    }\n    if (this.options[this._editableOption]) {\n      this._map.off('move', this._syncMarkers, this);\n      this._outerMarker.off('drag', this._handleOuterMarkerSnapping, this);\n    } else {\n      this._map.off('move', this._updateHiddenPolyCircle, this);\n    }\n\n    this._extendingDisable();\n\n    this._layer.off('remove', this.disable, this);\n\n    if (this._layerEdited) {\n      this._fireUpdate();\n    }\n    this._layerEdited = false;\n    this._fireDisable();\n\n    this._enabled = false;\n  },\n  _extendingDisable() {\n    this._layer.off('contextmenu', this._removeMarker, this);\n  },\n  enabled() {\n    return this._enabled;\n  },\n  toggleEdit(options) {\n    if (!this.enabled()) {\n      this.enable(options);\n    } else {\n      this.disable();\n    }\n  },\n  applyOptions() {\n    if (this.options[this._editableOption]) {\n      this._initMarkers();\n      this._map.on('move', this._syncMarkers, this);\n\n      // init snapping in different ways\n      if (this.options.snappable) {\n        this._initSnappableMarkers();\n        // update marker latlng when snapped latlng radius is out of min/max\n        this._outerMarker.on('drag', this._handleOuterMarkerSnapping, this);\n        // sync the hintline with hint marker\n        this._outerMarker.on('move', this._syncHintLine, this);\n        this._outerMarker.on('move', this._syncCircleRadius, this);\n      } else {\n        this._disableSnapping();\n      }\n    } else {\n      if (this.options.draggable) {\n        this.enableLayerDrag();\n      }\n      // only update the circle border poly\n      this._map.on('move', this._updateHiddenPolyCircle, this);\n\n      if (this.options.snappable) {\n        this._initSnappableMarkersDrag();\n      } else {\n        this._disableSnappingDrag();\n      }\n    }\n\n    this._extendingApplyOptions();\n  },\n  _extendingApplyOptions() {\n    // enable removal for the marker\n    if (!this.options.preventMarkerRemoval) {\n      this._layer.on('contextmenu', this._removeMarker, this);\n    }\n  },\n  _initMarkers() {\n    const map = this._map;\n\n    // cleanup old ones first\n    if (this._helperLayers) {\n      this._helperLayers.removeFrom(map);\n      this._helperLayers.clearLayers();\n    }\n\n    // add markerGroup to map, markerGroup includes regular and middle markers\n    this._helperLayers = new L.FeatureGroup();\n    this._helperLayers._pmTempLayer = true;\n    this._helperLayers.addTo(map);\n\n    // create marker for each coordinate\n    const center = this._layer.getLatLng();\n    const radius = this._layer._radius;\n\n    const outer = this._getLatLngOnCircle(center, radius);\n\n    this._centerMarker = this._createCenterMarker(center);\n    this._outerMarker = this._createOuterMarker(outer);\n    this._markers = [this._centerMarker, this._outerMarker];\n    this._createHintLine(this._centerMarker, this._outerMarker);\n  },\n  _getLatLngOnCircle(center, radius) {\n    const pointA = this._map.project(center);\n    const pointB = L.point(pointA.x + radius, pointA.y);\n    return this._map.unproject(pointB);\n  },\n  _createHintLine(markerA, markerB) {\n    const A = markerA.getLatLng();\n    const B = markerB.getLatLng();\n    this._hintline = L.polyline([A, B], this.options.hintlineStyle);\n    this._setPane(this._hintline, 'layerPane');\n    this._hintline._pmTempLayer = true;\n    this._helperLayers.addLayer(this._hintline);\n  },\n  _createCenterMarker(latlng) {\n    const marker = this._createMarker(latlng);\n    if (this.options.draggable) {\n      L.DomUtil.addClass(marker._icon, 'leaflet-pm-draggable');\n      marker.on('move', this._moveCircle, this);\n    } else {\n      marker.dragging.disable();\n    }\n    return marker;\n  },\n  _createOuterMarker(latlng) {\n    const marker = this._createMarker(latlng);\n    marker.on('drag', this._resizeCircle, this);\n    return marker;\n  },\n  _createMarker(latlng) {\n    const marker = new L.Marker(latlng, {\n      draggable: true,\n      icon: L.divIcon({ className: 'marker-icon' }),\n    });\n    this._setPane(marker, 'vertexPane');\n\n    marker._origLatLng = latlng;\n    marker._pmTempLayer = true;\n\n    marker.on('dragstart', this._onMarkerDragStart, this);\n    marker.on('drag', this._onMarkerDrag, this);\n    marker.on('dragend', this._onMarkerDragEnd, this);\n    marker.on('click', this._onVertexClick, this);\n\n    this._helperLayers.addLayer(marker);\n\n    return marker;\n  },\n\n  _moveCircle(e) {\n    const draggedMarker = e.target;\n    if (draggedMarker._cancelDragEventChain) {\n      return;\n    }\n\n    const center = this._centerMarker.getLatLng();\n    this._layer.setLatLng(center);\n\n    const radius = this._layer._radius;\n\n    const outer = this._getLatLngOnCircle(center, radius);\n    // don't call .setLatLng() because it fires the `move` event and then the radius is changed because of _syncCircleRadius #892\n    this._outerMarker._latlng = outer;\n    this._outerMarker.update();\n    this._syncHintLine();\n\n    this._updateHiddenPolyCircle();\n\n    this._fireCenterPlaced('Edit');\n    this._fireChange(this._layer.getLatLng(), 'Edit');\n  },\n  _syncMarkers() {\n    const center = this._layer.getLatLng();\n    const radius = this._layer._radius;\n    const outer = this._getLatLngOnCircle(center, radius);\n    this._outerMarker.setLatLng(outer);\n    this._centerMarker.setLatLng(center);\n    this._syncHintLine();\n    this._updateHiddenPolyCircle();\n  },\n  _resizeCircle() {\n    this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker());\n    this._syncHintLine();\n    this._syncCircleRadius();\n  },\n  _syncCircleRadius() {\n    const A = this._centerMarker.getLatLng();\n    const B = this._outerMarker.getLatLng();\n\n    const distance = this._distanceCalculation(A, B);\n\n    if (\n      this.options[this._minRadiusOption] &&\n      distance < this.options[this._minRadiusOption]\n    ) {\n      this._layer.setRadius(this.options[this._minRadiusOption]);\n    } else if (\n      this.options[this._maxRadiusOption] &&\n      distance > this.options[this._maxRadiusOption]\n    ) {\n      this._layer.setRadius(this.options[this._maxRadiusOption]);\n    } else {\n      this._layer.setRadius(distance);\n    }\n\n    this._updateHiddenPolyCircle();\n    this._fireChange(this._layer.getLatLng(), 'Edit');\n  },\n  _syncHintLine() {\n    const A = this._centerMarker.getLatLng();\n    const B = this._outerMarker.getLatLng();\n    // set coords for hintline from marker to last vertex of drawin polyline\n    this._hintline.setLatLngs([A, B]);\n  },\n  _removeMarker() {\n    if (this.options[this._editableOption]) {\n      this.disable();\n    }\n    this._layer.remove();\n    this._fireRemove(this._layer);\n    this._fireRemove(this._map, this._layer);\n  },\n  _onDragStart() {\n    this._map.pm.Draw.CircleMarker._layerIsDragging = true;\n  },\n  _onMarkerDragStart(e) {\n    if (!this._vertexValidation('move', e)) {\n      return;\n    }\n\n    this._fireMarkerDragStart(e);\n  },\n  _onMarkerDrag(e) {\n    // dragged marker\n    const draggedMarker = e.target;\n    if (\n      draggedMarker instanceof L.Marker &&\n      !this._vertexValidationDrag(draggedMarker)\n    ) {\n      return;\n    }\n\n    this._fireMarkerDrag(e);\n  },\n  _onMarkerDragEnd(e) {\n    this._extedingMarkerDragEnd();\n\n    // dragged marker\n    const draggedMarker = e.target;\n    if (!this._vertexValidationDragEnd(draggedMarker)) {\n      return;\n    }\n    if (this.options[this._editableOption]) {\n      this._fireEdit();\n      this._layerEdited = true;\n    }\n    this._fireMarkerDragEnd(e);\n  },\n  _extedingMarkerDragEnd() {\n    this._map.pm.Draw.CircleMarker._layerIsDragging = false;\n  },\n  // _initSnappableMarkers when option editable is not true\n  _initSnappableMarkersDrag() {\n    const marker = this._layer;\n\n    this.options.snapDistance = this.options.snapDistance || 30;\n    this.options.snapSegment =\n      this.options.snapSegment === undefined ? true : this.options.snapSegment;\n\n    marker.off('pm:drag', this._handleSnapping, this);\n    marker.on('pm:drag', this._handleSnapping, this);\n\n    marker.off('pm:dragend', this._cleanupSnapping, this);\n    marker.on('pm:dragend', this._cleanupSnapping, this);\n\n    marker.off('pm:dragstart', this._unsnap, this);\n    marker.on('pm:dragstart', this._unsnap, this);\n  },\n  // _disableSnapping when option editable is not true\n  _disableSnappingDrag() {\n    const marker = this._layer;\n\n    marker.off('pm:drag', this._handleSnapping, this);\n    marker.off('pm:dragend', this._cleanupSnapping, this);\n    marker.off('pm:dragstart', this._unsnap, this);\n  },\n  _updateHiddenPolyCircle() {\n    const map = this._layer._map || this._map;\n    if (map) {\n      const radius = L.PM.Utils.pxRadiusToMeterRadius(\n        this._layer.getRadius(),\n        map,\n        this._layer.getLatLng()\n      );\n      const _layer = L.circle(this._layer.getLatLng(), this._layer.options);\n      _layer.setRadius(radius);\n\n      const crsSimple = map && map.pm._isCRSSimple();\n      if (this._hiddenPolyCircle) {\n        this._hiddenPolyCircle.setLatLngs(\n          L.PM.Utils.circleToPolygon(_layer, 200, !crsSimple).getLatLngs()\n        );\n      } else {\n        this._hiddenPolyCircle = L.PM.Utils.circleToPolygon(\n          _layer,\n          200,\n          !crsSimple\n        );\n      }\n\n      if (!this._hiddenPolyCircle._parentCopy) {\n        this._hiddenPolyCircle._parentCopy = this._layer;\n      }\n    }\n  },\n  _getNewDestinationOfOuterMarker() {\n    const latlng = this._centerMarker.getLatLng();\n    let secondLatLng = this._outerMarker.getLatLng();\n\n    const distance = this._distanceCalculation(latlng, secondLatLng);\n\n    if (\n      this.options[this._minRadiusOption] &&\n      distance < this.options[this._minRadiusOption]\n    ) {\n      secondLatLng = destinationOnLine(\n        this._map,\n        latlng,\n        secondLatLng,\n        this._getMinDistanceInMeter(latlng)\n      );\n    } else if (\n      this.options[this._maxRadiusOption] &&\n      distance > this.options[this._maxRadiusOption]\n    ) {\n      secondLatLng = destinationOnLine(\n        this._map,\n        latlng,\n        secondLatLng,\n        this._getMaxDistanceInMeter(latlng)\n      );\n    }\n    return secondLatLng;\n  },\n  _handleOuterMarkerSnapping() {\n    if (this._outerMarker._snapped) {\n      const latlng = this._centerMarker.getLatLng();\n      const secondLatLng = this._outerMarker.getLatLng();\n      const distance = this._distanceCalculation(latlng, secondLatLng);\n      if (\n        this.options[this._minRadiusOption] &&\n        distance < this.options[this._minRadiusOption]\n      ) {\n        this._outerMarker.setLatLng(this._outerMarker._orgLatLng);\n      } else if (\n        this.options[this._maxRadiusOption] &&\n        distance > this.options[this._maxRadiusOption]\n      ) {\n        this._outerMarker.setLatLng(this._outerMarker._orgLatLng);\n      }\n    }\n    // calculate the new latlng of marker if radius is out of min/max\n    this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker());\n  },\n  _distanceCalculation(A, B) {\n    return this._map.project(A).distanceTo(this._map.project(B));\n  },\n  _getMinDistanceInMeter(latlng) {\n    return L.PM.Utils.pxRadiusToMeterRadius(\n      this.options[this._minRadiusOption],\n      this._map,\n      latlng\n    );\n  },\n  _getMaxDistanceInMeter(latlng) {\n    return L.PM.Utils.pxRadiusToMeterRadius(\n      this.options[this._maxRadiusOption],\n      this._map,\n      latlng\n    );\n  },\n  _onVertexClick(e) {\n    const vertex = e.target;\n    if (vertex._dragging) {\n      return;\n    }\n\n    this._fireVertexClick(e, undefined);\n  },\n});\n", "import Edit from './L.PM.Edit';\n\nEdit.Circle = Edit.CircleMarker.extend({\n  _shape: 'Circle',\n  initialize(layer) {\n    this._layer = layer;\n    this._enabled = false;\n\n    this._minRadiusOption = 'minRadiusCircle';\n    this._maxRadiusOption = 'maxRadiusCircle';\n    this._editableOption = 'resizeableCircle';\n    // create polygon around the circle border\n    this._updateHiddenPolyCircle();\n  },\n  enable(options) {\n    // TODO: this can be removed after the default options of CircleMarker.enable are removed\n    L.PM.Edit.CircleMarker.prototype.enable.call(this, options || {});\n  },\n  _extendingEnable() {},\n  _extendingDisable() {\n    this._layer.off('remove', this.disable, this);\n\n    // remove draggable class\n    const el = this._layer._path\n      ? this._layer._path\n      : this._layer._renderer._container;\n    L.DomUtil.removeClass(el, 'leaflet-pm-draggable');\n  },\n  _extendingApplyOptions() {},\n  _syncMarkers() {},\n  _removeMarker() {},\n  _onDragStart() {},\n  _extedingMarkerDragEnd() {},\n  _updateHiddenPolyCircle() {\n    const crsSimple = this._map && this._map.pm._isCRSSimple();\n    if (this._hiddenPolyCircle) {\n      this._hiddenPolyCircle.setLatLngs(\n        L.PM.Utils.circleToPolygon(this._layer, 200, !crsSimple).getLatLngs()\n      );\n    } else {\n      this._hiddenPolyCircle = L.PM.Utils.circleToPolygon(\n        this._layer,\n        200,\n        !crsSimple\n      );\n    }\n\n    if (!this._hiddenPolyCircle._parentCopy) {\n      this._hiddenPolyCircle._parentCopy = this._layer;\n    }\n  },\n  _distanceCalculation(A, B) {\n    return this._map.distance(A, B);\n  },\n  _getMinDistanceInMeter() {\n    return this.options[this._minRadiusOption];\n  },\n  _getMaxDistanceInMeter() {\n    return this.options[this._maxRadiusOption];\n  },\n  _onVertexClick(e) {\n    const vertex = e.target;\n    if (vertex._dragging) {\n      return;\n    }\n\n    this._fireVertexClick(e, undefined);\n  },\n});\n", "import Edit from './L.PM.Edit';\n\nEdit.ImageOverlay = Edit.extend({\n  _shape: 'ImageOverlay',\n  initialize(layer) {\n    this._layer = layer;\n    this._enabled = false;\n  },\n  toggleEdit(options) {\n    if (!this.enabled()) {\n      this.enable(options);\n    } else {\n      this.disable();\n    }\n  },\n  enabled() {\n    return this._enabled;\n  },\n  // TODO: remove default option in next major Release\n  enable(options = { draggable: true, snappable: true }) {\n    L.Util.setOptions(this, options);\n    this._map = this._layer._map;\n    // cancel when map isn't available, this happens when the polygon is removed before this fires\n    if (!this._map) {\n      return;\n    }\n\n    // layer is not allowed to edit\n    if (!this.options.allowEditing) {\n      this.disable();\n      return;\n    }\n\n    if (!this.enabled()) {\n      // if it was already enabled, disable first\n      // we don't block enabling again because new options might be passed\n      this.disable();\n    }\n\n    this.enableLayerDrag();\n\n    // if shape gets removed from map, disable edit mode\n    this._layer.on('remove', this.disable, this);\n\n    // change state\n    this._enabled = true;\n\n    // create markers for four corners of ImageOverlay\n    this._otherSnapLayers = this._findCorners();\n\n    this._fireEnable();\n  },\n  disable() {\n    // prevent disabling if layer is being dragged\n    if (this._dragging) {\n      return;\n    }\n\n    // Add map if it is not already set. This happens when disable() is called before enable()\n    if (!this._map) {\n      this._map = this._layer._map;\n    }\n    // disable dragging, as this could have been active even without being enabled\n    this.disableLayerDrag();\n\n    // remove listener\n    this._layer.off('remove', this.disable, this);\n\n    // only fire events if it was enabled before\n    if (!this.enabled()) {\n      if (this._layerEdited) {\n        this._fireUpdate();\n      }\n      this._layerEdited = false;\n      this._fireDisable();\n    }\n\n    this._enabled = false;\n  },\n  _findCorners() {\n    const corners = this._layer.getBounds();\n\n    const northwest = corners.getNorthWest();\n    const northeast = corners.getNorthEast();\n    const southeast = corners.getSouthEast();\n    const southwest = corners.getSouthWest();\n\n    return [northwest, northeast, southeast, southwest];\n  },\n});\n", "import Edit from './L.PM.Edit';\n\nEdit.Text = Edit.extend({\n  _shape: 'Text',\n  initialize(layer) {\n    this._layer = layer;\n    this._enabled = false;\n  },\n  enable(options) {\n    L.Util.setOptions(this, options);\n\n    if (!this.textArea) {\n      return;\n    }\n\n    // layer is not allowed to edit\n    if (!this.options.allowEditing || !this._layer._map) {\n      this.disable();\n      return;\n    }\n\n    this._map = this._layer._map;\n\n    if (this.enabled()) {\n      this.disable();\n    }\n    this.applyOptions();\n\n    this._safeToCacheDragState = true;\n\n    this._focusChange();\n    this.textArea.readOnly = false;\n    this.textArea.classList.remove('pm-disabled');\n\n    // if shape gets removed from map, disable edit mode\n    this._layer.on('remove', this.disable, this);\n    L.DomEvent.on(this.textArea, 'input', this._autoResize, this);\n    L.DomEvent.on(this.textArea, 'focus', this._focusChange, this);\n    L.DomEvent.on(this.textArea, 'blur', this._focusChange, this);\n    this._layer.on('dblclick', L.DomEvent.stop);\n\n    L.DomEvent.off(this.textArea, 'mousedown', this._preventTextSelection);\n\n    this._enabled = true;\n\n    this._fireEnable();\n  },\n  disable() {\n    // if it's not enabled, it doesn't need to be disabled\n    if (!this.enabled()) {\n      return;\n    }\n\n    // remove listener\n    this._layer.off('remove', this.disable, this);\n    L.DomEvent.off(this.textArea, 'input', this._autoResize, this);\n    L.DomEvent.off(this.textArea, 'focus', this._focusChange, this);\n    L.DomEvent.off(this.textArea, 'blur', this._focusChange, this);\n    document.removeEventListener('click', this._documentClickThis, {\n      capture: true,\n    });\n\n    this._focusChange();\n    this.textArea.readOnly = true;\n    this.textArea.classList.add('pm-disabled');\n\n    // remove selection\n    const focusedElement = document.activeElement;\n    // Chrome needs the focus on the element to change the selection\n    this.textArea.focus();\n    this.textArea.selectionStart = 0;\n    this.textArea.selectionEnd = 0;\n    L.DomEvent.on(this.textArea, 'mousedown', this._preventTextSelection);\n    focusedElement.focus();\n\n    this._disableOnBlurActive = false;\n\n    if (this._layerEdited) {\n      this._fireUpdate();\n    }\n    this._layerEdited = false;\n    this._fireDisable();\n\n    this._enabled = false;\n  },\n  enabled() {\n    return this._enabled;\n  },\n  toggleEdit(options) {\n    if (!this.enabled()) {\n      this.enable(options);\n    } else {\n      this.disable();\n    }\n  },\n  applyOptions() {\n    if (this.options.snappable) {\n      this._initSnappableMarkers();\n    } else {\n      this._disableSnapping();\n    }\n  },\n  // overwrite initSnappableMarkers from Snapping.js Mixin\n  _initSnappableMarkers() {\n    const marker = this._layer;\n\n    this.options.snapDistance = this.options.snapDistance || 30;\n    this.options.snapSegment =\n      this.options.snapSegment === undefined ? true : this.options.snapSegment;\n\n    marker.off('pm:drag', this._handleSnapping, this);\n    marker.on('pm:drag', this._handleSnapping, this);\n\n    marker.off('pm:dragend', this._cleanupSnapping, this);\n    marker.on('pm:dragend', this._cleanupSnapping, this);\n\n    marker.off('pm:dragstart', this._unsnap, this);\n    marker.on('pm:dragstart', this._unsnap, this);\n  },\n  _disableSnapping() {\n    const marker = this._layer;\n    marker.off('pm:drag', this._handleSnapping, this);\n    marker.off('pm:dragend', this._cleanupSnapping, this);\n    marker.off('pm:dragstart', this._unsnap, this);\n  },\n  _autoResize() {\n    this.textArea.style.height = '1px';\n    this.textArea.style.width = '1px';\n    const height =\n      this.textArea.scrollHeight > 21 ? this.textArea.scrollHeight : 21;\n    const width =\n      this.textArea.scrollWidth > 16 ? this.textArea.scrollWidth : 16;\n    this.textArea.style.height = `${height}px`;\n    this.textArea.style.width = `${width}px`;\n    this._layer.options.text = this.getText();\n    this._fireTextChange(this.getText());\n  },\n\n  _disableOnBlur() {\n    this._disableOnBlurActive = true;\n    // we need this timeout because else the place click event is triggered here too.\n    setTimeout(() => {\n      if (this.enabled()) {\n        this._documentClickThis =\n          this._documentClickThis || this._documentClick.bind(this);\n        document.addEventListener('click', this._documentClickThis, {\n          capture: true,\n        });\n      }\n    }, 100);\n  },\n  _documentClick(e) {\n    if (e.target !== this.textArea) {\n      this.disable();\n      if (!this.getText() && this.options.removeIfEmpty) {\n        this.remove();\n      }\n    }\n  },\n\n  _focusChange(e = {}) {\n    const focusAlreadySet = this._hasFocus;\n    this._hasFocus = e.type === 'focus';\n    if (!focusAlreadySet !== !this._hasFocus) {\n      if (this._hasFocus) {\n        this._applyFocus();\n        this._focusText = this.getText();\n        this._fireTextFocus();\n      } else {\n        this._removeFocus();\n        this._fireTextBlur();\n        if (this._focusText !== this.getText()) {\n          this._fireEdit();\n          this._layerEdited = true;\n        }\n      }\n    }\n  },\n  _applyFocus() {\n    this.textArea.classList.add('pm-hasfocus');\n\n    if (this._map.dragging) {\n      // save current map dragging state\n      if (this._safeToCacheDragState) {\n        this._originalMapDragState = this._map.dragging._enabled;\n        // don't cache the state again until another mouse up is registered\n        this._safeToCacheDragState = false;\n      }\n      this._map.dragging.disable();\n    }\n  },\n  _removeFocus() {\n    if (this._map.dragging) {\n      if (this._originalMapDragState) {\n        this._map.dragging.enable();\n      }\n      this._safeToCacheDragState = true;\n    }\n\n    this.textArea.classList.remove('pm-hasfocus');\n  },\n\n  focus() {\n    if (!this.enabled()) {\n      throw new TypeError('Layer is not enabled');\n    }\n    this.textArea.focus();\n  },\n\n  blur() {\n    if (!this.enabled()) {\n      throw new TypeError('Layer is not enabled');\n    }\n    this.textArea.blur();\n    if (this._disableOnBlurActive) {\n      this.disable();\n    }\n  },\n\n  hasFocus() {\n    return this._hasFocus;\n  },\n\n  getElement() {\n    return this.textArea;\n  },\n\n  setText(text) {\n    if (text) {\n      this.textArea.value = text;\n    }\n    this._autoResize();\n  },\n\n  getText() {\n    return this.textArea.value;\n  },\n\n  _initTextMarker() {\n    this.textArea = L.PM.Draw.Text.prototype._createTextArea.call(this);\n    if (this.options.className) {\n      const cssClasses = this.options.className.split(' ');\n      this.textArea.classList.add(...cssClasses);\n    }\n    const textAreaIcon = L.PM.Draw.Text.prototype._createTextIcon.call(\n      this,\n      this.textArea\n    );\n    this._layer.setIcon(textAreaIcon);\n\n    this._layer.once('add', this._createTextMarker, this);\n  },\n\n  _createTextMarker(enable = false) {\n    this._layer.off('add', this._createTextMarker, this);\n\n    this._layer.getElement().tabIndex = -1;\n\n    this.textArea.wrap = 'off';\n    this.textArea.style.overflow = 'hidden';\n    this.textArea.style.height = L.DomUtil.getStyle(this.textArea, 'font-size');\n    this.textArea.style.width = '1px';\n\n    if (this._layer.options.text) {\n      this.setText(this._layer.options.text);\n    }\n\n    this._autoResize();\n\n    if (enable === true) {\n      // enable editing for the marker\n      this.enable();\n      this.focus();\n      this._disableOnBlur();\n    }\n  },\n\n  // Chrome ignores `user-select: none`, so we need to disable text selection manually\n  _preventTextSelection(e) {\n    e.preventDefault();\n  },\n});\n", "/**\n * Copyright (c) https://github.com/w8r/Leaflet.Path.Transform\n * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n */\n\n/**\n * @class  L.PM.Matrix\n *\n * @param {Number} a\n * @param {Number} b\n * @param {Number} c\n * @param {Number} d\n * @param {Number} e\n * @param {Number} f\n */\nconst Matrix = function Matrix(a, b, c, d, e, f) {\n  /**\n   * @type {Array.<Number>}\n   */\n  this._matrix = [a, b, c, d, e, f];\n};\n\nMatrix.init = () => new L.PM.Matrix(1, 0, 0, 1, 0, 0);\n\nMatrix.prototype = {\n  /**\n   * @param  {L.Point} point\n   * @return {L.Point}\n   */\n  transform(point) {\n    return this._transform(point.clone());\n  },\n\n  /**\n   * Destructive\n   *\n   * [ x ] = [ a  b  tx ] [ x ] = [ a * x + b * y + tx ]\n   * [ y ] = [ c  d  ty ] [ y ] = [ c * x + d * y + ty ]\n   *\n   * @param  {L.Point} point\n   * @return {L.Point}\n   */\n  _transform(point) {\n    const matrix = this._matrix;\n    const { x, y } = point;\n    point.x = matrix[0] * x + matrix[1] * y + matrix[4];\n    point.y = matrix[2] * x + matrix[3] * y + matrix[5];\n    return point;\n  },\n\n  /**\n   * @param  {L.Point} point\n   * @return {L.Point}\n   */\n  untransform(point) {\n    const matrix = this._matrix;\n    return new L.Point(\n      (point.x / matrix[0] - matrix[4]) / matrix[0],\n      (point.y / matrix[2] - matrix[5]) / matrix[2]\n    );\n  },\n\n  /**\n   * @return {L.PM.Matrix}\n   */\n  clone() {\n    const matrix = this._matrix;\n    return new L.PM.Matrix(\n      matrix[0],\n      matrix[1],\n      matrix[2],\n      matrix[3],\n      matrix[4],\n      matrix[5]\n    );\n  },\n\n  /**\n   * @param {L.Point|Number} translate\n   * @return {L.PM.Matrix|L.Point}\n   */\n  translate(translate) {\n    if (translate === undefined) {\n      return new L.Point(this._matrix[4], this._matrix[5]);\n    }\n\n    let translateX;\n    let translateY;\n    if (typeof translate === 'number') {\n      translateX = translate;\n      translateY = translate;\n    } else {\n      translateX = translate.x;\n      translateY = translate.y;\n    }\n\n    return this._add(1, 0, 0, 1, translateX, translateY);\n  },\n\n  /**\n   * @param {L.Point|Number} scale\n   * @param {L.Point|Number} origin\n   * @return {L.PM.Matrix|L.Point}\n   */\n  scale(scale, origin) {\n    if (scale === undefined) {\n      return new L.Point(this._matrix[0], this._matrix[3]);\n    }\n\n    let scaleX;\n    let scaleY;\n    origin = origin || L.point(0, 0);\n    if (typeof scale === 'number') {\n      scaleX = scale;\n      scaleY = scale;\n    } else {\n      scaleX = scale.x;\n      scaleY = scale.y;\n    }\n\n    return this._add(scaleX, 0, 0, scaleY, origin.x, origin.y)._add(\n      1,\n      0,\n      0,\n      1,\n      -origin.x,\n      -origin.y\n    );\n  },\n\n  /**\n   * m00  m01  x - m00 * x - m01 * y\n   * m10  m11  y - m10 * x - m11 * y\n   * @param {Number}   angle\n   * @param {L.Point=} origin\n   * @return {L.PM.Matrix}\n   */\n  rotate(angle, origin) {\n    const cos = Math.cos(angle);\n    const sin = Math.sin(angle);\n\n    origin = origin || new L.Point(0, 0);\n\n    return this._add(cos, sin, -sin, cos, origin.x, origin.y)._add(\n      1,\n      0,\n      0,\n      1,\n      -origin.x,\n      -origin.y\n    );\n  },\n\n  /**\n   * Invert rotation\n   * @return {L.PM.Matrix}\n   */\n  flip() {\n    this._matrix[1] *= -1;\n    this._matrix[2] *= -1;\n    return this;\n  },\n\n  /**\n   * @param {Number|L.PM.Matrix} a\n   * @param {Number} b\n   * @param {Number} c\n   * @param {Number} d\n   * @param {Number} e\n   * @param {Number} f\n   */\n  _add(a, b, c, d, e, f) {\n    const result = [[], [], []];\n    let src = this._matrix;\n    const m = [\n      [src[0], src[2], src[4]],\n      [src[1], src[3], src[5]],\n      [0, 0, 1],\n    ];\n    let other = [\n      [a, c, e],\n      [b, d, f],\n      [0, 0, 1],\n    ];\n    let val;\n\n    if (a && a instanceof L.PM.Matrix) {\n      src = a._matrix;\n      other = [\n        [src[0], src[2], src[4]],\n        [src[1], src[3], src[5]],\n        [0, 0, 1],\n      ];\n    }\n\n    for (let i = 0; i < 3; i += 1) {\n      for (let j = 0; j < 3; j += 1) {\n        val = 0;\n        for (let k = 0; k < 3; k += 1) {\n          val += m[i][k] * other[k][j];\n        }\n        result[i][j] = val;\n      }\n    }\n\n    this._matrix = [\n      result[0][0],\n      result[1][0],\n      result[0][1],\n      result[1][1],\n      result[0][2],\n      result[1][2],\n    ];\n    return this;\n  },\n};\n\nexport default Matrix;\n", "import { createGeodesicPolygon, getTranslation } from './helpers';\nimport { _toLatLng, _toPoint } from './helpers/ModeHelper';\n\nconst Utils = {\n  calcMiddleLatLng(map, latlng1, latlng2) {\n    // calculate the middle coordinates between two markers\n\n    const p1 = map.project(latlng1);\n    const p2 = map.project(latlng2);\n\n    return map.unproject(p1._add(p2)._divideBy(2));\n  },\n  findLayers(map) {\n    let layers = [];\n    map.eachLayer((layer) => {\n      if (\n        layer instanceof L.Polyline ||\n        layer instanceof L.Marker ||\n        layer instanceof L.Circle ||\n        layer instanceof L.CircleMarker ||\n        layer instanceof L.ImageOverlay\n      ) {\n        layers.push(layer);\n      }\n    });\n\n    // filter out layers that don't have the leaflet-geoman instance\n    layers = layers.filter((layer) => !!layer.pm);\n\n    // filter out everything that's leaflet-geoman specific temporary stuff\n    layers = layers.filter((layer) => !layer._pmTempLayer);\n\n    // filter out everything that ignore leaflet-geoman\n    layers = layers.filter(\n      (layer) =>\n        (!L.PM.optIn && !layer.options.pmIgnore) || // if optIn is not set / true and pmIgnore is not set / true (default)\n        (L.PM.optIn && layer.options.pmIgnore === false) // if optIn is true and pmIgnore is false);\n    );\n\n    return layers;\n  },\n  circleToPolygon(circle, sides = 60, withBearing = true) {\n    const origin = circle.getLatLng();\n    const radius = circle.getRadius();\n    const polys = createGeodesicPolygon(origin, radius, sides, 0, withBearing); // these are the points that make up the circle\n    const polygon = [];\n    for (let i = 0; i < polys.length; i += 1) {\n      const geometry = [polys[i].lat, polys[i].lng];\n      polygon.push(geometry);\n    }\n    return L.polygon(polygon, circle.options);\n  },\n  disablePopup(layer) {\n    if (layer.getPopup()) {\n      layer._tempPopupCopy = layer.getPopup();\n      layer.unbindPopup();\n    }\n  },\n  enablePopup(layer) {\n    if (layer._tempPopupCopy) {\n      layer.bindPopup(layer._tempPopupCopy);\n      delete layer._tempPopupCopy;\n    }\n  },\n  _fireEvent(layer, type, data, propagate = false) {\n    layer.fire(type, data, propagate);\n\n    // fire event to all parent layers\n    const { groups } = this.getAllParentGroups(layer);\n    groups.forEach((group) => {\n      group.fire(type, data, propagate);\n    });\n  },\n  getAllParentGroups(layer) {\n    const groupIds = [];\n    const groups = [];\n\n    // get every group layer once\n    const loopThroughParents = (_layer) => {\n      for (const _id in _layer._eventParents) {\n        if (groupIds.indexOf(_id) === -1) {\n          groupIds.push(_id);\n          const group = _layer._eventParents[_id];\n          groups.push(group);\n          loopThroughParents(group);\n        }\n      }\n    };\n\n    // check if the last group fetch is under 1 sec, then we use the groups from before\n    if (\n      !layer._pmLastGroupFetch ||\n      !layer._pmLastGroupFetch.time ||\n      new Date().getTime() - layer._pmLastGroupFetch.time > 1000\n    ) {\n      loopThroughParents(layer);\n      layer._pmLastGroupFetch = {\n        time: new Date().getTime(),\n        groups,\n        groupIds,\n      };\n      return {\n        groupIds,\n        groups,\n      };\n    }\n    return {\n      groups: layer._pmLastGroupFetch.groups,\n      groupIds: layer._pmLastGroupFetch.groupIds,\n    };\n  },\n  createGeodesicPolygon,\n  getTranslation,\n  findDeepCoordIndex(arr, latlng, exact = true) {\n    // find latlng in arr and return its location as path\n    // thanks for the function, Felix Heck\n    let result;\n\n    const run = (path) => (v, i) => {\n      const iRes = path.concat(i);\n\n      if (exact) {\n        if (v.lat && v.lat === latlng.lat && v.lng === latlng.lng) {\n          result = iRes;\n          return true;\n        }\n      } else if (v.lat && L.latLng(v).equals(latlng)) {\n        result = iRes;\n        return true;\n      }\n\n      return Array.isArray(v) && v.some(run(iRes));\n    };\n    arr.some(run([]));\n\n    let returnVal = {};\n\n    if (result) {\n      returnVal = {\n        indexPath: result,\n        index: result[result.length - 1],\n        parentPath: result.slice(0, result.length - 1),\n      };\n    }\n\n    return returnVal;\n  },\n  findDeepMarkerIndex(arr, marker) {\n    // thanks for the function, Felix Heck\n    let result;\n\n    const run = (path) => (v, i) => {\n      const iRes = path.concat(i);\n\n      if (v._leaflet_id === marker._leaflet_id) {\n        result = iRes;\n        return true;\n      }\n\n      return Array.isArray(v) && v.some(run(iRes));\n    };\n    arr.some(run([]));\n\n    let returnVal = {};\n\n    if (result) {\n      returnVal = {\n        indexPath: result,\n        index: result[result.length - 1],\n        parentPath: result.slice(0, result.length - 1),\n      };\n    }\n\n    return returnVal;\n  },\n  _getIndexFromSegment(coords, segment) {\n    if (segment && segment.length === 2) {\n      const indexA = this.findDeepCoordIndex(coords, segment[0]);\n      const indexB = this.findDeepCoordIndex(coords, segment[1]);\n      let newIndex = Math.max(indexA.index, indexB.index);\n      if ((indexA.index === 0 || indexB.index === 0) && newIndex !== 1) {\n        newIndex += 1;\n      }\n      return {\n        indexA,\n        indexB,\n        newIndex,\n        indexPath: indexA.indexPath,\n        parentPath: indexA.parentPath,\n      };\n    }\n    return null;\n  },\n  // Returns the corners of the rectangle with a given rotation\n  // degrees: Between marker A and the marker counterclockwise before. Same for marker B\n  _getRotatedRectangle(A, B, rotation, map) {\n    const startPoint = _toPoint(map, A);\n    const endPoint = _toPoint(map, B);\n    const theta = (rotation * Math.PI) / 180;\n    const cos = Math.cos(theta);\n    const sin = Math.sin(theta);\n\n    const width =\n      (endPoint.x - startPoint.x) * cos + (endPoint.y - startPoint.y) * sin;\n    const height =\n      (endPoint.y - startPoint.y) * cos - (endPoint.x - startPoint.x) * sin;\n    const x0 = width * cos + startPoint.x;\n    const y0 = width * sin + startPoint.y;\n    const x1 = -height * sin + startPoint.x;\n    const y1 = height * cos + startPoint.y;\n\n    const p0 = _toLatLng(map, startPoint);\n    const p1 = _toLatLng(map, { x: x0, y: y0 });\n    const p2 = _toLatLng(map, endPoint);\n    const p3 = _toLatLng(map, { x: x1, y: y1 });\n    return [p0, p1, p2, p3];\n  },\n  pxRadiusToMeterRadius(radiusInPx, map, center) {\n    const pointA = map.project(center);\n    const pointB = L.point(pointA.x + radiusInPx, pointA.y);\n    return map.distance(map.unproject(pointB), center);\n  },\n};\n\nexport default Utils;\n", "/* A Leaflet Plugin For Editing Geometry Layers in Leaflet 1.0\n * Copyright (C) Geoman.io and Sumit Kumar - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Sumit Kumar <sumit@geoman.io>, January 2020\n * Twitter: @TweetsOfSumit\n * OSS Repo: https://github.com/geoman-io/leaflet-geoman\n * Get Pro: https://geoman.io\n */\n\nimport './polyfills';\nimport packageInfo from '../../package.json';\n\nimport Map from './L.PM.Map';\nimport Toolbar from './Toolbar/L.PM.Toolbar';\n\nimport Draw from './Draw/L.PM.Draw';\nimport './Draw/L.PM.Draw.Marker';\nimport './Draw/L.PM.Draw.Line';\nimport './Draw/L.PM.Draw.Polygon';\nimport './Draw/L.PM.Draw.Rectangle';\nimport './Draw/L.PM.Draw.CircleMarker';\nimport './Draw/L.PM.Draw.Circle';\nimport './Draw/L.PM.Draw.Cut';\nimport './Draw/L.PM.Draw.Text';\n\nimport Edit from './Edit/L.PM.Edit';\nimport './Edit/L.PM.Edit.LayerGroup';\nimport './Edit/L.PM.Edit.Marker';\nimport './Edit/L.PM.Edit.Line';\nimport './Edit/L.PM.Edit.Polygon';\nimport './Edit/L.PM.Edit.Rectangle';\nimport './Edit/L.PM.Edit.CircleMarker';\nimport './Edit/L.PM.Edit.Circle';\nimport './Edit/L.PM.Edit.ImageOverlay';\nimport './Edit/L.PM.Edit.Text';\n\nimport '../css/layers.css';\nimport '../css/controls.css';\n\nimport Matrix from './helpers/Matrix';\n\nimport Utils from './L.PM.Utils';\n\nL.PM = L.PM || {\n  version: packageInfo.version,\n  Map,\n  Toolbar,\n  Draw,\n  Edit,\n  Utils,\n  Matrix,\n  activeLang: 'en',\n  optIn: false,\n  initialize(options) {\n    this.addInitHooks(options);\n  },\n  setOptIn(value) {\n    this.optIn = !!value;\n  },\n  addInitHooks() {\n    function initMap() {\n      this.pm = undefined;\n\n      if (L.PM.optIn) {\n        if (this.options.pmIgnore === false) {\n          this.pm = new L.PM.Map(this);\n        }\n      } else if (!this.options.pmIgnore) {\n        this.pm = new L.PM.Map(this);\n      }\n\n      if (this.pm) {\n        this.pm.setGlobalOptions({});\n      }\n    }\n\n    L.Map.addInitHook(initMap);\n\n    function initLayerGroup() {\n      this.pm = undefined;\n      if (L.PM.optIn) {\n        if (this.options.pmIgnore === false) {\n          this.pm = new L.PM.Edit.LayerGroup(this);\n        }\n      } else if (!this.options.pmIgnore) {\n        this.pm = new L.PM.Edit.LayerGroup(this);\n      }\n    }\n\n    L.LayerGroup.addInitHook(initLayerGroup);\n\n    function initMarker() {\n      this.pm = undefined;\n\n      if (L.PM.optIn) {\n        if (this.options.pmIgnore === false) {\n          if (this.options.textMarker) {\n            this.pm = new L.PM.Edit.Text(this);\n            if (!this.options._textMarkerOverPM) {\n              this.pm._initTextMarker();\n            }\n            delete this.options._textMarkerOverPM;\n          } else {\n            this.pm = new L.PM.Edit.Marker(this);\n          }\n        }\n      } else if (!this.options.pmIgnore) {\n        if (this.options.textMarker) {\n          this.pm = new L.PM.Edit.Text(this);\n          if (!this.options._textMarkerOverPM) {\n            this.pm._initTextMarker();\n          }\n          delete this.options._textMarkerOverPM;\n        } else {\n          this.pm = new L.PM.Edit.Marker(this);\n        }\n      }\n    }\n    L.Marker.addInitHook(initMarker);\n\n    function initCircleMarker() {\n      this.pm = undefined;\n\n      if (L.PM.optIn) {\n        if (this.options.pmIgnore === false) {\n          this.pm = new L.PM.Edit.CircleMarker(this);\n        }\n      } else if (!this.options.pmIgnore) {\n        this.pm = new L.PM.Edit.CircleMarker(this);\n      }\n    }\n    L.CircleMarker.addInitHook(initCircleMarker);\n\n    function initPolyline() {\n      this.pm = undefined;\n\n      if (L.PM.optIn) {\n        if (this.options.pmIgnore === false) {\n          this.pm = new L.PM.Edit.Line(this);\n        }\n      } else if (!this.options.pmIgnore) {\n        this.pm = new L.PM.Edit.Line(this);\n      }\n    }\n\n    L.Polyline.addInitHook(initPolyline);\n\n    function initPolygon() {\n      this.pm = undefined;\n\n      if (L.PM.optIn) {\n        if (this.options.pmIgnore === false) {\n          this.pm = new L.PM.Edit.Polygon(this);\n        }\n      } else if (!this.options.pmIgnore) {\n        this.pm = new L.PM.Edit.Polygon(this);\n      }\n    }\n\n    L.Polygon.addInitHook(initPolygon);\n\n    function initRectangle() {\n      this.pm = undefined;\n\n      if (L.PM.optIn) {\n        if (this.options.pmIgnore === false) {\n          this.pm = new L.PM.Edit.Rectangle(this);\n        }\n      } else if (!this.options.pmIgnore) {\n        this.pm = new L.PM.Edit.Rectangle(this);\n      }\n    }\n\n    L.Rectangle.addInitHook(initRectangle);\n\n    function initCircle() {\n      this.pm = undefined;\n\n      if (L.PM.optIn) {\n        if (this.options.pmIgnore === false) {\n          this.pm = new L.PM.Edit.Circle(this);\n        }\n      } else if (!this.options.pmIgnore) {\n        this.pm = new L.PM.Edit.Circle(this);\n      }\n    }\n\n    L.Circle.addInitHook(initCircle);\n\n    function initImageOverlay() {\n      this.pm = undefined;\n\n      if (L.PM.optIn) {\n        if (this.options.pmIgnore === false) {\n          this.pm = new L.PM.Edit.ImageOverlay(this);\n        }\n      } else if (!this.options.pmIgnore) {\n        this.pm = new L.PM.Edit.ImageOverlay(this);\n      }\n    }\n\n    L.ImageOverlay.addInitHook(initImageOverlay);\n  },\n  reInitLayer(layer) {\n    if (layer instanceof L.LayerGroup) {\n      layer.eachLayer((_layer) => {\n        this.reInitLayer(_layer);\n      });\n    }\n    if (layer.pm) {\n      // PM is already added to the layer\n    } else if (L.PM.optIn && layer.options.pmIgnore !== false) {\n      // Opt-In is true and pmIgnore is not false\n    } else if (layer.options.pmIgnore) {\n      // pmIgnore is true\n    } else if (layer instanceof L.Map) {\n      layer.pm = new L.PM.Map(layer);\n    } else if (layer instanceof L.Marker) {\n      if (layer.options.textMarker) {\n        layer.pm = new L.PM.Edit.Text(layer);\n        layer.pm._initTextMarker();\n        layer.pm._createTextMarker(false);\n      } else {\n        layer.pm = new L.PM.Edit.Marker(layer);\n      }\n    } else if (layer instanceof L.Circle) {\n      layer.pm = new L.PM.Edit.Circle(layer);\n    } else if (layer instanceof L.CircleMarker) {\n      layer.pm = new L.PM.Edit.CircleMarker(layer);\n    } else if (layer instanceof L.Rectangle) {\n      layer.pm = new L.PM.Edit.Rectangle(layer);\n    } else if (layer instanceof L.Polygon) {\n      layer.pm = new L.PM.Edit.Polygon(layer);\n    } else if (layer instanceof L.Polyline) {\n      layer.pm = new L.PM.Edit.Line(layer);\n    } else if (layer instanceof L.LayerGroup) {\n      layer.pm = new L.PM.Edit.LayerGroup(layer);\n    } else if (layer instanceof L.ImageOverlay) {\n      layer.pm = new L.PM.Edit.ImageOverlay(layer);\n    }\n  },\n};\n\nif (L.version === '1.7.1') {\n  // Canvas Mode: After dragging the map the target layer can't be dragged anymore until it is clicked\n  // https://github.com/Leaflet/Leaflet/issues/7775 a fix is already merged for the Leaflet 1.8.0 version\n  L.Canvas.include({\n    _onClick(e) {\n      const point = this._map.mouseEventToLayerPoint(e);\n      let layer;\n      let clickedLayer;\n\n      for (let order = this._drawFirst; order; order = order.next) {\n        layer = order.layer;\n        if (layer.options.interactive && layer._containsPoint(point)) {\n          // changing e.type !== 'preclick' to e.type === 'preclick' fix the issue\n          if (\n            !(e.type === 'click' || e.type === 'preclick') ||\n            !this._map._draggableMoved(layer)\n          ) {\n            clickedLayer = layer;\n          }\n        }\n      }\n      if (clickedLayer) {\n        L.DomEvent.fakeStop(e);\n        this._fireEvent([clickedLayer], e);\n      }\n    },\n  });\n}\n\n// initialize leaflet-geoman\nL.PM.initialize();\n"],
  "mappings": "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",
  "names": ["require_listCacheClear", "__commonJSMin", "exports", "module", "listCacheClear", "require_eq", "eq", "value", "other", "require_assocIndexOf", "assocIndexOf", "array", "key", "length", "require_listCacheDelete", "arrayProto", "splice", "listCacheDelete", "data", "index", "lastIndex", "require_listCacheGet", "listCacheGet", "require_listCacheHas", "listCacheHas", "require_listCacheSet", "listCacheSet", "require_ListCache", "ListCache", "entries", "entry", "require_stackClear", "stackClear", "require_stackDelete", "stackDelete", "result", "require_stackGet", "stackGet", "require_stackHas", "stackHas", "require_freeGlobal", "freeGlobal", "require_root", "freeSelf", "root", "require_Symbol", "Symbol", "require_getRawTag", "objectProto", "hasOwnProperty", "nativeObjectToString", "symToStringTag", "getRawTag", "isOwn", "tag", "unmasked", "require_objectToString", "objectToString", "require_baseGetTag", "nullTag", "undefinedTag", "baseGetTag", "require_isObject", "isObject", "type", "require_isFunction", "asyncTag", "funcTag", "genTag", "proxyTag", "isFunction", "require_coreJsData", "coreJsData", "require_isMasked", "maskSrcKey", "uid", "isMasked", "func", "require_toSource", "funcProto", "funcToString", "toSource", "require_baseIsNative", "reRegExpChar", "reIsHostCtor", "reIsNative", "baseIsNative", "pattern", "require_getValue", "getValue", "object", "require_getNative", "getNative", "require_Map", "Map", "require_nativeCreate", "nativeCreate", "require_hashClear", "hashClear", "require_hashDelete", "hashDelete", "require_hashGet", "HASH_UNDEFINED", "hashGet", "require_hashHas", "hashHas", "require_hashSet", "hashSet", "require_Hash", "Hash", "require_mapCacheClear", "mapCacheClear", "require_isKeyable", "isKeyable", "require_getMapData", "getMapData", "map", "require_mapCacheDelete", "mapCacheDelete", "require_mapCacheGet", "mapCacheGet", "require_mapCacheHas", "mapCacheHas", "require_mapCacheSet", "mapCacheSet", "size", "require_MapCache", "MapCache", "require_stackSet", "LARGE_ARRAY_SIZE", "stackSet", "pairs", "require_Stack", "Stack", "require_defineProperty", "defineProperty", "require_baseAssignValue", "baseAssignValue", "require_assignMergeValue", "assignMergeValue", "require_createBaseFor", "createBaseFor", "fromRight", "iteratee", "keysFunc", "iterable", "props", "require_baseFor", "baseFor", "require_cloneBuffer", "freeExports", "freeModule", "moduleExports", "Buffer", "allocUnsafe", "cloneBuffer", "buffer", "isDeep", "require_Uint8Array", "Uint8Array", "require_cloneArrayBuffer", "cloneArrayBuffer", "arrayBuffer", "require_cloneTypedArray", "cloneTypedArray", "typedArray", "require_copyArray", "copyArray", "source", "require_baseCreate", "objectCreate", "baseCreate", "proto", "require_overArg", "overArg", "transform", "arg", "require_getPrototype", "getPrototype", "require_isPrototype", "isPrototype", "Ctor", "require_initCloneObject", "initCloneObject", "require_isObjectLike", "isObjectLike", "require_baseIsArguments", "argsTag", "baseIsArguments", "require_isArguments", "propertyIsEnumerable", "isArguments", "require_isArray", "isArray", "require_isLength", "MAX_SAFE_INTEGER", "isLength", "require_isArrayLike", "isArrayLike", "require_isArrayLikeObject", "isArrayLikeObject", "require_stubFalse", "stubFalse", "require_isBuffer", "nativeIsBuffer", "isBuffer", "require_isPlainObject", "objectTag", "objectCtorString", "isPlainObject", "require_baseIsTypedArray", "arrayTag", "boolTag", "dateTag", "errorTag", "mapTag", "numberTag", "regexpTag", "setTag", "stringTag", "weakMapTag", "arrayBufferTag", "dataViewTag", "float32Tag", "float64Tag", "int8Tag", "int16Tag", "int32Tag", "uint8Tag", "uint8ClampedTag", "uint16Tag", "uint32Tag", "typedArrayTags", "baseIsTypedArray", "require_baseUnary", "baseUnary", "require_nodeUtil", "freeProcess", "nodeUtil", "types", "require_isTypedArray", "nodeIsTypedArray", "isTypedArray", "require_safeGet", "safeGet", "require_assignValue", "assignValue", "objValue", "require_copyObject", "copyObject", "customizer", "isNew", "newValue", "require_baseTimes", "baseTimes", "n", "require_isIndex", "reIsUint", "isIndex", "require_arrayLikeKeys", "arrayLikeKeys", "inherited", "isArr", "isArg", "isBuff", "isType", "skipIndexes", "require_nativeKeysIn", "nativeKeysIn", "require_baseKeysIn", "baseKeysIn", "isProto", "require_keysIn", "keysIn", "require_toPlainObject", "toPlainObject", "require_baseMergeDeep", "baseMergeDeep", "srcIndex", "mergeFunc", "stack", "srcValue", "stacked", "isCommon", "isTyped", "require_baseMerge", "baseMerge", "require_identity", "identity", "require_apply", "apply", "thisArg", "args", "require_overRest", "nativeMax", "overRest", "start", "otherArgs", "require_constant", "constant", "require_baseSetToString", "baseSetToString", "string", "require_shortOut", "HOT_COUNT", "HOT_SPAN", "nativeNow", "shortOut", "count", "lastCalled", "stamp", "remaining", "require_setToString", "setToString", "require_baseRest", "baseRest", "require_isIterateeCall", "isIterateeCall", "require_createAssigner", "createAssigner", "assigner", "sources", "guard", "require_merge", "merge", "require_isSymbol", "symbolTag", "isSymbol", "require_isKey", "reIsDeepProp", "reIsPlainProp", "isKey", "require_memoize", "FUNC_ERROR_TEXT", "memoize", "resolver", "memoized", "cache", "require_memoizeCapped", "MAX_MEMOIZE_SIZE", "memoizeCapped", "require_stringToPath", "rePropName", "reEscapeChar", "stringToPath", "match", "number", "quote", "subString", "require_arrayMap", "arrayMap", "require_baseToString", "INFINITY", "symbolProto", "symbolToString", "baseToString", "require_toString", "toString", "require_castPath", "castPath", "require_toKey", "toKey", "require_baseGet", "baseGet", "path", "require_get", "get", "defaultValue", "require_rbush_min", "i", "t", "r", "e", "a", "h", "o", "s", "l", "f", "u", "m", "c", "p", "d", "x", "v", "M", "callback", "list", "element", "target", "arr", "item", "searchElement", "fromIndex", "len", "k", "sameValueZero", "y", "package_default", "import_merge", "en_default", "de_default", "it_default", "id_default", "ro_default", "ru_default", "es_default", "nl_default", "fr_default", "zh_default", "zh_tw_default", "pt_br_default", "pt_pt_default", "pl_default", "sv_default", "el_default", "hu_default", "da_default", "no_default", "fa_default", "ua_default", "tr_default", "cz_default", "ja_default", "fi_default", "ko_default", "ky_default", "pt", "translations_default", "GlobalEditMode", "options", "layer", "layers", "id", "Mode_Edit_default", "GlobalDragMode", "Mode_Drag_default", "GlobalRemovalMode", "Mode_Removal_default", "GlobalRotateMode", "Mode_Rotate_default", "EventMixin", "customPayload", "workingLayer", "fireLayer", "originalLayer", "indexPath", "intersectionReset", "refLayer", "marker", "latlng", "intersection", "latlngs", "text", "eventInfo", "helpLayer", "originLatLngs", "angleDiff", "oldLatLngs", "rotationLayer", "startAngle", "action", "btnName", "button", "oldLang", "activeLang", "fallback", "translations", "enabled", "event", "eventType", "focusOn", "payload", "Events_default", "createKeyboardMixins", "pm", "activeShape", "drawInstance", "coords", "_a", "Keyboard_default", "import_get", "getTranslation", "lang", "hasFinePointer", "hasValues", "removeEmptyCoordRings", "newItem", "destinationVincenty", "lonlat", "brng", "dist", "VincentyConstants", "b", "lon1", "lat1", "pi", "alpha1", "sinAlpha1", "cosAlpha1", "tanU1", "cosU1", "sinU1", "sigma1", "sinAlpha", "cosSqAlpha", "uSq", "A", "B", "sigma", "sigmaP", "cos2SigmaM", "sinSigma", "cosSigma", "deltaSigma", "tmp", "lat2", "lambda", "C", "lam", "lamFunc", "lat2a", "createGeodesicPolygon", "origin", "radius", "sides", "rotation", "withBearing", "trueAngle", "newLonlat", "geomPoint", "points", "pLat", "pLng", "destination", "heading", "distance", "rad", "radInv", "R", "rheading", "sinLat1", "cosLat1", "cosDistR", "sinDistR", "lon2", "optA", "optB", "calcAngle", "latlngA", "latlngB", "pointA", "pointB", "angleDeg", "destinationOnLine", "prioritiseSort", "_sortingOrder", "order", "keys", "objKey", "sortingOrder", "getShape", "keyA", "keyB", "first", "second", "copyLatLngs", "fixLatOffset", "max", "getRenderer", "resolveLanguageCode", "availableTranslations", "potentialKeys", "override", "shape", "optionsModifier", "ignore", "mergeOptions", "reenableCircleMarker", "reenableCircle", "asGroup", "group", "elm", "mouseEvent", "touchEvt", "L_PM_Map_default", "PMButton", "oldDomNode", "pos", "buttonContainer", "newButton", "actionContainer", "activeActions", "actions", "_action", "name", "actionNode", "actionClick", "buttons", "btn", "image", "className", "L_Controls_default", "Toolbar", "addControls", "container", "iconClasses", "exceptThisButton", "status", "disableOthers", "toggleBtnName", "drawMarkerButton", "ctx", "drawPolyButton", "drawLineButton", "drawCircleButton", "drawCircleMarkerButton", "drawRectButton", "editButton", "dragButton", "cutButton", "deleteButton", "rotateButton", "drawTextButton", "ignoreBtns", "block", "position", "copyInstance", "instance", "control", "_options", "buttonsInBlock", "buttonName", "shapeMapping", "_order", "newbtnorder", "state", "L_PM_Toolbar_default", "SnapMixin", "markerArr", "line", "selfSnapOnly", "_b", "snapList", "closestLayer", "isMarker", "snapLatLng", "minDistance", "triggerSnap", "debugIndicatorLines", "debugLine", "amount", "closestLayers", "results", "isPolygon", "P", "closedShape", "closestCoord", "shortestDistance", "closestSegment", "loopThroughCoords", "coord", "nextIndex", "distancePoint", "shapes", "prioOrder", "snapLatlng", "distanceAC", "distanceBC", "closestVertexLatLng", "distanceMC", "priorityDistance", "maxzoom", "closest", "Snapping_default", "Draw", "defaultIcon", "enabledShape", "jsClass", "L_PM_Draw_default", "fakeDragEvent", "earthRadius", "factors", "feature", "geom", "properties", "feat", "point", "coordinates", "isNumber", "lineString", "featureCollection", "features", "fc", "radiansToLength", "radians", "units", "factor", "radiansToDegrees", "degreesToRadians", "degrees", "num", "input", "kinks", "featureIn", "line1", "line2", "lineIntersects", "line1StartX", "line1StartY", "line1EndX", "line1EndY", "line2StartX", "line2StartY", "line2EndX", "line2EndY", "denominator", "numerator1", "numerator2", "index_default", "polyPoints", "lastPolygonPoint", "addVertex", "clone", "selfIntersection", "lastLatLng", "newMarker", "hintMarkerLatLng", "markers", "removedMarker", "markerPrevious", "indexMarkerPrev", "polylineLayer", "polygonLayer", "styleMarker", "corners", "unmarkedCorners", "corner", "unmarkedCorner", "rectangleLayer", "templineStyle", "secondLatLng", "center", "circleLayer", "TinyQueue", "compare", "defaultCompare", "top", "bottom", "parent", "current", "halfLength", "left", "best", "right", "checkWhichEventIsLeft", "e1", "e2", "checkWhichSegmentHasRightEndpointFirst", "seg1", "seg2", "Event", "featureId", "ringId", "eventId", "eventToCheck", "fillEventQueue", "geojson", "eventQueue", "processFeature", "featureOrGeometry", "ii", "currentP", "nextP", "iii", "Segment", "testSegmentIntersect", "x1", "y1", "x2", "y2", "x3", "y3", "x4", "y4", "denom", "numeA", "numeB", "uA", "uB", "runCheck", "ignoreSelfIntersections", "intersectionPoints", "outQueue", "segment", "otherSeg", "sweeplineIntersections", "sweeplineIntersections_esm_default", "lineIntersect", "removeDuplicates", "intersections", "unique", "import_rbush", "coordEach", "excludeWrapCoord", "j", "geometry", "stopG", "geometryMaybeCollection", "wrapShrink", "coordIndex", "isGeometryCollection", "isFeatureCollection", "isFeature", "stop", "featureIndex", "geomIndex", "multiFeatureIndex", "geometryIndex", "geomType", "featureEach", "featureReduce", "initialValue", "previousValue", "currentFeature", "geomEach", "g", "featureProperties", "featureBBox", "flattenEach", "bbox", "coordinate", "toBBox", "RBush", "maxEntries", "rbush", "load", "equals", "json", "geojsonRbush", "truncate", "precision", "mutate", "truncateCoords", "getCoord", "getCoords", "getGeom", "getType", "_name", "lineSegment", "lineSegmentFeature", "createSegments", "segments", "previousCoords", "currentCoords", "coords1", "coords2", "west", "south", "east", "north", "from", "to", "coordinates1", "coordinates2", "dLat", "dLon", "nearestPointOnLine", "lines", "inputPoint", "inputPos", "closestPt", "totalDistance", "lineDistance", "currentLineStringIndex", "_featureIndex", "lineStringIndex", "maxSegmentIndex", "startPos", "stopPos", "segmentLength", "intersectPos", "wasEnd", "nearestPointOnSegment", "pointDistance", "segmentDistance", "__spreadProps", "__spreadValues", "dot", "v1", "v2", "v1x", "v1y", "v1z", "v2x", "v2y", "v2z", "cross", "magnitude", "normalize", "mag", "lngLatToVector", "lat", "lng", "vectorToLngLat", "z", "zClamp", "posA", "posB", "posC", "segmentAxis", "targetAxis", "intersectionAxis", "I1", "I2", "I", "segmentAxisNorm", "cmpAI", "cmpIB", "lineSplit", "splitter", "lineType", "splitterType", "truncatedSplitter", "splitLineWithPoint", "splitLineWithPoints", "tree", "search", "closestLine", "findClosestFeature", "startPoint", "endPoint", "pointsEquals", "lastCoords", "previous", "splitterCoords", "closestFeature", "closestDistance", "pt1", "pt2", "epsilon", "resulterrbound", "sum", "elen", "flen", "Q", "Qnew", "hh", "bvirt", "enow", "fnow", "eindex", "findex", "hindex", "estimate", "vec", "ccwerrboundA", "ccwerrboundB", "ccwerrboundC", "C1", "C2", "D", "orient2dadapt", "ax", "ay", "bx", "by", "cx", "cy", "detsum", "acxtail", "acytail", "bcxtail", "bcytail", "ahi", "alo", "bhi", "blo", "_i", "_j", "_0", "s1", "s0", "t1", "t0", "u3", "acx", "bcx", "acy", "bcy", "det", "errbound", "C1len", "C2len", "Dlen", "orient2d", "detleft", "detright", "o3derrboundA", "o3derrboundB", "o3derrboundC", "bc", "ca", "ab", "at_b", "at_c", "bt_c", "bt_a", "ct_a", "ct_b", "bct", "cat", "abt", "_8", "_8b", "_16", "_12", "fin", "fin2", "iccerrboundA", "iccerrboundB", "iccerrboundC", "aa", "bb", "cc", "axtbc", "aytbc", "bxtca", "bytca", "cxtab", "cytab", "abtt", "bctt", "catt", "_16b", "_16c", "_32", "_32b", "_48", "_64", "isperrboundA", "isperrboundB", "isperrboundC", "cd", "de", "ea", "ac", "bd", "ce", "da", "eb", "abc", "bcd", "cde", "dea", "eab", "abd", "bce", "cda", "deb", "eac", "adet", "bdet", "cdet", "ddet", "edet", "abdet", "cddet", "cdedet", "deter", "_8c", "_24", "_48b", "_96", "_192", "_384x", "_384y", "_384z", "_768", "xdet", "ydet", "zdet", "pointInPolygon", "polygon", "u1", "u2", "numContours", "contour", "contourLen", "booleanPointInPolygon", "polys", "inBBox", "polyResult", "booleanPointOnLine", "ptCoords", "lineCoords", "ignoreBoundary", "isPointOnLineSegment", "lineSegmentStart", "lineSegmentEnd", "excludeBoundary", "dxc", "dyc", "dxl", "dyl", "booleanContains", "feature1", "feature2", "geom1", "geom2", "type1", "type2", "compareCoords", "isPointInMultiPoint", "isMultiPointInMultiPoint", "isLineOnLine", "isMultiPointOnLine", "isLineInPoly", "isPolyInPoly", "isMultiPointInPoly", "isMultiPolyInPoly", "isPolygonInMultiPolygon", "multiPolygon", "multiPoint", "output", "multiPoint1", "multiPoint2", "coord2", "matchFound", "coord1", "haveFoundInteriorPoint", "lineString1", "lineString2", "splitLineIntoSegmentsOnPolygon", "linestring", "outputSegments", "seg", "split", "polyBbox", "lineBbox", "doBBoxOverlap", "isContainedByPolygonBoundary", "lineSegments", "midpoint", "getMidpoint", "poly1Bbox", "poly2Bbox", "ring", "bbox1", "bbox2", "pair1", "pair2", "isNumeric", "mathceil", "mathfloor", "bignumberError", "tooManyDigits", "BASE", "LOG_BASE", "POWS_TEN", "SQRT_BASE", "MAX", "configObject", "div", "convertBase", "parseNumeric", "BigNumber", "ONE", "DECIMAL_PLACES", "ROUNDING_MODE", "TO_EXP_NEG", "TO_EXP_POS", "MIN_EXP", "MAX_EXP", "CRYPTO", "MODULO_MODE", "POW_PRECISION", "FORMAT", "ALPHABET", "alphabetHasNormalDecimalDigits", "alphabet", "caseChanged", "isNum", "str", "intCheck", "round", "obj", "out", "maxOrMin", "pow2_53", "random53bitInt", "dp", "rand", "decimal", "toBaseOut", "baseIn", "baseOut", "arrL", "sign", "callerIsToString", "xc", "rm", "toFixedPoint", "coeffToString", "multiply", "base", "temp", "xlo", "xhi", "carry", "klo", "khi", "aL", "bL", "cmp", "subtract", "more", "prod", "prodL", "q", "qc", "rem", "remL", "rem0", "xi", "xL", "yc0", "yL", "yz", "yc", "bitFloor", "format", "c0", "ne", "toExponential", "normalise", "basePrefix", "dotAfter", "dotBefore", "isInfinityOrNaN", "whitespaceOrPlus", "p1", "p2", "sd", "ni", "rd", "pows10", "valueOf", "half", "isModExp", "nIsBig", "nIsNeg", "nIsOdd", "isOdd", "xLTy", "xe", "ye", "xcL", "ycL", "ylo", "yhi", "zc", "sqrtBase", "rep", "g1", "g2", "groupSeparator", "intPart", "fractionPart", "isNeg", "intDigits", "md", "d0", "d1", "d2", "exp", "n0", "n1", "min", "zs", "bignumber_default", "SplayTreeNode", "SplayTreeSetNode", "SplayTree", "newTreeRight", "newTreeLeft", "comp", "currentLeft", "currentRight", "node", "nextLeft", "nextRight", "SplayTreeSet", "_SplayTreeSet", "isValidKey", "elements", "nodes", "nodeRight", "nodeLeft", "retainSet", "modificationCount", "set", "copyChildren", "dest", "newLeft", "newRight", "SplayTreeSetEntryIterableIterator", "SplayTreeKeyIterableIterator", "SplayTreeIterableIterator", "next", "constant_default", "compare_default", "eps", "almostEqual", "orient_default", "almostCollinear", "area2", "identity_default", "snap_default", "xTree", "yTree", "snapCoord", "snap", "isInBbox", "getBboxOverlap", "b1", "b2", "lowerX", "upperX", "lowerY", "upperY", "crossProduct", "dotProduct", "sineOfAngle", "pShared", "pBase", "pAngle", "vBase", "vAngle", "cosineOfAngle", "horizontalIntersection", "verticalIntersection", "kross", "ve", "SweepEvent", "_SweepEvent", "isLeft", "ptCmp", "aPt", "bPt", "otherEvents", "iMax", "evt", "numEvents", "evt1", "evt2", "events", "baseEvent", "fillCache", "linkedEvent", "nextEvent", "asine", "acosine", "bsine", "bcosine", "RingOut", "_RingOut", "allSegments", "ringsOut", "prevEvent", "startingPoint", "intersectionLEs", "availableLEs", "firstPt", "lastPt", "indexLE", "jMax", "intersectionLE", "ringEvents", "comparator", "prevPt", "nextPt", "step", "iStart", "iEnd", "orderedPoints", "enclosing", "leftMostEvt", "prevSeg", "prevPrevSeg", "PolyOut", "exteriorRing", "geom0", "ringGeom", "MultiPolyOut", "rings", "polyGeom", "enclosingRing", "SweepLine", "queue", "newEvents", "nextSeg", "prevMySplitter", "prevInter", "newEventsFromSplit", "nextMySplitter", "nextInter", "mySplitter", "inter", "rightSE", "Operation", "moreGeoms", "operation", "multipolys", "MultiPolyIn", "subject", "mpA", "sweepEvents", "sweepLine", "operation_default", "segmentId", "_Segment", "leftSE", "windings", "alx", "blx", "arx", "brx", "aly", "bly", "ary", "bry", "aCmpBLeft", "bCmpARight", "bCmpALeft", "aCmpBRight", "leftPt", "rightPt", "winding", "cmpPts", "newRightSE", "tBbox", "oBbox", "bboxOverlap", "tlp", "trp", "olp", "orp", "touchesOtherLSE", "touchesThisLSE", "touchesOtherRSE", "touchesThisRSE", "alreadyLinked", "newLeftSE", "oldRightSE", "newSeg", "tmpEvt", "consumer", "consumee", "beforeState", "ringsAfter", "windingsAfter", "mpsAfter", "polysAfter", "polysExclude", "poly", "mp", "mpsBefore", "noBefores", "noAfters", "least", "most", "diff", "isJustSubject", "mps", "RingIn", "geomRing", "isExterior", "firstPoint", "prevPoint", "PolyIn", "geomPoly", "multiPoly", "ringSweepEvents", "isSubject", "polySweepEvents", "difference", "setPrecision", "getGeometry", "turfLineString", "turfMultiLineString", "turfPolygon", "turfMultiPolygon", "intersect", "poly1", "poly2", "intersection2", "polygon1", "polygon2", "differenced", "getDepthOfCoords", "flattenPolyline", "polyline", "depth", "groupToMultiLineString", "all", "_latlngInfos", "lineInter", "newLayer", "info", "parentPath", "newIndex", "resultLayer", "resultingLayer", "_layer", "idx", "fg", "lineDiff", "lay", "cssClasses", "textAreaIcon", "focusAfterDraw", "textArea", "DragMixin", "fromLayerSync", "layersToSyncFound", "_editableOption", "el", "deltaLatLng", "moveCoords", "currentLatLng", "newLatlng", "newCoords", "coordsRefernce", "fnc", "layersToSync", "lg", "Dragging_default", "_convertLatLng", "matrix", "zoom", "_convertLatLngs", "_toPoint", "_toLatLng", "RotateMixin", "angleDiffRadiant", "that", "forEachLatLng", "_latlng", "angle", "radiant", "_matrix", "originPoint", "oldAngle", "rads", "newAnlge", "Rotating_default", "Edit", "validationFnc", "L_PM_Edit_default", "layerGroup", "addThrottle", "_initLayers", "removeThrottle", "_layerIds", "deep", "filterGeoman", "filterGroupsOut", "MarkerLimits", "allMarkers", "markerCacheIndex", "markersToAdd", "limit", "distanceA", "distanceB", "MarkerLimits_default", "handleRing", "coordsArr", "ringArr", "leftM", "rightM", "middleMarker", "middleIcon", "icon", "newM", "coordsRing", "flash", "disabled", "isHole", "layerRemoved", "rightMarkerIndex", "leftMarkerIndex", "nextMarkerIndex", "prevMarkerIndex", "prevMarker", "nextMarker", "prevLine", "nextLine", "prevLineIntersectionLen", "nextLineIntersectionLen", "markerLatLng", "prevMarkerLatLng", "nextMarkerLatLng", "middleMarkerNextLatLng", "middleMarkerPrevLatLng", "vertex", "draggedMarker", "movedMarker", "markerLatLngs", "correctIndex", "outer", "markerA", "markerB", "crsSimple", "northwest", "northeast", "southeast", "southwest", "focusedElement", "height", "width", "focusAlreadySet", "enable", "Matrix", "translate", "translateX", "translateY", "scale", "scaleX", "scaleY", "cos", "sin", "src", "val", "Matrix_default", "Utils", "latlng1", "latlng2", "circle", "propagate", "groups", "groupIds", "loopThroughParents", "_id", "exact", "run", "iRes", "returnVal", "indexA", "indexB", "theta", "x0", "y0", "p0", "p3", "radiusInPx", "L_PM_Utils_default", "initMap", "initLayerGroup", "initMarker", "initCircleMarker", "initPolyline", "initPolygon", "initRectangle", "initCircle", "initImageOverlay", "clickedLayer"]
}
